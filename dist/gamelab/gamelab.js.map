{"version":3,"sources":["../../src/__concat/gamelab.js"],"names":["arrays","delay","fxn","timing","setTimeout","repeat","setInterval","clog","a","b","c","console","log","dlog","Gamelab","config","DEV","numbers","getMinAndMaxByPair","error","min","max","TypeCode","info","arg1","arg2","warn","number","fallback","string","arrayWrap","obj","Array","allDefined","obj_all","list","failed","x","getPreferredPropertyByKey","property","key","warning","hasOwnProperty","psuedoTypeCheck","psuedotype","throwing","getAllFuncs","Object","getOwnPropertyNames","filter","p","getProtoFuncs","__proto__","truthOrDie","exitMessage","findError","Error","e","truthyPropsPerArray","propKeys","kill","keys","prop","y","typeArgsExtract","type","typeOrHalt","typeOrError","check","object","propKey","propValue","Gamelab_Module","module","settings","DEBUG","gui_mode","recursionCount","errorLimit","errors","stopDraw","defSize","WIDTH","document","body","clientWidth","HEIGHT","clientHeight","isMobileOrTablet","test","substr","navigator","userAgent","vendor","window","opera","getVideoCardInfo","gl","createElement","getContext","debugInfo","getExtension","getParameter","UNMASKED_VENDOR_WEBGL","renderer","UNMASKED_RENDERER_WEBGL","isGameObject","constructor","name","includes","getGameWindow","ix","game_windows","gs_renderables","gs_events","spriteTypes","systemSpriteTypes","__gameWindowList","all","all_objects","forEach","item","concat","drawables","init","testSquare","Sprite","onButton","gpix","callback","GamepadEvent","Gamepads","Keys","objectDestroyed","dead","gw","objects","getObjectById","id","length","interlog","message","div","isNaN","create_id","S4","Math","random","toString","substring","quit","m","initializers","addInitializer","i","push","_gameWindow","setGameWindow","gameWindow","ExtendEvents","extendedObject","extendedKey","extendor","extendorKey","evtLink","GSEventLink","parent","onRun","onComplete","assignAll","args","__gamelabInstance","each","loadSprites","sprites","LEN","COUNT","spr","onLoad","onResult","ready_callstack","ready","reload","callReady","funx","call","InputSystem","__running","getArg","k","normalArgs","normal","str","toLowerCase","replace","isNormalStringMatch","str1","str2","instance_type_pairs","objectList","constructor_name","getById","select","group","query","__inst","GamelabApi","get","post","contents","jstr","GSO","run_ext","complete_ext","caller","callkey","indexOf","exports","JSON","stringify","$Q","selector","s","mainSelector","before","trim","msfChar","__targetClassName","output","cleanSelectorString","after","criterion","between","cparts","split","__targetGroup","__targetName","getParts","on","evt_key","selectorObject","controller_ix","boolTrigger","boolCall","boolEvent","BoolEvent","On","Call","padding","evt_profile","cix","contains_any","button_mode","GamepadAdapter","item1","iy","item2","onUpdate","update","sprite","Collision","spriteBoxCollide","condition","evt_parts","run","mykey","parseFloat","propkey","complete","c1","test_str","start_pos","end_pos","contains","contains_all","cList","c2","test_selector_method","Q_TestStrings","Mouse","Position","Speed","setPosition","isIdle","speed","events","mousemove","mousepos","leftclick","rightclick","middleclick","wheelup","wheelDown","keymap","keyReplace","String","fromCharCode","extendKey","onFinish","down","extend","downCall","upCall","up","MOUSE","im","kmapItem","onkeydown","onkeyup","event","gs_key_string","keyCode","evt_object","canvases","querySelectorAll","getMousePos","pageX","pageY","clientX","scrollLeft","documentElement","clientY","scrollTop","offsetLeft","style","top","mouseMoving","pos","el","applyMouseMove","addEventListener","onmousedown","value","which","preventDefault","onmouseup","file_system","localizedSource","src","hostUrl","gs_folder_ix","loadJSON","filepath","readTextFile","file","rawFile","XMLHttpRequest","open","onreadystatechange","readyState","status","responseText","send","loadLevel","jsonText","data","parse","$","xitem","yitem","iz","zitem","add","loadJSONLevel","loadJson","lib","Screen","size","Vector","center","round","maxErrors","EventInterfaceMap","Animation","Motion","Shot","Terrain","Interactive","Global","instance","f","fkey","ObjectFeatureMap","SpriteGroup","SpriteBrush","Frame","Particle","RectangularLine","Circle","GridAnimation","Line2d","Text","InputIFM","GamepadButtons","GamepadSticks","Keyboard","MouseMove","MouseButton","MouseWheel","LeapMotion","UIEditables","UIOption","hint","script","UIPrefab","MainSelect","FormEditables","UIPrefabMainSelect","Background","getCustomPrefabMeta","UIObjectPrefabs","Camera","z","position","radians","degrees","PI","radius","r","count","points","pt_angle","cos","sin","pt_radius_sq","sqrt","pointInTriangle","point","triangle","cx","cy","t0","t1","t2","v0x","v0y","v1x","v1y","v2x","v2y","dot00","dot01","dot02","dot11","dot12","inv","u","v","boxCollide","pos1","size1","pos2","size2","pointInBox","box","triangles","Trig","getTrianglesByBox","collisionPoints","spriteMouseCollide","obj1","obj2","scale","camPos","S","paddingX","paddingY","left","right","bottom","spriteBoxCollideArray","collisions","spritesX","spritesY","collider","spriteCollideTop","getSpatialGrid","sourceSprite","spatialDivider","anime","getCurrentPixelMap","pixelGrid","RGBColor","g","ColorCalc","hexToRgba","ColorStrings","match","parseInt","color","sumOfSquares","pow","tolerance","matches","total_diff","diff","abs","ColorCalculator","hexToRgbArray","hex","result","exec","rgbFromString","rgba_string","join","scaledRGBAFromHex","hexcolor_a","hexcolor_b","scalePoint","rgba_a","rgba_b","finalRgba","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","map_orange","map_green","map_red","map_blue","map_darkgreen","map_yellow","map_aqua","map_grey","map_gray","map_darkgrey","map_darkgray","map_black","RE_RGB","Colors","fromString","ConditionalPromise","resolve","reject","every","unless","until","promise","Promise","d","do","o","timer","memes","getBox","width","height","floor","drawMemeText","ctx","text","toUpperCase","val","drawText","strs","wrap","font","fillStyle","textAlign","textBaseline","lineWidth","strokeStyle","strokeText","fillText","num","cache","meme","upper","lower","image","canvas","_w","_h","img","Image","setAttribute","onload","drawImage","toDataURL","url","dim","Curves","Sine","In","Out","InOut","Cubic","Quintic","Circular","Elastic","c4","c5","Quadratic","Quartic","Exponential","Back","c3","Bounce","n1","d1","None","Linear","Zero","EasingCurves","inOutCurves","quadratic","t","cubic","quartic","quintic","linear","UI","getCurveCanvasList","q","ckey","fillRect","shadowBlur","shadowColor","beginPath","calcHeight","calcWidth","p2","p1","moveTo","lineTo","stroke","getCurveImageList","images","display","zIndex","background","border","getAttribute","opacity","show","topLeftElement","rect","getBoundingClientRect","hide","StateFrame","target","easingCurve","timeLimit","alert","FeildSpan","transition","duration","undefined","ticker","Duration","Clone","Reset","getValue","option","tvalue","curveMethod","testValue","finalValue","portion","curveStep","ColorFeildSpan","colors","hasVariance","PrepareColors","getPortion","FiringClock","skip","repeats","callback_arguments","chance","skipMin","skipMax","lockout","Infinity","l","millis","hasChance","skipTime","UniqueList","addUnique","GameData","applyParentAndChildRelationship","child","trackBy","children","GameWindow","bool_events","paused","drawFromWindows","engaged","querySelector","HTMLCanvasElement","append","context","camera","scaleTracker","Size","update_ext","resize_ext","onresize","isAbsoluteSize","bind","onerror","clearTimeout","domElement","array","offscreen","w","h","getImageData","__trackStat","srcImage_Path","Pos","evt","wheelDelta","gameSprites","spriteType","total_x","total_y","grid","GridUnit","isPaused","sortDrawables","arr","sort","def_update","graphic","bool","before_draw_ext","reset_draw","__gameWindow","draw","px","py","sx","sy","frameSizeX","frameSizeY","hasDrawableByPosition","imageData","putImageData","after_draw_ext","getComplete","complete_callback","completion","boundCall","beforeDraw","parentNode","removeChild","afterDraw","$gw","GSEvent","apply","backgroundColor","splice","$window","life","remove","die_callback","removeDeadObjects","time","options","dev","start","animate","frameInterval","__stats","begin","__statsMS","__statsMB","isAtPlay","TWEEN","autoClear","clearRect","end","requestAnimationFrame","Stats","showPanel","dom","appendChild","marginLeft","Event","parent_id","child_id","parent_key","child_key","EventLink","Module","uri","load","fileObject","reader","FileReader","readAsText","moduleInstance","inst","modules","__object","executeNow","construct","endsWith","createTextNode","head","Code","Function","fxnString","innerHTML","loadAndCall","loadAndRun","ScopeInterface","scope","testInterface","testInput","submitRow","submit","marginTop","innerText","onclick","$mouse","delta","sign","deltaY","OffscreenCanvas","PixelChopper","chop","GameImage","canvasChop","OffscreenCanvasRendering","sourceImage","canvasSourceImage","Vector2Range","x1","y1","x2","y2","Min","Max","VectorBounds","VectorFrameBounds","termPoint","Renderable","onCreate","I","__error","Script","Scriptable","siblings","MOD","StateAction","stateOptions","reset","engageCallback","engage","commit","optionKey","optionValue","state","State","stateName","fallbackState","triggers","triggerCall","cancellators","cancelCall","listLimit","triggerFxn","cancelFxn","StateMachine","states","Texel","TexelArray","texels","$object","jsonData","ThreeJsMath","getScreenXY","clone","projScreenMat","THREE","Matrix4","multiply","projectionMatrix","matrixWorldInverse","multiplyVector3","offset","findOffset","element","offsetParent","offsetTop","ThreeJsWindow","container","threejs","scene","Scene","PerspectiveCamera","innerWidth","innerHeight","WebGLRenderer","alpha","defaultLight","AmbientLight","setSize","Color","HTMLCollection","HTMLElement","render","ThreeJSWindow","ThreejsWindow","Trigonometry","rotatePointsByOrigin","origin","rotation","rotate_from_xy","fullPosition","point_a1","copy","point_a2","point_a3","point_b1","point_b2","point_b3","plista","negate","plistb","angle","nx","ny","rotational_speed","find_point_on_circle","single_numeric_x","copied","valid_check","multiple","ceil","speedValue","targetInc","sub","mult","dist","v1","v2","minFloat","maxFloat","atan2","minimize","key1","key2","maximize","Vector3","Vector2","Rotation","Vector2d","Vector2D","VectorMath","rotatePointsXY","theta","WebGLWindow","canvasBox","classList","dev_log","$webgl","frameSize","init_singleFrame","HTMLImageElement","min_cix","visible","frameBounds","frameOffset","apply2DFrames","flipX","selected_frame","frames","seesaw_mode","reverse_frames","Scale","$f","bone","parentBone","$frame","frame","$anime","load_call","__isInit","FrameSize","FrameBounds","_hang","SingleFrame","xFinal","yFinal","maxFrame","ReverseFrames","locked","fullPass","restartFrame","endFrame","fcount","quitLoop","framePos","FramePos","Origin","frames_reversed","slice","reverse","pop","sized_Object","canvasObject","colorMap","ColoredPixelMap","spatialDiv","colorGrid","coloGrid","ColoredPixelGrid","init_colorMap","frameSizeDiv","pixel","vector","gridObject","map","fun","update_frame","__frametype","applied","call_on_run","tween","Tween","easing","curve","Easing","to","call_on_complete","isComplete","continuous","continue","Bone","rotatedOffset","RotateTarget","Bone3D","member","threejsScale","previousOffset","rotOffset","targetRotOffset","Bone3d","BoneState","boneList","Box2D","BooleanEvent","onBool","boolFunction","callbackFunction","Boolean","CollisionEvent","$collision","$obj","$sprite","$sib","BoxCollisionEvent","InputEvent","btnix","button_ix","gamepad_ix","six","stickix","stick_ix","inputKey","keyboardKeys","keyitem","KeyboardEvent","gps","gamepadKeys","MouseLeftClickEvent","Callback","cb","MouseMoveEvent","MousePosEvent","MouseRightClickEvent","StoreOffscreen","unitSize","getColoredPixelGrid","nonColorMap","getNonColoredPixelGrid","altImage","pixelMap","getFullPixelGrid","testCtx","fullPixelMap","gamepads","__gamepads","intervals","controller_stack","__gamepadMaster","xbox_pc","button_0","button_1","button_2","button_3","button_4","button_5","button_6","button_7","button_8","button_9","button_10","button_11","button_12","button_13","button_14","button_15","selectSettings","gamepad","index","buttons","axes","mainLoop","clearInterval","getGamepads","process","selectedSettings","game_pad_index","game_pad","$adapter","gp","stick_left","stick_right","extendFunc","f1","f2","fc","normal_key","current_cb","parts","gpEvents","process_buttons","process_axes","axis1","axia2","pressed","clearance_1","gpc","bkey","GamepadEvents","phase_index","colorStops","gradient_call","minBlur","maxBlur","stepFunction","blurStepFunction","blurTimer","gameObject","lineCollisionCallback","gop","gos","COLLIDE","LINE","x_total","out_of_1","next_x","next_y","last_point","next_point","angleBetween","window_offset","layer","gc","globalComposite","save","lastPoint","gradient","real_pos","blurTime","blurLen","globalCompositeOperation","globalAlpha","closePath","fill","restore","Line2D","Sound","sound","volume","srcList","SoundList","Volume","loop","soundOff","play","sounds","Audio","trackableSpeed","referenceSize","startSize","Life","DefaultValues","NormalizeOptions","Options","sourceSprites","livingSprites","total","inTestMode","prerendered","precanvas","testDom","overflow","prectx","portions","presprites","fw","fh","isPrerendered","V","presprite","testSize","colorOptions","colorOptionSet","all_colors","max_ix","effectDataList","colorIndex","pushColorEffectCanvas","ColorEffect","Layer","ScrollFactor","active","selected_animation","xpos","ypos","scrollFactor","noScroll","targetSize","realWidth","realHeight","pct","effectCanvasList","targetCanvas","imageFrameArgs","canvasContext","flipY","Canvas","draw_image_frame","def_life","composite","gobalCompositeOperation","Composite","Alpha","Angle","maxlife","particle","oldest","maxTicker","nextObjectIndex","countLiving","stock","detached_particle","lockedRotation","positions","shape","pointMode","getRandomCircumferencePoints","getRandomPoints","lastSprite","has","flyByRotation","gunOptions","angleDiff","fly_angle","trackablePosition","Opacity","gunSpeed","lineList","lineSelector","lines","addParticles","$p","Effect","arguments","GravityForce","description","subjects","clasticObjects","topClastics","accel","itemx","jumping","flying","accelY","__inAir","Force","GForce","Gravity","Elipsoid","borderGradient","invisible","borderGradientColorA","borderGradientColorB","gradientColorA","gradientColorB","Fill","bt","borderThickness","startX","createLinearGradient","addColorStop","translate","rotate","arc","Rectangle","strokeRect","CircleShape","handleAnimationArgs","animations","filters","effects","actions","handleCanvasArgs","apply_args","forEachPixel","srcTail","isBroken","clearEffects","effectCanvas","effectCtx","stored","effectFrames","api","effectCanvasTimer","doCanvasEffects","next","load_total","err","FromData","array_instance","sourceError","listnames","ln","motions","particles","shots","init_ext","realPosition","collision_bounds","GROUNDED","acceleration","rot_speed","rot_accel","Anime","hasError","errorTimer","selected_sprite","DRAWOFFSCREEN","onScreen","draw_current_frame","spriteCollideArray","amt","rate","assertSpeed","frameList","camera_pos","fx","fy","fxlCopy","scaleFloat","above_zero_xy","size_x","size_y","diffpos","half","boundFun","framesize","__mapSize","mx","my","wth","htw","_obj","actionObject","Name","Parent","lineObject","curveKey","motionCurveOptions","line","__crtLineIx","pctFloat","ixChange","prep_key","animation","bullet","velocity","rot_offset","rot_disp","__playerInst","bx","by","bw","bh","shot","rotPlus","subsprite","diff_min_y","diff_min_x","diff_max_y","diff_max_x","dimens","minkey","grounded","pLeft","pRight","apart","ct","diffX","distX","items","solidGroundPosition","solidGroundSprite","overlap_x","nextY","tilesX","tilesY","unitWidth","unitHeight","srcImageSave","file_path","getJSON","decycle","BoneSprite","bones","oncreate","SetParentPosition","boffset","CalcOffset","b1","b2","frame_offset","CompositeSprite","SpriteFill","overlaySprites","mode","selection_mode","selected_mode","onCreateShape","bounds","enclose_rectangle","tracker","currentSize","currentIndex","offscreenCanvas","nextSprite","Item","imageOptions","collisionObjects","collisionBehavior","collectionAnimation","imageProfiles","ScriptedSprite","ScrollingBackground","source_objects","members","rows","cols","flip","approxRows","approxCols","xBacksTotal","yBacksTotal","minX","maxX","minY","maxY","campos","cleanCheck","SpriteAlgorythm","setCallback","Engage","spritebrush","outputSprite","oix","addSprite","addOverlaySprite","SpriteFactory","livingTotal","lockoutTime","frequency","menu_sprite","exampleSprite","onCreateSprite","createSprite","exampleSprites","loadFxn","numberUpdates","$controller","livingCount","onfire","assignTrackableSpeed","assignLinesAndSelector","onupdate","enter","mainSprite","basePosition","skipTop","skipLeft","CookieCutterTerrain","baseSprite","StaticAnimation","FontSize","FontFamily","blur","fsize","ffamily","fontSize","fontFamily","measureText","realPos","getOffsetPos","assign3DGroupMesh","mesh","ThreejsGroups","Object3D","countOps","Sprite3D","gamelabSprite","texture","TextureLoader","wrapS","wrapT","ClampToEdgeWrapping","geometry","PlaneGeometry","vertices","material","MeshPhongMaterial","transparent","side","DoubleSide","Mesh","needsUpdate","spriteScale","set","size3D","size3d","builderGroup","threejsGroup","threejsMesh","realSize","t3d","size2D","visibleSize","updateMatrixWorld","vertex","vertexWorldCoord","applyMatrix4","matrixWorld","vertexScreenSpace","project","Box2","scaleValue","Box3","setFromObject","getSize","distance","distanceTo","aspect","vFOV","degToRad","fov","ratio","viewProjectionMatrix","viewMatrix","multiplyMatrices","widthHalf","heightHalf","setFromMatrixPosition","boundingBox","getCenter","maxDim","cameraZ","objectWorldPosition","directionVector","unitDirectionVector","normalize","multiplyScalar","lookAt","minZ","cameraToFarEdge","far","updateProjectionMatrix","Sprite3d","FeatureSymbol","symbol","Symbol","FeatureInjectors","FeatureInject","GClassFeatures","featureSymbols","hasKey","hasSymbol","props","prototype","CssFeatures","min_color","max_color","DataFunctions","n","Description","Context","VectorFunctions","collision_callback","onCollide","collideables","Rot","Rotate","bpx","baseRotation","Transpose","Minimum","Maximum","minable","maxable","np","FlipX","middle","FlipY","curve_string","setTweenCurve","cps","s1","s2","easeType","curvesToArray","GamelabCanvas","__levelMaker","draw_object","isStopped","imageFrameOptions","deg","rad","psuedoImage","htmlImage","testCanvas","paths","derez","path","nu","$ref","retrocycle","rez","eval","json_stringify","arg3","clean_object","json_parse","retro_object","cssText","addPanel","panel","beginTime","performance","Date","now","prevTime","fpsPanel","Panel","msPanel","self","memory","memPanel","REVISION","usedJSHeapSize","jsHeapSizeLimit","setMode","fg","bg","PR","devicePixelRatio","TEXT_X","TEXT_Y","GRAPH_X","GRAPH_Y","GRAPH_WIDTH","GRAPH_HEIGHT","maxValue","_tweens","getAll","removeAll","preserve","_object","_valuesStart","_valuesEnd","_valuesStartRepeat","_duration","_repeat","_repeatDelayTime","_yoyo","_isPlaying","_reversed","_delayTime","_startTime","_easingFunction","_interpolationFunction","Interpolation","_chainedTweens","_onStartCallback","_onStartCallbackFired","_onUpdateCallback","_onCompleteCallback","_onStopCallback","field","properties","stop","stopChainedTweens","numChainedTweens","amount","times","repeatDelay","yoyo","interpolation","chain","onStart","onStop","elapsed","charAt","isFinite","tmp","Sinusoidal","fn","Utils","Bezier","pw","bn","Bernstein","CatmullRom","p0","Factorial","p3","v0","t3","root","define","amd"],"mappings":"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","file":"gamelab.js","sourcesContent":["//TODO: list the fxns needed for arrays only\r\n\r\nlet arrays = {\r\n\r\n\r\n};\r\n;//Simplified expressions for setTimeout and setInterval\r\nlet delay = (fxn, timing) => {\r\n  setTimeout(fxn, timing);\r\n};\r\n\r\nlet repeat = (fxn, timing) => {\r\n  setInterval(fxn, timing);\r\n};\r\n;let clog = (a, b, c) => {\r\n  console.log(a, b, c);\r\n};\r\n\r\nlet dlog = () => {\r\n  if (Gamelab.config.DEV)\r\n    console.log(a, b, c)\r\n};\r\n;\r\n//TODO: list the fxns needed for numbers only\r\n\r\nlet numbers = {\r\n\r\n  getMinAndMaxByPair:function(a, b){\r\n\r\n    if(!(a || b))\r\n    return console.error('null or undefined args');\r\n\r\n    if(typeof a == 'number' && !b)\r\n    return {min:a, max:a}\r\n    else if(a >= b)\r\n    {\r\n      return {\r\n        min:b, max:a\r\n      }\r\n    }\r\n    else\r\n    {\r\n      return {\r\n        min:a, max:b\r\n      }\r\n    }\r\n  }\r\n\r\n};\r\n;let TypeCode = {\r\n\r\n  DEV:false,\r\n\r\n  //Display message in console\r\n  info: function(arg1, arg2) {\r\n\r\n    if(!this.DEV)\r\n    return;\r\n\r\n    console.info(arg1, arg2);\r\n\r\n  },\r\n\r\n  log:function(arg1, arg2){\r\n\r\n    if(!this.DEV)\r\n    return;\r\n\r\n      console.log(arg1, arg2);\r\n\r\n  },\r\n\r\n  /* ERRORS always show */\r\n  error:function(arg1, arg2){\r\n\r\n    if(!this.DEV)\r\n    return;\r\n\r\n      console.error(arg1, arg2);\r\n\r\n  },\r\n\r\n\r\n  warn:function(arg1, arg2){\r\n\r\n    if(!this.DEV)\r\n    return;\r\n\r\n      console.error(arg1, arg2);\r\n\r\n  },\r\n\r\n  //obj is number or becomes fallback\r\n  number: function(number, fallback = 0) {\r\n\r\n    number = typeof(number) == 'number' ? number : fallback;\r\n\r\n  },\r\n\r\n  //obj is string or becomes fallback\r\n  string: function(string, fallback) {\r\n\r\n    string = typeof(string) == 'string' ? string : fallback;\r\n\r\n  },\r\n\r\n  //obj is Array or becomes wrapped in [] as [obj]\r\n  arrayWrap: function(obj) {\r\n    if (obj instanceof Array)\r\n      return obj;\r\n    else\r\n      return [obj];\r\n  },\r\n\r\n  //obj or array-of-objects are ALL truthy (return=true) or not (return=false)\r\n  allDefined: function(obj_all) {\r\n\r\n    var list = this.arrayWrap(obj_all);\r\n\r\n    var failed = false;\r\n\r\n    for (var x in list) {\r\n      if (!list[x]) {\r\n        failed = true;\r\n        console.error('Failed to define @ TypeCode.Define()');\r\n      }\r\n    };\r\n\r\n    return !failed;\r\n  },\r\n\r\n  //getPreferredPropertyByKey(): uses the property[key] if present, if not returns same property passed in\r\n  getPreferredPropertyByKey:function(property, key, warning){\r\n\r\n    if(property.hasOwnProperty(key))\r\n    {\r\n      this.warn(warning);\r\n      return property[key];\r\n    }\r\n\r\n    else {\r\n      return property;\r\n    }\r\n  },\r\n\r\n\r\n  //obj's are all of type or return false\r\n  psuedoTypeCheck: function(obj, psuedotype = [], throwing = false) //obj is type or is encapsulated into type\r\n  {\r\n    var list = this.arrayWrap(obj);\r\n\r\n    for (var x in list) {\r\n      if (typeof(list[x]) !== psuedotype && !(list[x] instanceof psuedotype)) {\r\n        if (!throwing)\r\n          return console.error(error);\r\n        else\r\n          throw new console.error(error);\r\n      }\r\n    }\r\n\r\n    return true;\r\n  },\r\n\r\n  getAllFuncs: function(obj) {\r\n\r\n    return Object.getOwnPropertyNames(obj).filter(function (p) {\r\n        return typeof obj[p] === 'function';\r\n    });\r\n\r\n  },\r\n\r\n  getProtoFuncs: function(obj) {\r\n\r\n    return Object.getOwnPropertyNames(obj.__proto__).filter(function (p) {\r\n        return typeof obj[p] === 'function';\r\n    });\r\n\r\n  },\r\n\r\n  truthOrDie:function(list, exitMessage) //All members of Array are truthy or the program exits with Error()\r\n  {\r\n    function findError(obj, error) {\r\n      return obj || new Error(error)\r\n    };\r\n\r\n    for (var x in list) {\r\n\r\n        let e = findError(list[x], exitMessage);\r\n\r\n        if (e instanceof Error) {\r\n            console.Error(e);\r\n        }\r\n      };\r\n  },\r\n\r\n  truthyPropsPerArray: function(obj, propKeys, kill) {\r\n\r\n    var list = this.arrayWrap(obj),\r\n      keys = this.arrayWrap(propKeys);\r\n\r\n    let error = \"The required truthy property has non-truthy value.\";\r\n\r\n    function findError(obj, prop) {\r\n      return obj[prop] || new Error(error)\r\n    };\r\n\r\n    var failed = false;\r\n\r\n    for (var x in list) {\r\n      for (var y in keys) {\r\n        let e = findError(list[x], keys[y]);\r\n        if (e instanceof Error) {\r\n          failed = true;\r\n          if (kill)\r\n            throw e;\r\n          else\r\n            console.error(e);\r\n        }\r\n      }\r\n    }\r\n\r\n    return !failed;\r\n  },\r\n\r\n  typeArgsExtract: function(obj, type) //obj is type or is each-converted into type\r\n  {\r\n    if (obj instanceof type) {\r\n      return obj;\r\n    } else {\r\n      obj = [obj];\r\n    }\r\n    return obj;\r\n  },\r\n\r\n  typeOrHalt: function(obj, type) //obj is type or error is thrown\r\n  {\r\n    if (obj instanceof type) {\r\n      return obj;\r\n    } else {\r\n      throw new Error('object not of required type');\r\n      console.info(obj);\r\n      console.info(type + \"?\");\r\n    }\r\n    return obj;\r\n  },\r\n\r\n  typeOrError: function(obj, type) //obj is type or error is logged, execution continues\r\n  {\r\n    if (obj instanceof type) {\r\n      return obj;\r\n    } else {\r\n      console.log(new Error('object not of required type'));\r\n      console.info(obj);\r\n      console.info(type + \"?\");\r\n    }\r\n    return obj;\r\n  },\r\n\r\n  check:function(object, propKey, propValue)\r\n  {\r\n    if(!object[propKey])\r\n    {\r\n       object[propKey] = propValue;\r\n    }\r\n  }\r\n};\r\n;/**@author\r\n Jordan Blake\r\n * */\r\n\r\n/**@copyright\r\n Copyright 2018\r\n **/\r\n\r\n\r\n//Gamelab: the main module object:\r\nlet Gamelab_Module = function() {\r\n\r\n  var module = {\r\n\r\n    settings: {\r\n\r\n      DEBUG: false,\r\n\r\n      gui_mode: true,\r\n\r\n      recursionCount: 0,\r\n\r\n      errorLimit: 20\r\n    },\r\n\r\n    errors: 0,\r\n\r\n    stopDraw: false,\r\n\r\n    defSize() {\r\n      if (this.WIDTH == 0) {\r\n        this.WIDTH = document.body.clientWidth;\r\n      }\r\n\r\n      if (this.HEIGHT == 0) {\r\n        this.HEIGHT = document.body.clientHeight;\r\n      }\r\n\r\n    },\r\n\r\n    /*\r\n     *\r\n     * A simple method to detect whether the user agent is mobile or tablet\r\n     * -assumes that if not mobile or tablet then it must be a PC\r\n     * isMobileOrTablet(){}\r\n     **/\r\n\r\n    isMobileOrTablet: function() {\r\n      let check = false;\r\n      (function(a) {\r\n        if (/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0, 4))) check = true;\r\n      })(navigator.userAgent || navigator.vendor || window.opera);\r\n      return check;\r\n    },\r\n\r\n    /**\r\n     * A very simple method to retrieve the name of the default videocard of the system\r\n     * using webgl.\r\n     *\r\n     * @see https://stackoverflow.com/questions/49267764/how-to-get-the-video-card-driver-name-using-javascript-browser-side\r\n     * @returns {Object}\r\n     */\r\n    getVideoCardInfo: function() {\r\n      const gl = document.createElement('canvas').getContext('webgl');\r\n\r\n      if (!gl) {\r\n        return {\r\n          error: \"no webgl\",\r\n        };\r\n      }\r\n\r\n      const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');\r\n\r\n      if (debugInfo) {\r\n        return {\r\n          vendor: gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL),\r\n          renderer: gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL),\r\n        };\r\n      }\r\n\r\n      return {\r\n        error: \"no WEBGL_debug_renderer_info\",\r\n      };\r\n    },\r\n\r\n    isGameObject(object) {\r\n      object.type = object.constructor.name;\r\n      return ['Sprite',\r\n        'BackgroundElement',\r\n        'BackgroundFill',\r\n        'Terrain',\r\n        'Animation',\r\n        'Frame',\r\n        'Line2D'\r\n      ].includes(object.type);\r\n    },\r\n\r\n    getGameWindow(ix = 0) {\r\n      return this.game_windows[0]\r\n    },\r\n\r\n    WIDTH: 0,\r\n\r\n    HEIGHT: 0,\r\n\r\n    game_windows: [],\r\n\r\n    gs_renderables: [],\r\n\r\n    gs_events: [],\r\n\r\n    spriteTypes: [],\r\n\r\n    systemSpriteTypes: ['player', 'enemy', 'background', 'interactive', 'terrain', 'weapon', 'subsprite'],\r\n\r\n    __gameWindowList: [],\r\n\r\n    all: function() {\r\n      var all_objects = [];\r\n      this.game_windows.forEach(function(item) {\r\n        all_objects = all_objects.concat(item.drawables);\r\n      });\r\n      console.info('Gamelab.all():', all_objects);\r\n      return all_objects;\r\n    },\r\n\r\n    init: function() {\r\n\r\n      this.testSquare = new Gamelab.Sprite();\r\n\r\n\r\n    },\r\n\r\n    onButton: function(gpix = 0, callback) {\r\n      if (typeof gpix == 'function') {\r\n        callback = gpix;\r\n        gpix = 0;\r\n      }\r\n      new Gamelab.GamepadEvent().Gamepads([gpix]).Keys();\r\n    },\r\n\r\n    objectDestroyed(obj) {\r\n      var dead = true;\r\n\r\n      for (var x in this.game_windows) {\r\n        let gw = this.game_windows[x];\r\n\r\n        for (var y in gw.objects) {\r\n          if (gw.objects[y] === obj)\r\n            dead = false;\r\n        }\r\n      }\r\n      return dead;\r\n    },\r\n\r\n    getObjectById(id) {\r\n      for (var x = 0; x < this.all_objects.length; x++) {\r\n        if (this.all_objects[x].id == id) {\r\n          return this.all_objects[x];\r\n        }\r\n      }\r\n    },\r\n\r\n    interlog: function(message, div) //recursive safe :: won't go crazy with recursive logs :: log message every x times this is called\r\n    {\r\n      this.recursionCount++;\r\n      if (!isNaN(div) && this.settings.recursionCount % div == 0) {\r\n        //   console.log('Interval Log:'+  message);\r\n      }\r\n    },\r\n\r\n\r\n    create_id: function() {\r\n      var S4 = function() {\r\n        return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\r\n      };\r\n      return (S4() + S4() + \"-\" + S4() + \"-\" + S4() + \"-\" + S4() + \"-\" + S4() + S4() + S4());\r\n    },\r\n\r\n\r\n    error: function(quit, message) {\r\n\r\n      if (quit) {\r\n        throw new Error(message);\r\n      } else {\r\n        console.error('E!' + message);\r\n      }\r\n    },\r\n\r\n    info: function(m) {\r\n\r\n      if (Gamelab.DEBUG) {\r\n        console.info('Info:' + m);\r\n      }\r\n    },\r\n\r\n\r\n    log: function(m) {\r\n\r\n      if (Gamelab.DEBUG) {\r\n        console.log('Gamelab:' + m);\r\n      }\r\n    },\r\n\r\n    initializers: [],\r\n\r\n    addInitializer: function(i) {\r\n\r\n      this.initializers.push(i);\r\n\r\n    },\r\n\r\n    _gameWindow: {},\r\n\r\n    setGameWindow: function(gameWindow) {\r\n      this._gameWindow = gameWindow;\r\n    },\r\n\r\n    ExtendEvents: function(extendedObject, extendedKey, extendor, extendorKey) {\r\n      var evtLink = new GSEventLink(extendedObject, extendedKey, extendor, extendorKey);\r\n\r\n      this.all_objects.push(new GSEventLink(extendedObject, extendedKey, extendor, extendorKey));\r\n\r\n      var parent = extendedObject;\r\n\r\n      // console.log(parent);\r\n\r\n      if (parent) {\r\n        console.log('Gamelab:EXTENDING EVENTS:' + extendedKey + \":\" + extendorKey);\r\n\r\n        if (parent.onRun) //Any extendable object has an onRun ... OR\r\n        {\r\n          parent.onRun(extendor, extendorKey);\r\n\r\n        }\r\n        if (parent.onComplete) //object has an onComplete\r\n        {\r\n          parent.onComplete(extendor, extendorKey);\r\n\r\n        }\r\n      }\r\n    },\r\n\r\n\r\n    assignAll: function(object, args, keys) {\r\n\r\n      __gamelabInstance.each(keys, function(ix, item) {\r\n\r\n        object[ix] = args[ix];\r\n\r\n      });\r\n\r\n    },\r\n\r\n\r\n    loadSprites: function(sprites, callback) {\r\n\r\n      var LEN = sprites.length,\r\n        COUNT = 0;\r\n\r\n      if (sprites instanceof Array) {\r\n        sprites.forEach(function(spr) {\r\n\r\n          spr.onLoad(function() {\r\n\r\n            COUNT += 1;\r\n\r\n            if (COUNT >= LEN) {\r\n              callback(sprites);\r\n            }\r\n\r\n          });\r\n\r\n        });\r\n      } else if (typeof sprites == 'object') {\r\n        LEN = Object.keys(sprites).length;\r\n\r\n        for (var x in sprites) {\r\n          var spr = sprites[x];\r\n          if (spr.constructor.name == 'Sprite' ||\r\n            spr.constructor.name == 'BoneSprite' ||\r\n            spr.constructor.name == 'SpriteGroup' ||\r\n            spr.constructor.name == 'Animation') {\r\n            spr.onLoad(function() {\r\n\r\n              COUNT += 1;\r\n\r\n              if (COUNT >= LEN) {\r\n                callback(sprites);\r\n              }\r\n            });\r\n          }\r\n        }\r\n      }\r\n    },\r\n\r\n    each: function(list, onResult, onComplete) {\r\n      for (var i in list) {\r\n        onResult(i, list[i]);\r\n      }\r\n\r\n      if (typeof(onComplete) === 'function') {\r\n        onComplete(false, list)\r\n      };\r\n\r\n    },\r\n\r\n    ready_callstack: [],\r\n\r\n    ready: function(callback) {\r\n\r\n      this.ready_callstack.push(callback);\r\n\r\n    },\r\n    reload: function() {\r\n\r\n      this.callReady();\r\n\r\n    },\r\n\r\n    callReady: function() {\r\n\r\n      var funx = this.ready_callstack;\r\n\r\n      var gameWindow = this.game_windows[0],\r\n        module = this;\r\n\r\n      //call every function in the ready_callstack\r\n\r\n      this.each(funx, function(ix, call) {\r\n\r\n        call(module, gameWindow);\r\n\r\n      });\r\n\r\n      this.InputSystem.init();\r\n\r\n      this.__running = true;\r\n\r\n    },\r\n\r\n    getArg: function(args, keys, fallback) {\r\n\r\n      if (typeof(keys) == 'string') {\r\n        keys = [keys]; //always array\r\n      }\r\n      for (var x = 0; x < keys.length; x++) {\r\n        var k = keys[x];\r\n\r\n        if (args && args.hasOwnProperty(k)) {\r\n          return args[k]; //return first argument match\r\n        }\r\n      }\r\n      return fallback;\r\n    },\r\n\r\n    normalArgs: function(args) {\r\n\r\n      var a = {};\r\n\r\n      function normal(str) {\r\n        return str.toLowerCase().replace('-', '').replace(' ', '').replace('_', '')\r\n      };\r\n\r\n      for (var x in args) {\r\n        a[normal(x)] = args[x];\r\n      }\r\n\r\n      return a;\r\n    },\r\n\r\n    isNormalStringMatch: function(str1, str2) {\r\n\r\n      return str1.toLowerCase().replace(' ', '') == str2.toLowerCase().replace(' ', '');\r\n\r\n    },\r\n\r\n    instance_type_pairs: function() {\r\n\r\n      //get an array of all instance/type pairs added to the library\r\n\r\n      //example : [ {constructor_name:Sprite, type:enemy_basic}, {constructor_name:Animation, type:enemy_attack}  ];\r\n\r\n      var objectList = [];\r\n\r\n      this.each(this.all_objects, function(ix, item) {\r\n\r\n        objectList.push({\r\n          constructor_name: item.constructor.name,\r\n          type: item.type\r\n        });\r\n\r\n      });\r\n\r\n      return objectList;\r\n\r\n    },\r\n\r\n    getById: function(id) {\r\n\r\n      for (var x in this.all_objects) {\r\n        if (this.all_objects[x].id == id) {\r\n          return this.all_objects[x];\r\n\r\n        }\r\n\r\n      }\r\n\r\n    },\r\n\r\n    select: function(constructor_name, name, group /*ignoring spaces and CAPS/CASE on type match*/ ) {\r\n\r\n      var query = [];\r\n\r\n      var __inst = this;\r\n\r\n      this.each(Gamelab.all(), function(ix, item) {\r\n\r\n        if (constructor_name == '*' || item.constructor.name == constructor_name) {\r\n\r\n          if (group == '*' || __inst.isNormalStringMatch(group, item.group)) {\r\n\r\n            if (name == '*' || __inst.isNormalStringMatch(name, item.name)) {\r\n\r\n              query.push(item);\r\n\r\n            }\r\n          }\r\n        }\r\n      });\r\n\r\n      return query;\r\n    }\r\n  }\r\n\r\n  return module;\r\n\r\n};\r\n\r\nlet GamelabApi = {\r\n  get: function() {\r\n\r\n\r\n  },\r\n\r\n  post: function(object) {\r\n    //TODO decycle the object before saving\r\n\r\n    if (!object.id) {\r\n      object.id = Gamelab.create_id();\r\n\r\n    }\r\n\r\n    var name = object.name,\r\n      type = object.constructor.name,\r\n      contents = jstr(object),\r\n      id = object.id;\r\n\r\n\r\n  }\r\n\r\n};\r\n\r\n\r\nclass GSO //Gamelab-Overrideable\r\n{\r\n  constructor(args = {}) {\r\n\r\n    this.run_ext = args.run_ext || [];\r\n\r\n    this.complete_ext = args.complete_ext || [];\r\n  }\r\n\r\n  /*****\r\n   * Overridable / Extendable functions\r\n   * -allows stacking of external object-function calls\r\n   ******/\r\n\r\n  onRun(caller, callkey) {\r\n    this.run_ext = this.run_ext || [];\r\n\r\n    if (this.run_ext.indexOf(caller[callkey]) == -1) {\r\n      this.run_ext.push({\r\n        caller: caller,\r\n        callkey: callkey\r\n      });\r\n    }\r\n  }\r\n\r\n  onComplete(caller, callkey) {\r\n    this.complete_ext = this.complete_ext || [];\r\n\r\n    if (this.complete_ext.indexOf(caller[callkey]) == -1) {\r\n      this.complete_ext.push({\r\n        caller: caller,\r\n        callkey: callkey\r\n      });\r\n    }\r\n  }\r\n\r\n  call_on_run() {\r\n    //call any function extension that is present\r\n    for (var x = 0; x < this.run_ext.length; x++) {\r\n      this.run_ext[x].caller[this.run_ext[x].callkey]();\r\n    }\r\n  }\r\n\r\n  call_on_complete() {\r\n    //call any function extension that is present\r\n    for (var x = 0; x < this.complete_ext.length; x++) {\r\n      this.complete_ext[x].caller[this.complete_ext[x].callkey]();\r\n    }\r\n  }\r\n\r\n}\r\n\r\nlet Gamelab = Gamelab_Module();\r\n\r\n\r\nGamelab.DEV = true;\r\n\r\n\r\nif (typeof module !== 'undefined' && module.exports) {\r\n\r\n  //This library is being instaniated via require() aka node.js require or similar library loader\r\n  module.exports = Gamelab;\r\n\r\n} else {\r\n\r\n\r\n}\r\n\r\n/***************\r\n * TODO : fix the above duplicate references, which exist now for backward compatibility with previouslyh authored code\r\n *  -apply find and replace accross the codebase\r\n * ****************/\r\n\r\n/********\r\n * jstr() : public function for stringifying objects and arrays (uses pretty print style)\r\n * *********/\r\n\r\nfunction jstr(obj) {\r\n\r\n  return JSON.stringify(obj);\r\n\r\n};\r\n\r\nGamelab.jstr = jstr;\r\n\r\n/**********\r\n * $Q : Selector Function\r\n *  -allows string-based-selection of game-objects.\r\n * **********/\r\n\r\nfunction $Q(selector, gameWindow) {\r\n\r\n  //declare events:\r\n\r\n  console.log(selector);\r\n\r\n  var query = [];\r\n\r\n  //handle selector / selection of objects:\r\n\r\n  if (typeof selector !== 'string') {\r\n\r\n    if (selector instanceof Array) {\r\n\r\n    } else {\r\n\r\n\r\n    }\r\n\r\n  } else {\r\n\r\n\r\n    if (selector && selector !== '*') {\r\n\r\n      var s = selector || '';\r\n\r\n      console.info('selector:' + s);\r\n\r\n\r\n      var mainSelector = $Q.before('[', s).trim(),\r\n        msfChar = mainSelector.substring(0, 1);\r\n\r\n      var __targetClassName = \"*\";\r\n\r\n      var output = [];\r\n\r\n      var cleanSelectorString = function(str) {\r\n        return str.replace(\",\", \"\");\r\n      };\r\n\r\n      switch (msfChar.toLowerCase()) {\r\n        case \".\":\r\n\r\n          console.info('Selecting by \".\" or class');\r\n\r\n          __targetClassName = cleanSelectorString($Q.after('.', mainSelector));\r\n\r\n          console.info('Target class is:' + __targetClassName);\r\n\r\n          break;\r\n\r\n        case \"*\":\r\n\r\n          console.info('Selecting by \"*\" or ANY object in the library instance');\r\n\r\n          __targetClassName = \"*\";\r\n\r\n          break;\r\n\r\n      }\r\n\r\n      var criterion = $Q.between('[', ']', s),\r\n        cparts = criterion.split('=');\r\n\r\n      var __targetGroup = \"*\",\r\n        __targetName = \"*\";\r\n\r\n      var getParts = function() {\r\n\r\n        if (cparts.length >= 2) {\r\n\r\n          switch (cparts[0].toLowerCase()) {\r\n\r\n            case \"name\":\r\n\r\n              //get all objects according to name=name\r\n\r\n              console.log('Q():Detected parts in selector:' + jstr(cparts));\r\n\r\n              __targetName = cleanSelectorString(cparts[1]);\r\n\r\n              break;\r\n\r\n            case \"group\":\r\n\r\n              console.log('Q():Detected parts in selector:' + jstr(cparts));\r\n\r\n              __targetGroup = cleanSelectorString(cparts[1]);\r\n\r\n              break;\r\n\r\n          }\r\n\r\n        }\r\n\r\n        if (cparts.length >= 4) {\r\n\r\n          cparts[2] = cparts[2].replace(\",\", \"\");\r\n\r\n          switch (cparts[2].toLowerCase()) {\r\n\r\n            case \"name\":\r\n\r\n              //get all objects according to name=name\r\n\r\n              console.log('Q():Detected parts in selector:' + jstr(cparts));\r\n\r\n              __targetName = cleanSelectorString(cparts[3]);\r\n\r\n              break;\r\n\r\n            case \"group\":\r\n\r\n              console.log('Q():Detected parts in selector:' + jstr(cparts));\r\n\r\n              __targetGroup = cleanSelectorString(cparts[3]);\r\n\r\n              break;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      };\r\n\r\n      getParts(cparts);\r\n\r\n      query = Gamelab.select(__targetClassName, __targetName, __targetGroup);\r\n\r\n    } else if (selector == '*') {\r\n\r\n      query = Gamelab.all();\r\n\r\n    }\r\n\r\n  }\r\n\r\n\r\n  query.each = function(callback) {\r\n\r\n    var objects = [];\r\n\r\n    for (var x = 0; x < this.length; x++) {\r\n      if (typeof x == 'number') {\r\n\r\n        callback(x, this[x]);\r\n      }\r\n\r\n    }\r\n\r\n\r\n  };\r\n\r\n  query.on = function(evt_key, selectorObject, controller_ix, callback) //handle each event such as on('collide') OR on('stick_left_0') << first controller stick_left\r\n  {\r\n\r\n    if (typeof evt_key == 'function' && typeof selectorObject == 'function') {\r\n      //this is a special pattern of if(f() == true){ runFunction(); };\r\n\r\n      var boolTrigger = evt_key,\r\n        boolCall = selectorObject,\r\n\r\n        boolEvent = new Gamelab.BoolEvent().On(boolTrigger).Call(boolCall);\r\n    }\r\n\r\n\r\n    var criterion = $Q.between('[', ']', evt_key);\r\n\r\n    if (criterion.indexOf('===') >= 0) {\r\n      criterion = criterion.replace('===', '=');\r\n    }\r\n\r\n    if (criterion.indexOf('==') >= 0) {\r\n      criterion = criterion.replace('==', '=').replace('==', 0);\r\n    }\r\n\r\n    var cparts = criterion.split('=');\r\n\r\n    var __targetGroup = \"*\",\r\n      __targetName = \"*\";\r\n\r\n    if (evt_key.indexOf('[') >= 0) {\r\n      evt_key = $Q.before('[', evt_key).trim();\r\n\r\n    }\r\n\r\n\r\n    var padding = 0;\r\n\r\n    //if controller_ix is function, and callback not present, then controller_ix is the callback aka optional argument\r\n\r\n    if (controller_ix && typeof controller_ix == 'function' && !callback) {\r\n      callback = controller_ix;\r\n      controller_ix = 0;\r\n    }\r\n\r\n    //optional argument: if controller_ix is function, and callback not present, then callback is selectorObject\r\n\r\n    if (selectorObject && typeof selectorObject == 'function' && !callback) {\r\n\r\n      callback = selectorObject;\r\n\r\n      selectorObject = $Q('*');\r\n\r\n      controller_ix = 0;\r\n    };\r\n\r\n    var evt_profile = {};\r\n\r\n    //which controller?\r\n\r\n    evt_profile.cix = controller_ix;\r\n\r\n    //Need the control key: 'left_stick', 'button_0', etc..\r\n\r\n    evt_profile.evt_key = evt_key;\r\n\r\n    if ($Q.contains_any(['stick', 'button', 'click', 'key'], evt_profile.evt_key)) {\r\n\r\n      var button_mode = evt_profile.evt_key.indexOf('button') >= 0;\r\n\r\n      Gamelab.GamepadAdapter.on(evt_profile.evt_key, 0, function(x, y) {\r\n\r\n        callback(x, y);\r\n\r\n      });\r\n\r\n      console.info('detected input event key in:' + evt_profile.evt_key);\r\n\r\n      console.info('TODO: rig events');\r\n\r\n    }\r\n\r\n    //TODO: test collision events:\r\n    else if ($Q.contains_any(['collide', 'collision', 'hit', 'touch'], evt_profile.evt_key)) {\r\n\r\n      //   console.info('Rigging a collision event');\r\n\r\n      //   console.info('detected collision event key in:' + evt_profile.evt_key);\r\n\r\n      //  console.info('TODO: rig collision events');\r\n\r\n      this.each(function(ix, item1) {\r\n\r\n        // console.info('Collision Processing 1:' + item1.name);\r\n        //  console.info('Collision Processing 1:' + item1.type);\r\n\r\n        selectorObject.each(function(iy, item2) {\r\n\r\n          //    console.info('Collision Processing 2:' + item2.name);\r\n          //   console.info('Collision Processing 2:' + item2.type);\r\n\r\n          if (typeof(item1.onUpdate) == 'function') {\r\n\r\n            var update = function(sprite) {\r\n\r\n              console.log('Box collide::' + jstr([this, item2]));\r\n\r\n              if (Gamelab.Collision.spriteBoxCollide(this, item2, gameWindow)) {\r\n\r\n                callback(this, item2);\r\n\r\n              };\r\n\r\n            };\r\n\r\n            item1.onUpdate(update);\r\n\r\n          }\r\n\r\n\r\n        });\r\n\r\n      });\r\n\r\n\r\n    } else {\r\n      console.info('Rigging a property event');\r\n\r\n      //TODO: test property-watch events:\r\n\r\n      console.info('detected property threshhold event key in:' + evt_profile.evt_key);\r\n\r\n      console.info('TODO: rig property events');\r\n\r\n      var condition = \"_\",\r\n        key = criterion || evt_profile.evt_key;\r\n\r\n      if (key.indexOf('[') >= 0 || key.indexOf(']') >= 0) {\r\n        key = $Q.between('[', ']', key);\r\n\r\n      }\r\n\r\n      var evt_parts = [];\r\n\r\n      var run = function() {\r\n        console.error('Sprite property check was not set correctly');\r\n\r\n      };\r\n\r\n      if (key.indexOf('>=') >= 0) {\r\n        condition = \">=\";\r\n\r\n\r\n      } else if (key.indexOf('<=') >= 0) {\r\n        condition = \"<=\";\r\n      } else if (key.indexOf('>') >= 0) {\r\n        condition = \">\";\r\n      } else if (key.indexOf('<') >= 0) {\r\n        condition = \"<\";\r\n      } else if (key.indexOf('=') >= 0) {\r\n        condition = \"=\";\r\n      }\r\n\r\n      evt_parts = key.split(condition);\r\n\r\n      for (var x = 0; x < evt_parts.length; x++) {\r\n        evt_parts[x] = evt_parts[x].replace('=', '').replace('=', '').trim(); //remove any trailing equals and trim()\r\n\r\n      }\r\n\r\n      var mykey, number;\r\n\r\n      // alert(evt_parts[0]);\r\n\r\n      try {\r\n\r\n        mykey = evt_parts[0];\r\n\r\n        number = parseFloat(evt_parts[1]);\r\n\r\n      } catch (e) {\r\n        console.log(e);\r\n      }\r\n\r\n      console.info('Gamelab:Processing condition with:' + condition);\r\n\r\n      switch (condition) {\r\n\r\n        case \">=\":\r\n\r\n\r\n          run = function(obj, key) {\r\n            if (obj[key] >= number) {\r\n              callback();\r\n            }\r\n          };\r\n\r\n          break;\r\n\r\n        case \"<=\":\r\n\r\n          run = function(obj, key) {\r\n            if (obj[key] <= number) {\r\n              callback();\r\n            }\r\n          };\r\n\r\n          break;\r\n\r\n\r\n        case \">\":\r\n\r\n          run = function(obj, key) {\r\n            if (obj[key] > number) {\r\n              callback();\r\n            }\r\n          };\r\n\r\n          break;\r\n\r\n        case \"<\":\r\n\r\n          run = function(obj, key) {\r\n            if (obj[key] < number) {\r\n              callback();\r\n            }\r\n          };\r\n\r\n          break;\r\n\r\n        case \"=\":\r\n\r\n          run = function(obj, key) {\r\n            if (obj[key] == number) {\r\n              callback();\r\n            }\r\n          };\r\n\r\n          break;\r\n\r\n      }\r\n\r\n\r\n      /************\r\n       * Attach update to each member\r\n       *\r\n       * **************/\r\n\r\n      var keys = mykey.split('.'),\r\n        propkey = \"\";\r\n\r\n      this.each(function(ix, item) {\r\n\r\n        var object = {};\r\n\r\n        if (keys.length == 1) {\r\n          object = item;\r\n\r\n          propkey = mykey;\r\n\r\n        } else if (keys.length == 2) {\r\n          object = item[keys[0]];\r\n\r\n          propkey = keys[1];\r\n\r\n\r\n        } else if (keys.length == 3) {\r\n          object = item[keys[0]][keys[1]];\r\n\r\n          propkey = keys[2];\r\n\r\n        } else {\r\n          console.error(\":length of '.' notation out of range. We use max length of 3 or prop.prop.key.\");\r\n\r\n        }\r\n\r\n        if (typeof item.onUpdate == 'function') {\r\n\r\n\r\n          var spr = item;\r\n\r\n          item.onUpdate(function(sprite) {\r\n\r\n            run(object, propkey);\r\n\r\n          });\r\n\r\n        }\r\n\r\n      });\r\n\r\n    }\r\n\r\n  };\r\n\r\n\r\n  return query;\r\n\r\n}\r\n\r\n\r\n$Q.each = function(obj, callback, complete) {\r\n\r\n  for (var x in obj) {\r\n    callback(obj);\r\n\r\n  }\r\n\r\n  if (typeof(complete) == 'function') {\r\n    complete(obj);\r\n\r\n  }\r\n\r\n};\r\n\r\n\r\n$Q.before = function(c1, test_str) {\r\n  var start_pos = 0;\r\n  var end_pos = test_str.indexOf(c1, start_pos);\r\n  return test_str.substring(start_pos, end_pos);\r\n};\r\n\r\n\r\n$Q.contains = function(c1, test_str) {\r\n  return test_str.indexOf(c1) >= 0;\r\n};\r\n\r\n$Q.contains_all = function(cList, test_str) {\r\n  for (var x = 0; x < cList.length; x++) {\r\n    if (test_str.indexOf(cList[x]) < 0) {\r\n      return false;\r\n\r\n    }\r\n  }\r\n\r\n  return true;\r\n\r\n};\r\n\r\n$Q.contains_any = function(cList, test_str) {\r\n\r\n  for (var x = 0; x < cList.length; x++) {\r\n    if (test_str.indexOf(cList[x]) >= 0) {\r\n      return true;\r\n\r\n    }\r\n  }\r\n\r\n  return false;\r\n\r\n};\r\n\r\n$Q.after = function(c1, test_str) {\r\n  var start_pos = test_str.indexOf(c1) + 1;\r\n  var end_pos = test_str.length;\r\n  return test_str.substring(start_pos, end_pos);\r\n};\r\n\r\n$Q.between = function(c1, c2, test_str) {\r\n  var start_pos = test_str.indexOf(c1) + 1;\r\n  var end_pos = test_str.indexOf(c2, start_pos);\r\n  return test_str.substring(start_pos, end_pos)\r\n};\r\n\r\n\r\n/****************************************\r\n *  Developer's own test-function:\r\n *      -Q.test_selector_method():\r\n * ***************************************/\r\n\r\n$Q.test_selector_method = function() { //leftover method of hand-testing\r\n  var Q_TestStrings = ['*', '.Sprite', '*[group=\"enemy_type_0\"]', '.Sprite[group=\"enemy_type_0\"]'];\r\n\r\n  for (var x = 0; x < Q_TestStrings.length; x++) {\r\n    var test = Q_TestStrings[x];\r\n\r\n    console.info('testing:' + test);\r\n\r\n    $Q(test);\r\n  }\r\n\r\n  console.log('Testing stick left');\r\n\r\n  this.on('stick_left_0');\r\n\r\n  console.log('Testing button');\r\n\r\n  this.on('button_0');\r\n\r\n\r\n  console.log('Testing collide');\r\n\r\n  this.on('collide');\r\n\r\n\r\n  console.log('Testing button');\r\n\r\n  this.on('collide');\r\n\r\n  console.log('Testing prop');\r\n\r\n  this.on('health>=0');\r\n\r\n\r\n};\r\n\r\n\r\nGamelab.$Q = $Q;\r\n\r\nGamelab.query = $Q;\r\n\r\n\r\n/********************\r\n * Gamelab.InputSystem\r\n * Various Keyboard + mouse Input Events\r\n ********************/\r\n\r\nGamelab.InputSystem = {\r\n\r\n  //PC input events\r\n\r\n  Mouse: {\r\n    Position: {\r\n      x: 0,\r\n      y: 0\r\n    },\r\n    Speed: {\r\n      x: 0,\r\n      y: 0\r\n    },\r\n    setPosition(x, y) {\r\n\r\n      this.Speed.x = x - this.Position.x;\r\n\r\n      this.Speed.y = y - this.Position.y;\r\n\r\n      this.Position.x = x;\r\n\r\n      this.Position.y = y;\r\n\r\n    },\r\n    isIdle: function() {\r\n      return this.speed.x == 0 && this.speed.y == 0;\r\n    }\r\n  },\r\n\r\n  events: {\r\n\r\n    mousemove: [],\r\n    mousepos: [],\r\n    leftclick: [],\r\n    rightclick: [],\r\n    middleclick: [],\r\n    wheelup: [],\r\n    wheelDown: []\r\n  },\r\n\r\n  keymap: {},\r\n\r\n  keyReplace: function(str) {\r\n    return str.toLowerCase().replace('space', ' ').replace('left', String.fromCharCode(37)).replace('left', String.fromCharCode(37)).replace('up', String.fromCharCode(38)).replace('right', String.fromCharCode(39)).replace('down', String.fromCharCode(40));\r\n  },\r\n\r\n  extendKey: function(evt_key, callback, onFinish) {\r\n\r\n    evt_key = this.keyReplace(evt_key);\r\n\r\n    Gamelab.InputSystem.keymap[evt_key] = {\r\n\r\n      down: false,\r\n\r\n      callback: function() {\r\n        callback(evt_key);\r\n      }\r\n    };\r\n\r\n    return Gamelab.InputSystem.keymap[evt_key];\r\n\r\n  },\r\n\r\n  extend: function(evt_key, downCall, upCall, onFinish) {\r\n\r\n    evt_key = evt_key.toLowerCase();\r\n\r\n    //each event-group has object-type\r\n    Gamelab.InputSystem.events[evt_key] = Gamelab.InputSystem.events[evt_key] || [];\r\n\r\n    Gamelab.InputSystem.events[evt_key].push({\r\n\r\n      down: downCall,\r\n\r\n      up: upCall\r\n\r\n    });\r\n\r\n  },\r\n\r\n  init: function() {\r\n\r\n    var MOUSE = this.Mouse;\r\n\r\n    window.setInterval(function() {\r\n\r\n      Gamelab.each(Gamelab.InputSystem.keymap, function(im, kmapItem) {\r\n\r\n        if (kmapItem.down == true) {\r\n\r\n          kmapItem.callback();\r\n\r\n        }\r\n\r\n      });\r\n\r\n    }, 10);\r\n\r\n    document.onkeydown = document.onkeyup = function(e) {\r\n\r\n      e = e || event; // to deal with IE\r\n\r\n      var gs_key_string = 'key_' + String.fromCharCode(e.keyCode),\r\n\r\n        evt_object = Gamelab.InputSystem['keymap'][gs_key_string] || Gamelab.InputSystem['keymap'][gs_key_string.toLowerCase()];\r\n\r\n\r\n      if (e.keyCode == 32) {\r\n        gs_key_string = 'key_space';\r\n      }\r\n\r\n      if (e.keyCode == 18) {\r\n        gs_key_string = 'key_alt';\r\n      }\r\n\r\n      if (e.keyCode == 9) {\r\n        gs_key_string = 'key_tab';\r\n      }\r\n\r\n      if (e.keyCode == 16) {\r\n        gs_key_string = 'key_shift';\r\n      }\r\n\r\n\r\n      if (evt_object) {\r\n        evt_object.down = e.type == 'keydown';\r\n      }\r\n\r\n    }\r\n\r\n    var canvases = document.querySelectorAll('canvas.gamewindow');\r\n\r\n\r\n    function getMousePos(e, c) {\r\n\r\n      var x;\r\n      var y;\r\n      if (e.pageX || e.pageY) {\r\n        x = e.pageX;\r\n        y = e.pageY;\r\n      } else {\r\n        x = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;\r\n        y = e.clientY + document.body.scrollTop + document.documentElement.scrollTop;\r\n      }\r\n      x -= c.offsetLeft;\r\n      y -= c.style.top;\r\n      return {\r\n        x: x,\r\n        y: y\r\n      };\r\n    }\r\n\r\n    let InputSystem = Gamelab.InputSystem;\r\n\r\n    function mouseMoving(event, c) {\r\n\r\n      var pos = getMousePos(event, c);\r\n\r\n      MOUSE.setPosition(pos.x, pos.y);\r\n\r\n      if (InputSystem.events['mousemove']) {\r\n        Gamelab.each(InputSystem.events['mousemove'], function(ix, el) {\r\n\r\n          el.down(pos.x, pos.y);\r\n\r\n        });\r\n      }\r\n\r\n    };\r\n\r\n    //Interval for mouse-idle time : run mouse move again with same position, no difference\r\n    setInterval(function() {\r\n\r\n      if (InputSystem.events['mousepos']) {\r\n\r\n        var pos = MOUSE.Position;\r\n\r\n        Gamelab.each(InputSystem.events['mousepos'], function(ix, el) {\r\n\r\n          el.down(pos.x, pos.y);\r\n\r\n        });\r\n      }\r\n\r\n    }, 10);\r\n\r\n\r\n    for (var x = 0; x < canvases.length; x++) {\r\n      var c = canvases[x];\r\n\r\n      function applyMouseMove(e) {\r\n        mouseMoving(e, c);\r\n      }\r\n\r\n      console.info('Gamelab-lib-code:main.js: InputSystem applying mousemove');\r\n\r\n      document.addEventListener(\"mousemove\", applyMouseMove);\r\n\r\n      c.onmousedown = function(e) {\r\n        //    alert(JSON.stringify(Gamelab.InputSystem, true, 2));\r\n\r\n        var value = e.which;\r\n        var pos = getMousePos(e, c);\r\n        var InputSystem = Gamelab.InputSystem;\r\n\r\n        e.preventDefault();\r\n\r\n        switch (e.which) {\r\n          case 1:\r\n\r\n            for (var x in InputSystem.events) {\r\n\r\n              if (InputSystem.events[x] instanceof Array && x == 'leftclick') {\r\n\r\n                Gamelab.each(InputSystem.events[x], function(ix, el) {\r\n\r\n                  el.down(pos.x, pos.y);\r\n                });\r\n              }\r\n            }\r\n\r\n            break;\r\n          case 2:\r\n            // alert('Middle Mouse button pressed.');\r\n\r\n            for (var x in Gamelab.InputSystem.events) {\r\n\r\n              if (InputSystem.events[x] instanceof Array && x == 'middleclick') {\r\n\r\n                Gamelab.each(InputSystem.events[x], function(ix, el) {\r\n\r\n                  el.down(pos.x, pos.y);\r\n                });\r\n              }\r\n            }\r\n            break;\r\n          case 3:\r\n            //  alert('Right Mouse button pressed.');\r\n\r\n\r\n            for (var x in Gamelab.InputSystem.events) {\r\n\r\n\r\n              if (InputSystem.events[x] instanceof Array && x == 'rightclick') {\r\n\r\n\r\n                Gamelab.each(InputSystem.events[x], function(ix, el) {\r\n\r\n                  el.down(pos.x, pos.y);\r\n                });\r\n\r\n                return false;\r\n              }\r\n\r\n\r\n            }\r\n\r\n            break;\r\n          default:\r\n\r\n            return 0;\r\n            //alert('You have a strange Mouse!');\r\n\r\n        }\r\n\r\n\r\n        e.preventDefault();\r\n        return 0;\r\n      };\r\n\r\n      c.onmouseup = function(e) {\r\n\r\n        //    alert(JSON.stringify(Gamelab.InputSystem, true, 2));\r\n\r\n        var value = e.which;\r\n        var pos = getMousePos(e, c);\r\n        var InputSystem = Gamelab.InputSystem;\r\n\r\n\r\n        e.preventDefault();\r\n\r\n        switch (e.which) {\r\n          case 1:\r\n\r\n            for (var x in InputSystem.events) {\r\n\r\n\r\n              if (InputSystem.events[x] instanceof Array && x == 'leftclick') {\r\n\r\n\r\n                Gamelab.each(InputSystem.events[x], function(ix, el) {\r\n\r\n                  el.up(pos.x, pos.y);\r\n                });\r\n              }\r\n\r\n\r\n            }\r\n\r\n            break;\r\n          case 2:\r\n            // alert('Middle Mouse button pressed.');\r\n\r\n\r\n            for (var x in Gamelab.InputSystem.events) {\r\n\r\n\r\n              if (InputSystem.events[x] instanceof Array && x == 'middleclick') {\r\n\r\n\r\n                Gamelab.each(InputSystem.events[x], function(ix, el) {\r\n\r\n                  el.up(pos.x, pos.y);\r\n                });\r\n              }\r\n\r\n\r\n            }\r\n            break;\r\n          case 3:\r\n            //  alert('Right Mouse button pressed.');\r\n\r\n\r\n            for (var x in Gamelab.InputSystem.events) {\r\n\r\n\r\n              if (InputSystem.events[x] instanceof Array && x == 'rightclick') {\r\n\r\n\r\n                Gamelab.each(InputSystem.events[x], function(ix, el) {\r\n\r\n                  el.up(pos.x, pos.y);\r\n                });\r\n\r\n\r\n                return false;\r\n\r\n              }\r\n\r\n\r\n            }\r\n\r\n            break;\r\n          default:\r\n\r\n            return 0;\r\n            //alert('You have a strange Mouse!');\r\n\r\n        }\r\n\r\n\r\n      };\r\n    }\r\n\r\n\r\n  }\r\n\r\n\r\n};\r\n\r\n//Override the existing window.onload function\r\n\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n\r\n  Gamelab.callReady();\r\n\r\n});\r\n\r\nGamelab.file_system = {\r\n\r\n  localizedSource: function(src, hostUrl) {\r\n\r\n    hostUrl = hostUrl || \"../\";\r\n\r\n    var gs_folder_ix = src.indexOf('assets/game');\r\n\r\n    return hostUrl + src.substring(gs_folder_ix, src.length);\r\n\r\n  },\r\n\r\n  loadJSON: function(filepath, callback) {\r\n\r\n    function readTextFile(file, callback) {\r\n      var rawFile = new XMLHttpRequest();\r\n      rawFile.open(\"GET\", file, false);\r\n      rawFile.onreadystatechange = function() {\r\n        if (rawFile.readyState === 4) {\r\n          if (rawFile.status === 200 || rawFile.status == 0) {\r\n            callback(rawFile.responseText);\r\n          }\r\n        }\r\n      }\r\n      rawFile.send(null);\r\n    };\r\n\r\n    readTextFile('file:///' + filepath, callback);\r\n\r\n  },\r\n\r\n  loadLevel: function(jsonText, gw, callback) {\r\n\r\n    var data = JSON.parse(jsonText);\r\n\r\n    if (typeof(gw) == 'function' || !gw) {\r\n      callback = gw || callback || function() {};\r\n\r\n      gw = Gamelab.game_windows[0];\r\n    }\r\n\r\n    $.each(data.sprites, function(ix, xitem) {\r\n\r\n      if (typeof(xitem.src) == 'string') {\r\n\r\n        xitem.src = Gamelab.file_system.localizedSource(xitem.src);\r\n      }\r\n\r\n      __gamelabInstance.each(xitem, function(iy, yitem) {\r\n\r\n        if (yitem.src) {\r\n\r\n          yitem.src = Gamelab.file_system.localizedSource(yitem.src);\r\n\r\n        }\r\n\r\n        __gamelabInstance.each(yitem, function(iz, zitem) {\r\n\r\n          if (zitem.src) {\r\n            zitem.src = Gamelab.file_system.localizedSource(zitem.src);\r\n\r\n          }\r\n\r\n\r\n        });\r\n\r\n\r\n      });\r\n\r\n      xitem = new Gamelab.Sprite(xitem);\r\n\r\n      gw.add(xitem);\r\n      //sprite.image = sprite.selected_animation.image;\r\n\r\n\r\n      if (ix >= data.sprites.length - 1) {\r\n\r\n        //last sprite is loaded //WHY DOESN't this work?\r\n\r\n        callback(false, data);\r\n      }\r\n\r\n    });\r\n\r\n  },\r\n\r\n  loadJSONLevel: function(filepath, gw, callback) {\r\n\r\n    if (typeof(gw) == 'function' || !gw) {\r\n      callback = gw || callback || function() {};\r\n\r\n      gw = Gamelab.game_windows[0];\r\n    }\r\n\r\n    this.loadJSON(filepath, function(data) {\r\n\r\n      //localize .src up to three levels of recursion (.src must be altered to refer locally)\r\n\r\n      $.each(data.sprites, function(ix, xitem) {\r\n\r\n        if (typeof(xitem.src) == 'string') {\r\n\r\n          xitem.src = Gamelab.file_system.localizedSource(xitem.src);\r\n        }\r\n\r\n        __gamelabInstance.each(xitem, function(iy, yitem) {\r\n\r\n          if (yitem.src) {\r\n\r\n            yitem.src = Gamelab.file_system.localizedSource(yitem.src);\r\n\r\n          }\r\n\r\n          __gamelabInstance.each(yitem, function(iz, zitem) {\r\n\r\n            if (zitem.src) {\r\n              zitem.src = Gamelab.file_system.localizedSource(zitem.src);\r\n\r\n            }\r\n\r\n\r\n          });\r\n\r\n\r\n        });\r\n\r\n        xitem = new Gamelab.Sprite(xitem);\r\n\r\n        gw.add(xitem);\r\n        //sprite.image = sprite.selected_animation.image;\r\n\r\n\r\n        if (ix >= data.sprites.length - 1) {\r\n\r\n          //last sprite is loaded //WHY DOESN't this work?\r\n\r\n          callback(false, data);\r\n        }\r\n\r\n\r\n      });\r\n\r\n\r\n    });\r\n\r\n  }\r\n\r\n\r\n};\r\n\r\n\r\n//reference loadJSON direct from Gamelab::\r\nGamelab.loadJSON = Gamelab.file_system.loadJSON;\r\n//reference loadJSON as loadJson::\r\nGamelab.file_system.loadJson = Gamelab.file_system.loadJSON;\r\nGamelab.loadJson = Gamelab.loadJSON;\r\n\r\n\r\nGamelab.ready(function(lib) {\r\n\r\n  Gamelab.log('Gamelab: library is ready');\r\n\r\n});\r\n\r\n\r\n/* Screen */\r\n\r\nlet Screen = {\r\n\r\n  size: function() {\r\n    return new Gamelab.Vector(Gamelab.WIDTH, Gamelab.HEIGHT);\r\n  },\r\n\r\n  center: function() {\r\n    return new Gamelab.Vector(Gamelab.WIDTH / 2, Gamelab.HEIGHT / 2).round();\r\n  }\r\n\r\n};\r\n;\r\n\r\n\r\nGamelab.config = Gamelab.config || {\r\n    DEV:true,\r\n    maxErrors:50\r\n};\r\n;/**************************\r\n  EventInterfaceMap: StringKeys:\r\n\r\n    * (must implement without option)\r\n    @ (may implement optional)\r\n*****************************/\r\n\r\n\r\nlet EventInterfaceMap = { //className / must have named functions whyen carrying Symbol of className\r\n\r\n  Sprite: ['@onUpdate', '@onDestroy'],\r\n\r\n  Animation: ['@onRun', '@onComplete', '*onCollide'],\r\n\r\n  Motion: ['@onCommit', '@onComplete', '*onCollide'],\r\n\r\n  Shot: ['@onShoot', '*onCollide', '*onCollide'],\r\n\r\n  Terrain: ['@onCollide'],\r\n\r\n  Interactive: ['@onCollide'],\r\n\r\n  Global: ['@onUpdate'],\r\n\r\n  check: function(instance) {\r\n    for (var x in this) {\r\n      if (x == 'check')\r\n        continue;\r\n      else {\r\n        if (this[x] instanceof Array) {\r\n          this[x].forEach(function(f) {\r\n            var fkey = f.replace('@', '');\r\n            if (!instance.getOwnPropertyNames.indexOf(fkey) >= 0)\r\n              throw new Error('Object must implement function by name of:' + fkey);\r\n\r\n          });\r\n        }\r\n      }\r\n    };\r\n  }\r\n}\r\n\r\n/**************************\r\n  ObjectFeatureInterfaceMap:\r\n      Indicates classNames, and what they must carry as functions\r\n*****************************/\r\n\r\nlet ObjectFeatureMap = { //className / must have named function properties when carrying Symbol of className\r\n\r\n  Sprite: ['@spatial', '@data'],\r\n\r\n  SpriteGroup: ['@relative_spatial', '@data'],\r\n\r\n  SpriteBrush: ['@spatial', '@data'],\r\n\r\n  Frame: ['@spatial'],\r\n\r\n  Particle: ['@spatial'],\r\n\r\n  RectangularLine: ['@spatial'],\r\n\r\n  Circle: ['@spatial'],\r\n\r\n  GridAnimation: ['@anchored', '@framedriven', '@effectdriven', '@data'],\r\n\r\n  Line2d: ['@spatial', '@pointarrayflippable', '@selftransposable', '@data'],\r\n\r\n  Text: ['@spatial', '@text', '@colored'],\r\n\r\n};\r\n\r\nGamelab.ObjectFeatureMap = ObjectFeatureMap;\r\n\r\n\r\nlet InputIFM = {\r\n\r\n  GamepadButtons: ['@onButton'],\r\n\r\n  GamepadSticks: ['@onStick'],\r\n\r\n  Keyboard: ['@onKey'],\r\n\r\n  MouseMove: ['@onMouseMove'],\r\n\r\n  MouseButton: ['@onMouseButton'],\r\n\r\n  MouseWheel: ['@onMouseWheel'],\r\n\r\n  LeapMotion: ['@onLeapMotion']\r\n\r\n};\r\n\r\n\r\nlet UIEditables = {\r\n\r\n  Sprite: ['size', 'position', 'rotation'],\r\n\r\n  Animation: ['frameBounds', 'etc']\r\n\r\n};\r\n\r\n\r\nlet UIOption = function(name, hint, script) {\r\n  return {\r\n    name,\r\n    hint,\r\n    script\r\n  }\r\n};\r\n\r\nlet UIPrefab = {\r\n\r\n  MainSelect: {\r\n    Interactive: {\r\n\r\n      name: 'FourwayClasticRect',\r\n\r\n      hint: 'Object is collideable on four rectangular sides',\r\n\r\n      script: '#MY-SCRIPT-PATH'\r\n    }\r\n  },\r\n\r\n  FormEditables: {\r\n\r\n    Interactive: []\r\n  }\r\n};\r\n\r\n\r\nlet UIPrefabMainSelect = {\r\n\r\n  Background: ['Bound']\r\n\r\n};\r\n\r\n\r\nlet getCustomPrefabMeta = function() { //get name and file/data resources for each custom prefab\r\n\r\n};\r\n\r\n/**********************************\r\n\r\n  UIObjectSelectMap:\r\n\r\n    -Just the system default options\r\n\r\n*********************************/\r\n\r\nlet UIObjectPrefabs = {\r\n\r\n  Sprite: ['Side-Scroll-Player', 'Collider', 'Spaceship', 'Robot'],\r\n\r\n};;\r\n;(function() {\r\n\r\n  /**\r\n   * Creates a new Camera\r\n   * @param {number} x=0 position-x\r\n   * @param {number} y=0 position-y\r\n   * @param {number} z=0 position-z\r\n   * @returns {Camera}\r\n   */\r\n\r\n  class Camera {\r\n    constructor(x, y, z) {\r\n      if (isNaN(x)) {\r\n        x = 0;\r\n      }\r\n\r\n      if (isNaN(y)) {\r\n        y = 0;\r\n      }\r\n\r\n      if (isNaN(z)) {\r\n        z = 0;\r\n      }\r\n\r\n         /**\r\n          * @property {Vector} position the vector-position of Camera\r\n          * @memberof Camera\r\n          **********/\r\n\r\n      this.position = new Gamelab.Vector(x, y, z);\r\n\r\n      this.speed = new Gamelab.Vector(0, 0, 0);\r\n    }\r\n\r\n    update(){\r\n        this.position.x += this.speed.x;\r\n        this.position.y += this.speed.y;\r\n    }\r\n\r\n  }\r\n\r\n  Gamelab.Camera = Camera;\r\n\r\n})();\r\n;\r\n// Converts from degrees to radians.\r\nMath.radians = function(degrees) {\r\n  return degrees * Math.PI / 180;\r\n};\r\n\r\n// Converts from radians to degrees.\r\nMath.degrees = function(radians) {\r\n  return radians * 180 / Math.PI;\r\n};\r\n\r\nclass Circle {\r\nconstructor(radius){\r\nthis.radius = radius;\r\n}\r\nRadius(r)\r\n{\r\n  this.radius = r;\r\n  return this;\r\n}\r\ngetRandomCircumferencePoints(count){\r\n  if(isNaN(count))\r\n  return console.error('needs 1st argument of number --count');\r\n  var points = [], radius = this.radius;\r\n  while (count) {\r\n      var pt_angle = Math.random() * 2 * Math.PI;\r\n      var p = new Gamelab.Vector(Math.cos(pt_angle)*this.radius, Math.sin(pt_angle)* this.radius);\r\n      p.r = pt_angle * 180 / Math.PI;\r\n      points.push(p);\r\n      count--;\r\n  }\r\n  return points;\r\n}\r\ngetRandomPoints(count=1.0){\r\n  if(isNaN(count))\r\n  return console.error('needs 1st argument of number --count');\r\n  var points = [], radius = this.radius;\r\n  while (count) {\r\n      var pt_angle = Math.random() * 2 * Math.PI;\r\n      var pt_radius_sq = Math.random() * radius * radius;\r\n      var x = Math.sqrt(pt_radius_sq) * Math.cos(pt_angle);\r\n      var y = Math.sqrt(pt_radius_sq) * Math.sin(pt_angle);\r\n      points.push(new Gamelab.Vector(x, y));\r\n      count--;\r\n  }\r\n  return points;\r\n}\r\n\r\ngetCircumferencePoint(r)\r\n{\r\n  var pt_angle = Math.radians(r);\r\n  var p = new Gamelab.Vector(Math.cos(pt_angle)*this.radius, Math.sin(pt_angle)* this.radius);\r\n  return p;\r\n}\r\n\r\n\r\n}\r\n\r\n\r\nGamelab.Circle = Circle;\r\n;//http://www.blackpawn.com/texts/pointinpoly/\r\nfunction pointInTriangle(point, triangle) {\r\n  //compute vectors & dot products\r\n  var cx = point.x,\r\n    cy = point.y,\r\n    t0 = triangle[0],\r\n    t1 = triangle[1],\r\n    t2 = triangle[2],\r\n    v0x = t2.x - t0.x,\r\n    v0y = t2.y - t0.y,\r\n    v1x = t1.x - t0.x,\r\n    v1y = t1.y - t0.y,\r\n    v2x = cx - t0.x,\r\n    v2y = cy - t0.y,\r\n    dot00 = v0x * v0x + v0y * v0y,\r\n    dot01 = v0x * v1x + v0y * v1y,\r\n    dot02 = v0x * v2x + v0y * v2y,\r\n    dot11 = v1x * v1x + v1y * v1y,\r\n    dot12 = v1x * v2x + v1y * v2y\r\n\r\n  // Compute barycentric coordinates\r\n  var b = (dot00 * dot11 - dot01 * dot01),\r\n    inv = b === 0 ? 0 : (1 / b),\r\n    u = (dot11 * dot02 - dot01 * dot12) * inv,\r\n    v = (dot00 * dot12 - dot01 * dot02) * inv\r\n  return u >= 0 && v >= 0 && (u + v < 1)\r\n};\r\n\r\n\r\nlet Collision = {\r\n\r\n  /*Collide straight boxes no-rotate*/\r\n  boxCollide(pos1, size1, pos2, size2) {\r\n    return pos1.x >= pos2.x - size1.x &&\r\n      pos1.x <= pos2.x + size2.x &&\r\n      pos1.y >= pos2.y - size1.y &&\r\n      pos1.y <= pos2.y + size2.y;\r\n  },\r\n\r\n  //determine if point is inside box / allows rotation\r\n  pointInBox(point, box) {\r\n    var triangles = Gamelab.Trig.getTrianglesByBox(box);\r\n    box.collisionPoints = triangles;\r\n    return pointInTriangle(point, triangles[0]) ||\r\n      pointInTriangle(point, triangles[1]);\r\n  },\r\n\r\n\r\n  /* Collide objects with NO-rotation */\r\n  spriteMouseCollide(obj1, obj2, gw) {\r\n\r\n    gw = gw || Gamelab.game_windows[0];\r\n    let scale = gw.scale || 1.0;\r\n    if (gw.settings && gw.settings.hasOwnProperty(scale)) {\r\n      scale = gw.settings.scale;\r\n    }\r\n    var camPos = new Gamelab.Vector(0, 0, 0);\r\n    obj1.padding = obj1.padding || new Gamelab.Vector(0, 0, 0);\r\n\r\n    let S = function(value) {\r\n      return value * scale;\r\n    };\r\n\r\n    var paddingX = Math.round(obj1.padding.x * S(obj1.size.x)),\r\n      paddingY = Math.round(obj1.padding.y * S(obj1.size.y)),\r\n      left = S(obj1.position.x) + paddingX + camPos.x,\r\n      right = S(obj1.position.x) + S(obj1.size.x) - paddingX + camPos.x,\r\n      top = S(obj1.position.y) + camPos.y + paddingY,\r\n      bottom = S(obj1.position.y) + S(obj1.size.y) - paddingY + camPos.y;\r\n    if (right > obj2.position.x && left < obj2.position.x + obj2.size.x &&\r\n      bottom > obj2.position.y && top < obj2.position.y + obj2.size.y) {\r\n      return true;\r\n    }\r\n  },\r\n\r\n  /* Collide Sprites NO-Rotation */\r\n  spriteBoxCollide(obj1, obj2, gw) {\r\n    gw = gw || Gamelab.game_windows[0];\r\n    let scale = gw.scale || 1.0;\r\n    var camPos = new Gamelab.Vector(0, 0, 0);\r\n    obj1.padding = obj1.padding || new Gamelab.Vector(0, 0, 0);\r\n\r\n    let S = function(value) {\r\n      return value * scale;\r\n    };\r\n\r\n    var paddingX = Math.round(obj1.padding.x * S(obj1.size.x)),\r\n      paddingY = Math.round(obj1.padding.y * S(obj1.size.y)),\r\n      left = S(obj1.position.x) + paddingX + camPos.x,\r\n      right = S(obj1.position.x) + S(obj1.size.x) - paddingX + camPos.x,\r\n      top = S(obj1.position.y) + camPos.y + paddingY,\r\n      bottom = S(obj1.position.y) + S(obj1.size.y) - paddingY + camPos.y;\r\n    if (right > S(obj2.position.x) && left < S(obj2.position.x) + S(obj2.size.x) &&\r\n      bottom > S(obj2.position.y) && top < S(obj2.position.y) + S(obj2.size.y)) {\r\n      return true;\r\n    }\r\n  },\r\n\r\n\r\n  //takes 2 arrays, returns array (empy array means no-collision)\r\n  spriteBoxCollideArray(obj1, obj2, gw) {\r\n\r\n    var collisions = [],\r\n      spritesX = obj1 instanceof Array ? obj1 : [obj1],\r\n      spritesY = obj2 instanceof Array ? obj2 : [obj2];\r\n\r\n    for (var x = 0; x < spritesX.length; x++) {\r\n      for (var y = 0; y < spritesY.length; y++) {\r\n        if (this.spriteBoxCollide(spritesX[x], spritesY[y])) {\r\n          collisions.push({\r\n            object: spritesX[x],\r\n            collider: spritesY[y]\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    return collisions;\r\n  },\r\n\r\n  spriteCollideTop(obj1, obj2, gw) {\r\n    gw = gw || Gamelab.game_windows[0];\r\n\r\n    var camPos = new Gamelab.Vector(0, 0, 0);\r\n\r\n    obj1.padding = obj1.padding || new Gamelab.Vector(0, 0, 0);\r\n\r\n    var paddingX = Math.round(obj1.padding.x * obj1.size.x),\r\n\r\n      paddingY = Math.round(obj1.padding.y * obj1.size.y),\r\n      left = obj1.position.x + paddingX + camPos.x,\r\n\r\n      right = obj1.position.x + obj1.size.x - paddingX + camPos.x,\r\n\r\n      top = obj1.position.y + camPos.y + paddingY,\r\n      bottom = obj1.position.y + obj1.size.y - paddingY + camPos.y;\r\n\r\n    if (right > obj2.position.x && left < obj2.position.x + obj2.size.x &&\r\n      bottom > obj2.position.y && top < obj2.position.y + obj2.size.y\r\n    ) {\r\n      return true;\r\n    }\r\n  },\r\n\r\n\r\n  /*\r\n   *\r\n   *  ##Not known to be working -->> Below function\r\n   *\r\n   * */\r\n\r\n  getSpatialGrid(sourceSprite, spatialDivider = 5.0) {\r\n    if (sourceSprite.anime && sourceSprite.anime.getCurrentPixelMap) {\r\n      let pixelGrid = sourceSprite.anime.getCurrentPixelMap(spatialDivider);\r\n      return pixelGrid;\r\n    } else {\r\n      return [];\r\n    }\r\n  }\r\n};\r\n\r\n\r\nGamelab.Collision = Collision;\r\n;\r\n//RGBColor:: Color object\r\nclass RGBColor {\r\n  constructor(r = 0, g = 0, b = 0, a = 0) {\r\n    this.r = r;\r\n    this.g = g;\r\n    this.b = b;\r\n    this.a = a;\r\n  }\r\n\r\n  //Create color from string (rgba-string or hex-string to RGBAColor{})\r\n  fromString(str) {\r\n    if(str.indexOf('#') >= 0) //color-string is hex-color-string\r\n    {\r\n      str = Gamelab.ColorCalc.hexToRgba(str);\r\n    }\r\n\r\n    str = str.replace(/^\\s*#|\\s*$/g, '');\r\n    str = str.toLowerCase();\r\n    if (ColorStrings[str]) str = ColorStrings[str];\r\n\r\n    var match;\r\n    // RGB(A)\r\n    if ((match = str.match(/\\d+/g))) {\r\n\r\n      return new Gamelab.RGBColor(\r\n        parseInt(match[0], 10),\r\n        parseInt(match[1], 10),\r\n        parseInt(match[2], 10),\r\n        1.0\r\n      );\r\n    }\r\n  }\r\n\r\n  //Create color from pixel-data\r\n  fromData(data) {\r\n    return new Gamelab.RGBColor(\r\n      parseInt(data[0], 10),\r\n      parseInt(data[1], 10),\r\n      parseInt(data[2], 10),\r\n      1.0\r\n    );\r\n\r\n  }\r\n\r\n  //Distance between two colors (a 3d distance fxn)\r\n  distance(color) {\r\n    var sumOfSquares = 0;\r\n    sumOfSquares += Math.pow(this.r - color.r, 2);\r\n    sumOfSquares += Math.pow(this.g - color.g, 2);\r\n    sumOfSquares += Math.pow(this.b - color.b, 2);\r\n    return Math.sqrt(sumOfSquares);\r\n  }\r\n\r\n  //Fuzzy Match with tolerance for distance\r\n  match_by_tolerance(color, tolerance) {\r\n\r\n    var matches = {\r\n      r: color.r,\r\n      g: color.g,\r\n      b: color.b\r\n    };\r\n\r\n    var total_diff = 0;\r\n\r\n    for (var x in matches) {\r\n      var diff = Math.abs(color[x] - this[x]);\r\n\r\n      //console.log('COLOR-DIFF: --1::' + jstr(this) + ':: --2::' + jstr(color));\r\n\r\n      total_diff += diff;\r\n    }\r\n\r\n    return total_diff <= tolerance;\r\n\r\n  }\r\n\r\n};\r\n\r\n\r\nGamelab.RGBColor = RGBColor;\r\n\r\n//Color calculations::\r\nGamelab.ColorCalculator = {\r\n\r\n  hexToRgbArray(hex) {\r\n  var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n  return result ? [\r\n    parseInt(result[1], 16),\r\n    parseInt(result[2], 16),\r\n    parseInt(result[3], 16)\r\n  ] : null;\r\n  },\r\n\r\n  rgbFromString: function(rgba_string) {\r\n    return new Gamelab.RGBColor(rgba_string);\r\n  },\r\n\r\n  hexToRgba: function(hex) {\r\n    var c;\r\n    if (/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)) {\r\n      c = hex.substring(1).split('');\r\n      if (c.length == 3) {\r\n        c = [c[0], c[0], c[1], c[1], c[2], c[2]];\r\n      }\r\n      c = '0x' + c.join('');\r\n      return 'rgba(' + [(c >> 16) & 255, (c >> 8) & 255, c & 255].join(',') + ',1)';\r\n    }\r\n    throw new Error('Bad Hex');\r\n  },\r\n\r\n  scaledRGBAFromHex:function(hexcolor_a, hexcolor_b, scalePoint){\r\n\r\n    //get the point between color_a and color_b using value of 0-1 ::\r\n    //scalePoint of 0 = color_a as rgba & scalePoint of 1.0 will return color_b as rgba\r\n\r\n    var rgba_a = this.hexToRgbArray(hexcolor_a),\r\n    rgba_b = this.hexToRgbArray(hexcolor_b);\r\n\r\n\r\n    var finalRgba={\r\n      0:rgba_a[0] + ((rgba_a[0] - rgba_b[0]) * scalePoint * -1.0),\r\n      1:rgba_a[1] + ((rgba_a[1] - rgba_b[1]) * scalePoint * -1.0),\r\n      2:rgba_a[2] + ((rgba_a[2] - rgba_b[2]) * scalePoint * -1.0),\r\n      3:1.0\r\n    };\r\n\r\n    //first 3 values are rounded / whole number\r\n    [0, 1, 2].forEach(function(x){\r\n      if(finalRgba[x] >= 255)\r\n      {\r\n        finalRgba[x] = 255\r\n      }\r\n      finalRgba[x] = Math.round(finalRgba[x]);\r\n    });\r\n\r\n    return \"rgba(\"+ finalRgba[0] +  \",\" + finalRgba[1] + \",\" + finalRgba[2] + \", 1.0)\" ;\r\n  }\r\n\r\n};\r\n\r\n//Css Colors by name::\r\nvar ColorStrings = {\r\n  aliceblue: 'rgb(240, 248, 255)',\r\n  antiquewhite: 'rgb(250, 235, 215)',\r\n  aqua: 'rgb(0, 255, 255)',\r\n  aquamarine: 'rgb(127, 255, 212)',\r\n  azure: 'rgb(240, 255, 255)',\r\n  beige: 'rgb(245, 245, 220)',\r\n  bisque: 'rgb(255, 228, 196)',\r\n  black: 'rgb(0, 0, 0)',\r\n  blanchedalmond: 'rgb(255, 235, 205)',\r\n  blue: 'rgb(0, 0, 255)',\r\n  blueviolet: 'rgb(138, 43, 226)',\r\n  brown: 'rgb(165, 42, 42)',\r\n  burlywood: 'rgb(222, 184, 135)',\r\n  cadetblue: 'rgb(95, 158, 160)',\r\n  chartreuse: 'rgb(127, 255, 0)',\r\n  chocolate: 'rgb(210, 105, 30)',\r\n  coral: 'rgb(255, 127, 80)',\r\n  cornflowerblue: 'rgb(100, 149, 237)',\r\n  cornsilk: 'rgb(255, 248, 220)',\r\n  crimson: 'rgb(220, 20, 60)',\r\n  cyan: 'rgb(0, 255, 255)',\r\n  darkblue: 'rgb(0, 0, 139)',\r\n  darkcyan: 'rgb(0, 139, 139)',\r\n  darkgoldenrod: 'rgb(184, 134, 11)',\r\n  darkgray: 'rgb(169, 169, 169)',\r\n  darkgreen: 'rgb(0, 100, 0)',\r\n  darkgrey: 'rgb(169, 169, 169)',\r\n  darkkhaki: 'rgb(189, 183, 107)',\r\n  darkmagenta: 'rgb(139, 0, 139)',\r\n  darkolivegreen: 'rgb(85, 107, 47)',\r\n  darkorange: 'rgb(255, 140, 0)',\r\n  darkorchid: 'rgb(153, 50, 204)',\r\n  darkred: 'rgb(139, 0, 0)',\r\n  darksalmon: 'rgb(233, 150, 122)',\r\n  darkseagreen: 'rgb(143, 188, 143)',\r\n  darkslateblue: 'rgb(72, 61, 139)',\r\n  darkslategray: 'rgb(47, 79, 79)',\r\n  darkslategrey: 'rgb(47, 79, 79)',\r\n  darkturquoise: 'rgb(0, 206, 209)',\r\n  darkviolet: 'rgb(148, 0, 211)',\r\n  deeppink: 'rgb(255, 20, 147)',\r\n  deepskyblue: 'rgb(0, 191, 255)',\r\n  dimgray: 'rgb(105, 105, 105)',\r\n  dimgrey: 'rgb(105, 105, 105)',\r\n  dodgerblue: 'rgb(30, 144, 255)',\r\n  firebrick: 'rgb(178, 34, 34)',\r\n  floralwhite: 'rgb(255, 250, 240)',\r\n  forestgreen: 'rgb(34, 139, 34)',\r\n  fuchsia: 'rgb(255, 0, 255)',\r\n  gainsboro: 'rgb(220, 220, 220)',\r\n  ghostwhite: 'rgb(248, 248, 255)',\r\n  gold: 'rgb(255, 215, 0)',\r\n  goldenrod: 'rgb(218, 165, 32)',\r\n  gray: 'rgb(128, 128, 128)',\r\n  green: 'rgb(0, 128, 0)',\r\n  greenyellow: 'rgb(173, 255, 47)',\r\n  grey: 'rgb(128, 128, 128)',\r\n  honeydew: 'rgb(240, 255, 240)',\r\n  hotpink: 'rgb(255, 105, 180)',\r\n  indianred: 'rgb(205, 92, 92)',\r\n  indigo: 'rgb(75, 0, 130)',\r\n  ivory: 'rgb(255, 255, 240)',\r\n  khaki: 'rgb(240, 230, 140)',\r\n  lavender: 'rgb(230, 230, 250)',\r\n  lavenderblush: 'rgb(255, 240, 245)',\r\n  lawngreen: 'rgb(124, 252, 0)',\r\n  lemonchiffon: 'rgb(255, 250, 205)',\r\n  lightblue: 'rgb(173, 216, 230)',\r\n  lightcoral: 'rgb(240, 128, 128)',\r\n  lightcyan: 'rgb(224, 255, 255)',\r\n  lightgoldenrodyellow: 'rgb(250, 250, 210)',\r\n  lightgray: 'rgb(211, 211, 211)',\r\n  lightgreen: 'rgb(144, 238, 144)',\r\n  lightgrey: 'rgb(211, 211, 211)',\r\n  lightpink: 'rgb(255, 182, 193)',\r\n  lightsalmon: 'rgb(255, 160, 122)',\r\n  lightseagreen: 'rgb(32, 178, 170)',\r\n  lightskyblue: 'rgb(135, 206, 250)',\r\n  lightslategray: 'rgb(119, 136, 153)',\r\n  lightslategrey: 'rgb(119, 136, 153)',\r\n  lightsteelblue: 'rgb(176, 196, 222)',\r\n  lightyellow: 'rgb(255, 255, 224)',\r\n  lime: 'rgb(0, 255, 0)',\r\n  limegreen: 'rgb(50, 205, 50)',\r\n  linen: 'rgb(250, 240, 230)',\r\n  magenta: 'rgb(255, 0, 255)',\r\n  maroon: 'rgb(128, 0, 0)',\r\n  mediumaquamarine: 'rgb(102, 205, 170)',\r\n  mediumblue: 'rgb(0, 0, 205)',\r\n  mediumorchid: 'rgb(186, 85, 211)',\r\n  mediumpurple: 'rgb(147, 112, 219)',\r\n  mediumseagreen: 'rgb(60, 179, 113)',\r\n  mediumslateblue: 'rgb(123, 104, 238)',\r\n  mediumspringgreen: 'rgb(0, 250, 154)',\r\n  mediumturquoise: 'rgb(72, 209, 204)',\r\n  mediumvioletred: 'rgb(199, 21, 133)',\r\n  midnightblue: 'rgb(25, 25, 112)',\r\n  mintcream: 'rgb(245, 255, 250)',\r\n  mistyrose: 'rgb(255, 228, 225)',\r\n  moccasin: 'rgb(255, 228, 181)',\r\n  navajowhite: 'rgb(255, 222, 173)',\r\n  navy: 'rgb(0, 0, 128)',\r\n  oldlace: 'rgb(253, 245, 230)',\r\n  olive: 'rgb(128, 128, 0)',\r\n  olivedrab: 'rgb(107, 142, 35)',\r\n  orange: 'rgb(255, 165, 0)',\r\n  orangered: 'rgb(255, 69, 0)',\r\n  orchid: 'rgb(218, 112, 214)',\r\n  palegoldenrod: 'rgb(238, 232, 170)',\r\n  palegreen: 'rgb(152, 251, 152)',\r\n  paleturquoise: 'rgb(175, 238, 238)',\r\n  palevioletred: 'rgb(219, 112, 147)',\r\n  papayawhip: 'rgb(255, 239, 213)',\r\n  peachpuff: 'rgb(255, 218, 185)',\r\n  peru: 'rgb(205, 133, 63)',\r\n  pink: 'rgb(255, 192, 203)',\r\n  plum: 'rgb(221, 160, 221)',\r\n  powderblue: 'rgb(176, 224, 230)',\r\n  purple: 'rgb(128, 0, 128)',\r\n  red: 'rgb(255, 0, 0)',\r\n  rosybrown: 'rgb(188, 143, 143)',\r\n  royalblue: 'rgb(65, 105, 225)',\r\n  saddlebrown: 'rgb(139, 69, 19)',\r\n  salmon: 'rgb(250, 128, 114)',\r\n  sandybrown: 'rgb(244, 164, 96)',\r\n  seagreen: 'rgb(46, 139, 87)',\r\n  seashell: 'rgb(255, 245, 238)',\r\n  sienna: 'rgb(160, 82, 45)',\r\n  silver: 'rgb(192, 192, 192)',\r\n  skyblue: 'rgb(135, 206, 235)',\r\n  slateblue: 'rgb(106, 90, 205)',\r\n  slategray: 'rgb(112, 128, 144)',\r\n  slategrey: 'rgb(112, 128, 144)',\r\n  snow: 'rgb(255, 250, 250)',\r\n  springgreen: 'rgb(0, 255, 127)',\r\n  steelblue: 'rgb(70, 130, 180)',\r\n  tan: 'rgb(210, 180, 140)',\r\n  teal: 'rgb(0, 128, 128)',\r\n  thistle: 'rgb(216, 191, 216)',\r\n  tomato: 'rgb(255, 99, 71)',\r\n  turquoise: 'rgb(64, 224, 208)',\r\n  violet: 'rgb(238, 130, 238)',\r\n  wheat: 'rgb(245, 222, 179)',\r\n  white: 'rgb(255, 255, 255)',\r\n  whitesmoke: 'rgb(245, 245, 245)',\r\n  yellow: 'rgb(255, 255, 0)',\r\n  yellowgreen: 'rgb(154, 205, 50)',\r\n\r\n\r\n  //special map Colors\r\n  map_orange: 'rgb(255, 106, 0)',\r\n  map_green: 'rgb(76, 255, 0)',\r\n  map_red: 'rgb(255, 0, 0)',\r\n  map_blue: 'rgb(0, 38, 255)',\r\n  map_darkgreen: 'rgb(38, 127, 0)',\r\n  map_yellow: 'rgb(255, 216, 0)',\r\n  map_aqua: 'rgb(0, 255, 255)',\r\n  map_grey: 'rgb(128, 128, 128)',\r\n  map_gray: 'rgb(128, 128, 128)',\r\n  map_darkgrey: 'rgb(64, 64, 64)',\r\n  map_darkgray: 'rgb(64, 64, 64)',\r\n  map_black: 'rgb(0, 0, 0)',\r\n};\r\n\r\nvar RE_RGB = /^rgb\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)$/;\r\n\r\nGamelab.Colors = {};\r\n\r\nfor (var x in ColorStrings) {\r\n  if (ColorStrings.hasOwnProperty(x)) {\r\n    Gamelab.Colors[x] = new Gamelab.RGBColor().fromString(x);\r\n  }\r\n}\r\n;class ConditionalPromise extends Promise {\r\n  constructor(resolve, reject) {\r\n    super(resolve, reject);\r\n    this.every = function() {}; //millis || boolfxn\r\n    this.unless = function() {};\r\n    this.resolve = resolve || function() {};\r\n    this.reject = reject || function() {};\r\n    this.until = function() {}; //millis || boolfxn\r\n    this.promise = new Promise(this.resolve, this.reject);\r\n  }\r\n  Do(d) {\r\n    this.do = d;\r\n    return this;\r\n  }\r\n  On(o) {\r\n    this.on = o;\r\n    return this;\r\n  }\r\n  Every(e) {\r\n    this.every = e;\r\n    return this;\r\n  }\r\n  Unless(u) {\r\n    this.unless = u;\r\n    return this;\r\n  }\r\n  Until(u) {\r\n    this.until = u;\r\n    return this;\r\n  }\r\n  run(timer) {\r\n\r\n  }\r\n}\r\n\r\nGamelab.ConditionalPromise = ConditionalPromise;;/**\r\n * Dubiously created by Adrian Cooney\r\n * http://adriancooney.github.io\r\n */\r\n(function(console) {\r\n\t\"use strict\";\r\n\r\n\t//Bootlegged of imgur.com/memegen\r\n\tvar memes = {\"10 Guy\":\"//i.imgur.com/LaENqOV.jpg\",\"3rd World Success Kid\":\"//i.imgur.com/WA5duA1.jpg\",\"90's Problems\":\"//i.imgur.com/tL47qtp.jpg\",\"Aaand It's Gone\":\"//i.imgur.com/yf12saq.jpg\",\"Actual Advice Mallard\":\"//i.imgur.com/WymFmVy.jpg\",\"Advice Dog\":\"//i.imgur.com/Qk0VO6D.jpg\",\"Advice God\":\"//i.imgur.com/xH2fSFg.jpg\",\"Almost Politically Correct Redneck\":\"//i.imgur.com/YqLgINf.jpg\",\"Am I The Only One\":\"//i.imgur.com/gS9YL5U.jpg\",\"Ancient Aliens\":\"//i.imgur.com/NfCknz0.jpg\",\"Annoyed Picard\":\"//i.imgur.com/s9GmfSS.jpg\",\"Annoying Childhood Friend\":\"//i.imgur.com/27VCyQw.jpg\",\"Annoying Facebook Girl\":\"//i.imgur.com/ccczyGt.jpg\",\"Anti-Joke Chicken (Rooster)\":\"//i.imgur.com/KOsW0jh.jpg\",\"Awkward Penguin\":\"//i.imgur.com/ez1tQrq.jpg\",\"Back In My Day Grandpa\":\"//i.imgur.com/zuJSZp8.jpg\",\"Bad Advice Mallard\":\"//i.imgur.com/QEPvL2B.jpg\",\"Bad Luck Brian\":\"//i.imgur.com/sRW8BiO.jpg\",\"Bear Grylls\":\"//i.imgur.com/6Spqy1D.jpg\",\"Brace Yourself\":\"//i.imgur.com/NhIq0LY.jpg\",\"Captain Obvious\":\"//i.imgur.com/DmUcxBu.jpg\",\"Chemistry Cat\":\"//i.imgur.com/8agP4Xe.jpg\",\"College Freshman\":\"//i.imgur.com/2Ynyv9t.jpg\",\"College Liberal\":\"//i.imgur.com/OWfvSFE.jpg\",\"Condescending Wonka\":\"//i.imgur.com/D0e5fgL.jpg\",\"Confession Bear\":\"//i.imgur.com/kH1SKhp.jpg\",\"Confession Kid\":\"//i.imgur.com/jhOxR12.jpg\",\"Confused Gandalf\":\"//i.imgur.com/iIb5SEo.jpg\",\"Conspiracy Keanu\":\"//i.imgur.com/pFyk3J7.jpg\",\"Courage Wolf\":\"//i.imgur.com/H5qoXFb.jpg\",\"Dating Site Murderer\":\"//i.imgur.com/jffNNql.jpg\",\"Depression Dog\":\"//i.imgur.com/wgad6P8.jpg\",\"Drunk Baby\":\"//i.imgur.com/QvZdbRE.jpg\",\"English Motherfucker\":\"//i.imgur.com/sJThEC0.jpg\",\"Evil Plotting Raccoon\":\"//i.imgur.com/xMslWFf.jpg\",\"First Day On The Internet Kid\":\"//i.imgur.com/TWfdmVu.jpg\",\"First World Cat Problems\":\"//i.imgur.com/0vR5Slq.jpg\",\"First World Problem\":\"//i.imgur.com/ATcIl08.jpg\",\"Forever Alone\":\"//i.imgur.com/pcfXSUU.jpg\",\"Forever Resentful Mother\":\"//i.imgur.com/pIrdwo2.jpg\",\"Foul Bachelor Frog\":\"//i.imgur.com/JUFmusm.jpg\",\"Foul Bachelorette Frog\":\"//i.imgur.com/dYf971U.jpg\",\"Friendzone Fiona\":\"//i.imgur.com/Qu1eedL.jpg\",\"Frustrated Farnsworth\":\"//i.imgur.com/U3SElKP.jpg\",\"Fuck Me, Right?\":\"//i.imgur.com/J9gfxsx.jpg\",\"Gangster Baby\":\"//i.imgur.com/C3XhI56.jpg\",\"Good Girl Gina\":\"//i.imgur.com/qK6lYr2.jpg\",\"Good Guy Greg\":\"//i.imgur.com/UXMPoKN.jpg\",\"Grandma Finds The Internet\":\"//i.imgur.com/xPfGYqu.jpg\",\"Grinds My Gears\":\"//i.imgur.com/t4JqU1j.jpg\",\"Grumpy Cat (Tard)\":\"//i.imgur.com/dU5CDxN.jpg\",\"High Expectations Asian Father\":\"//i.imgur.com/7QeB9LI.jpg\",\"Hipster Barista\":\"//i.imgur.com/AbWxdy2.jpg\",\"Horrifying House Guest\":\"//i.imgur.com/DxmoFp1.jpg\",\"I Dare You Samuel Jackson\":\"//i.imgur.com/UQtpdqj.jpg\",\"I Should Buy A Boat\":\"//i.imgur.com/XqlqPxn.jpg\",\"I Too Like To Live Dangerously\":\"//i.imgur.com/qF70EL9.jpg\",\"Idiot Nerd Girl\":\"//i.imgur.com/8hYPYwd.jpg\",\"Insanity Wolf\":\"//i.imgur.com/GOOdg3k.jpg\",\"Joker Mind Loss\":\"//i.imgur.com/qQIRaOD.jpg\",\"Joseph Ducreux\":\"//i.imgur.com/QL7TyR9.jpg\",\"Lame Joke Eel\":\"//i.imgur.com/oQXw3jF.jpg\",\"Lame Pun Raccoon\":\"//i.imgur.com/nvALRK3.jpg\",\"Lazy College Senior\":\"//i.imgur.com/PpkVfzz.jpg\",\"Mad Karma\":\"//i.imgur.com/G0QMPum.jpg\",\"Masturbating Spidey\":\"//i.imgur.com/dZ7AB4c.jpg\",\"Matrix Morpheus\":\"//i.imgur.com/8Yrw6cZ.jpg\",\"Mayonnaise Patrick\":\"//i.imgur.com/5jE0Y7f.jpg\",\"Musically Oblivious 8th Grader\":\"//i.imgur.com/l5YHN5D.jpg\",\"Not Sure Fry\":\"//i.imgur.com/7rFgBB1.jpg\",\"Oblivious Suburban Mom\":\"//i.imgur.com/Y7o7UJs.jpg\",\"One Does Not Simply\":\"//i.imgur.com/7LrwR1Y.jpg\",\"Overly Attached Girlfriend\":\"//i.imgur.com/5blLJLR.jpg\",\"Overly Manly Man\":\"//i.imgur.com/dOSn9Na.jpg\",\"Paranoid Parrot\":\"//i.imgur.com/KooYHdg.jpg\",\"Pedobear\":\"//i.imgur.com/c6JZKRW.jpg\",\"Pepperidge Farm Remembers\":\"//i.imgur.com/uFde4v5.jpg\",\"Philosoraptor\":\"//i.imgur.com/eERhI5h.jpg\",\"Priority Peter\":\"//i.imgur.com/BBEFk0e.jpg\",\"Rasta Science Teacher\":\"//i.imgur.com/Js6Ai5T.jpg\",\"Redditor's Wife\":\"//i.imgur.com/d1XfJeD.jpg\",\"Revenge Band Kid\":\"//i.imgur.com/dlvmaRI.jpg\",\"Schrute Facts\":\"//i.imgur.com/UxcvPwT.jpg\",\"Scumbag Brain\":\"//i.imgur.com/OZhhZdS.jpg\",\"Scumbag Stacy\":\"//i.imgur.com/Qqz1axp.jpg\",\"Scumbag Steve\":\"//i.imgur.com/Rfvoc0Y.jpg\",\"Sexually Oblivious Rhino\":\"//i.imgur.com/RoaNuEC.jpg\",\"Sheltering Suburban Mom\":\"//i.imgur.com/vMkSofv.jpg\",\"Shut Up And Take My Money\":\"//i.imgur.com/uWe0rtQ.jpg\",\"Skeptical Third World Kid\":\"//i.imgur.com/uwAusxV.jpg\",\"Smug Spongebob\":\"//i.imgur.com/OTTRjrv.jpg\",\"Socially Awesome Penguin\":\"//i.imgur.com/S6WgQW7.jpg\",\"Success Kid\":\"//i.imgur.com/ZibijBz.jpg\",\"Successful Black Man\":\"//i.imgur.com/ogIm0cy.jpg\",\"Sudden Clarity Clarence\":\"//i.imgur.com/N3Xmfbe.jpg\",\"Tech Impaired Duck\":\"//i.imgur.com/riz28ci.jpg\",\"The Most Interesting Man In The World\":\"//i.imgur.com/MGv15MH.jpg\",\"The Rent Is Too High\":\"//i.imgur.com/r5WLktQ.jpg\",\"Tough Spongebob\":\"//i.imgur.com/2w0F1HX.jpg\",\"Unhelpful Highschool Teacher\":\"//i.imgur.com/ohbGhuD.jpg\",\"Vengeance Dad\":\"//i.imgur.com/0nUStsa.jpg\",\"What Year Is It?\":\"//i.imgur.com/fj79hQS.jpg\",\"X, X Everywhere\":\"//i.imgur.com/GGy94Gt.jpg\",\"Yeah That'd Be Great\":\"//i.imgur.com/nz9M2pl.jpg\",\"Yo Dawg Xzibit\":\"//i.imgur.com/XOyGqF2.jpg\",\"You're Bad And You Should Feel Bad\":\"//i.imgur.com/YsabGnQ.jpg\",\"You're Gonna Have A Bad Time\":\"//i.imgur.com/2tNR7P7.jpg\"};\r\n\r\n\t/**\r\n\t * Since the console.log doesn't respond to the `display` style,\r\n\t * setting a width and height has no effect. In fact, the only styles\r\n\t * I've found it responds to is font-size, background-image and color.\r\n\t * To combat the image repeating, we have to get a create a font bounding\r\n\t * box so to speak with the unicode box characters. EDIT: See Readme.md\r\n\t *\r\n\t * @param  {int} width  The height of the box\r\n\t * @param  {int} height The width of the box\r\n\t * @return {object}     {string, css}\r\n\t */\r\n\tfunction getBox(width, height) {\r\n\t\treturn {\r\n\t\t\tstring: \"+\",\r\n\t\t\tstyle: \"font-size: 1px; padding: \" + Math.floor(height/2) + \"px \" + Math.floor(width/2) + \"px; line-height: \" + height + \"px;\"\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Draw's meme text on a context.\r\n\t *\r\n\t * @param  {CanvasRenderingContext2D} ctx   The canvas context\r\n\t * @param  {string} type  \"upper\"|\"lower\"\r\n\t * @param  {string} text  The text to draw\r\n\t * @param  {int} width The width of the image\r\n\t * @param  {int} y     The y value to draw at\r\n\t * @return {null}\r\n\t */\r\n\tfunction drawMemeText(ctx, type, text, width, y) {\r\n\t\ttext = text.toUpperCase();\r\n\t\t//Determine the font size\r\n\t\tif(text.length < 24) {\r\n\t\t\tvar val = Math.max(0, text.length - 12),\r\n\t\t\t\tsize = 70 + (val * - 3);\r\n\r\n\t\t\tdrawText(ctx, size, text, width/2, y);\r\n\t\t} else if(text.length < 29) {\r\n\t\t\tdrawText(ctx, 40, text, width/2, y);\r\n\t\t} else {\r\n\t\t\tvar strs = wrap(text, 27);\r\n\t\t\tstrs.forEach(function(str, i) {\r\n\t\t\t\tdrawText(ctx, 40, str, width/2, (type == \"lower\") ? (y - ((strs.length - 1) * 40)) + (i * 40) : y + (i * 40));\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Draws text in impact font with stroke on context\r\n\t *\r\n\t * @param  {CanvasRenderingContext2D} ctx  The canvas context\r\n\t * @param  {int} size Font size\r\n\t * @param  {string} text The string to write\r\n\t * @param  {int} x    X Position\r\n\t * @param  {int} y    Y position\r\n\t * @return {null}\r\n\t */\r\n\tfunction drawText(ctx, size, text, x, y) {\r\n\t\t//Set the text styles\r\n\t\tctx.font = \"bold \" + size + \"px Impact\";\r\n\t\tctx.fillStyle = \"#fff\";\r\n\t\tctx.textAlign = \"center\";\r\n\t\tctx.textBaseline = \"middle\";\r\n\t\tctx.lineWidth = 7;\r\n\t\tctx.strokeStyle = \"#000\";\r\n\t\tctx.strokeText(text, x, y);\r\n\t\tctx.fillText(text, x, y);\r\n\t}\r\n\r\n\t/**\r\n\t * Wrap a line of text at an index\r\n\t *\r\n\t * @param  {string} text The text\r\n\t * @param  {int} num  The index to wrap at\r\n\t * @return {array}      Array of text\r\n\t */\r\n\tfunction wrap(text, num) {\r\n\t\tvar output = [],\r\n\t\t\tsplit = text.split(\" \");\r\n\r\n\t\tvar str = [];\r\n\t\tfor(var i = 0, cache = split.length; i < cache; i++) {\r\n\t\t\tif((str + split[i]).length < num) str.push(split[i])\r\n\t\t\telse {\r\n\t\t\t\toutput.push(str.join(\" \"));\r\n\t\t\t\tstr.length = 0;\r\n\t\t\t\tstr.push(split[i]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//Push the final line\r\n\t\toutput.push(str.join(\" \"));\r\n\r\n\t\treturn output;\r\n\t}\r\n\r\n\t/**\r\n\t * Add a meme to the console!\r\n\t *\r\n\t * @param  {string} upper  The upper text\r\n\t * @param  {string} lower  The lower text\r\n\t * @param  {string} image  The meme type (see `console.meme` for all supported) or image url (Make sure it's CORS enabled)\r\n\t * @param  {int} width  The width of the meme\r\n\t * @param  {int} height The height of the meme\r\n\t * @return {null}\r\n\t */\r\n\tconsole.meme = function(upper, lower, image, width, height) {\r\n\t\tif(!upper) console.error(\"Yo, you forgot the text for the upper part of the meme. The bit at the top. Yeah, that bit.\");\r\n\t\tif(!lower) console.error(\"You forgot the text for the bottom of the meme, stupid.\");\r\n\t\tif(!image) console.error(\"Dude, you forgot the meme type or url for the background image (CORS enabled, *hint* imgur *hint*). To see a list of supported memes, hit `console.meme()`\");\r\n\t\tif(!upper && !lower && !image) return console.log(\"> \" + Object.keys(memes).join(\"\\n> \"));\r\n\r\n\t\tvar canvas = document.createElement(\"canvas\"),\r\n\t\t\tctx = canvas.getContext(\"2d\"),\r\n\t\t\twidth = width || 500,\r\n\t\t\theight = width || 500,\r\n\t\t\t//I tweaked it at these dimensions,\r\n\t\t\t//So everything scales from here\r\n\t\t\t_w = 500, _h = 500;\r\n\r\n\t\tvar img = new Image();\r\n    \t\timg.setAttribute('crossOrigin','anonymous');\r\n\t\timg.onload = function() {\r\n\t\t\tcanvas.width = width;\r\n\t\t\tcanvas.height = height;\r\n\r\n\t\t\tvar text = upper.toUpperCase();\r\n\r\n\t\t\tctx.scale(width/500, height/500);\r\n\r\n\t\t\t//Draw the background\r\n\t\t\tctx.drawImage(this, 0, 0, _w, _h);\r\n\r\n\t\t\tdrawMemeText(ctx, \"upper\", upper, _w, 50); //upper\r\n\t\t\tdrawMemeText(ctx, \"lower\", lower, _w, _h - 50); //upper\r\n\r\n\t\t\tconsole.image(canvas.toDataURL());\r\n\t\t};\r\n\r\n\t\tif(memes[image]) var url = memes[image];\r\n\t\telse var url = image;\r\n\r\n\t\timg.src = url; //\"http://www.corsproxy.com/\" + url.replace(/https?:\\/\\//, \"\");\r\n\t};\r\n\r\n\t/**\r\n\t * Display an image in the console.\r\n\t * @param  {string} url The url of the image.\r\n\t * @param  {int} scale Scale factor on the image\r\n\t * @return {null}\r\n\t */\r\n\tconsole.image = function(url, scale) {\r\n\t\tscale = scale || 1;\r\n\t\tvar img = new Image();\r\n\r\n\t\timg.onload = function() {\r\n\t\t\tvar dim = getBox(this.width * scale, this.height * scale);\r\n\t\t\tconsole.log(\"%c\" + dim.string, dim.style + \"background: url(\" + url + \"); background-size: \" + (this.width * scale) + \"px \" + (this.height * scale) + \"px; color: transparent;\");\r\n\t\t};\r\n\r\n\t\timg.src = url;\r\n\t};\r\n})(console);\r\n;(function() {\r\n  console.log('Line() class... creating');\r\n\r\n  let cos = Math.cos,\r\n    pow = Math.pow,\r\n    sin = Math.sin,\r\n    sqrt = Math.sqrt,\r\n    PI = Math.PI;\r\n\r\n\r\n  var Curves = { //ALL HAVE INPUT AND OUTPUT OF: 0-1.\r\n    Sine: {\r\n      In: function(x){\r\n        return 1 - cos((x * PI) / 2);\r\n      },\r\n\r\n      Out: function(x){\r\n\r\n        return sin((x * PI) / 2);\r\n      },\r\n\r\n      InOut: function(x){\r\n\r\n          return -(cos(PI * x) - 1) / 2;\r\n\r\n      }\r\n    },\r\n    Cubic: {\r\n      In: function(x){\r\n        return x * x * x;\r\n      },\r\n\r\n      Out: function(x){\r\n\r\n        return 1 - pow(1 - x, 3);\r\n      },\r\n\r\n      InOut: function(x){\r\n\r\n        return x < 0.5 ? 4 * x * x * x : 1 - pow(-2 * x + 2, 3) / 2;\r\n      }\r\n    },\r\n    Quintic: {\r\n      In: function(x){\r\n        return x * x * x * x * x;\r\n      },\r\n\r\n      Out: function(x){\r\n\r\n        return 1 - pow(1 - x, 5);\r\n      },\r\n\r\n      InOut: function(x){\r\n\r\n        return x < 0.5 ? 16 * x * x * x * x * x : 1 - pow(-2 * x + 2, 5) / 2;\r\n      }\r\n    },\r\n    Circular: {\r\n      In: function(x){\r\n        return 1 - sqrt(1 - pow(x, 2));\r\n      },\r\n\r\n      Out: function(x){\r\n\r\n        return sqrt(1 - pow(x - 1, 2));\r\n      },\r\n\r\n      InOut: function(x){\r\n\r\n        return x < 0.5 ?\r\n          (1 - sqrt(1 - pow(2 * x, 2))) / 2 :\r\n          (sqrt(1 - pow(-2 * x + 2, 2)) + 1) / 2;\r\n      }\r\n    },\r\n    Elastic: {\r\n      In: function(x){\r\n        const c4 = (2 * Math.PI) / 3;\r\n\r\n        return x === 0 ?\r\n          0 :\r\n          x === 1 ?\r\n          1 :\r\n          -pow(2, 10 * x - 10) * sin((x * 10 - 10.75) * c4);\r\n      },\r\n\r\n      Out: function(x){\r\n\r\n        const c4 = (2 * Math.PI) / 3;\r\n        return x === 0 ?\r\n          0 :\r\n          x === 1 ?\r\n          1 :\r\n          pow(2, -10 * x) * sin((x * 10 - 0.75) * c4) + 1;\r\n      },\r\n\r\n      InOut: function(x){\r\n\r\n        const c5 = (2 * Math.PI) / 4.5;\r\n\r\n        return x === 0 ?\r\n          0 :\r\n          x === 1 ?\r\n          1 :\r\n          x < 0.5 ?\r\n          -(pow(2, 20 * x - 10) * sin((20 * x - 11.125) * c5)) / 2 :\r\n          (pow(2, -20 * x + 10) * sin((20 * x - 11.125) * c5)) / 2 + 1;\r\n      }\r\n    },\r\n    Quadratic: {\r\n      In: function(x){\r\n        return x * x;\r\n      },\r\n\r\n      Out: function(x){\r\n\r\n        return 1 - (1 - x) * (1 - x);\r\n      },\r\n\r\n      InOut: function(x){\r\n        return x < 0.5 ? 2 * x * x : 1 - pow(-2 * x + 2, 2) / 2;\r\n\r\n      }\r\n    },\r\n    Quartic: {\r\n      In: function(x){\r\n        return x * x * x * x;\r\n      },\r\n\r\n      Out: function(x){\r\n\r\n        return 1 - pow(1 - x, 4);\r\n      },\r\n\r\n      InOut: function(x){\r\n\r\n        return x < 0.5 ? 8 * x * x * x * x : 1 - pow(-2 * x + 2, 4) / 2;\r\n      }\r\n    },\r\n    Exponential: {\r\n      In: function(x){\r\n        return x === 0 ? 0 : pow(2, 10 * x - 10);\r\n      },\r\n\r\n      Out: function(x){\r\n        return x === 1 ? 1 : 1 - pow(2, -10 * x);\r\n\r\n      },\r\n\r\n      InOut: function(x){\r\n\r\n        return x === 0 ?\r\n          0 :\r\n          x === 1 ?\r\n          1 :\r\n          x < 0.5 ? pow(2, 20 * x - 10) / 2 :\r\n          (2 - pow(2, -20 * x + 10)) / 2;\r\n      }\r\n    },\r\n    Back: {\r\n      In: function(x){\r\n        const c1 = 1.70158;\r\n        const c3 = c1 + 1;\r\n\r\n        return c3 * x * x * x - c1 * x * x;\r\n      },\r\n\r\n      Out: function(x){\r\n\r\n        const c1 = 1.70158;\r\n        const c3 = c1 + 1;\r\n\r\n        return 1 + c3 * pow(x - 1, 3) + c1 * pow(x - 1, 2);\r\n      },\r\n\r\n      InOut: function(x){\r\n\r\n        const c1 = 1.70158;\r\n        const c2 = c1 * 1.525;\r\n\r\n        return x < 0.5 ?\r\n          (pow(2 * x, 2) * ((c2 + 1) * 2 * x - c2)) / 2 :\r\n          (pow(2 * x - 2, 2) * ((c2 + 1) * (x * 2 - 2) + c2) + 2) / 2;\r\n      }\r\n    },\r\n    Bounce: {\r\n      In: function(x){\r\n        return 1 - Curves.Out.Bounce(1 - x);\r\n      },\r\n\r\n      Out: function(x){\r\n\r\n        const n1 = 7.5625;\r\n        const d1 = 2.75;\r\n\r\n        if (x < 1 / d1) {\r\n          return n1 * x * x;\r\n        } else if (x < 2 / d1) {\r\n          return n1 * (x -= 1.5 / d1) * x + 0.75;\r\n        } else if (x < 2.5 / d1) {\r\n          return n1 * (x -= 2.25 / d1) * x + 0.9375;\r\n        } else {\r\n          return n1 * (x -= 2.625 / d1) * x + 0.984375;\r\n        }\r\n      },\r\n\r\n      InOut: function(x){\r\n\r\n        const n1 = 7.5625;\r\n        const d1 = 2.75;\r\n\r\n        if (x < 1 / d1) {\r\n          return n1 * x * x;\r\n        } else if (x < 2 / d1) {\r\n          return n1 * (x -= 1.5 / d1) * x + 0.75;\r\n        } else if (x < 2.5 / d1) {\r\n          return n1 * (x -= 2.25 / d1) * x + 0.9375;\r\n        } else {\r\n          return n1 * (x -= 2.625 / d1) * x + 0.984375;\r\n        }\r\n      }\r\n    },\r\n\r\n    None: {\r\n      Linear: function(x) {\r\n        return x;\r\n      },\r\n      Zero(x) {\r\n        return 0;\r\n      }\r\n    },\r\n    In: {\r\n      Sine: function(x) {\r\n        return 1 - cos((x * PI) / 2);\r\n      },\r\n      Cubic: function(x) {\r\n        return x * x * x;\r\n      },\r\n      Quintic: function(x) {\r\n        return x * x * x * x * x;\r\n      },\r\n      Circular: function(x) {\r\n        return 1 - sqrt(1 - pow(x, 2));\r\n      },\r\n      Elastic: function(x) {\r\n        const c4 = (2 * Math.PI) / 3;\r\n\r\n        return x === 0 ?\r\n          0 :\r\n          x === 1 ?\r\n          1 :\r\n          -pow(2, 10 * x - 10) * sin((x * 10 - 10.75) * c4);\r\n      },\r\n      Quadratic: function(x) {\r\n        return x * x;\r\n      },\r\n      Quartic: function(x) {\r\n        return x * x * x * x;\r\n      },\r\n      Exponential: function(x) {\r\n        return x === 0 ? 0 : pow(2, 10 * x - 10);\r\n      },\r\n      Back: function(x) {\r\n        const c1 = 1.70158;\r\n        const c3 = c1 + 1;\r\n\r\n        return c3 * x * x * x - c1 * x * x;\r\n      },\r\n      Bounce: function(x) {\r\n        return 1 - Curves.Out.Bounce(1 - x);\r\n      },\r\n    },\r\n\r\n    Out: {\r\n      Sine: function(x) {\r\n        return sin((x * PI) / 2);\r\n      },\r\n      Cubic: function(x) {\r\n        return 1 - pow(1 - x, 3);\r\n      },\r\n      Quintic: function(x) {\r\n        return 1 - pow(1 - x, 5);\r\n      },\r\n      Circular: function(x) {\r\n        return sqrt(1 - pow(x - 1, 2));\r\n      },\r\n      Elastic: function(x) {\r\n        const c4 = (2 * Math.PI) / 3;\r\n        return x === 0 ?\r\n          0 :\r\n          x === 1 ?\r\n          1 :\r\n          pow(2, -10 * x) * sin((x * 10 - 0.75) * c4) + 1;\r\n      },\r\n      Quadratic: function(x) {\r\n        return 1 - (1 - x) * (1 - x);\r\n      },\r\n      Quartic: function(x) {\r\n        return 1 - pow(1 - x, 4);\r\n      },\r\n      Exponential: function(x) {\r\n        return x === 1 ? 1 : 1 - pow(2, -10 * x);\r\n      },\r\n      Back: function(x) {\r\n        const c1 = 1.70158;\r\n        const c3 = c1 + 1;\r\n\r\n        return 1 + c3 * pow(x - 1, 3) + c1 * pow(x - 1, 2);\r\n      },\r\n      Bounce: function(x) {\r\n        const n1 = 7.5625;\r\n        const d1 = 2.75;\r\n\r\n        if (x < 1 / d1) {\r\n          return n1 * x * x;\r\n        } else if (x < 2 / d1) {\r\n          return n1 * (x -= 1.5 / d1) * x + 0.75;\r\n        } else if (x < 2.5 / d1) {\r\n          return n1 * (x -= 2.25 / d1) * x + 0.9375;\r\n        } else {\r\n          return n1 * (x -= 2.625 / d1) * x + 0.984375;\r\n        }\r\n      },\r\n    },\r\n    InOut: {\r\n      Sine: function(x) {\r\n        return -(cos(PI * x) - 1) / 2;\r\n      },\r\n      Cubic: function(x) {\r\n        return x < 0.5 ? 4 * x * x * x : 1 - pow(-2 * x + 2, 3) / 2;\r\n      },\r\n      Quintic: function(x) {\r\n        return x < 0.5 ? 16 * x * x * x * x * x : 1 - pow(-2 * x + 2, 5) / 2;\r\n      },\r\n      Circular: function(x) {\r\n        return x < 0.5 ?\r\n          (1 - sqrt(1 - pow(2 * x, 2))) / 2 :\r\n          (sqrt(1 - pow(-2 * x + 2, 2)) + 1) / 2;\r\n      },\r\n      Elastic: function(x) {\r\n        const c5 = (2 * Math.PI) / 4.5;\r\n\r\n        return x === 0 ?\r\n          0 :\r\n          x === 1 ?\r\n          1 :\r\n          x < 0.5 ?\r\n          -(pow(2, 20 * x - 10) * sin((20 * x - 11.125) * c5)) / 2 :\r\n          (pow(2, -20 * x + 10) * sin((20 * x - 11.125) * c5)) / 2 + 1;\r\n      },\r\n      Quadratic: function(x) {\r\n        return x < 0.5 ? 2 * x * x : 1 - pow(-2 * x + 2, 2) / 2;\r\n      },\r\n      Quartic: function(x) {\r\n        return x < 0.5 ? 8 * x * x * x * x : 1 - pow(-2 * x + 2, 4) / 2;\r\n      },\r\n      Exponential: function(x) {\r\n        return x === 0 ?\r\n          0 :\r\n          x === 1 ?\r\n          1 :\r\n          x < 0.5 ? pow(2, 20 * x - 10) / 2 :\r\n          (2 - pow(2, -20 * x + 10)) / 2;\r\n      },\r\n      Back: function(x) {\r\n        const c1 = 1.70158;\r\n        const c2 = c1 * 1.525;\r\n\r\n        return x < 0.5 ?\r\n          (pow(2 * x, 2) * ((c2 + 1) * 2 * x - c2)) / 2 :\r\n          (pow(2 * x - 2, 2) * ((c2 + 1) * (x * 2 - 2) + c2) + 2) / 2;\r\n      },\r\n      Bounce: function(x) {\r\n        const n1 = 7.5625;\r\n        const d1 = 2.75;\r\n\r\n        if (x < 1 / d1) {\r\n          return n1 * x * x;\r\n        } else if (x < 2 / d1) {\r\n          return n1 * (x -= 1.5 / d1) * x + 0.75;\r\n        } else if (x < 2.5 / d1) {\r\n          return n1 * (x -= 2.25 / d1) * x + 0.9375;\r\n        } else {\r\n          return n1 * (x -= 2.625 / d1) * x + 0.984375;\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  Gamelab.Curves = Curves;\r\n  Gamelab.EasingCurves = Gamelab.Curves;\r\n\r\n  var inOutCurves = {\r\n    quadratic: function(t) {\r\n      return t < .5 ? 2 * t * t : -1 + (4 - 2 * t) * t\r\n    },\r\n    cubic: function(t) {\r\n      return t < .5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1\r\n    },\r\n    quartic: function(t) {\r\n      return t < .5 ? 8 * t * t * t * t : 1 - 8 * (--t) * t * t * t\r\n    },\r\n    quintic: function(t) {\r\n      return t < .5 ? 16 * t * t * t * t * t : 1 + 16 * (--t) * t * t * t * t\r\n    },\r\n    linear: function(t) {\r\n      return t;\r\n    } //provided for consistency / in case 'linear' is needed\r\n  };\r\n\r\n  Gamelab.UI = Gamelab.UI || {};\r\n\r\n  let getCurveCanvasList = function() {\r\n    var canvases = [];\r\n    for (var q in Gamelab.Curves) {\r\n      for (var t in Gamelab.Curves[q]) {\r\n        if (typeof Gamelab.Curves[q][t] == 'function') {\r\n          let c = document.createElement('canvas');\r\n          let ckey = q + '.' + t;\r\n          c.width = 170;\r\n          c.height = 100;\r\n          c.style.width = '170px';\r\n          c.style.height = '100px';\r\n          c.fillStyle = 'rgba(0, 0, 0, 0.6)';\r\n\r\n          c.setAttribute('data-curve-keys', q + '.' + t);\r\n\r\n          let ctx = c.getContext('2d');\r\n          ctx.fillRect(0, 0, 170, 100);\r\n          ctx.lineWidth = 1;\r\n          ctx.shadowBlur = 2;\r\n          ctx.shadowColor = 'teal';\r\n\r\n          let padding = 40;\r\n\r\n          ctx.beginPath();\r\n\r\n          for (var x = padding / 2.0; x < c.width - padding / 2.0; x += 1.0) {\r\n            let calcHeight = c.height - padding;\r\n            let calcWidth = c.width - padding;\r\n            let p2 = new Gamelab.Vector(x, padding / 2.0 + calcHeight * Gamelab.Curves[q][t](x / calcWidth));\r\n            if (x > 0) {\r\n\r\n              let p1 = new Gamelab.Vector(x - 1, padding / 2.0 + calcHeight * Gamelab.Curves[q][t]((x - 1) / calcWidth));\r\n              ctx.strokeStyle = 'limegreen';\r\n\r\n              if (ckey.indexOf('In.Elastic') >= 0) {\r\n                p1.y += 20;\r\n                p2.y += 20;\r\n              }\r\n\r\n              if (ckey.indexOf('Out.Elastic') >= 0) {\r\n                p1.y -= 20;\r\n                p2.y -= 20;\r\n              }\r\n\r\n              ctx.moveTo(p1.x, 100 - p1.y);\r\n              ctx.lineTo(p2.x, 100 - p2.y);\r\n              ctx.stroke();\r\n            };\r\n          }\r\n          canvases.push(c);\r\n        }\r\n      }\r\n    }\r\n    return canvases;\r\n  };\r\n\r\n  let getCurveImageList = function() {\r\n    var images = [],\r\n      canvases = this.getCurveCanvasList();\r\n    canvases.forEach(function(c) {\r\n\r\n      let image = document.createElement('img');\r\n\r\n      image.style.display = 'none';\r\n      image.style.position = 'absolute';\r\n      image.style.zIndex = '9999';\r\n\r\n      image.style.width = 'auto';\r\n      image.style.height = 'auto';\r\n\r\n      image.style.background = 'transparent';\r\n      image.style.border = '1px inset #444';\r\n\r\n      image.setAttribute('data-curve-keys', c.getAttribute('data-curve-keys'));\r\n      image.style.opacity = 0.8;\r\n      image.src = c.toDataURL();\r\n      image.onload = function() {\r\n\r\n\r\n      };\r\n\r\n      image.show = function(topLeftElement) {\r\n        var rect = topLeftElement.getBoundingClientRect();\r\n        this.style.top = $(topLeftElement).position().top - 6 + 'px';\r\n        this.style.left = 5 + 120 + 'px';\r\n        this.style.display = 'block';\r\n      };\r\n\r\n      image.hide = function() {\r\n        this.style.display = 'none';\r\n      };\r\n      images.push(image);\r\n    });\r\n    return images;\r\n  };\r\n\r\n\r\n  class StateFrame {\r\n    constructor(object, target) {\r\n      this.object = object;\r\n      this.target = target;\r\n      this.easingCurve = 'linear-none';\r\n      this.timeLimit = 100;\r\n      this.complete = function() {\r\n        console.log('empty complete');\r\n      };\r\n    }\r\n    Object(o) {\r\n      this.object = o;\r\n      return this;\r\n    }\r\n    Target(t) {\r\n      this.target = t;\r\n      return this;\r\n    }\r\n    EasingCurve(e) {\r\n      this.easingCurve = e;\r\n      return this;\r\n    }\r\n    TimeLimit(t) {\r\n      this.timeLimit = t;\r\n      return this;\r\n    }\r\n    onComplete(complete) {\r\n      this.complete = complete;\r\n      return this;\r\n    }\r\n    commit() {\r\n      alert('commiting keyframe');\r\n      if (this.complete) {\r\n        this.complete();\r\n      }\r\n    }\r\n  }\r\n\r\n  Gamelab.StateFrame = StateFrame;\r\n\r\n  Gamelab.UI.getCurveCanvasList = getCurveCanvasList;\r\n  Gamelab.UI.getCurveImageList = getCurveImageList;\r\n\r\n\r\n})();\r\n;class FeildSpan {\r\n  constructor(a, b, transition = 'linear', duration = 500) {\r\n    //console.log('FeildSpan(a, b, transition) :: transition may be the key-name of a curve or \"random\"');\r\n\r\n    if (typeof a == 'number' && b == undefined)\r\n      transition = 'fixed';\r\n\r\n    this.a = a;\r\n    this.b = b;\r\n    this.transition = transition;\r\n    this.duration = duration;\r\n    this.ticker = 0;\r\n\r\n    this.Duration = function(d) {\r\n      this.duration = d;\r\n      return this;\r\n    };\r\n\r\n    this.Clone = function() {\r\n      return new FeildSpan(this.a, this.b, this.transition, this.duration);\r\n    };\r\n\r\n    this.max = function() {\r\n      if (typeof this.a == 'number' && typeof this.b !== 'number')\r\n        return this.a;\r\n      else\r\n        return this.a >= this.b ? this.a : this.b;\r\n    };\r\n\r\n    this.Reset = function() {\r\n      this.ticker = 0;\r\n      return this;\r\n    };\r\n\r\n    this.getValue = function() {\r\n\r\n      if (this.transition == 'fixed')\r\n        return this.a;\r\n\r\n      var option = this,\r\n\r\n        value = 0,\r\n\r\n        diff = option.a - option.b;\r\n      option.duration = option.duration || 500;\r\n      var tvalue = option.transition;\r\n\r\n      var curveMethod;\r\n\r\n      for (var x in Gamelab.EasingCurves) {\r\n        for (var y in Gamelab.EasingCurves[x]) {\r\n          if (y.toLowerCase() == option.transition.toLowerCase() && x == 'None' || x == 'In') {\r\n            curveMethod = Gamelab.EasingCurves[x][y] || Gamelab.EasingCurves[x][y];\r\n          }\r\n        }\r\n      }\r\n\r\n      if (tvalue == 'random-once' && this.testValue !== undefined) {\r\n        return this.testValue;\r\n      } else if (tvalue == 'random-once' || tvalue == 'random') {\r\n\r\n        option.ticker += 1;\r\n\r\n        var finalValue = option.a;\r\n\r\n        if (option.a <= option.b) {\r\n          return option.a + Math.abs((Math.random() * diff));\r\n        } else {\r\n          return option.a - Math.abs((Math.random() * diff));\r\n        }\r\n\r\n\r\n      } else if (curveMethod) {\r\n\r\n        var portion = Math.round((option.ticker / option.duration) * 100) / 100;\r\n\r\n        option.ticker += 1;\r\n\r\n        diff = Math.abs(diff);\r\n\r\n        var curveStep = Math.abs(curveMethod(portion) * diff);\r\n\r\n        var finalValue = option.a;\r\n\r\n        finalValue += option.a > option.b ? curveStep * -1 : curveStep;\r\n\r\n        if (option.ticker >= option.duration) {\r\n          return option.b;\r\n        }\r\n\r\n        return Math.round(finalValue * 100) / 100;\r\n      }\r\n    };\r\n\r\n\r\n    this.testValue = this.getValue();\r\n\r\n  }\r\n}\r\n\r\n\r\nclass ColorFeildSpan {\r\n\r\n  constructor(a, b, transition = 'linear', duration = 500, colors = []) {\r\n\r\n    if (typeof a == 'string' && b == undefined)\r\n      transition = 'fixed';\r\n\r\n    this.a = a;\r\n    this.b = b;\r\n    this.transition = transition;\r\n    this.duration = duration;\r\n    this.ticker = 0;\r\n    this.colors = colors;\r\n\r\n    this.Duration = function(d) {\r\n      this.duration = d;\r\n      return this;\r\n    };\r\n\r\n    this.Clone = function() {\r\n      return new ColorFeildSpan(this.a, this.b, this.transition, this.duration, this.colors);\r\n    };\r\n\r\n    this.hasVariance = function() {\r\n      return this.transition !== 'fixed';\r\n    };\r\n\r\n    this.PrepareColors = function() {\r\n      //runs 100 X , creates set of differential colors on the specified scale\r\n\r\n      for (var x = 0.0; x <= 1.0; x += 0.01) {\r\n        //use the x value to get the set of y values for this transition | curve (ex 'cubic')\r\n        var tvalue = this.transition !== 'random' ? this.transition : 'linear';\r\n        var option = this,\r\n          value = 0;\r\n\r\n        var curveMethod;\r\n\r\n        option.duration = option.duration || 500;\r\n\r\n        //if 'random' then create a linear scale to select from\r\n        if (this.transition == 'random') {\r\n          tvalue = 'linear';\r\n        }\r\n\r\n        if (this.transition == 'fixed') {\r\n          this.colors.push(Gamelab.ColorCalculator.scaledRGBAFromHex(option.a, option.a, 0));\r\n          continue;\r\n        }\r\n\r\n        var portion = x;\r\n\r\n        this.colors.push(Gamelab.ColorCalculator.scaledRGBAFromHex(option.a, option.b, portion));\r\n      };\r\n\r\n      return this;\r\n    };\r\n\r\n    this.Reset = function() {\r\n      this.ticker = 0;\r\n      return this;\r\n    };\r\n\r\n    this.min = function() {\r\n\r\n      if (typeof this.a == 'number' && this.b == undefined)\r\n        return this.a;\r\n\r\n      if (this.a <= this.b)\r\n        return this.a;\r\n      else {\r\n        return this.b;\r\n      }\r\n    };\r\n\r\n    this.max = function() {\r\n\r\n      if (typeof this.a == 'number' && this.b == undefined)\r\n        return this.a;\r\n\r\n      if (this.a >= this.b)\r\n        return this.a;\r\n      else {\r\n        return this.b;\r\n      }\r\n    };\r\n\r\n    this.getPortion = function() {\r\n      return this.ticker / this.duration;\r\n    };\r\n\r\n\r\n    //getValue :: returns the color for current step\r\n    this.getValue = function() {\r\n      //calculate portion as step 0.0 - 1.0\r\n      var portion = this.ticker / this.duration;\r\n\r\n      //increment ticker\r\n      this.ticker += 1;\r\n\r\n      //handle random transition\r\n      if (this.transition == 'random') {\r\n        return this.colors[Math.floor(Math.random() * this.colors.length)];\r\n      }\r\n\r\n      if (this.transition == 'fixed')\r\n        return this.colors[0];\r\n\r\n      //get the correct array-member of index 0-99 using portion\r\n      return this.colors[Math.floor(portion * 100)];\r\n    };\r\n\r\n  }\r\n\r\n}\r\n\r\nGamelab.FeildSpan = FeildSpan;\r\nGamelab.ColorFeildSpan = ColorFeildSpan;;class FiringClock {\r\n  constructor() {\r\n    this.ticker = 0;\r\n    this.skip = 0;\r\n    this.duration = 200;\r\n    this.repeats = 0;\r\n    this.callback = function() {};\r\n    this.callback_arguments = {};\r\n    this.chance = 1.0;\r\n    this.every = 1.0;\r\n    this.skipMin = -1;\r\n    this.skipMax = -1;\r\n    this.lockout = 0; //when > 0 cannot fire / locked;\r\n  }\r\n\r\n  Reset() {\r\n    this.ticker = 0;\r\n    return this;\r\n  }\r\n\r\n  NeverDie() {\r\n    this.duration = Infinity;\r\n    return this;\r\n  }\r\n\r\n  Callback(c, args) {\r\n    this.callback = c;\r\n    this.callback_arguments = args;\r\n    return this;\r\n  }\r\n\r\n  Repeat(repeats) {\r\n    this.repeats = repeats;\r\n    return this;\r\n  }\r\n\r\n  Skip(min, max) {\r\n    this.skipMin = min;\r\n    this.skipMax = max;\r\n    return this;\r\n  }\r\n\r\n  Duration(d) {\r\n    this.duration = d;\r\n    return this;\r\n  }\r\n\r\n  Lockout(l) {\r\n    this.lockout = l;\r\n    return this;\r\n  }\r\n\r\n  Every(millis) {\r\n    if (millis >= 1)\r\n      this.every = millis;\r\n    return this;\r\n  }\r\n\r\n  Chance(c) {\r\n    this.chance = c;\r\n    return this;\r\n  }\r\n\r\n  hasChance() {\r\n    return this.lockout <= 0 && Math.random() * 1.0 <= this.chance;\r\n  }\r\n\r\n  skipTime() {\r\n    return this.ticker >= this.skipMin && this.ticker <= this.skipMax;\r\n  }\r\n\r\n  fire(callback) {\r\n\r\n    this.lockout--;\r\n\r\n    if (!this.hasChance())\r\n      return;\r\n\r\n    if (callback)\r\n      this.callback = callback;\r\n\r\n    if (this.ticker % this.every !== 0)\r\n      return;\r\n\r\n    if (this.repeat > 0 && this.ticker >= this.duration) {\r\n      this.ticker = 0;\r\n      this.repeat--;\r\n    }\r\n\r\n    if (this.ticker <= this.duration && !this.skipTime()) {\r\n      this.callback(this.callback_arguments);\r\n    }\r\n\r\n    this.ticker += 1;\r\n  }\r\n}\r\n\r\nGamelab.FiringClock = FiringClock;;/*UniqueList : store only unique array items*/\r\nlet UniqueList = (list) => {\r\n  list.addUnique = function(i) {\r\n    if (this.indexOf(i) == -1) {\r\n      this.push(i)\r\n    }\r\n  };\r\n  return list;\r\n};\r\n\r\nlet GameData = {\r\n  applyParentAndChildRelationship(parent, child, trackBy) {\r\n    parent.children = parent.children || [];\r\n    parent.children = UniqueList(parent.children);\r\n    child.parent = parent;\r\n    parent.children.addUnique(child);\r\n  }\r\n};\r\n\r\n\r\nGamelab.GameData = GameData;;/**\r\n * Creates a new GameWindow\r\n * <iframe style='width:400px; height:450px; overflow:hidden;' src='./html/iframe-error.html'> </iframe>\r\n * @param   {Object} canvas the canvas element for this gameWindow. --GameWindow's if not supplied, the constructor will create a full-screen canvas, if a canvas.\r\n * @param   {Array} drawables=[] a list of drawable objects to be drawn. --Drawables can also be added after constructor call.\r\n * @returns {GameWindow} a Gamelab.GameWindow object\r\n * */\r\n\r\nclass GameWindow {\r\n  constructor(canvas = false, drawables = []) {\r\n\r\n    /**\r\n     * list of all drawables in the window.\r\n     *\r\n     * @property this.drawables\r\n     * @memberof GameWindow\r\n     **********/\r\n\r\n    this.drawables = drawables;\r\n    this.bool_events = Gamelab.bool_events || [];\r\n    this.settings = {};\r\n\r\n\r\n    this.paused = false;\r\n    this.drawFromWindows = false;\r\n\r\n    /**\r\n     * the html-canvas of the GameWindow.\r\n     *\r\n     * @property this.canvas\r\n     * @memberof GameWindow\r\n     **********/\r\n\r\n    this.canvas = canvas || false;\r\n\r\n    this.engaged = true;\r\n\r\n    if (!canvas) {\r\n      console.info('GameWindow() had no {canvas:canvas} argument. Creating a new canvas in document.body...');\r\n      this.canvas = document.createElement('CANVAS');\r\n    }\r\n    else if(typeof canvas == 'string') {\r\n      this.canvas = document.querySelector(canvas);\r\n    }\r\n    else if(typeof canvas == HTMLCanvasElement)\r\n    {\r\n      this.canvas = canvas;\r\n    }\r\n\r\n    this.canvas.setAttribute('class', 'gamewindow');\r\n    document.body.append(this.canvas);\r\n\r\n    this.context = this.canvas.getContext('2d');\r\n\r\n    document.body.style.position = \"absolute\";\r\n    document.body.style.width = \"100%\";\r\n    document.body.style.height = \"100%\";\r\n\r\n    /**\r\n     * the camera of the GameWindow. --An instance of Gamelab.Camera\r\n     *\r\n     * @property this.camera\r\n     * @memberof GameWindow\r\n     **********/\r\n\r\n    this.camera = new Gamelab.Camera();\r\n\r\n    this.camera.target = false;\r\n\r\n    Gamelab.camera = this.camera;\r\n\r\n    this.scaleTracker = 1.0;\r\n\r\n    var __inst = this;\r\n\r\n    this.Size();\r\n\r\n    this.update_ext = [];\r\n    this.resize_ext = [];\r\n\r\n    window.onresize = function() {\r\n\r\n      if (__inst.isAbsoluteSize)\r\n        return;\r\n\r\n      __inst.Size();\r\n\r\n      __inst.resize_ext.forEach(function(f) {\r\n\r\n        f.bind(this).call();\r\n\r\n      });\r\n\r\n    };\r\n\r\n    this.ctx = this.canvas.getContext('2d');\r\n    Gamelab.game_windows.push(this);\r\n\r\n    window.onerror = function() {\r\n      Gamelab.errors += 1;\r\n      console.log('Canvas Error --');\r\n      if (Gamelab.errors > Gamelab.config.maxErrors) {\r\n        Gamelab.stopDraw = true;\r\n        var call = call || window.setTimeout(function() {\r\n          if (call) {\r\n            window.clearTimeout(call);\r\n          }\r\n          console.log('%cDraw stopped at errorLimit:' + Gamelab.settings.errorLimit, 'color:darkorange;');\r\n        }, 200);\r\n      }\r\n    }\r\n    this.domElement = this.canvas;\r\n  }\r\n\r\n  FromArray(array) {\r\n    this.drawFromWindows = [];\r\n    return this;\r\n  }\r\n\r\n  Offscreen(o) {\r\n    this.offscreen = o;\r\n    this.canvas.display = 'none';\r\n    return this;\r\n  }\r\n\r\n  isPaused() {\r\n    return this.paused;\r\n  }\r\n\r\n  setPause(p) {\r\n    this.paused = p;\r\n    return this;\r\n  }\r\n\r\n  getImageData(x, y, w, h) {\r\n\r\n    return this.ctx.getImageData(x, y, w, h);\r\n\r\n  }\r\n\r\n\r\n  /**\r\n   * returns the gameWindow.canvas property, an HTMLCanvasElement\r\n   *\r\n   * @function\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n  getCanvas() {\r\n    return this.canvas;\r\n  }\r\n\r\n\r\n  /**\r\n   * returns a vector(x, y) showing the center of the GameWindow\r\n   *\r\n   * @function\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n\r\n  center() {\r\n    return new Gamelab.Vector(Math.round(this.canvas.width / 2), Math.round(this.canvas.height / 2));\r\n  }\r\n\r\n\r\n  TrackStat() {\r\n\r\n    this.__trackStat = true;\r\n    return this;\r\n  }\r\n\r\n\r\n  GridUnit(x, y, w, h, srcImage_Path) {\r\n\r\n    var size = new Gamelab.Vector(w, h),\r\n      position = new Gamelab.Vector(x, y);\r\n\r\n    var sprite;\r\n\r\n    if (srcImage_Path) {\r\n      sprite = new Gamelab.Sprite(srcImage_Path);\r\n      sprite.Size(size);\r\n      sprite.Pos(position);\r\n\r\n      Gamelab.game_windows[0].add(sprite);\r\n    }\r\n\r\n    return {\r\n      size: size,\r\n      position: position\r\n    };\r\n  }\r\n\r\n\r\n  onMouseMove(callback) {\r\n\r\n    var canvas = this.canvas;\r\n\r\n    this.canvas.addEventListener('mousemove', function(evt) {\r\n\r\n      var x = evt.clientX,\r\n        y = evt.clientY;\r\n\r\n      const rect = canvas.getBoundingClientRect();\r\n\r\n      x -= rect.left;\r\n      y -= rect.top;\r\n\r\n      callback(x, y);\r\n\r\n    });\r\n  }\r\n\r\n\r\n  onMouseClick(callback) {\r\n    var canvas = this.canvas;\r\n    this.canvas.addEventListener('click', function(evt) {\r\n      var x = evt.clientX,\r\n        y = evt.clientY;\r\n      const rect = canvas.getBoundingClientRect();\r\n      x -= rect.left;\r\n      y -= rect.top;\r\n      callback(x, y, evt);\r\n    });\r\n  }\r\n\r\n\r\n  onMouseWheel(callback, kill) {\r\n    var canvas = this.canvas;\r\n    this.canvas.addEventListener('mousewheel', function(evt) {\r\n      var x = evt.clientX,\r\n        y = evt.clientY;\r\n      const rect = canvas.getBoundingClientRect();\r\n      x -= rect.left;\r\n      y -= rect.top;\r\n      callback(x, y, evt.wheelDelta > 0 ? 1 : -1, evt);\r\n      if (kill) {\r\n        evt.preventDefault();\r\n        return true;\r\n      }\r\n    });\r\n  }\r\n\r\n  getGameSprites() {\r\n    var gameSprites = [];\r\n    this.drawables.forEach(function(sprite) {\r\n      console.info(sprite);\r\n      if (sprite.spriteType = 'game') {\r\n        gameSprites.push(sprite);\r\n      }\r\n    });\r\n    return gameSprites;\r\n  }\r\n\r\n  /**\r\n   * creates an array of gridUnits\r\n   *\r\n   * @function\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n  GridStyle(total_x, total_y, w, h, srcImage_Path) {\r\n\r\n    if (!(this.grid instanceof Array)) {\r\n      this.grid = [];\r\n    }\r\n\r\n    function GridUnit(x, y, w, h, srcImage_Path) {\r\n\r\n      var size = new Gamelab.Vector(w, h),\r\n        position = new Gamelab.Vector(x, y);\r\n\r\n      var sprite;\r\n\r\n      if (srcImage_Path) {\r\n        sprite = new Gamelab.Sprite(srcImage_Path);\r\n        sprite.Size(size);\r\n        sprite.Pos(position);\r\n\r\n        Gamelab.game_windows[0].add(sprite);\r\n      }\r\n\r\n      return {\r\n        size: size,\r\n        position: position\r\n      };\r\n    };\r\n\r\n    for (var y = 0; y < total_y; y++) {\r\n\r\n      for (var x = 0; x < total_x; x++) {\r\n\r\n        this.grid.push(new GridUnit(x * w, y * h, w, h, srcImage_Path));\r\n\r\n      }\r\n\r\n    }\r\n    return this;\r\n  }\r\n\r\n  getCanvas() {\r\n    return this.canvas;\r\n  }\r\n\r\n  /**\r\n   * adds an update to the GameWindow:: update to be called every 20 milliseconds\r\n   *\r\n   * @function\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n\r\n  onUpdate(f) {\r\n\r\n    this.update_ext.push(f);\r\n\r\n  }\r\n\r\n\r\n  /**\r\n   * adds a resize call to the GameWindow:: resize to be called when window size changes\r\n   *\r\n   * @function\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n\r\n  onResize(r) {\r\n\r\n    this.resize_ext.push(r);\r\n\r\n  }\r\n\r\n  /**\r\n   * the main update for the GameWindow:: called automatically after call of GameWindow.start() or GameWindow.animate()\r\n   *\r\n   * @function\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n  update() {\r\n\r\n    if (this.isPaused())\r\n      return;\r\n\r\n\r\n    if (this.camera && this.camera.update)\r\n      this.camera.update();\r\n\r\n    var sortDrawables = function(arr, key) {\r\n      return arr.sort((a, b) => {\r\n        return a[key] - b[key];\r\n      });\r\n    };\r\n\r\n    sortDrawables(this.drawables, \"layer\");\r\n\r\n    Gamelab.each(this.drawables, function(ix, item) {\r\n\r\n      if (item && typeof(item.def_update) == 'function') {\r\n        item.def_update(item);\r\n      }\r\n\r\n      if (item && typeof(item.update) == 'function') {\r\n        item.update(item);\r\n      }\r\n\r\n\r\n      if (item && ['SpriteArray', 'RobotixArray', 'RobotixVerticalChain'].indexOf(item.constructor.name) >= 0 &&\r\n        typeof item.each == 'function') {\r\n\r\n        item.each(function(ix, graphic) {\r\n\r\n          graphic.update(graphic);\r\n\r\n        });\r\n\r\n      }\r\n\r\n    });\r\n\r\n    Gamelab.each(this.bool_events, function(ix, item) {\r\n\r\n      if (item && item.bool()) {\r\n        item.callback();\r\n      }\r\n\r\n    });\r\n\r\n\r\n    for (var x in this.update_ext) {\r\n      this.update_ext[x]();\r\n    }\r\n\r\n\r\n  }\r\n\r\n  reset_draw() {\r\n    this.before_draw_ext = function() {};\r\n  }\r\n\r\n  disengage() {\r\n    this.drawables = [];\r\n    this.engaged = false;\r\n    this.reset_draw();\r\n  }\r\n\r\n  engage() {\r\n    this.engaged = true;\r\n  }\r\n\r\n  batchDraw(drawables) {\r\n\r\n    var __gameWindow = this;\r\n\r\n    Gamelab.each(drawables, function(ix, item) {\r\n\r\n      if (typeof item.draw == 'function') {\r\n        item.draw(__gameWindow.ctx, __gameWindow.camera);\r\n      }\r\n\r\n    });\r\n\r\n  }\r\n\r\n  hasDrawableByPosition(px, py) {\r\n\r\n    for(var x = 0; x < this.drawables.length; x++)\r\n    {\r\n\r\n      var sprite = this.drawables[x];\r\n\r\n      if(px >= sprite.position.x && px <= sprite.position.x + sprite.size.x &&\r\n        py >= sprite.position.y && py <= sprite.position.y + sprite.size.y)\r\n        {\r\n          return true;\r\n        }\r\n\r\n    }\r\n\r\n    return false;\r\n\r\n  }\r\n\r\n  splitCurrentWindowToSpriteArray(sx, sy, frameSizeX, frameSizeY) {\r\n\r\n    let sprites = [];\r\n\r\n    for(var x = 0; x < frameSizeX; x+=sx)\r\n    {\r\n\r\n      for(var y = 0; y < frameSizeY; y+=sy)\r\n      {\r\n\r\n        if(!this.hasDrawableByPosition(x, y))\r\n        {\r\n          continue;\r\n        }\r\n\r\n        var canvas = document.createElement('CANVAS');\r\n        canvas.width = frameSizeX;\r\n        canvas.height = frameSizeY;\r\n        var ctx = canvas.getContext('2d');\r\n\r\n        var imageData = this.ctx.getImageData(x, y, sx, sy);\r\n        ctx.putImageData(imageData, 0, 0);\r\n\r\n        var sprite = new Gamelab.Sprite(canvas);\r\n\r\n        sprite.Position(x, y);\r\n\r\n        sprite.Size(sx, sy);\r\n\r\n        sprites.push(sprite);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return sprites;\r\n\r\n  }\r\n\r\n  draw(canvas) {\r\n\r\n    if (canvas instanceof HTMLCanvasElement)\r\n      this.ctx.drawImage(canvas, 0, 0, canvas.width, canvas.height);\r\n\r\n    else if (typeof canvas == 'object' && canvas.canvas instanceof HTMLCanvasElement)\r\n      this.ctx.drawImage(canvas.canvas, canvas.canvas.width, canvas.canvas.height);\r\n\r\n    if (this.isPaused())\r\n      return;\r\n\r\n    var __gameWindow = this;\r\n\r\n    if (this.before_draw_ext) {\r\n      this.before_draw_ext();\r\n    }\r\n\r\n    Gamelab.each(this.drawables, function(ix, item) {\r\n\r\n      if (typeof item.draw == 'function') {\r\n        item.draw(__gameWindow.ctx, __gameWindow.camera);\r\n      }\r\n\r\n    });\r\n\r\n\r\n    if (this.after_draw_ext) {\r\n      this.after_draw_ext();\r\n    }\r\n\r\n  }\r\n\r\n\r\n  defineComplete(getComplete) {\r\n    this.getComplete = getComplete;\r\n    return this;\r\n  }\r\n\r\n  complete() {\r\n\r\n    if (this.complete_callback)\r\n      this.complete_callback();\r\n\r\n  }\r\n\r\n  onComplete(completion) {\r\n    this.complete_callback = completion;\r\n    return this;\r\n  }\r\n\r\n\r\n  /**\r\n   * adds a call before the GameWindow draw()\r\n   *\r\n   * @function\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n  onBeforeDraw(f) {\r\n\r\n    var boundCall = f.bind(this);\r\n\r\n    if (!this.before_draw_ext)\r\n      this.before_draw_ext = function() {};\r\n\r\n    var beforeDraw = this.before_draw_ext.bind(this);\r\n\r\n    this.before_draw_ext = function() {\r\n      beforeDraw();\r\n      boundCall();\r\n    };\r\n\r\n  }\r\n\r\n  removeSelf() {\r\n    this.canvas.parentNode.removeChild(this.canvas);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * adds a call after the GameWindow draw()\r\n   *\r\n   * @function\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n\r\n  onAfterDraw(f) {\r\n\r\n    var boundCall = f.bind(this);\r\n\r\n    if (!this.after_draw_ext)\r\n      this.after_draw_ext = function() {};\r\n\r\n\r\n    var afterDraw = this.after_draw_ext.bind(this);\r\n\r\n    this.after_draw_ext = function() {\r\n      afterDraw();\r\n      boundCall();\r\n    };\r\n\r\n  }\r\n\r\n  /**\r\n   * sets the size of the GameWindow\r\n   *\r\n   * @function\r\n   * @param {integer} w the width of the GameWindow\r\n   * @param {integer} h the HEIGHT of the GameWindow\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n  Size(w, h, isAbsoluteSize) { //call with no args to fill to browser-window-size;\r\n\r\n    w = w || this.canvas.parentNode.clientWidth;\r\n\r\n    h = h || this.canvas.parentNode.clientHeight;\r\n\r\n    var c = this.canvas;\r\n\r\n    if (c) {\r\n      c.setAttribute('width', w)\r\n    };\r\n\r\n    if (c) {\r\n      c.setAttribute('height', h)\r\n    };\r\n\r\n    Gamelab.WIDTH = w;\r\n\r\n    Gamelab.HEIGHT = h;\r\n\r\n    this.canvas.width = w;\r\n\r\n    this.canvas.height = h;\r\n\r\n    this.size = new Gamelab.Vector(w, h);\r\n\r\n    this.isAbsoluteSize = isAbsoluteSize || false;\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n  /**\r\n   * adds an object to the GameWindow\r\n   *\r\n   * @function\r\n   * @param {Object} obj the object to be added (Sprite)\r\n   * @param {Boolean} onBottom if true, adds to the bottom of layer-stack in GameWindow\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n  add(obj) {\r\n\r\n    if (obj instanceof Array) {\r\n      var $gw = this;\r\n      obj.forEach(function(o) {\r\n        $gw.add(o);\r\n      });\r\n      return;\r\n    }\r\n\r\n    var __inst = this;\r\n\r\n    if (obj instanceof Gamelab.Camera) {\r\n\r\n      this.camera = obj;\r\n\r\n    } else if (obj instanceof Gamelab.GSEvent) {\r\n\r\n      if (Gamelab.__running) {\r\n\r\n        return console.error('Events can only be added before Gamstack.animate() is called::aka before the main update / loop begins');\r\n      } else {\r\n\r\n        obj.apply();\r\n\r\n      }\r\n    } else {\r\n\r\n      this.drawables.push(obj);\r\n\r\n    };\r\n\r\n    return obj;\r\n\r\n  }\r\n\r\n  /**\r\n   * set background-color of GameWindow\r\n   *\r\n   * @function\r\n   * @param {string} c the new background-color for GameWindow\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n  Background(c) {\r\n    this.canvas.style.background = c;\r\n    this.canvas.style.backgroundColor = c;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * removes an object from the GameWindow\r\n   *\r\n   * @function\r\n   * @param {Object} obj the object to be removed (Sprite)\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n  remove(obj) {\r\n    var ix = this.drawables.indexOf(obj);\r\n    if (ix >= 0) {\r\n      this.drawables.splice(ix, 1);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * removeAll(): removes all drawables\r\n   *\r\n   * @function\r\n   * @param {Object} obj the object to be removed (Sprite)\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n  removeAll() {\r\n    this.drawables = [];\r\n  }\r\n\r\n  has(obj) {\r\n\r\n    var ix = this.drawables.indexOf(obj);\r\n\r\n    if (ix >= 0) {\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n\r\n  removeDeadObjects() {\r\n\r\n    var $window = this;\r\n\r\n    this.drawables.forEach(function(sprite) {\r\n\r\n      if (sprite.life <= 0) {\r\n        $window.remove(sprite);\r\n        if (sprite.die_callback) {\r\n          sprite.die_callback();\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n  cleanup() {\r\n\r\n    this.removeDeadObjects();\r\n\r\n  }\r\n\r\n\r\n  /**\r\n   * begins the animation-loop of GameWindow.\r\n   *\r\n   * @function\r\n   * @param {number} time optional time parameter for usage with Tween\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n  run(time = 0, options = {}) {\r\n\r\n    if (options.DEV || options.dev) {\r\n      this.start(time);\r\n    } else\r\n      this.animate(time);\r\n\r\n  }\r\n\r\n  drawOnce() {\r\n\r\n    if (!this.engaged)\r\n      return;\r\n\r\n    if (this.frameInterval) {\r\n      frameInterval = this.frameInterval;\r\n    }\r\n\r\n    if (this.drawFromWindows instanceof Array) {\r\n      this.drawFromWindows.forEach(function(w) {\r\n        this.draw(w);\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (this.getComplete && this.getComplete()) {\r\n      return;\r\n    }\r\n\r\n    var __inst = this;\r\n\r\n    if (this.__stats) {\r\n      this.__stats.begin();\r\n      this.__statsMS.begin();\r\n      this.__statsMB.update();\r\n    }\r\n\r\n    Gamelab.isAtPlay = true;\r\n\r\n    this.update();\r\n\r\n    if (!this.isPaused()) {\r\n      if (window.TWEEN)\r\n        TWEEN.update(time);\r\n\r\n      if (this.settings.hasOwnProperty('autoClear') && this.settings.autoClear == false) {\r\n\r\n      } else {\r\n        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n      }\r\n\r\n      this.draw();\r\n\r\n      if (this.__stats) {\r\n        this.__stats.end();\r\n        this.__statsMS.end();\r\n      }\r\n    }\r\n  }\r\n\r\n  pause() {\r\n    this.engaged = false;\r\n    this.paused = true;\r\n  }\r\n\r\n  unpause() {\r\n    this.engaged = true;\r\n    this.paused = true;\r\n  }\r\n\r\n  animate(time, frameInterval) {\r\n\r\n    if (!this.engaged)\r\n      return;\r\n\r\n    if (this.frameInterval) {\r\n      frameInterval = this.frameInterval;\r\n    }\r\n\r\n    if (this.drawFromWindows instanceof Array) {\r\n      this.drawFromWindows.forEach(function(w) {\r\n        this.draw(w);\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (this.getComplete && this.getComplete()) {\r\n      return;\r\n    }\r\n\r\n    var __inst = this;\r\n\r\n    if (typeof frameInterval == 'number') {\r\n      setTimeout(function() {\r\n\r\n        requestAnimationFrame(function() {\r\n          __inst.animate();\r\n        });\r\n\r\n      }, frameInterval);\r\n    } else {\r\n      requestAnimationFrame(function() {\r\n        __inst.animate();\r\n      });\r\n    }\r\n\r\n    if (this.__stats) {\r\n      this.__stats.begin();\r\n      this.__statsMS.begin();\r\n      this.__statsMB.update();\r\n    }\r\n\r\n    Gamelab.isAtPlay = true;\r\n\r\n    this.update();\r\n\r\n    if (!this.isPaused()) {\r\n      if (window.TWEEN)\r\n        TWEEN.update(time);\r\n\r\n      if (this.settings.hasOwnProperty('autoClear') && this.settings.autoClear == false) {\r\n\r\n      } else {\r\n        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n      }\r\n\r\n      this.draw();\r\n\r\n      if (this.__stats) {\r\n        this.__stats.end();\r\n        this.__statsMS.end();\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * begins the animation-loop of GameWindow, with performance Stats shown on-screen\r\n   *\r\n   * @function\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n\r\n  start() {\r\n\r\n    if (typeof(Stats) == 'function') //Stats library exists\r\n    {\r\n      //basic stat animation\r\n      this.__stats = new Stats();\r\n      this.__stats.showPanel(0); // 0: fps, 1: ms, 2: mb, 3+: custom\r\n\r\n      this.__stats.dom.style.left = '10%';\r\n\r\n      this.__stats.dom.setAttribute('class', 'stat');\r\n\r\n      this.canvas.parentNode.appendChild(this.__stats.dom);\r\n\r\n      //basic stat animation\r\n      this.__statsMS = new Stats();\r\n      this.__statsMS.showPanel(1); // 0: fps, 1: ms, 2: mb, 3+: custom\r\n\r\n      this.__statsMS.dom.style.left = '10%';\r\n\r\n      this.__statsMS.dom.style.marginLeft = '90px';\r\n\r\n      this.__statsMS.dom.setAttribute('class', 'stat');\r\n\r\n      this.canvas.parentNode.appendChild(this.__statsMS.dom);\r\n\r\n      //basic stat animation\r\n      this.__statsMB = new Stats();\r\n      this.__statsMB.showPanel(2); // 0: fps, 1: ms, 2: mb, 3+: custom\r\n\r\n      this.__statsMB.dom.style.left = '10%';\r\n\r\n      this.__statsMB.dom.setAttribute('class', 'stat');\r\n\r\n      this.__statsMB.dom.style.marginLeft = '180px';\r\n\r\n      this.canvas.parentNode.appendChild(this.__statsMB.dom);\r\n    }\r\n\r\n    this.animate();\r\n  }\r\n}\r\n\r\nGamelab.GameWindow = GameWindow;\r\n;class GSEvent {\r\n  constructor(args = {}) {}\r\n}\r\n\r\nGamelab.GSEvent = GSEvent;\r\nGamelab.Event = GSEvent;\r\n\r\nclass GSEventLink {\r\n  constructor(extendedObject, extendedKey, extendor, extendorKey) {\r\n    this.parent_id = extendedObject.id,\r\n      this.child_id = extendor.id,\r\n      this.parent_key = extendedKey,\r\n      this.child_key = extendorKey;\r\n  }\r\n};\r\n\r\nGamelab.GSEventLink = GSEventLink;\r\nGamelab.EventLink = GSEventLink;;/**\r\n * Creates a new Module\r\n * @param   {string} uri the uri that the .js file is located at\r\n * @param   {Function} callback=function(){} The callback to call after the module is loaded\r\n * @returns {Module} a Gamelab.Module object\r\n * */\r\n\r\nclass Module {\r\n\r\n  constructor(uri, callback) {\r\n    if (uri)\r\n      this.load(uri, callback);\r\n  }\r\n\r\n  readFile(fileObject, callback) {\r\n    var reader = new FileReader();\r\n    reader.onload = function(e) {\r\n      callback(reader.result);\r\n    }\r\n    reader.readAsText(fileObject);\r\n  }\r\n\r\n  onInstanceCallback(uri, callback) {\r\n    var moduleInstance;\r\n    this.load(uri, function(inst) {\r\n      moduleInstance = new inst();\r\n      callback(moduleInstance);\r\n    });\r\n  }\r\n\r\n  load(uri, callback) {\r\n\r\n    Gamelab.modules = Gamelab.modules || [];\r\n\r\n    var __object = this;\r\n    this.uri = uri;\r\n    callback = callback || function() {};\r\n    callback = callback.bind(this);\r\n\r\n    var script = document.createElement('SCRIPT'),\r\n      executeNow = false;\r\n\r\n    for (var x = 0; x < Gamelab.modules.length; x++) {\r\n      if (Gamelab.modules[x].uri == uri) {\r\n        callback(Gamelab.modules[x].construct);\r\n        return Gamelab.modules[x];\r\n      }\r\n    }\r\n\r\n    if (uri.toLowerCase().endsWith('.js')) {\r\n      script.src = uri;\r\n    } else {\r\n      //assumed to be raw value\r\n      var data = uri;\r\n      executeNow = true;\r\n      script.appendChild(document.createTextNode(data));\r\n    }\r\n    //be sure the window.module is set to new {}\r\n    window.module = window.module || {};\r\n    //define onload fxn\r\n    script.onload = function() {\r\n      var construct = window.module.exports;\r\n      __object.construct = __object.lib = construct;\r\n      callback(construct, uri);\r\n    };\r\n    if (executeNow) {\r\n      setTimeout(function() {\r\n        var construct = window.module.exports;\r\n        callback(construct, uri);\r\n      }, 250);\r\n    }\r\n    //append to the document\r\n\r\n    Gamelab.modules.push(__object);\r\n\r\n    document.head.appendChild(script);\r\n  }\r\n};\r\n\r\nGamelab.Module = Module;\r\n\r\nclass Code {\r\n  constructor() {\r\n\r\n  }\r\n  run(callback) {\r\n    if (typeof callback == 'string') {\r\n      callback = new Function('return function run(){' + callback + '}();');\r\n    }\r\n    //get string contents after the name\r\n    var fxnString = callback.toString().split('()')[1];\r\n    //add generic name\r\n    fxnString = '\\n function run()' + fxnString;\r\n    var script = document.createElement('SCRIPT');\r\n    script.innerHTML = fxnString + '\\n  run();';\r\n    document.head.appendChild(script);\r\n  }\r\n\r\n  loadAndRun(uri, callback) {\r\n    var __object = this;\r\n    this.uri = uri;\r\n    callback = callback || function() {};\r\n    callback = callback.bind(this);\r\n    var script = document.createElement('SCRIPT');\r\n    script.src = uri;\r\n    //be sure the window.module is set to new {}\r\n    window.module = window.module || {};\r\n\r\n    //define onload fxn\r\n    script.onload = function() {\r\n      var construct = window.module.exports;\r\n      var value;\r\n      if (typeof construct == 'function') {\r\n        value = window.module.exports();\r\n      }\r\n      callback(value, construct, uri);\r\n    };\r\n    //append to the document\r\n    document.head.appendChild(script);\r\n  }\r\n}\r\n\r\nCode.call = Code.run;\r\nCode.loadAndCall = Code.loadAndRun;\r\nGamelab.Code = Code;\r\n\r\nGamelab.ScopeInterface = function(scope) {\r\n  var testInterface = document.createElement('div');\r\n  testInterface.style.position = 'fixed';\r\n  testInterface.style.display = 'block';\r\n  testInterface.style.top = '58px';\r\n  testInterface.style.right = '4%';\r\n  testInterface.style.width = '40%';\r\n  testInterface.style.height = '40%';\r\n  testInterface.style.zIndex = '9999';\r\n  testInterface.style.padding = '7px';\r\n  testInterface.style.background = '#222';\r\n  testInterface.style.border = '1px solid lightgrey';\r\n  var testInput = document.createElement('textarea');\r\n  testInput.style.backgroundColor = '#000';\r\n  testInput.style.height = '80%';\r\n  testInput.style.width = '96%';\r\n  testInput.style.color = 'lightgrey';\r\n  var submitRow = document.createElement('span');\r\n  var submit = document.createElement('button');\r\n  submit.style.backgroundColor = '#222';\r\n  submit.style.color = 'lightgrey';\r\n  submit.style.border = '1px solid lightgrey';\r\n  submit.style.marginTop = '4px';\r\n  submitRow.appendChild(submit);\r\n  submit.innerText = 'Run Code';\r\n\r\n  submit.onclick = function() {\r\n    console.log('testing-interface-value:' + testInput.value);\r\n    var value = testInput.value;\r\n    new Gamelab.Code().run(value);\r\n  };\r\n\r\n\r\n  testInterface.appendChild(testInput);\r\n  testInterface.appendChild(submit);\r\n  document.body.appendChild(testInterface);\r\n};\r\n;\r\nclass Mouse {\r\n  constructor(domElement){\r\n    this.position = new Gamelab.Vector(0, 0);\r\n    this.domElement = domElement.domElement || domElement;\r\n  }\r\n  onMouseMove(call)\r\n  {\r\n    let $mouse = this;\r\n    this.domElement.addEventListener('mousemove', function(evt){\r\n        $mouse.position = new Gamelab.Vector(evt.clientX, evt.clientY);\r\n        call.bind($mouse)($mouse.position.x, $mouse.position.y);\r\n    });\r\n    return this;\r\n  }\r\n  onMouseUp(call)\r\n  {\r\n    let $mouse = this;\r\n    this.domElement.addEventListener('mouseup', function(evt){\r\n        call.bind($mouse)(true);\r\n    });\r\n    return this;\r\n  }\r\n  onMouseDown(call)\r\n  {\r\n    let $mouse = this;\r\n    this.domElement.addEventListener('mousedown', function(evt){\r\n        call.bind($mouse)(false);\r\n    });\r\n    return this;\r\n  }\r\n  onMouseOver(call)\r\n  {\r\n    let $mouse = this;\r\n    this.domElement.addEventListener('mouseover', function(evt){\r\n      $mouse.position = new Gamelab.Vector(evt.clientX, evt.clientY);\r\n      call.bind($mouse)($mouse.position.x, $mouse.position.y);\r\n    });\r\n    return this;\r\n  }\r\n  onMouseOut(call)\r\n  {\r\n    let $mouse = this;\r\n    this.domElement.addEventListener('mouseout', function(evt){\r\n      $mouse.position = new Gamelab.Vector(evt.clientX, evt.clientY);\r\n      call.bind($mouse).call($mouse.position.x, $mouse.position.y);\r\n    });\r\n    return this;\r\n  }\r\n\r\n  onLeftClick(call)\r\n  {\r\n    let $mouse = this;\r\n    this.domElement.addEventListener('click', function(evt){\r\n      evt = evt || window.event;\r\n      if(evt.which == 1)\r\n      (function(){\r\n        $mouse.position = new Gamelab.Vector(evt.clientX, evt.clientY);\r\n        call.bind($mouse)($mouse.position.x, $mouse.position.y);\r\n      })();\r\n    });\r\n  }\r\n  onRightClick(call)\r\n  {\r\n    let $mouse = this;\r\n    this.domElement.addEventListener('contextmenu', function(evt){\r\n\r\n      (function(){\r\n        $mouse.position = new Gamelab.Vector(evt.clientX, evt.clientY);\r\n        call.bind($mouse)($mouse.position.x, $mouse.position.y);\r\n      })();\r\n\r\n      evt.preventDefault();\r\n\r\n      return false;\r\n\r\n    });\r\n  }\r\n  onMouseWheel(call){\r\n\r\n    var $mouse = this;\r\n\r\n    window.addEventListener(\"wheel\", event => {\r\n        const delta = Math.sign(event.deltaY);\r\n        call.bind($mouse)(event.deltaY);\r\n    });\r\n\r\n  }\r\n  onMiddleButton(call)\r\n  {\r\n    var $mouse = this;\r\n    this.domElement.addEventListener('click', function(evt){\r\n      evt = evt || window.event;\r\n      if(evt.which == 2)\r\n      (function(){\r\n        $mouse.position = new Gamelab.Vector(evt.clientX, evt.clientY);\r\n        call.bind($mouse)($mouse.position.x, $mouse.position.y);\r\n      })();\r\n    });\r\n  }\r\n};\r\n\r\nGamelab.Mouse = Mouse;\r\n;\r\n(function(){\r\n\r\n  class OffscreenCanvas {\r\n\r\n    constructor(canvas, x, y){\r\n      this.canvas = canvas;\r\n      this.x = x;\r\n      this.y = y;\r\n\r\n      this.ctx = this.canvas.getContext('2d');\r\n    }\r\n    draw(ctx)\r\n    {\r\n      ctx.draw(this.canvas, this.x, this.y);\r\n    }\r\n\r\n  }\r\n\r\n  Gamelab.OffscreenCanvas = OffscreenCanvas;\r\n\r\n\r\n})();\r\n;\r\nclass PixelChopper {\r\n\r\n  constructor(src) {\r\n   this.chop = new Gamelab.GameImage(src);\r\n   this.canvasChop = this.canvasChop || new Gamelab.OffscreenCanvasRendering(this.chop);\r\n  }\r\n  chop(src) {\r\n\r\n    this.sourceImage =  new Gamelab.GameImage(src);\r\n    this.canvasSourceImage = this.canvasSourceImage ||\r\n     new Gamelab.OffscreenCanvasRendering(this.sourceImage);\r\n\r\n  }\r\n}\r\n;\n\n/**\n * Creates an instance of Rectangle.\n * @param   {Gamelab.Vector} min the minimum vector point (x,y)\n * @param   {Gamelab.Vector} max the maximum vector point (x,y)\n *\n * @returns {Rectangle} a Rectangle object\n */\n\nclass Vector2Range {\n    constructor(x1, y1, x2, y2) {\n      this.Min(x1, y1);\n      this.Max(x2, y2);\n    }\n    Min(x, y)\n    {\n      this.min = new Gamelab.Vector(x, y);\n      return this;\n    }\n    Max(x, y)\n    {\n      this.max = new Gamelab.Vector(x, y);\n      return this;\n    }\n}\n;\n\n\n\nlet VectorBounds = Vector2Range;\nGamelab.VectorBounds = Vector2Range;\nGamelab.Vector2Range = Vector2Range;\n\n/**\n * Takes the min and max vectors plus termPoint ('termination-point'), returns VectorFrameBounds\n *  *use this to define the bounds of an Animation object.\n * @param   {Vector} min the minimum vector point (x,y)\n * @param   {Vector} max the maximum vector point (x,y)\n * @param   {Vector=} termPoint the optional termination vector point (x,y) : defaults to the value of 'max'\n * -While a min and max Gamelab.Vector(x,y) will describe the grid-size of Animation frames,\n * the termPoint will indicate the last frame on-grid for this set of frames --Animation may stop early on the 'grid')\n * @returns {VectorFrameBounds} a VectorFrameBounds object\n */\n\n//traverse a grid from min(x,y) toward max(x,y)\n//stop or repeat at the termPoint(x,y)\nclass VectorFrameBounds {\n    constructor(min, max, termPoint) {\n        this.min = min;\n        this.max = max;\n        this.termPoint = termPoint || new Gamelab.Vector(this.max.x, this.max.y, this.max.z);\n    }\n}\n;\n\nGamelab.VectorFrameBounds = VectorFrameBounds;\n;/**\r\n * Renderable : consistent base-type for graphic-objects\r\n * @param   {Object} args the object of arguments\r\n * @returns {Renderable} a Gamelab.Renderable object.\r\n * */\r\n\r\nclass Renderable {\r\n  constructor(args = {}) {\r\n    //  Gamelab.FeatureInject(this, args);\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * A game-image object based on HTMLImage element. Creates GameImage, attaches gameImage.domElement --an instance of HTMLImageElement\r\n * @param   {string} src the sourcePath of the image-file.\r\n * @returns {GameImage} a Gamelab.GameImage object.\r\n * */\r\n\r\nclass GameImage extends Renderable {\r\n\r\n  constructor(src = {}, onCreate = function() {\r\n    I('image: used default fxn argument:');\r\n  }) {\r\n\r\n    super(src);\r\n\r\n    if (typeof src == 'object' && !(src instanceof HTMLCanvasElement)) {\r\n      return src;\r\n    }\r\n\r\n    if (typeof src == 'string') {\r\n      this.domElement = document.createElement('IMG');\r\n      this.domElement.src = src;\r\n    } else if (src instanceof HTMLCanvasElement) {\r\n      this.domElement = src;\r\n    }\r\n\r\n\r\n    this.domElement.onerror = function() {\r\n      this.__error = true;\r\n      //console.dev('--image error');\r\n    };\r\n\r\n  }\r\n};\r\n\r\nGamelab.GameImage = GameImage;\r\n;\r\n\r\n\r\nclass Script{\r\n\r\n  constructor(uri, callback){\r\n\r\n    this.src = uri || '';\r\n\r\n    if(uri && callback)\r\n    {\r\n    this.load(uri, callback);\r\n    }\r\n    else{\r\n      console.info('Created Script() without uri + callback --1st and 2nd arguments. To use object call script.load()');\r\n    }\r\n\r\n  }\r\n\r\n  load(uri, callback){\r\n\r\n    var __object = this;\r\n\r\n    callback = callback || function(){};\r\n\r\n    callback.bind(this);\r\n\r\n    var script = document.createElement('SCRIPT');\r\n    script.src = uri;\r\n\r\n    //define onload fxn\r\n    script.onload = function(){\r\n\r\n      var construct = module.exports;\r\n      callback(construct);\r\n\r\n    };\r\n\r\n    //append to the document\r\n    document.head.appendChild(script);\r\n\r\n  }\r\n\r\n};\r\n\r\nGamelab.Script = Script;\r\n\r\n\r\nclass Scriptable{\r\n\r\n  constructor(object, siblings){\r\n\r\n    this.object = object;\r\n\r\n    this.siblings = siblings;\r\n\r\n  }\r\n\r\n  Object(object)\r\n  {\r\n    this.object = object;\r\n    return this;\r\n  }\r\n\r\n\r\n  load(url, callback){\r\n\r\n    var __object = this;\r\n\r\n    callback = callback || function(){};\r\n\r\n    callback = callback.bind(this);\r\n\r\n    var script = document.createElement('SCRIPT');\r\n    script.src = url;\r\n\r\n    //define onload fxn\r\n    script.onload = function(){\r\n\r\n      var construct = window.module.exports;\r\n\r\n      var MOD = construct(__object.object, __object.siblings);\r\n\r\n      callback.bind(__object).call(MOD, __object.object, __object.siblings);\r\n    };\r\n\r\n    //append to the document\r\n    document.head.appendChild(script);\r\n\r\n  }\r\n\r\n};\r\n\r\nGamelab.Scriptable = Scriptable;\r\n;\r\n\r\nclass StateAction {\r\n\r\n  constructor() {\r\n\r\n  }\r\n  Name(name) {\r\n    this.name = name;\r\n    return this;\r\n  }\r\n  Parent(p) {\r\n    this.parent = p;\r\n    return this;\r\n  }\r\n  Options(options) {\r\n    this.options = options;\r\n    this.stateOptions = {};\r\n    this.reset();\r\n    return this;\r\n  }\r\n  Call(engageCallback) {\r\n    this.engage = this.commit = engageCallback;\r\n    return this;\r\n  }\r\n  set(optionKey, optionValue) {\r\n    this.stateOptions[optionKey] = optionValue;\r\n    return this;\r\n  }\r\n  get(optionKey) {\r\n    return this.stateOptions[optionKey];\r\n  }\r\n  reset() {\r\n    //reset the options to original values\r\n    for (var x in this.options) {\r\n      this.stateOptions[x] = this.options[x];\r\n    }\r\n  }\r\n  disengage() {\r\n    //set the parent's state to '_NEXT_'\r\n    this.parent.state = '_NEXT_';\r\n    this.reset();\r\n  }\r\n  commit() {\r\n    //default as empty function\r\n  }\r\n  engage() {\r\n    //same as calling commit()\r\n  }\r\n\r\n}\r\n\r\n\r\nGamelab.StateAction = StateAction;\r\n;class State {\r\n  constructor(object, stateName, fallbackState) {\r\n    this.object = object;\r\n    this.stateName = stateName;\r\n    //list of boolean fxns which cancel the state\r\n    this.triggers = [];\r\n    //fxn to be called when triggered\r\n    this.triggerCall = function() {};\r\n    //list of boolean fxns which trigger the state\r\n    this.cancellators = [];\r\n    //fxn to be called when cancelled\r\n    this.cancelCall = function() {};\r\n    //error-protection: use limit on number of list-Members\r\n    this.listLimit = 10;\r\n    this.fallbackState = fallbackState;\r\n  }\r\n  onTrigger(call) {\r\n    this.triggerCall = call || function() {\r\n      clog('--empty trigger call');\r\n    };\r\n  }\r\n  onCancel(call) {\r\n    this.cancelCall = call || function() {\r\n      clog('--empty cancel call');\r\n    };\r\n  }\r\n  defineTrigger(triggerFxn) {\r\n    this.triggers.push(triggerFxn);\r\n    return this;\r\n  }\r\n  defineCancellator(cancelFxn) {\r\n    this.cancellators.push(cancelFxn);\r\n    return this;\r\n  }\r\n  isTriggered() {\r\n    for (var x = 0; x < this.triggers.length; x++) {\r\n      if (this.triggers[x]()) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n  isCancelled() {\r\n    for (var x = 0; x < this.triggers.length; x++) {\r\n      if (this.cancellators[x]) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n}\r\n\r\nclass StateMachine {\r\n  constructor() {\r\n    this.states = [];\r\n  }\r\n  add(state) {\r\n    this.states.push(state);\r\n  }\r\n};\r\n\r\n\r\n\r\nclass Texel {\r\n  constructor(x, y, w, h){\r\n    this.size = new Gamelab.Vector(w, h);\r\n    this.x = x;\r\n    this.y = y;\r\n  }\r\n}\r\n\r\n\r\nclass TexelArray {\r\n\r\n  constructor(texels, onCreate){\r\n\r\n      onCreate = onCreate || function(){};\r\n\r\n      var array = this;\r\n\r\n      texels = texels || [];\r\n\r\n      this.texels = [];\r\n\r\n      this.id = Gamelab.create_id();\r\n\r\n      var $object = this;\r\n\r\n      texels.forEach(function(v){\r\n\r\n        $object.texels.push(v);\r\n\r\n      });\r\n\r\n      onCreate.bind(this).call();\r\n  }\r\n\r\n  Clone(object){\r\n    if(object.texels instanceof Array)\r\n    return new Gamelab.TexelArray(object.texels);\r\n    else\r\n    return console.error('needs array-type@ on 1st arg: .texels');\r\n  }\r\n\r\n  push(item){\r\n    this.texels.push(item);\r\n  }\r\n  add(item)\r\n  {\r\n    this.texels.push(item);\r\n  }\r\n\r\n  FromData(data)\r\n  {\r\n    var jsonData = JSON.parse(JSON.stringify(data));\r\n    return new TexelArray(jsonData.texels);\r\n  }\r\n}\r\n\r\nGamelab.Texel = Texel;\r\nGamelab.TexelArray = TexelArray;\r\n;var ThreeJsMath = {\r\n  getScreenXY: function(position, camera, div) {\r\n    var pos = position.clone();\r\n    var projScreenMat = new THREE.Matrix4();\r\n    projScreenMat.multiply(camera.projectionMatrix, camera.matrixWorldInverse);\r\n    projScreenMat.multiplyVector3(pos);\r\n    var offset = this.findOffset(div);\r\n    return {\r\n      x: (pos.x + 1) * div.width / 2 + offset.left,\r\n      y: (-pos.y + 1) * div.height / 2 + offset.top\r\n    };\r\n    return offset;\r\n  },\r\n  findOffset: function(element) {\r\n    var pos = new Object();\r\n    pos.left = pos.top = 0;\r\n    if (element.offsetParent) {\r\n      do {\r\n        pos.left += element.offsetLeft;\r\n        pos.top += element.offsetTop;\r\n      } while (element = element.offsetParent);\r\n    }\r\n    return pos;\r\n  }\r\n};\r\n\r\nGamelab.ThreeJsMath = ThreeJsMath;\r\n\r\nclass ThreeJsWindow {\r\n  constructor(container, threejs) {\r\n\r\n    var THREE = window.THREE || threejs;\r\n\r\n    if (!THREE)\r\n      return console.error('Needs three.js library in window.');\r\n\r\n    var scene = this.scene = new THREE.Scene();\r\n    var camera = this.camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 1.0, 5000);\r\n    var renderer = this.renderer = new THREE.WebGLRenderer({\r\n      alpha: true\r\n    });\r\n    var defaultLight = this.defaultLight = new THREE.AmbientLight(0xffffff); // soft white light\r\n    scene.add(defaultLight);\r\n    renderer.setSize(window.innerWidth, window.innerHeight);\r\n    renderer.background = new THREE.Color(0xffffff);\r\n    if (typeof container == 'string') {\r\n      container = document.querySelector(container);\r\n    }\r\n    if (container instanceof HTMLCollection) {\r\n      container = container[0];\r\n    }\r\n    if (!(container instanceof HTMLElement)) {\r\n      container = document.body;\r\n    }\r\n    container.appendChild(renderer.domElement);\r\n  }\r\n  add(object) {\r\n    this.scene.add(object);\r\n  }\r\n  animate() {\r\n    let $window = this;\r\n    requestAnimationFrame(function() {\r\n      $window.animate();\r\n    });\r\n    this.renderer.render(this.scene, this.camera);\r\n  }\r\n  start() {\r\n    this.animate();\r\n  }\r\n}\r\n\r\nGamelab.ThreeJsWindow = ThreeJsWindow;\r\nlet ThreeJSWindow = ThreeJsWindow;\r\nGamelab.ThreeJSWindow = ThreeJSWindow;\r\nlet ThreejsWindow = ThreeJsWindow;\r\nGamelab.ThreejsWindow = ThreejsWindow;;var Trigonometry = {\r\n\r\n  rotatePointsByOrigin: function(points, origin, rotation) {\r\n    for (var x = 0; x < points.length; x++) {\r\n      points[x] = this.rotate_from_xy(origin.x,\r\n        origin.y,\r\n        points[x].x,\r\n        points[x].y,\r\n        typeof rotation == 'number' ? rotation : rotation.x);\r\n    }\r\n\r\n    return points;\r\n  },\r\n\r\n  getTrianglesByBox: function(box) {\r\n    box.origin = box.origin || new Gamelab.Vector(0, 0, 0);\r\n\r\n    let position = box.fullPosition || box.position;\r\n\r\n    var point_a1 = position.copy(),\r\n      point_a2 = position.add(box.size.x, 0),\r\n      point_a3 = position.add(box.size.x, box.size.y),\r\n      point_b1 = position.copy(),\r\n      point_b2 = position.add(0, box.size.y),\r\n      point_b3 = position.add(box.size.x, box.size.y);\r\n\r\n    var plista = this.rotatePointsByOrigin([point_a1, point_a2, point_a3],\r\n      box.origin.add(position),\r\n      box.rotation.negate());\r\n\r\n    var plistb = this.rotatePointsByOrigin([point_b1, point_b2, point_b3],\r\n      box.origin.add(position),\r\n      box.rotation.negate());\r\n\r\n    return [\r\n      plista, plistb\r\n    ];\r\n  },\r\n\r\n  rotate_from_xy: function(cx, cy, x, y, angle) {\r\n    var radians = (Math.PI / 180) * angle,\r\n      cos = Math.cos(radians),\r\n      sin = Math.sin(radians),\r\n      nx = (cos * (x - cx)) + (sin * (y - cy)) + cx,\r\n      ny = (cos * (y - cy)) - (sin * (x - cx)) + cy;\r\n    return new Gamelab.Vector(nx, ny);\r\n  },\r\n\r\n  rotational_speed: function(angle, speed) {\r\n    // Move towards the player\r\n    var radians = (angle / 360) * Math.PI * 2.0;\r\n    return new Gamelab.Vector(Math.cos(radians) * speed, Math.sin(radians) * speed);\r\n  },\r\n\r\n  find_point_on_circle: function(x, y, radius, degrees) {\r\n\r\n  }\r\n};\r\n\r\n\r\nGamelab.Trig = Trigonometry;\r\nGamelab.Trigonometry = Trigonometry;;(function() {\r\n  console.log('Vector class... creating');\r\n\r\n  /**\r\n   * Creates a Vector object with x, y, and --optional z.\r\n   * @param   {number} x the x coordinate\r\n   * @param   {number} y the y coordinate\r\n   * @param   {number} z the optional z coordinate\r\n   * @param   {number} r the optional r value\r\n   * @returns {Vector} a Vector object\r\n   */\r\n\r\n\r\nfunction single_numeric_x(x, y, z)\r\n{\r\n  return typeof x == 'number' && y == undefined && z == undefined;\r\n}\r\n\r\n\r\n  class Vector {\r\n    constructor(x, y, z, r) {\r\n\r\n      var copied = false;\r\n\r\n      if (typeof(x) == 'object' && x.hasOwnProperty('x') && x.hasOwnProperty('y')) //optionally pass vector3\r\n      {\r\n        this.x = x.x;\r\n        this.y = x.y;\r\n        this.z = x.z || 0;\r\n\r\n        if (this.z == null) {\r\n          this.z = 0;\r\n        }\r\n\r\n        this.valid_check();\r\n\r\n        copied = true;\r\n      }\r\n\r\n      if (!copied) {\r\n\r\n        if(single_numeric_x(x, y, z))\r\n        {\r\n          this.x = x;\r\n          this.y = x;\r\n          this.z = x;\r\n        }\r\n        else{\r\n          if (z == null) {\r\n            z = 0;\r\n          }\r\n\r\n                  this.x = x;\r\n                  this.y = y;\r\n                  this.z = z;\r\n                  this.r = r;\r\n        }\r\n\r\n        this.valid_check();\r\n      }\r\n    }\r\n\r\n    valid_check() {\r\n      if (this.x == undefined) {\r\n        this.x = 0;\r\n      }\r\n      if (this.y == undefined) {\r\n        this.y = 0;\r\n      }\r\n      if (this.z == undefined) {\r\n        this.z = 0;\r\n      }\r\n    }\r\n\r\n    copy(){\r\n      return new Gamelab.Vector(this);\r\n    }\r\n\r\n    negate(){\r\n      return new Gamelab.Vector(-this.x, -this.y, -this.z);\r\n    }\r\n\r\n    /**\r\n     * Subtracts another Vector from this vector and returns a vector for the resulting difference.\r\n     *\r\n     * @function\r\n     * @param {Vector} v the vector to be subtracted from this vector\r\n     * @memberof Vector\r\n     **********/\r\n\r\n    sub(x, y, z) {\r\n      var v = new Gamelab.Vector(x, y, z);\r\n      return new Gamelab.Vector(this.x - v.x, this.y - v.y, this.z - v.z);\r\n    }\r\n\r\n    /**\r\n     * Adds another Vector to this vector and returns a vector for the resulting sum.\r\n     *\r\n     * @function\r\n     * @param {Vector} v the vector to be added to this vector\r\n     * @memberof Vector\r\n     **********/\r\n\r\n    add(x, y, z) {\r\n      var v = new Gamelab.Vector(x, y, z);\r\n      return new Gamelab.Vector(this.x + v.x, this.y + v.y, this.z + v.z);\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * Multiplies another Vector by this vector and returns a vector for the resulting product.\r\n     *\r\n     * @function\r\n     * @param {Vector} v the vector that this vector will by muliplied by\r\n     * @memberof Vector\r\n     **********/\r\n\r\n    mult(x, y, z) {\r\n      var v = new Gamelab.Vector(x, y, z);\r\n      return new Gamelab.Vector(this.x * v.x, this.y * v.y, this.z * v.z);\r\n    }\r\n\r\n    /**\r\n     * Gets vector of absolute values.\r\n     *\r\n     * @function\r\n     * @param {Vector} v the absolute vector\r\n     * @memberof Vector\r\n     **********/\r\n\r\n    abs() {\r\n      return new Gamelab.Vector(Math.abs(this.x), Math.abs(this.y), Math.abs(this.z));\r\n    }\r\n\r\n    /**\r\n     * Divides another Vector by this vector and returns a vector for the resulting quotient.\r\n     *\r\n     * @function\r\n     * @param {Vector} v the vector for this vector to be divided by\r\n     * @memberof Vector\r\n     **********/\r\n\r\n    div(x, y, z) {\r\n      var v = new Gamelab.Vector(x, y, z);\r\n      return new Gamelab.Vector(this.x / v.x, this.y / v.y, this.z / v.z);\r\n    }\r\n\r\n    /**\r\n     * Rounds this vector to the nearest set of whole numbers and returns the result.\r\n     *\r\n     * @function\r\n     * @memberof Vector\r\n     * @returns {Vector} a Gamelab.Vector object\r\n     **********/\r\n\r\n    round(multiple=1.0) {\r\n      var d = multiple;\r\n      if(isNaN(d) || d < 1)\r\n      {\r\n        d = 1;\r\n      }\r\n\r\n      var z = !isNaN(this.z) ? this.z : 0;\r\n      return new Gamelab.Vector(Math.round(this.x * d) / d, Math.round(this.y * d) / d, Math.round(this.z  * d) / d);\r\n    }\r\n\r\n    /**\r\n     * Floors this vector to the nearest set of whole numbers and returns the result (subtractive-only, an x of 1.7 becomes 1)\r\n     *\r\n     * @function\r\n     * @memberof Vector\r\n     * @returns {Vector} a Gamelab.Vector object\r\n     **********/\r\n\r\n     floor(multiple=1.0) {\r\n       var d = multiple;\r\n       if(isNaN(d) || d < 1)\r\n       {\r\n         d = 1;\r\n       }\r\n\r\n       var z = !isNaN(this.z) ? this.z : 0;\r\n       return new Gamelab.Vector(Math.floor(this.x * d) / d, Math.floor(this.y * d) / d, Math.floor(this.z  * d) / d);\r\n     }\r\n\r\n    /**\r\n     * Ceils this vector to the nearest set of whole numbers  and returns the result (additive-only, an x of 1.2 becomes 2)\r\n     *\r\n     * @function\r\n     * @memberof Vector\r\n     * @returns {Vector} a Gamelab.Vector object\r\n     **********/\r\n\r\n     ceil(multiple=1.0) {\r\n       var d = multiple;\r\n       if(isNaN(d) || d < 1)\r\n       {\r\n         d = 1;\r\n       }\r\n\r\n       var z = !isNaN(this.z) ? this.z : 0;\r\n       return new Gamelab.Vector(Math.ceil(this.x * d) / d, Math.ceil(this.y * d) / d, Math.ceil(this.z  * d) / d);\r\n     }\r\n\r\n\r\n     above_zero_xy(){\r\n\r\n       return this.x > 0 && this.y > 0;\r\n\r\n     }\r\n\r\n    /**\r\n     * Creates new vector, with the negated x,y,z values (-x-y-z), returns the resulting vector\r\n     *\r\n     * @function\r\n     * @memberof Vector\r\n     * @returns {Vector} a Gamelab.Vector object\r\n     **********/\r\n\r\n    neg() {\r\n      return new Gamelab.Vector(-this.x, -this.y, -this.z);\r\n    }\r\n\r\n    seek(x, y, speedValue=1.0)\r\n    {\r\n      var targetInc;\r\n\r\n      if(typeof x == 'object' && typeof y == 'number')\r\n      {\r\n        speedValue = y;\r\n        y = undefined;\r\n        targetInc = new Gamelab.Vector(x).sub(this).mult(speedValue);\r\n      }\r\n      else{\r\n        targetInc = new Gamelab.Vector(x, y).sub(this).mult(speedValue);\r\n      }\r\n      return this.add(targetInc);\r\n    }\r\n\r\n    half(){\r\n      return this.div(2);\r\n    }\r\n\r\n    /**\r\n     * An equals-test for vectors. Returns true OR false.\r\n     *\r\n     * @function\r\n     * @memberof Vector\r\n     * @returns {boolean} a true OR false value\r\n     **********/\r\n\r\n    equals(x, y, z) {\r\n      var v = new Gamelab.Vector(x, y, z);\r\n      return this.x == v.x && this.y == v.y && this.z == v.z;\r\n    }\r\n\r\n    /**\r\n     * Gets  the specific distance between this and the argument-vector. --applies to x and y of two vectors. Returns a single number.\r\n     *\r\n     * @function\r\n     * @memberof Vector\r\n     * @returns {number} the specific distance between this and the argument-vector\r\n     **********/\r\n\r\n    distance(v) {\r\n      var dist = this.sub(v);\r\n      return Math.sqrt(dist.x * dist.x + dist.y * dist.y);\r\n    }\r\n\r\n\r\n    is_between(v1, v2) {\r\n      //TODO : overlap vectors return boolean\r\n\r\n      return this.x >= v1.x && this.x <= v2.x &&\r\n        this.y >= v1.y && this.y <= v2.y &&\r\n        this.z >= v1.z && this.z <= v2.z;\r\n    }\r\n\r\n    /**\r\n     * Returns a vector-multiple: the original-size, multiplied by a random between the minFloat and maxFloat arguments.\r\n     *\r\n     * @function\r\n     * @memberof Vector\r\n     * @returns {Vector} the resulting vector.\r\n     **********/\r\n\r\n    randomize(minFloat, maxFloat) {\r\n      var random = (Math.random() * (maxFloat - minFloat) + minFloat) * 1000 / 1000;\r\n      return this.mult(random);\r\n    }\r\n\r\n    /**\r\n     * Returns a speed vector, based on rotation.\r\n     *\r\n     * @function\r\n     * @param {number} rotation in degrees, 0-360\r\n     * @param {number} speed the level of speed to apply, default being 1\r\n     * @returns {Vector}\r\n     * @memberof Vector\r\n     **********/\r\n\r\n    rotationalSpeedPoints(rotation, speed) {\r\n      var r = rotation;\r\n      if (isNaN(speed)) {\r\n        speed = 1;\r\n      }\r\n      if (typeof(rotation) == 'object' && rotation.x) {\r\n        r = rotation.x;\r\n      }\r\n\r\n      return new Gamelab.Vector(Math.cos((r) * 3.14 / 180) * speed, Math.sin((r) * 3.14 / 180) * speed);\r\n    }\r\n\r\n    /**\r\n     * Returns the right-handed angle of degrees between two two position-vectors.\r\n\r\n     * @memberof Vector\r\n     * @function\r\n     * @param {Vector} p1 the 1st vector-argument\r\n     * @param {Vector} p2 the 2nd vector-argument\r\n     * @returns {number} the resulting angle in degrees.\r\n     **********/\r\n\r\n    angleBetween(p1, p2) {\r\n      return Math.atan2(p2.y - p1.y, p2.x - p1.x) * 180 / Math.PI;\r\n    }\r\n\r\n    //apply minimum value to all values\r\n    min2d() {\r\n\r\n      function minimize(object, key1, key2) {\r\n        if (object[key1] < object[key2])\r\n          object[key2] = object[key1];\r\n\r\n        if (object[key2] < object[key1])\r\n          object[key1] = object[key2];\r\n      };\r\n\r\n      minimize(this, 'x', 'y');\r\n\r\n      return this;\r\n    }\r\n\r\n\r\n    //apply maximum value to all values\r\n    max2d() {\r\n\r\n      function maximize(object, key1, key2) {\r\n        if (object[key1] > object[key2])\r\n          object[key2] = object[key1];\r\n\r\n        if (object[key2] > object[key1])\r\n          object[key1] = object[key2];\r\n      };\r\n\r\n      maximize(this, 'x', 'y');\r\n\r\n      return this;\r\n    }\r\n\r\n  };\r\n\r\n  let Vector3 = Vector,\r\n    Pos = Vector,\r\n    Size = Vector,\r\n    Position = Vector,\r\n    Vector2 = Vector,\r\n    Rotation = Vector;\r\n\r\n  Gamelab.Vector = Vector;\r\n\r\n  //synonymous w/ Vector::\r\n  Gamelab.Vector2d = Vector;\r\n  Gamelab.Vector2D = Vector;\r\n  Gamelab.Rotation = Vector;\r\n  Gamelab.Pos = Vector;\r\n  Gamelab.Position = Vector;\r\n  Gamelab.Size = Vector;\r\n\r\n  //The above are a list of synonymous expressions for Vector. All of these do the same thing in this library (store and manipulate x,y,z values)\r\n\r\n  var VectorMath = {\r\n\r\n    rotatePointsXY(x, y, angle) {\r\n\r\n      var theta = angle * Math.PI / 180;\r\n\r\n      var point = {};\r\n      point.x = x * Math.cos(theta) - y * Math.sin(theta);\r\n      point.y = x * Math.sin(theta) + y * Math.cos(theta);\r\n\r\n      point.z = 0;\r\n\r\n      return new Gamelab.Vector(point.x, point.y, point.z);\r\n    }\r\n\r\n  }\r\n\r\n  Gamelab.VectorMath = VectorMath;\r\n\r\n})();\r\n;class WebGLWindow {\r\n  constructor(container) {\r\n    if (typeof container == 'string') {\r\n      container = document.querySelector(container);\r\n    }\r\n\r\n    this.container = container;\r\n    var canvasBox = document.createElement('div');\r\n    canvasBox.classList.add('control');\r\n\r\n    var canvas = document.createElement('CANVAS');\r\n\r\n    canvas.style.position = 'relative';\r\n    canvas.style.width = '500px';\r\n    canvas.style.height = '500px';\r\n    canvas.width = 500;\r\n    canvas.height = 500;\r\n    canvas.style.marginTop = '30px';\r\n\r\n    var scene = this.scene = new THREE.Scene();\r\n    var camera = this.camera = new THREE.PerspectiveCamera(75, canvasBox.clientWidth / canvasBox.clientHeight, 0.1, 1000);\r\n    var renderer = this.renderer = new THREE.WebGLRenderer();\r\n    renderer.setSize(window.innerWidth, window.innerHeight);\r\n    document.body.appendChild(renderer.domElement);\r\n    canvasBox.appendChild(renderer.domElement);\r\n    container.append(canvasBox);\r\n  }\r\n  update(scene, renderer) {\r\n    console.dev_log('updating');\r\n  }\r\n  //animate(): begins the update-interval\r\n  animate() {\r\n    var $webgl = this;\r\n    var update = this.update;\r\n\r\n    function run() {\r\n      update($webgl.scene, $webgl.renderer);\r\n      requestAnimationFrame(run);\r\n      renderer.render($webgl.scene, $webgl.camera);\r\n    }\r\n    run();\r\n  }\r\n  //start() :: calls animate to begin the update-interval\r\n  start() {\r\n    this.animate();\r\n  }\r\n}\r\n\r\n\r\nGamelab.WebGLWindow = WebGLWindow;;(function() {\r\n  console.log('Animation class... creating');\r\n\r\n  /**\r\n   *\r\n   * Creates an instance of Animation with one or more Frames.\r\n   *\r\n   * <example-marker data-class='Animation' data-info='Use JQuery fnxs to load content into the div outside of this p-element. Do not use iframe' > </example-marker>\r\n   *\r\n   * @param   {string=} [src] the src-image-path for this Animation\r\n   * @returns {Animation} an Animation object\r\n   *\r\n   * @example\r\n   *\r\n   * //constructor call: Creates a single-frame Animation from src\r\n   * var singleFrameAnime = new Animation('directory/myFile.png');\r\n   *\r\n   * @example\r\n   * //constructor call with chainable function-calls: Creates multi-frame Animation from src, then sets properties with chainable-function-calls.\r\n   * var multiFrameAnime = new Gamelab.GridAnimation('../images/characters/full/spaceman1.png') //constructor is called\r\n   * .FrameSize(130, 130)\r\n   * .FrameBounds(new Gamelab.Vector(9, 0), new Gamelab.Vector(23, 0), new Gamelab.Vector(23, 0))\r\n   * .Seesaw() //The Animation will play back-and-forth repeatedly (cycle through frames forwards, then backwards and so on.\r\n   * .Duration(900); //Animation lasts 900 millis OR just under 1 second\r\n   *\r\n   *  @design\r\n   *\r\n   * //single-responsibility : to define a list of frames, then progress that list of frames with a 'selected_frame' property\r\n   * var singleFrameAnime = new Animation('directory/myFile.png');\r\n   */\r\n\r\n  class Animation {\r\n    constructor(src = {}) {\r\n      var args = typeof(src) == 'object' ? src : {};\r\n      //Gamelab.Modifiers.informable(this, args);\r\n      /**\r\n       * @property {Vector} frameSize the frameSize of the Animation\r\n       * @memberof Animation\r\n       **********/\r\n\r\n      this.frameSize = this.frameSize || new Gamelab.Vector(args.frameSize || new Gamelab.Vector(0, 0));\r\n      this.size = this.size || new Gamelab.Vector(args.size || new Gamelab.Vector(0, 0));\r\n\r\n      this.type = 'Animation';\r\n\r\n      if (typeof src == 'string' || src instanceof HTMLCanvasElement) {\r\n        this.src = src;\r\n        this.image = new Gamelab.GameImage(src);\r\n        this.init_singleFrame();\r\n      } else if (args instanceof Gamelab.GameImage) {\r\n        //console.log('Animation(): args are an instance of GameImage');\r\n        this.image = args;\r\n      } else if (args instanceof HTMLImageElement) {\r\n        //console.log('Animation(): args was an instance of HTMLImageElement');\r\n        this.image = new Gamelab.GameImage(args);\r\n      } else if (args instanceof Gamelab.GridAnimation) {\r\n        this.image = args.image;\r\n      } else if (typeof(args) == 'object' && args.src) {\r\n        this.src = args.src;\r\n        this.image = new Gamelab.GameImage(args.src);\r\n      }\r\n\r\n      this.min_cix = 0;\r\n\r\n      this.visible = args.visible || true;\r\n\r\n      if (args.frameBounds && args.frameBounds.min && args.frameBounds.max) {\r\n        /**\r\n         * @property {VectorFrameBounds} frameBounds the frameBounds of the Animation, has three Vectors\r\n         * @memberof Animation\r\n         **********/\r\n        this.frameBounds = new Gamelab.VectorFrameBounds(args.frameBounds.min, args.frameBounds.max, args.frameBounds.termPoint);\r\n\r\n      } else {\r\n        this.frameBounds = new Gamelab.VectorFrameBounds(new Gamelab.Vector(0, 0, 0), new Gamelab.Vector(0, 0, 0), new Gamelab.Vector(0, 0, 0));\r\n      }\r\n\r\n      this.scale = 1.0;\r\n\r\n      this.origin = new Gamelab.Vector(0, 0, 0);\r\n      this.position = new Gamelab.Vector(0, 0);\r\n      this.rotation = new Gamelab.Vector(0, 0, 0);\r\n      this.frameOffset = this.getArg(args, 'frameOffset', new Gamelab.Vector(0, 0, 0));\r\n\r\n      this.apply2DFrames();\r\n      this.flipX = this.getArg(args, 'flipX', false);\r\n      this.cix = 0;\r\n      /**\r\n       * @property {Frame} selected_frame the selected_frame of the Animation, a Gamelab.Frame\r\n       * @memberof Animation\r\n       **********/\r\n\r\n      this.selected_frame = this.frames[0] || false;\r\n      this.timer = 0;\r\n      this.duration = args.duration || 2000;\r\n      this.seesaw_mode = args.seesaw_mode || false;\r\n      this.reverse_frames = args.reverse_frames || false;\r\n      this.run_ext = args.run_ext || [];\r\n      this.complete_ext = args.complete_ext || [];\r\n\r\n      this.Scale(this.scale);\r\n      // this.colorMap = this.createColorMap(5);\r\n    }\r\n\r\n    set img_src(value) {\r\n      this.src = value;\r\n    }\r\n\r\n    get img_src() {\r\n      return this.src;\r\n    }\r\n\r\n    Origin(x, y, z) {\r\n      this.origin = new Gamelab.Vector(x, y, z);\r\n\r\n      this.frames.forEach(function($f) {\r\n        $f.origin = new Gamelab.Vector(x, y, z);\r\n      });\r\n      if (this.selected_frame) {\r\n        this.selected_frame.origin = new Gamelab.Vector(x, y, z);\r\n      }\r\n      return this;\r\n    }\r\n\r\n    Position(x, y, z) {\r\n      this.position = new Gamelab.Vector(x, y, z);\r\n\r\n      this.frames.forEach(function($f) {\r\n        $f.position = new Gamelab.Vector(x, y, z);\r\n      });\r\n\r\n      return this;\r\n    }\r\n\r\n    Size(x, y) {\r\n\r\n      this.size = new Gamelab.Vector(x, y);\r\n      this.frames.forEach(function(f) {\r\n\r\n        f.Size(x, y);\r\n\r\n      });\r\n      return this;\r\n    }\r\n\r\n    Bone(b) {\r\n      this.bone = b;\r\n      return this;\r\n    }\r\n\r\n    ParentBone(b) {\r\n      this.parentBone = b;\r\n      return this;\r\n    }\r\n\r\n    Rotation(x, y, z) {\r\n\r\n      this.rotation = new Gamelab.Vector(x, y, z);\r\n\r\n      this.frames.forEach(function($frame) {\r\n        $frame.Rotation(x, y, z);\r\n      });\r\n\r\n      return this;\r\n    }\r\n\r\n    add(frame) {\r\n      this.frames.push(frame);\r\n    }\r\n\r\n    Src(src, options = {}) {\r\n      if (typeof src == 'string') {\r\n        console.log('setting GameImage with string:' + src);\r\n        this.src = src;\r\n        this.image = new Gamelab.GameImage(src);\r\n      } else if (src instanceof GameImage) {\r\n        //console.log('Animation(): args are an instance of GameImage');\r\n        this.image = src;\r\n      } else if (src instanceof HTMLImageElement) {\r\n        //console.log('Animation(): args are an instance of HTMLImageElement');\r\n        this.image = new Gamelab.GameImage(src);\r\n      }\r\n\r\n      if (!options.frameBounds)\r\n        this.init_singleFrame();\r\n\r\n      return this;\r\n    }\r\n\r\n    Scale(s) {\r\n      this.scale = s;\r\n      if (this.image && this.image.domElement && this.image.domElement.width > 0) {\r\n        this.size = new Gamelab.Vector(this.image.domElement.width * s, this.image.domElement.height * s).round();\r\n        this.Size(this.size);\r\n      }\r\n      if (this.frames instanceof Array)\r\n        this.frames.forEach(function(f) {\r\n          f.Scale(s);\r\n        });\r\n      return this;\r\n    }\r\n\r\n    Size(x, y, z) {\r\n      this.size = new Gamelab.Vector(x, y, z);\r\n      this.frames.forEach(function(f) {\r\n        f.size = new Gamelab.Vector(x, y, z);\r\n      });\r\n      return this;\r\n    }\r\n\r\n    Image(src) {\r\n\r\n      if (typeof(src) == 'string') {\r\n        //console.log('setting GameImage with string:' + src);\r\n        this.src = src;\r\n        this.image = new Gamelab.GameImage(src);\r\n      } else if (src instanceof Gamelab.GameImage) {\r\n        //console.log('Animation(): args are an instance of GameImage');\r\n        this.image = src;\r\n      } else if (src instanceof HTMLImageElement) {\r\n        console.log('Animation(): args was an instance of HTMLImageElement');\r\n\r\n        this.image = new Gamelab.GameImage(src);\r\n      }\r\n      this.init_singleFrame();\r\n      return this;\r\n    }\r\n\r\n\r\n    /**\r\n     * sets this Animation to a single-frame-animation, from existing image\r\n     * @function\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    init_singleFrame() {\r\n\r\n      var $anime = this;\r\n\r\n      $anime.load_call = $anime.load_call || function() {};\r\n\r\n      this.image.domElement.onload = function() {\r\n\r\n        //alert('Anime loaded');\r\n\r\n        //first run callback assigned by the api-fxns\r\n        $anime.load_call();\r\n\r\n        if ($anime.frameSize.x == 0 && !$anime.__isInit) //indicates zero frame size\r\n          $anime.FrameSize($anime.image.domElement.width, $anime.image.domElement.height)\r\n          .FrameBounds(new Gamelab.Vector(0, 0), new Gamelab.Vector(0, 0));\r\n\r\n        if ($anime.size.x == 0 && !$anime.__isInit) //indicates zero size\r\n          $anime.Size($anime.frameSize.mult(new Gamelab.Vector($anime.scale, $anime.scale)));\r\n\r\n        if (!$anime.__isInit)\r\n          $anime.apply2DFrames();\r\n\r\n      };\r\n      Gamelab.log('Animation():set single-frame animation');\r\n      return this;\r\n    }\r\n\r\n    /*****\r\n     * Overridable / Extendable functions\r\n     * -allows stacking of external object-function calls\r\n     ******/\r\n\r\n\r\n    /**\r\n     * Provides a function to be called when this Animation.image loads.\r\n     *\r\n     * @function\r\n     * @params {Function} call the function to be called on load\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    onLoad(call) {\r\n\r\n      var $anime = this;\r\n      call = call || function() {};\r\n\r\n      this.load_call = call;\r\n\r\n      this.image.domElement.onload = function() {\r\n\r\n        call.bind($anime).call();\r\n\r\n      };\r\n\r\n    }\r\n\r\n    /**\r\n     * Provides a function to be called whenever this Animation starts. Function should run every time the Animation reaches frame-index 0\r\n     *\r\n     * @function\r\n     * @params {Function} call the function to be called on start\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    onRun(call) {\r\n\r\n      if (this.run_ext.indexOf(call) == -1) {\r\n        this.run_ext.push(call.bind(this));\r\n      }\r\n    }\r\n\r\n\r\n    /**\r\n     * Provides a function to be called whenever this Animation completes. Function should run every time the Animation reaches it's last frame-index.\r\n     *\r\n     * @function\r\n     * @params {Function} call the function to be called on complete\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    onComplete(call) {\r\n\r\n      if (this.complete_ext.indexOf(call) == -1) {\r\n        this.complete_ext.push(call.bind(this));\r\n      }\r\n    }\r\n\r\n\r\n    /**\r\n     * Provides a single and only function to be called whenever this Animation completes. Function should run every time the Animation reaches it's last frame-index.\r\n     *\r\n     * @function\r\n     * @params {Function} call the function to be called on complete\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    soleComplete(call) {\r\n      this.complete_ext = [];\r\n      if (this.complete_ext.indexOf(call) == -1) {\r\n        this.complete_ext.push(call.bind(this));\r\n      }\r\n    }\r\n\r\n    call_on_run() {\r\n      //call any function extension that is present\r\n      for (var x = 0; x < this.run_ext.length; x++) {\r\n        this.run_ext[x](this);\r\n      }\r\n    }\r\n\r\n    call_on_complete() {\r\n      //call any function extension that is present\r\n      for (var x = 0; x < this.complete_ext.length; x++) {\r\n        this.complete_ext[x](this);\r\n      }\r\n    }\r\n\r\n\r\n    Visible(v) {\r\n      this.visible = v;\r\n      return this;\r\n    }\r\n\r\n\r\n    FrameSize(w, h) {\r\n      this.frameSize = new Gamelab.Vector(w, h);\r\n      this.__isInit = true;\r\n      this.apply2DFrames();\r\n      return this;\r\n    }\r\n\r\n    Hang() {\r\n      this._hang = true;\r\n      return this;\r\n    }\r\n\r\n    ResetHang() {\r\n      this._hang = false;\r\n      this.cix = this.min_cix;\r\n    }\r\n\r\n    FrameBounds(min, max, termPoint) {\r\n      if (max && !termPoint) {\r\n        termPoint = max;\r\n      }\r\n      this.frameBounds = new Gamelab.VectorFrameBounds(\r\n        new Gamelab.Vector(min), new Gamelab.Vector(max), termPoint);\r\n      this.__isInit = true;\r\n      this.apply2DFrames();\r\n      return this;\r\n    }\r\n\r\n    //4 ways of doing an animation:\r\n    //Verbatim(): each frame is specifically defined\r\n    Verbatim() {\r\n\r\n    }\r\n    //Single(): single frame from src image\r\n    Single() {\r\n      this.SingleFrame();\r\n      return this;\r\n    }\r\n    //ByCanvas(): what's on the canvas at any time is what you get\r\n    ByCanvas() {\r\n\r\n    }\r\n\r\n    //GridFrame(): Frames are laid out evenly\r\n    GridFrame(x1, y1, x2, y2, xFinal, yFinal) {\r\n      var maxFrame;\r\n\r\n      if (typeof xFinal == 'number' && typeof yFinal == 'number')\r\n        maxFrame = new Gamelab.Vector(xFinal, yFinal);\r\n\r\n      this.frameBounds = new Gamelab.VectorFrameBounds(\r\n        new Gamelab.Vector(x1, y1), new Gamelab.Vector(x2, y2), maxFrame);\r\n      this.__isInit = true;\r\n      this.apply2DFrames();\r\n      return this;\r\n    }\r\n\r\n    FrameOffset(x, y) {\r\n      this.frameOffset = new Gamelab.Vector(x, y);\r\n      return this;\r\n    }\r\n\r\n    //X ways of animating:\r\n    //Seesaw: animate back and forth across frame-sequence\r\n    Seesaw() {\r\n      if (!this.seesaw_mode) {\r\n        this.seesaw_mode = true;\r\n      }\r\n      return this;\r\n    }\r\n\r\n    //Reverse: animate in reverse\r\n    Reverse() {\r\n      this.ReverseFrames();\r\n      return this;\r\n    }\r\n\r\n    Lock() {\r\n      this.locked = true;\r\n      return this;\r\n    }\r\n\r\n    Unlock() {\r\n      this.locked = false;\r\n      return this;\r\n    }\r\n\r\n    //Forward and loop: first pass is completed, then always loop back to a\r\n    //specific point and end at another point\r\n    LoopAndPass(fullPass=1, restartFrame=0, endFrame=this.length) {\r\n\r\n    }\r\n\r\n    Duration(millis) {\r\n      this.duration = millis;\r\n      return this;\r\n    }\r\n\r\n    /**\r\n     * Reverses all frames of the animation. Frames are then expected to run backwards.\r\n     *\r\n     * @function\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    ReverseFrames() {\r\n      this.reverse_frames = true;\r\n      return this;\r\n    }\r\n\r\n    /**\r\n     * Sets the animation a a single frame / full-image. Use before img is loaded\r\n     *\r\n     * @function\r\n     * @param {Vector} frameSize optional size param\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    SingleFrame() {\r\n      this.init_singleFrame();\r\n      return this;\r\n    }\r\n\r\n    getArg(args, key, fallback) {\r\n\r\n      if (args.hasOwnProperty(key)) {\r\n        return args[key];\r\n      } else {\r\n        return fallback;\r\n      }\r\n    }\r\n\r\n    init() {\r\n      this.apply2DFrames();\r\n      return this;\r\n    }\r\n\r\n\r\n    apply2DFrames() {\r\n      this.frames = [];\r\n\r\n      if (!this.size) {\r\n        this.Size(this.frameSize.x, this.frameSize.y);\r\n      }\r\n\r\n      var fcount = 0;\r\n      var quitLoop = false;\r\n\r\n      for (let y = this.frameBounds.min.y; y <= this.frameBounds.max.y; y++) {\r\n        for (let x = this.frameBounds.min.x; x <= this.frameBounds.max.x; x++) {\r\n\r\n          let framePos = {\r\n            x: x * this.frameSize.x + this.frameOffset.x,\r\n            y: y * this.frameSize.y + this.frameOffset.y\r\n          };\r\n\r\n          var f = new Gamelab.Frame().Image(this.image).FramePos(framePos).FrameSize(this.frameSize).Origin(this.origin).Size(this.size || this.frameSize).Position(this.position || framePos);\r\n          f.Rotation(this.rotation);\r\n\r\n          this.frames.push(f);\r\n\r\n          if (x >= this.frameBounds.termPoint.x && y >= this.frameBounds.termPoint.y) {\r\n            quitLoop = true;\r\n            break;\r\n          }\r\n\r\n          fcount += 1;\r\n\r\n          if (quitLoop)\r\n            break;\r\n        }\r\n\r\n      }\r\n\r\n      this.frames[0] = this.selected_frame = this.frames[0] || new Gamelab.Frame().Image(this.image).FrameSize(this.frameSize).Size(this.frameSize);\r\n\r\n      if (this.seesaw_mode) {\r\n        // console.log('Animation: applying seesaw');\r\n        var frames_reversed = this.frames.slice().reverse();\r\n        this.frames.pop();\r\n        this.frames = this.frames.concat(frames_reversed);\r\n      }\r\n      if (this.reverse_frames) {\r\n        this.frames.reverse();\r\n      }\r\n    }\r\n\r\n    scaleOf(sized_Object) {\r\n      var s = TypeCode.getPreferredPropertyByKey(sized_Object, 'size', 'argument had nested size variable. Using this instead.');\r\n      return s.div(this.frameSize);\r\n    }\r\n\r\n    init_colorMap() {\r\n      TypeCode.info('init_colorMap()');\r\n\r\n      if (!TypeCode.allDefined([this.image, this.image.domElement]))\r\n        return [];\r\n\r\n      this.canvasObject = this.canvasObject || new Gamelab.OffscreenCanvasRendering(this.image);\r\n      this.colorMap = this.colorMap || this.ColoredPixelMap();\r\n      return this.colorMap;\r\n    }\r\n\r\n    init_colorGrid(spatialDiv) {\r\n      TypeCode.info('init_colorMap()');\r\n\r\n      if (!TypeCode.allDefined([this.image, this.image.domElement]))\r\n        return [];\r\n\r\n      this.canvasObject = this.canvasObject || new Gamelab.OffscreenCanvasRendering(this.image);\r\n      this.colorGrid = this.coloGrid || this.ColoredPixelGrid();\r\n      return this.colorGrid;\r\n    }\r\n\r\n    forEachPixel(callback)\r\n    {\r\n\r\n      this.init_colorMap();\r\n\r\n      this.colorMap.forEach(function(item){\r\n        callback(item);\r\n      });\r\n\r\n    }\r\n\r\n    ColoredPixelGrid(spatialDiv = 5.0) {\r\n\r\n      var image = this.image.domElement,\r\n        ctx = this.canvasObject.ctx,\r\n        grid = [],\r\n        frameSizeDiv = this.selected_frame.frameSize.div(spatialDiv).round();\r\n\r\n\r\n      for (var x = 0; x <= image.width; x += frameSizeDiv.x) {\r\n        for (var y = 0; y <= image.height; y += frameSizeDiv.y) {\r\n          // Fetch pixel at current position\r\n          var pixel = ctx.getImageData(x, y, 1, 1);\r\n          // Check that opacity is above zero\r\n          if (pixel.data[3] !== 0) {\r\n            var vector = new Gamelab.Vector(x, y),\r\n              gridObject = {\r\n                position: vector.sub(frameSizeDiv.div(2.0)),\r\n                size: frameSizeDiv\r\n              };\r\n\r\n            grid.push(gridObject);\r\n          }\r\n        }\r\n      }\r\n\r\n      return grid;\r\n    }\r\n\r\n    ColoredPixelMap() {\r\n\r\n      var image = this.image.domElement,\r\n        ctx = this.canvasObject.ctx,\r\n        grid = [],\r\n        frameSizeDiv = this.selected_frame.frameSize.div(this.selected_frame.frameSize).round();\r\n\r\n\r\n      for (var x = 0; x <= image.width; x += frameSizeDiv.x) {\r\n        for (var y = 0; y <= image.height; y += frameSizeDiv.y) {\r\n          // Fetch pixel at current position\r\n          var pixel = ctx.getImageData(x, y, 1, 1);\r\n          // Check that opacity is above zero\r\n          if (pixel.data[3] !== 0) {\r\n            var vector = new Gamelab.Vector(x, y),\r\n              gridObject = {\r\n                position: vector.sub(frameSizeDiv.div(2.0)),\r\n                size: frameSizeDiv\r\n              };\r\n\r\n            grid.push(gridObject);\r\n          }\r\n        }\r\n      }\r\n\r\n      return grid;\r\n    }\r\n\r\n\r\n    /**\r\n     * Returns the existing ColorMap for this animation.\r\n     *\r\n     * @function\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    getCurrentPixelMap(spatialDiv) {\r\n\r\n      TypeCode.info('getCurrentPixelMap()');\r\n      var map = [];\r\n      var frame = this.selected_frame;\r\n      let __inst = this;\r\n\r\n      this.colorMap = this.init_colorMap();\r\n\r\n      for (var x in this.colorMap) {\r\n        var c = this.colorMap[x];\r\n\r\n        if (Gamelab.Collision.boxCollide(frame.framePos, frame.frameSize, c.position, c.size)) {\r\n          map.push(c);\r\n        }\r\n      }\r\n\r\n      return map;\r\n    }\r\n\r\n    /**\r\n     * Sets the frame to a specific array-index.\r\n     *\r\n     * @function\r\n     * @param {number} ix the frame-index to apply.\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    setFrame(ix) {\r\n      this.selected_frame = this.frames[ix];\r\n    }\r\n\r\n\r\n    /**\r\n     * extends the update of this animation with a new function to be called during the update\r\n     * --repeated calls will extend, (not replace) the update --Allows multiple extensions of the update\r\n     * @function\r\n     * @memberof Animation\r\n     * @param {function} fun the function to be appended to sprite.update\r\n     *\r\n     *  * @example\r\n     * // extend the behavior of your animation\r\n     * myAnime.onUpdate(function(spr)\r\n     *\r\n     *                    console.log('extended update'); //runs automatically whenever animation.update runs\r\n     *\r\n     *                   });\r\n     *\r\n     **********/\r\n    onUpdate(fun) {\r\n      fun = fun.bind(this);\r\n      let update = this.update_frame.bind(this);\r\n      let __inst = this;\r\n      this.update_frame = function(__inst) {\r\n        update(__inst);\r\n        fun(__inst);\r\n      };\r\n    }\r\n    soleUpdate(fun) {\r\n      fun = fun.bind(this);\r\n      let __inst = this;\r\n      this.update_frame = function(__inst) {\r\n        fun(__inst);\r\n      };\r\n    }\r\n    update_frame() {\r\n      this.selected_frame = this.frames[Math.round(this.cix) % this.frames.length];\r\n    }\r\n    reset() {\r\n      this.apply2DFrames();\r\n      this.cix = 0;\r\n    }\r\n    /**\r\n     * Applies a continuous animation. Use this in parent-sprite's update if continuous animation is required.\r\n     * Also works as a single call at any time during game-update.\r\n     *\r\n     * @function\r\n     * @memberof Animation\r\n     **********/\r\n    run() {\r\n\r\n      if(this.locked)\r\n      {\r\n        return;\r\n      }\r\n      \r\n      if (this.__frametype == 'single') {\r\n        return 0;\r\n      }\r\n      this.apply2DFrames();\r\n      this.cix += 1;\r\n      this.update_frame();\r\n    }\r\n    /**\r\n     * animate():: same as run()\r\n     *\r\n     * @function\r\n     * @memberof Animation\r\n     **********/\r\n    animate() {\r\n\r\n      if(this.locked)\r\n      {\r\n        return;\r\n      }\r\n\r\n      if (this.__frametype == 'single') {\r\n        return 0;\r\n      }\r\n\r\n      if (!this.applied) {\r\n        this.apply2DFrames();\r\n        this.applied = true;\r\n      }\r\n\r\n      if (this.cix % this.frames.length == 0) {\r\n        this.engage();\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Engages, or updates the animation for a one full frame-cycle.\r\n     *\r\n     * @function\r\n     * @param {number} duration the number of milliseconds the animation should take.\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    engage(duration) {\r\n\r\n      if(this.locked)\r\n      {\r\n        return;\r\n      }\r\n\r\n      this.call_on_run();\r\n      duration = duration || this.duration || this.frames.length * 20;\r\n      if (this.__frametype == 'single') {\r\n        return 0;\r\n      }\r\n\r\n      //note support of min_cix (eg: min_cix of 1 if top-row starts 1 frame later than bottom)\r\n      if (this.cix >= this.frames.length - 1 || this.cix < this.min_cix && !this._hang) {\r\n        this.cix = this.min_cix;\r\n      }\r\n      let __inst = this;\r\n\r\n      //we have a target\r\n      this.tween = new TWEEN.Tween(this)\r\n        .easing(__inst.curve || TWEEN.Easing.Linear.None)\r\n        .to({\r\n          cix: this.min_cix + (this.frames.length - 1)\r\n        }, duration)\r\n        .onUpdate(function() {\r\n          //console.log(objects[0].position.x,objects[0].position.y);\r\n          //__inst.cix = Math.ceil(__inst.cix);\r\n          __inst.update_frame();\r\n        })\r\n        .onComplete(function() {\r\n          //console.log(objects[0].position.x, objects[0].position.y);\r\n          if (!__inst._hang)\r\n            __inst.cix = __inst.min_cix;\r\n          __inst.call_on_complete();\r\n          __inst.isComplete = true;\r\n          __inst.apply2DFrames();\r\n        });\r\n\r\n      if (this.cix == this.min_cix)\r\n        this.tween.start();\r\n\r\n    }\r\n  };\r\n\r\n  /** @memberof Gamelab */\r\n  Gamelab.GridAnimation = Animation;\r\n  Gamelab.Animation = Animation;\r\n\r\n  Gamelab.GridAnimation.continuous = Gamelab.GridAnimation.run; //'continuous is an alternate reference to 'run'.'\r\n  Gamelab.Animation.continuous = Gamelab.Animation.run; //'continuous is an alternate\r\n\r\n  Gamelab.GridAnimation.update = Gamelab.GridAnimation.update_frame; //alt ref\r\n  Gamelab.Animation.continue = Gamelab.GridAnimation.run; //'continue is an alternate reference to 'run'.'\r\n\r\n})();\r\n;class Bone {\r\n  constructor() {\r\n    this.parent = undefined;\r\n    this.target = undefined;\r\n    this.offset = new Gamelab.Vector(0, 0);\r\n  }\r\n  updatePositionRotation() {\r\n    //  console.log('Parent-Rotation:' + this.parentAnimation.rotation.x);\r\n    var rotatedOffset = Gamelab.VectorMath.rotatePointsXY(this.offset.x, this.offset.y, this.parent.rotation.x),\r\n      fullPosition = this.parent.position.add(this.parent.origin).sub(this.target.origin).add(rotatedOffset);\r\n    this.target.Position(fullPosition);\r\n    this.RotateTarget(this.target.rotation);\r\n    return fullPosition;\r\n  }\r\n\r\n  RotateTarget(x, y, z) {\r\n    this.target.Rotation(x, y, z);\r\n    return this;\r\n  }\r\n\r\n  Parent(p) {\r\n    this.parent = p;\r\n    return this;\r\n  }\r\n\r\n  Origin(o) {\r\n    this.target.origin = new Gamelab.Vector(o);\r\n    return this;\r\n  }\r\n\r\n  Target(t) {\r\n    this.target = t;\r\n    return this;\r\n  }\r\n\r\n  Offset(o) {\r\n    this.offset = o;\r\n    return this;\r\n  }\r\n}\r\n\r\nGamelab.Bone = Bone;\r\n\r\nclass Bone3D {\r\n  constructor() {\r\n    this.parent = undefined;\r\n    this.target = undefined;\r\n    this.offset = new Gamelab.Vector(0, 0);\r\n  }\r\n  getRotatedOffset() {\r\n    //  console.log('Parent-Rotation:' + this.parentAnimation.rotation.x);\r\n    //apply rotation, convert radians to degrees\r\n    if (!this.parent || !this.parent.member) {\r\n      return console.error('cannot update bone3d without parent and parent.member ');\r\n    }\r\n\r\n    var scale = this.target.threejsScale;\r\n\r\n    var previousOffset = this.parent.rotOffset || new Gamelab.Vector(0, 0, 0);\r\n\r\n    var rotatedOffset = Gamelab.VectorMath.rotatePointsXY(this.offset.x, this.offset.y, this.parent.rotation.z),\r\n      targetRotOffset = new Gamelab.Vector(0, 0, 0)\r\n      .add(this.parent.origin)\r\n      .sub(this.target.origin).add(rotatedOffset);\r\n    var rotOffset = targetRotOffset;\r\n    return rotOffset;\r\n  }\r\n\r\n  Parent(p) {\r\n    this.parent = p;\r\n    return this;\r\n  }\r\n  Target(t) {\r\n    this.target = t;\r\n    return this;\r\n  }\r\n\r\n  Offset(o) {\r\n    this.offset = o;\r\n    return this;\r\n  }\r\n}\r\n\r\nGamelab.Bone3D = Bone3D;\r\nlet Bone3d = Bone3D;\r\nGamelab.Bone3D = Bone3D;\r\n\r\n\r\nclass BoneState {\r\n  constructor(boneList) {\r\n    var states = [];\r\n    boneList.forEach(function(bone) {\r\n      states.push({\r\n        bone: bone,\r\n        offset: new Gamelab.Vector(),\r\n        rotation: new Gamelab.Vector(),\r\n        size: new Gamelab.Vector(),\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\nGamelab.BoneState = BoneState;\r\n;\r\nclass Box2D{\r\n  constructor(pos, size){\r\n    this.Position(pos | 0);\r\n    this.Size(size | 0);\r\n  }\r\n\r\n  Position(x, y)\r\n  {\r\n    this.position = new Gamelab.Vector(x, y);\r\n    return this;\r\n  }\r\n  Size(x, y)\r\n  {\r\n    this.size = new Gamelab.Vector(x, y);\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\n\r\n\r\nGamelab.Box2D = Box2D;\r\n;/**\r\n * returns BoolEvent --allows code to run whenever a conditional-function returns true\r\n * @param   {onBool} onBool the function to be tested each update\r\n * @param   {call} call the function to be called when onBool returns true;\r\n\r\n * @returns {BoolEvent} a Gamelab.BoolEvent object\r\n */\r\n\r\nclass BooleanEvent extends GSEvent {\r\n  constructor(onBool, callback) {\r\n    super({});\r\n    this.bool = onBool || function() {\r\n      console.info('CustomBoolEvent():needs .on function(){}. --Add this as 1st argument or via chainable On() function returning bool argument');\r\n    }\r\n    /*Defaults to false to avoid broken code*/\r\n    this.callback = callback || function() {\r\n      console.info('CustomBoolEvent():needs .callback function(){} --Add this as 2nd argument or via chainable Call() function');\r\n    };\r\n    Gamelab.gs_events.push(this);\r\n  }\r\n\r\n  /**\r\n   * applies a boolFunction to be tested for true each update\r\n   * @param   {boolFunction} boolFunction the function to be tested each update --replaces the value of boolEvent.onBool\r\n\r\n   * @returns {BoolEvent} the current instance of BoolEvent, reference to 'this' keyword\r\n   */\r\n\r\n  On(boolFunction) {\r\n    this.bool = boolFunction;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * applies a callback to be called whenever the onBool function returns true\r\n   * @memberof BoolEvent\r\n   * @param   {callbackFunction} callbackFunction the function to be called --replaces the value of boolEvent.callback\r\n\r\n   * @returns {BoolEvent} the current instance of BoolEvent, reference to 'this' keyword\r\n   */\r\n\r\n  Call(callbackFunction) {\r\n    this.callback = callbackFunction || this.callback || function() {};\r\n    return this;\r\n  }\r\n};\r\n\r\nBooleanEvent.Boolean = BooleanEvent.Boolean = BooleanEvent.On;\r\nGamelab.BooleanEvent = BooleanEvent;;class CollisionEvent extends GSEvent {\r\n  constructor(args = {}) {\r\n    super(args);\r\n  }\r\n\r\n  /**\r\n   * applies objects and siblings to be compared for the CollisionEvent instance\r\n   * @memberof CollisionEvent\r\n   * @param   {Array} objects the main-objects for collision processing\r\n   * @param   {Array} siblings the comparable-objects for collision processing\r\n   * @returns {CollisionEvent} the current instance of CollisionEvent, reference to 'this' keyword\r\n   */\r\n\r\n  OnCollision(objects, siblings) {\r\n    this.objects = TypeCode.arrayWrap(objects || this.objects || []);\r\n    this.siblings = TypeCode.arrayWrap(siblings || this.siblings || []);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * applies a callback to be called whenever the onBool function returns true\r\n   * @memberof CollisionEvent\r\n   * @param   {callbackFunction} callbackFunction the function to be called --replaces the value of collisionEvent.callback\r\n\r\n   * @returns {CollisionEvent} the current instance of CollisionEvent, reference to 'this' keyword\r\n   */\r\n\r\n  Call(callbackFunction) {\r\n    this.callback = callbackFunction || this.callback || function() {};\r\n    let $collision = this;\r\n    this.objects.forEach(function($obj) {\r\n      $obj.onUpdate(function() {\r\n        var $sprite = this;\r\n        $collision.siblings.forEach(function($sib) {\r\n          if (Gamelab.Collision.spriteBoxCollide($sprite, $sib)) {\r\n            $collision.callback($sprite, $sib);\r\n          }\r\n        });\r\n      });\r\n    });\r\n\r\n    return this;\r\n  }\r\n};\r\n\r\nGamelab.CollisionEvent = CollisionEvent;\r\nGamelab.BoxCollisionEvent = CollisionEvent;;/**\r\n * Creates an instance of InputEvent\r\n * <info-bit> Gamelab.InputEvent runs a callback function when a specified input is triggered</info-bit>\r\n *\r\n * <tip is=\"p\">Instead of calling\r\n *\r\n * @param   {Object} args object of arguments\r\n * @param   {number} args.btnix the index of controller-button to be applied\r\n * @param   {number} args.gpix the index of pc-gamepad --the 1st gamepad will have index 0\r\n * @param   {number} args.stickix the controller-stick-index to be applied\r\n * @param   {Array} args.keys array of strings for keys to be applied\r\n * @param   {Function} args.callback the function to call when InputEvent is triggered\r\n * @returns {Gamelab.InputEvent} a Gamelab.InputEvent object\r\n */\r\n\r\n\r\nclass InputEvent extends GSEvent {\r\n  constructor(args) {\r\n    super(args);\r\n\r\n    var btnix = args.btnix || args.button_ix || false,\r\n      gpix = args.gpix || args.gamepad_ix || 0,\r\n      callback = args.callback || function() {};\r\n\r\n    var six = args.stickix || args.six || args.stick_ix || false;\r\n    var inputKey = six !== false ? 'stick_' + six : btnix !== false ? 'button_' + btnix : false;\r\n\r\n    //Keys:\r\n    var keyboardKeys = TypeCode.arrayWrap(args.keys || []);\r\n\r\n    //Run the Q() function\r\n    if (keyboardKeys instanceof Array) {\r\n      Gamelab.each(keyboardKeys, function(ix, keyitem) {\r\n        Gamelab.InputSystem.extendKey('key_' + keyitem.toLowerCase(), function() {\r\n          callback(keyitem.toLowerCase());\r\n        });\r\n      });\r\n    }\r\n\r\n    if (inputKey && gpix >= 0) {\r\n      Gamelab.GamepadAdapter.on(inputKey, gpix, function(x, y) {\r\n        callback(x, y);\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nGamelab.InputEvent = InputEvent;\r\n\r\n\r\n/**\r\n *\r\n * @extends InputEvent\r\n *\r\n * Creates an instance of KeyboardEvent\r\n * <info-bit> Gamelab.KeyboardEvent runs a callback function when keyboard-keys are pressed</info-bit>\r\n * @param   {Array | string} keys the Array of keys or single string-key for this event\r\n * @param   {Function} callback the callback-function to be called when this event is triggered\r\n\r\n * @returns {Gamelab.KeyboardEvent}\r\n */\r\n\r\nclass KeyboardEvent extends InputEvent {\r\n  constructor(keys = keys instanceof Array ? keys : [keys], callback = function() {}) {\r\n    super({});\r\n    this.keys = keys;\r\n    this.callback = callback;\r\n  }\r\n\r\n  init() {\r\n    var keyboardKeys = this.keys;\r\n    var __inst = this;\r\n\r\n    if (keyboardKeys instanceof Array) {\r\n      Gamelab.each(keyboardKeys, function(ix, keyitem) {\r\n        Gamelab.InputSystem.extendKey('key_' + keyitem.toLowerCase(), function() {\r\n          __inst.callback(keyitem.toLowerCase());\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  Keys(keys = []) {\r\n    this.keys = TypeCode.arrayWrap(keys)\r\n    return this;\r\n  }\r\n\r\n  Call(callback = function() {}) {\r\n    this.callback = callback;\r\n    this.init();\r\n    return this;\r\n  }\r\n};\r\n\r\nGamelab.KeyboardEvent = KeyboardEvent;\r\n\r\n\r\n/**\r\n *\r\n * @extends InputEvent\r\n *\r\n * Creates an instance of GamepadEvent\r\n * <info-bit> Gamelab.GamepadEvent runs a callback function when any specified gamepad-buttons or gamepad-sticks are pressed</info-bit>\r\n * @param   {Array | string} gamepadKeys the Array of gamepadKeys or single string-key, representing gamepad-buttons or gamepad-sticks for this event\r\n * @param   {Function} callback the callback-function to be called when this event is triggered\r\n\r\n * @returns {Gamelab.GamepadEvent}\r\n */\r\n\r\nclass GamepadEvent extends InputEvent {\r\n  constructor() {\r\n    super({});\r\n    this.gps = [0];\r\n    this.keys = [];\r\n    this.callback = function() {};\r\n  }\r\n\r\n  Gamepads(gps = []) {\r\n    this.gps = TypeCode.arrayWrap(gps);\r\n    return this;\r\n  }\r\n\r\n  init() {\r\n    var gamepadKeys = TypeCode.arrayWrap(this.keys || []);\r\n    var __inst = this;\r\n    Gamelab.GamepadAdapter.on(gamepadKeys, this.gps, function(x, y) {\r\n      __inst.callback(x, y);\r\n    });\r\n  }\r\n\r\n  Keys(keys = []) {\r\n    this.keys = TypeCode.arrayWrap(keys);\r\n    for (var x = 0; x < this.keys.length; x++) {\r\n      if (typeof this.keys[x] == 'number') { //must change to a string\r\n        this.keys[x] = (this.keys[x] + '');\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  Call(callback = function() {}) {\r\n    this.callback = callback;\r\n    this.init();\r\n    return this;\r\n  }\r\n};\r\n\r\nGamelab.GamepadEvent = GamepadEvent;;class MouseLeftClickEvent {\r\n  constructor(callback) {\r\n    callback = callback || function(x, y) {};\r\n\r\n    this.Callback(callback);\r\n  }\r\n  Callback(cb) {\r\n    Gamelab.InputSystem.extend('leftclick', function(x, y) {\r\n      cb(x, y);\r\n    });\r\n  }\r\n};\r\n\r\nGamelab.MouseLeftClickEvent = MouseLeftClickEvent;;class MouseMoveEvent {\r\n  constructor(callback) {\r\n    callback = callback || function(x, y) {};\r\n\r\n    this.Callback(callback);\r\n  }\r\n  Callback(cb) {\r\n    Gamelab.InputSystem.extend('mousemove', function(x, y) {\r\n\r\n      cb(x, y);\r\n\r\n    });\r\n  }\r\n};\r\n\r\nGamelab.MouseMoveEvent = MouseMoveEvent;;class MousePosEvent {\r\n  constructor(callback) {\r\n    callback = callback || function(x, y) {};\r\n\r\n    this.Callback(callback);\r\n  }\r\n  Callback(cb) {\r\n    Gamelab.InputSystem.extend('mousepos', function(x, y) {\r\n      cb(x, y);\r\n    });\r\n  }\r\n};\r\n\r\nGamelab.MousePosEvent = MousePosEvent;;class MouseRightClickEvent {\r\n  constructor(callback) {\r\n    callback = callback || function(x, y) {};\r\n\r\n    this.Callback(callback);\r\n  }\r\n  Callback(cb) {\r\n    Gamelab.InputSystem.extend('rightclick', function(x, y) {\r\n      cb(x, y);\r\n    });\r\n  }\r\n};\r\n\r\nGamelab.MouseRightClickEvent = MouseRightClickEvent;;(function() {\r\n  console.log('Frame class... creating');\r\n\r\n  /**\r\n   * Creates an instance of Frame\r\n   *\r\n   * <info-bit>Gamelab.Frame is called automatically by Gamelab.Sprite and Gamelab.Animation.\r\n   * Gamelab.Frame does not take arguments.\r\n   * It is instantiated, then initilized with chainable function-calls.</info-bit>\r\n   *\r\n   * @returns {Frame}\r\n   *\r\n   * @example\r\n   *\r\n   * var selected_frame = new Gamelab.Frame().Image(gameImage).Size(frameSizeVector);\r\n   */\r\n\r\n\r\n  class Frame {\r\n    constructor() {\r\n      var __inst = this;\r\n      this.framePos = new Gamelab.Vector(0, 0, 0);\r\n      this.frameSize = new Gamelab.Vector(0, 0, 0);\r\n      this.origin = new Gamelab.Vector(0, 0, 0);\r\n      this.position = new Gamelab.Vector(0, 0, 0);\r\n      this.rotation = new Gamelab.Vector(0, 0, 0);\r\n    }\r\n\r\n    Image(src) {\r\n      this.image = new Gamelab.GameImage(src);\r\n      return this;\r\n    }\r\n\r\n    onLoad(fxn) {\r\n\r\n      fxn = fxn || function() {};\r\n      fxn = fxn.bind(this);\r\n      this.image.domElement.onload = function() {\r\n        fxn();\r\n      };\r\n\r\n    }\r\n\r\n    Origin(x, y, z) {\r\n      this.origin = new Gamelab.Vector(x, y, z);\r\n      return this;\r\n    }\r\n\r\n    Rotation(x, y, z) {\r\n      this.rotation = new Gamelab.Vector(x, y, z);\r\n      return this;\r\n    }\r\n\r\n    FramePos(x, y, z) {\r\n      this.framePos = new Gamelab.Vector(x, y, z);\r\n      return this;\r\n    }\r\n\r\n    FrameSize(x, y, z) {\r\n      this.frameSize = new Gamelab.Vector(x, y, z);\r\n      return this;\r\n    }\r\n\r\n    Scale(s) {\r\n      if (this.image && this.image.domElement) {\r\n        this.size = new Gamelab.Vector(Math.round(this.image.domElement.width * s), Math.round(this.image.domElement.height * s));\r\n      }\r\n    }\r\n\r\n    StoreOffscreen() {\r\n\r\n      this.offscreen = this.offscreen || new Gamelab.OffscreenCanvasRendering(this.image);\r\n\r\n      for (var x in this.offscreen) {\r\n        if (x == 'ctx' || x == 'canvas')\r\n          this[x] = this.offscreen[x];\r\n      }\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    getURL() {\r\n      this.StoreOffscreen();\r\n      return this.offscreen.canvas.toDataURL();\r\n    }\r\n\r\n    getColoredPixelGrid(unitSize = 5, ctx) {\r\n\r\n      var grid = [];\r\n\r\n      ctx = ctx || this.ctx;\r\n\r\n      let min = this.framePos,\r\n        max = this.framePos.add(this.frameSize);\r\n\r\n\r\n      for (var x = min.x; x <= max.x; x += unitSize) {\r\n        for (var y = min.y; y <= max.y; y += unitSize) {\r\n          // Fetch pixel at current position\r\n          var pixel = ctx.getImageData(x, y, 1, 1);\r\n          // Check that opacity is above zero\r\n          if (pixel.data[3] != 0) {\r\n\r\n            var vector = new Gamelab.Vector(x, y),\r\n\r\n              gridObject = {\r\n\r\n                position: vector,\r\n\r\n                x: x,\r\n                y: y,\r\n\r\n                size: new Gamelab.Vector(unitSize, unitSize),\r\n\r\n                pixel: pixel,\r\n\r\n                rotation: this.rotation\r\n\r\n              };\r\n\r\n            grid.push(gridObject);\r\n          }\r\n        }\r\n      }\r\n\r\n      return grid;\r\n    }\r\n\r\n    getNonColoredPixelGrid(unitSize = 5, ctx) {\r\n\r\n      var grid = [];\r\n\r\n      ctx = ctx || this.ctx;\r\n\r\n      let min = this.framePos,\r\n        max = this.framePos.add(this.frameSize);\r\n\r\n\r\n      for (var x = min.x; x <= max.x; x += unitSize) {\r\n        for (var y = min.y; y <= max.y; y += unitSize) {\r\n          // Fetch pixel at current position\r\n          var pixel = ctx.getImageData(x, y, 1, 1);\r\n          // Check that opacity is above zero\r\n          if (pixel.data[3] == 0) {\r\n\r\n            var vector = new Gamelab.Vector(x, y),\r\n\r\n              gridObject = {\r\n\r\n                position: vector,\r\n\r\n                x: x,\r\n                y: y,\r\n\r\n                size: new Gamelab.Vector(unitSize, unitSize),\r\n\r\n                pixel: pixel,\r\n\r\n                rotation: this.rotation\r\n\r\n              };\r\n\r\n            grid.push(gridObject);\r\n          }\r\n        }\r\n      }\r\n\r\n      return grid;\r\n    }\r\n\r\n    getFullPixelGrid(unitSize = 5, ctx) {\r\n\r\n      ctx = ctx || this.ctx;\r\n\r\n      var grid = [];\r\n\r\n      let min = this.framePos,\r\n        max = this.framePos.add(this.frameSize);\r\n\r\n      for (var x = min.x; x <= max.x; x += unitSize) {\r\n        for (var y = min.y; y <= max.y; y += unitSize) {\r\n          // Fetch pixel at current position\r\n          var pixel = ctx.getImageData(x, y, 1, 1);\r\n          // Check that opacity is above zero\r\n\r\n\r\n          var vector = new Gamelab.Vector(x, y),\r\n\r\n            gridObject = {\r\n\r\n              position: vector,\r\n\r\n              x: x,\r\n              y: y,\r\n\r\n              size: new Gamelab.Vector(unitSize, unitSize),\r\n\r\n              pixel: pixel,\r\n\r\n              rotation: this.rotation\r\n\r\n            };\r\n\r\n          grid.push(gridObject);\r\n        }\r\n      }\r\n\r\n      return grid;\r\n    }\r\n\r\n\r\n    /**\r\n     * Creates and returns a ColorMap for this animation, allowing opacity-based pixel-collision.\r\n     *\r\n     * @function\r\n     * @param {number} unitDimen a Colormap grid-unit-size --A larger unitDimen decreases accuracy, and results in faster-processing.\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    createColorMap(size, ctx) {\r\n\r\n      this.StoreOffscreen();\r\n\r\n      ctx = ctx || this.ctx;\r\n\r\n      this.colorMap = this.colorMap || this.getColoredPixelGrid(size, ctx);\r\n\r\n      return this.colorMap;\r\n    }\r\n\r\n    createNonColorMap(size, ctx) {\r\n      this.StoreOffscreen();\r\n      ctx = ctx || this.ctx;\r\n      this.nonColorMap = this.nonColorMap || this.getNonColoredPixelGrid(size, ctx);\r\n      return this.nonColorMap;\r\n    }\r\n\r\n\r\n    createPixelMap(size, altImage) {\r\n      if (this.image.domElement instanceof HTMLCanvasElement) {\r\n        this.canvas = this.image.domElement;\r\n        ctx = this.ctx = this.canvas.getContext('2d');\r\n      } else {\r\n        this.StoreOffscreen();\r\n        ctx = ctx || this.ctx;\r\n      }\r\n\r\n      this.pixelMap = this.pixelMap || this.getFullPixelGrid(size, this.testCtx);\r\n      return this.fullPixelMap;\r\n    }\r\n\r\n  }\r\n\r\n  Gamelab.Frame = Frame;\r\n\r\n})();;\n\n/**\n * Creates an instance of GamepadAdapter: --instead use the existing: Gamelab.GamepadAdapter, a working instance of this class.\n * -supports game-controller input for web-games\n * -accesses live gamepad input from the HTML5 Gamepad Api\n * @returns {GamepadAdapter} an instance of GamepadAdapter\n * */\n\nGamelab.gamepads = Gamelab.gamepads || [];\n\nclass GamepadAdapter {\n\n    constructor() {\n        this.__gamepads = [];\n        this.intervals = [];\n        let controller_stack = this;\n        let __gamepadMaster = this;\n        this.settings = {};\n        this.settings.xbox_pc = {\n          button_0:'a',\n          button_1:'b',\n          button_2:'x',\n          button_3:'y',\n          button_4:'lb',\n          button_5:'rb',\n          button_6:'lt',\n          button_7:'rt',\n          button_8:'select',\n          button_9:'start',\n          button_10:'left_stick_button',\n          button_11:'right_stick_button',\n          button_12:'up',\n          button_13:'down',\n          button_14:'right',\n          button_15:'left'\n        };\n\n        this.selectSettings('xbox_pc');\n\n        this.events = [];\n\n        window.addEventListener(\"gamepadconnected\", function (e) {\n            console.log(\"Gamepad connected at index %d: %s. %d buttons, %d axes.\",\n                e.gamepad.index, e.gamepad.id,\n                e.gamepad.buttons.length, e.gamepad.axes.length);\n\n            if (__gamepadMaster.mainLoop) {\n                window.clearInterval(__gamepadMaster.mainLoop);\n            }\n\n            __gamepadMaster.mainLoop = window.setInterval(function () {\n\n                var gps = navigator.getGamepads();\n\n                __gamepadMaster.gps = gps;\n\n                for (var x = 0; x < gps.length; x++) {\n\n                    var events = __gamepadMaster.__gamepads[x] ? __gamepadMaster.__gamepads[x] : {};\n\n                    __gamepadMaster.process(__gamepadMaster.gps[x], events);\n                }\n            }, 20);\n        });\n    }\n\n    selectSettings(name)\n    {\n      for(var x in this.settings)\n      {\n        if(x.toLowerCase() == name.toLowerCase())\n        {\n                this.selectedSettings = this.settings[x];\n        }\n      }\n    }\n\n    addButtonSettings(name, settings)\n    {\n      name = name || '#untitled';\n      this.settings[name] = settings;\n    }\n\n    gamepads() {\n\n        return navigator.getGamepads();\n\n    }\n\n    disconnect_all() {\n\n        for (var x = 0; x < this.intervals.length; x++) {\n\n            window.clearInterval(this.intervals[x]);\n\n        }\n    }\n\n    disconnect_by_index(game_pad_index) {\n\n        window.clearInterval(this.intervals[game_pad_index]);\n\n    }\n\n    hasAnyPad() {\n        return \"getGamepads\" in navigator;\n\n    }\n\n    Event(key, game_pad, callback) {\n        return {\n\n            key: key, game_pad: game_pad, callback: callback\n\n        }\n\n    }\n\n    GamepadEvents(args) {\n\n        var $adapter = this;\n\n        var gp = {};\n\n        gp.stick_left = args.stick_left || function (x, y) {\n\n            //  console.log('Def call');\n\n        }\n\n        gp.stick_right = args.stick_right || function (x, y) {\n\n        }\n\n        gp.buttons = [];\n\n        gp.extendFunc = function (f1, f2) {\n\n            var fc = f2;\n\n            return function (x, y) {\n\n                f2(x, y);\n\n                f1(x, y);\n\n            }\n\n        };\n\n\n                gp.normal_key = function(k){ //replace spaces and dashes with _\n                  for(var x = 0; x < 4; x++)\n                  {\n                    if(k.indexOf(' ') >= 0)\n                    {\n                        k = k.replace(' ', '_');\n                    }\n                    if(k.indexOf('-') >= 0)\n                    {\n                        k = k.replace('-', '_');\n                    }\n                  }\n\n                  return k.toLowerCase();\n                }\n\n                gp.on = function (key, callback) {\n\n                    var settings = $adapter.selectedSettings;\n\n                    key = this.normal_key(key);\n\n\n                                if (this[key] && key !== \"on\") {\n\n                                    var current_cb = typeof(this[key]) == 'function' ? this[key] : function (x, y) {\n                                    };\n\n                                    this[key] = this.extendFunc(callback, current_cb);\n                                }\n\n\n                    for(var x in settings)\n                    {\n                        var parts = x.split('_');\n\n                        if(this.normal_key(x) == key || this.normal_key(settings[x]) == key) //its in the settings\n                        {\n\n                                          var number;\n\n                                          try {\n\n                                              number = parseInt(parts[1]);\n\n                                              var current_cb = typeof(this['buttons'][number]) == 'function' ? this['buttons'][number] : function (x, y) {\n                                              };\n\n                                              this['buttons'][number] = this.extendFunc(callback, current_cb);\n\n                                          }\n                                          catch (e) {\n                                              console.error('could not parse \"on\" event with ' + key);\n\n                                          }\n                        }\n                    }\n                }\n\n        gp.constructor = {name: \"GamepadEvents\"};\n\n        this.__gamepads.push(gp);\n\n        Gamelab.gamepads = this.__gamepads;\n\n        return gp;\n\n    }\n\n    getGamepads() {\n        return Gamelab.gamepads;\n\n    }\n\n    process(gp, gpEvents) {\n\n        this.process_buttons(gp, gpEvents);\n\n        this.process_axes(gp, gpEvents);\n\n    }\n\n    process_axes(gp, events) {\n\n        if (!gp || !gp['axes']) {\n\n            return false;\n\n        }\n\n\n        for (var i = 0; i < gp.axes.length; i += 2) {\n\n            var axis1 = gp.axes[i], axia2 = gp.axes[i + 1];\n\n            var ix = (Math.ceil(i / 2) + 1), x = gp.axes[i], y = gp.axes[i + 1];\n\n            if (ix == 1 && events.stick_left) {\n                events.stick_left(x, y);\n\n            }\n\n            if (ix == 2 && events.stick_right) {\n                events.stick_right(x, y);\n\n            }\n\n            if (this.events && this.events['stick_' + i] && typeof(this.events['stick_' + i].callback) == 'function') {\n                this.events['stick_' + i].callback();\n\n            }\n        }\n\n    }\n\n\n    process_buttons(gp, events) {\n\n        if (!gp || !gp['buttons']) {\n            return false;\n\n        }\n\n        for (var i = 0; i < gp.buttons.length; i++) {\n\n            if (!events.buttons)\n                break;\n\n            else if (events.buttons.length > i && typeof(events.buttons[i]) == 'function') {\n                events.buttons[i](gp.buttons[i].pressed);\n            }\n            else if (events.buttons.length > i && typeof(events.buttons[i]) == 'object' && typeof(events.buttons[i].update) == 'function') {\n                events.buttons[i].update(events.buttons[i].pressed);\n\n            }\n            var clearance_1 = this.events && this.events[i], gpc, bkey = \"button_\" + i;\n\n            if (clearance_1) {\n                gpc = this.events[bkey] && !isNaN(this.events[bkey].game_pad) ? this.gamepads[this.events[bkey].game_pad] : this.events[bkey].game_pad;\n            }\n            ;\n\n            if (clearance_1 && gpc && typeof(this.events[bkey].callback) == 'function') {\n                //call the callback\n                this.events[i].callback();\n\n            }\n\n        }\n    }\n\n\n    on(key, gpix, callback) {\n\n        var keys = TypeCode.arrayWrap(key || []), gps = TypeCode.arrayWrap(gpix || []);;\n\n        for(var x in keys)\n        {\n            for(var y in gps)\n            {\n                if (gps[y] >= this.__gamepads.length) {\n\n                    this.__gamepads.push(this.GamepadEvents({}));\n\n                }\n\n                this.__gamepads[y].on(keys[x], callback);\n\n            }\n        }\n    }\n}\n\n/**********\n * NOTE: here we bind the instance, and NOT the instantiator.\n *\n * *********/\n\nif (!Gamelab.GamepadAdapter) {\n\n    Gamelab.GamepadAdapter = new GamepadAdapter();\n\n    // __gameInstance.gamepads.push(gamepad);\n\n}\n;class Line2d extends Scriptable {\r\n  constructor() {\r\n    super();\r\n    this.Object(this);\r\n    this.points = [];\r\n    this.position = new Gamelab.Vector(0, 0);\r\n    this.rotation = new Gamelab.Vector(0, 0);\r\n    this.size = new Gamelab.Vector(0, 0);\r\n    this.index = 0;\r\n    this.lineWidth = 1.0;\r\n    this.timer = 0;\r\n    this.phase_index = 0;\r\n    this.call = function() {};\r\n  }\r\n\r\n  StepFunction(call) {\r\n    this.call = call;\r\n    return this;\r\n  }\r\n\r\n  next() {\r\n    this.index += 1;\r\n    return this.points[this.index % this.points.length];\r\n  }\r\n\r\n  Color(c) {\r\n    this.color = c;\r\n    return this;\r\n  }\r\n\r\n  GradientCall(fxn, colorStops=[]){\r\n    this.colorStops = colorStops;\r\n    this.gradient_call = fxn.bind(this);\r\n      return this;\r\n  }\r\n\r\n  ShadowBlur(shadowBlur, color){\r\n      this.shadowBlur = shadowBlur;\r\n      this.shadowColor = color;\r\n    return this;\r\n  }\r\n\r\n  Opacity(o){\r\n    this.opacity = o;\r\n    return this;\r\n  }\r\n\r\n  AnimateShadowBlur(minBlur, maxBlur, color, stepFunction){\r\n    this.shadowBlur = minBlur;\r\n    this.shadowColor = color;\r\n    this.minBlur = minBlur;\r\n    this.maxBlur = maxBlur;\r\n    this.blurStepFunction = stepFunction.bind(this);\r\n    this.blurTimer = 0;\r\n    return this;\r\n  }\r\n\r\n  collide(gameObject, lineCollisionCallback=function(){}){\r\n    var gop = gameObject.position, gos = gameObject.size;\r\n    var COLLIDE = false, LINE = this;\r\n    this.points.forEach(function(p){\r\n      if(p.x  >= gop.x && p.x <= gop.x + gos.x &&\r\n      p.y  >= gop.y && p.y <= gop.y + gos.y)\r\n      {\r\n        COLLIDE = true;\r\n        lineCollisionCallback(p, LINE.points);\r\n      }\r\n    });\r\n    return COLLIDE;\r\n  }\r\n\r\n  Fill() {\r\n    for (var x = 1; x <= this.size.x; x++) {\r\n          var x_total = this.size.x;\r\n          var out_of_1 = x / x_total;\r\n        //  console.log('using x portion::' + out_of_1);\r\n          var y = (this.size.y * this.call(out_of_1, 1.0)),\r\n          pos = new Gamelab.Vector(Gamelab.VectorMath.rotatePointsXY(x, y, this.rotation.x));\r\n                    var next_x = this.position.x + pos.x,\r\n            next_y = this.position.y + pos.y,\r\n          last_point = this.points[this.points.length - 1];\r\n          if(!last_point)\r\n          {\r\n            last_point = new Gamelab.Vector(0, 0);\r\n          }\r\n          var next_point = new Gamelab.Vector(next_x, next_y);\r\n          next_point.r = next_point.angleBetween(last_point, next_point);\r\n          this.points.push(next_point);\r\n      }\r\n    return this;\r\n  }\r\n\r\n  getOffsetPos(pos){\r\n    var offset = this.window_offset || new Gamelab.Vector(0, 0);\r\n    return pos.add(offset);\r\n  }\r\n\r\n  LineWidth(number)\r\n  {\r\n    this.lineWidth = number;\r\n    return this;\r\n  }\r\n\r\n  Layer(l)\r\n  {\r\n    this.layer = l;\r\n    return this;\r\n  }\r\n\r\n  GlobalComposite(gc)\r\n  {\r\n    this.globalComposite = gc;\r\n    return this;\r\n  }\r\n\r\n  draw(ctx, camera) {\r\n    ctx = ctx || Gamelab.game_windows[0].ctx;\r\n    camera = camera || Gamelab.game_windows[0].camera;\r\n\r\n    this.ctx = ctx;\r\n    var points = this.points;\r\n    ctx.save();\r\n    ctx.strokeStyle = this.color;\r\n    ctx.lineWidth = this.lineWidth;\r\n    ctx.beginPath();\r\n    this.timer += 1;\r\n    var lastPoint = false;\r\n\r\n    if (points instanceof Array) {\r\n      for (var x = 0; x < points.length; x++) {\r\n        var p = points[x];\r\n        if(x >= 1)\r\n        {\r\n          lastPoint = points[x];\r\n          if(this.gradient_call)\r\n          {\r\n            this.gradient = this.gradient_call(lastPoint, p, this.colorStops);\r\n            ctx.strokeStyle = this.gradient || this.color;\r\n          }\r\n        }\r\n        var position = p.position || p;\r\n        var real_pos = position.sub(camera.position);\r\n        if (real_pos.hasOwnProperty('x') && real_pos.hasOwnProperty('y')) {\r\n          ctx.lineTo(real_pos.x, real_pos.y);\r\n        }\r\n      }\r\n    }\r\n\r\n    var blurTime = this.timer % (this.maxBlur - this.minBlur),\r\n    blurLen = this.maxBlur - this.minBlur;\r\n    this.phase_index = Math.floor(this.timer / (this.maxBlur - this.minBlur));\r\n\r\n    if(this.shadowBlur)\r\n    {\r\n        ctx.shadowBlur = this.shadowBlur;\r\n    }\r\n    if(this.blurStepFunction)\r\n    {\r\n      ctx.shadowBlur = this.minBlur +  this.blurStepFunction(blurTime / blurLen, 1.0) * (this.maxBlur - this.minBlur);\r\n    }\r\n    if(this.shadowColor)\r\n    {\r\n      ctx.shadowColor = this.shadowColor;\r\n    }\r\n    if(this.globalComposite)\r\n    {\r\n      ctx.globalCompositeOperation = this.globalComposite;\r\n    }\r\n    if(typeof this.opacity == 'number')\r\n    {\r\n      ctx.globalAlpha = this.opacity;\r\n    }\r\n\r\n    ctx.stroke();\r\n\r\n    if(this.fillStyle)\r\n    {\r\n      ctx.fillStyle = this.fillStyle;\r\n      ctx.closePath();\r\n      ctx.fill();\r\n    }\r\n    ctx.restore();\r\n  }\r\n\r\n}\r\n\r\nGamelab.Line2d = Line2d;\r\n\r\nGamelab.Line2D = Line2d;\r\n;\n/**\n * Creates a Sound instance. Implements HTML5-Audio object\n * --DevTODO : complete docs for the Sound class\n *\n * @param   {string} src the source-path of the targeted sound-file\n * @returns {Sound} instance of Gamelab.Sound\n * */\n\nclass Sound {\n\n    constructor(src, data) {\n\n        if (typeof(src) == 'object') {\n\n            this.sound = document.createElement('audio');\n            this.sound.volume = src.sound.volume;\n            this.sound.src = src.src;\n            this.src = src.src;\n        }\n\n        else if (typeof(src) == 'string') {\n\n            this.sound = document.createElement('audio');\n            this.sound.volume = 1;\n            this.sound.src = src;\n            this.src = src;\n\n        }\n\n        if(typeof(data)=='object') {\n            for (var x in data) {\n                if (x !== 'sound') {\n                    this[x] = data[x];\n\n                }\n            }\n        }\n\n        this.onLoad = this.onLoad || function () {\n            };\n\n        if (typeof(this.onLoad) == 'function') {\n\n            this.onLoad(this.sound);\n\n        }\n\n    }\n\n    Multiply(number){\n\n      var srcList = [];\n      for(var x = 0; x < number; x++)\n      {\n        srcList.push(this.src || this.sound.src);\n      }\n\n      return new Gamelab.SoundList(srcList).Volume(this.sound.volume);\n    }\n\n    Loop(loop)\n    {\n        this.sound.loop = loop || true;\n\n        return this;\n\n    }\n\n    loop(loop) //same as Loop()\n    {\n        this.sound.loop = loop || true;\n\n        return this;\n\n    }\n\n\n    Volume(val)\n    {\n        this.sound.volume = val;\n\n        return this;\n\n    }\n\n\n    volume(val) //same as Volume()\n    {\n\n        this.sound.volume = val;\n\n        return this;\n\n    }\n\n    Play() {\n\n        if(Gamelab.config && Gamelab.config.soundOff)\n        {\n          return;\n        }\n\n        if (typeof(this.sound) == 'object' && typeof(this.sound.play) == 'function') {\n\n            this.sound.play();\n\n        }\n\n        return this;\n\n    }\n\n    play() { //same as Play()\n      if(Gamelab.config && Gamelab.config.soundOff)\n      {\n        return;\n      }\n        if (typeof(this.sound) == 'object' && typeof(this.sound.play) == 'function') {\n\n            this.sound.play();\n        }\n        return this;\n    }\n\n}\n\n\nclass SoundList{\n\n    constructor(list)\n    {\n        this.cix = 1;\n\n        this.sounds = [];\n\n        if(list instanceof Array)\n        {\n            for(var x in list)\n            {\n                if(list[x].src)\n                {\n                    this.sounds.push(new Sound(list[x].src, list[x]));\n\n                }\n                else if(typeof(list[x]) == 'string')\n                {\n                    this.sounds.push(new Sound(list[x]));\n\n                }\n            }\n        }\n    }\n\n    Multiply(number){\n\n      var srcList = [];\n      for(var x = 0; x < number; x++)\n      {\n        srcList.push(this.src || this.sound.src);\n      }\n\n      return new Gamelab.SoundList(srcList).Volume(this.sounds[0].volume);\n    }\n\n    add(src, name)\n    {\n        if(typeof(src) == 'object' && src.src)\n        {\n            this.sounds.push(new Sound(src.src, src));\n\n        }\n        else if(typeof(src) == 'string')\n        {\n            var data = {};\n\n            if(name)\n            {\n                data.name = name;\n            }\n\n            this.sounds.push(new Sound(list[x], data));\n\n        }\n\n    }\n\n    Volume(v)\n    {\n        for(var x = 0; x < this.sounds.length;x++)\n        {\n            this.sounds[x].volume(v);\n\n        }\n\n        return this;\n    }\n\n    volume(v)\n    {\n        for(var x = 0; x < this.sounds.length;x++)\n        {\n            this.sounds[x].volume(v);\n\n        }\n\n        return this;\n    }\n\n\n    PlayNext()\n    {\n      if(Gamelab.config && Gamelab.config.soundOff)\n      {\n        return;\n      }\n\n        this.sounds[this.cix % this.sounds.length].play();\n\n        this.cix += 1;\n\n    }\n\n    Play()\n    {\n\n      if(Gamelab.config && Gamelab.config.soundOff)\n      {\n        return;\n      }\n\n        this.sounds[this.cix % this.sounds.length].play();\n\n        this.cix += 1;\n\n\n    }\n\n    playNext() //same as PlayNext()\n    {\n      if(Gamelab.config && Gamelab.config.soundOff)\n      {\n        return;\n      }\n        this.sounds[this.cix % this.sounds.length].play();\n\n        this.cix += 1;\n\n    }\n\n    play() //same as Play()\n    {\n      if(Gamelab.config && Gamelab.config.soundOff)\n      {\n        return;\n      }\n\n        this.sounds[this.cix % this.sounds.length].play();\n\n        this.cix += 1;\n\n\n    }\n\n}\n\nGamelab.Sound = Sound;\n\nGamelab.SoundList = SoundList;\n\n\n\n\nclass Audio {\n\n  constructor(){\n\n\n  }\n\n}\n\nGamelab.Audio = Audio;\n;class Particle {\r\n\r\n  constructor(options = {}, gameWindow) {\r\n\r\n    var canvas = document.createElement('CANVAS');\r\n    options.size = options.size || new Gamelab.Vector(2000, 2000);\r\n    this.options = options;\r\n    this.trackableSpeed = false;\r\n\r\n    canvas.width = options.size.x;\r\n    canvas.height = options.size.y;\r\n    canvas.style.display = 'none';\r\n\r\n    this.duration = 500;\r\n\r\n    //refers to an approxomated size\r\n    this.referenceSize = new Gamelab.Vector(0, 0);\r\n\r\n    this.startSize = this.referenceSize;\r\n\r\n    if (!this.life)\r\n      this.Life(70, 70, 'random');\r\n\r\n    this.DefaultValues();\r\n\r\n    this.NormalizeOptions(options);\r\n\r\n    this.Options(options);\r\n\r\n    if (options.duration)\r\n      this.duration = options.duration;\r\n\r\n    var sourceSprites = [],\r\n      livingSprites = [],\r\n      ctx = canvas.getContext('2d');\r\n\r\n    this.sourceSprites = [];\r\n\r\n    this.gameWindow = gameWindow;\r\n    this.ctx = ctx;\r\n    this.canvas = canvas;\r\n\r\n    this.sprites = [];\r\n    this.layer = 0;\r\n    this.ticker = 0;\r\n    this.total = 0;\r\n    this.position = new Gamelab.Vector(200, 200);\r\n  }\r\n\r\n  Layer(l) {\r\n    this.layer = l;\r\n    return this;\r\n  }\r\n\r\n  Prerender(inTestMode = false) {\r\n\r\n    this.prerendered = true;\r\n    this.precanvas = document.createElement('CANVAS');\r\n\r\n    this.precanvas.width = 200;\r\n    this.precanvas.height = 200;\r\n\r\n\r\n    var testDom;\r\n\r\n    if (inTestMode) {\r\n      testDom = document.createElement('DIV');\r\n      testDom.style.position = 'fixed';\r\n      testDom.style.overflow = 'scroll';\r\n      testDom.style.width = '60%';\r\n      testDom.style.height = '60%';\r\n      this.testDom = testDom;\r\n    }\r\n\r\n    this.prectx = this.precanvas.getContext('2d');\r\n\r\n    this.image = document.createElement('img');\r\n    this.image.src = this.options.src;\r\n\r\n    this.portions = [];\r\n\r\n    this.presprites = [];\r\n\r\n    for (var x = 0; x <= 64; x++) {\r\n      this.portions.push(Math.round((x / 64) * 100) / 100);\r\n    }\r\n\r\n    var $object = this;\r\n\r\n    var fw = 0,\r\n      fh = 0;\r\n\r\n\r\n    var $sprite = new Gamelab.Sprite(this.image.src);\r\n\r\n    this.isPrerendered = true;\r\n\r\n    var V = Gamelab.Vector;\r\n\r\n    this.presprite = $sprite;\r\n\r\n    $sprite.onLoad(function() {\r\n\r\n      fw = this.size.x;\r\n      fh = this.size.y;\r\n\r\n      $object.precanvas.style.width = this.size.x * 64 + 'px';\r\n      $object.precanvas.style.height = this.size.y + 'px';\r\n\r\n      $object.precanvas.width = this.size.x * 64;\r\n      $object.precanvas.height = this.size.y;\r\n\r\n      if ($object.testDom)\r\n        $object.testDom.style.height = (this.size.y + 35) + 'px';\r\n\r\n      this.testSize = this.size;\r\n\r\n      var colorOptions = $object.options.color,\r\n        colorOptionSet = numbers.getMinAndMaxByPair(colorOptions.a, colorOptions.b);\r\n\r\n      var colors = new Gamelab.ColorFeildSpan(colorOptionSet.min, colorOptionSet.max, 'linear').PrepareColors();\r\n\r\n      var all_colors = colors.colors,\r\n        max_ix = 64;\r\n\r\n      var frames = [];\r\n\r\n      $sprite.effectDataList = [];\r\n\r\n      for (var ix = 0; ix < 64; ix++) {\r\n\r\n        var colorIndex = Math.floor((ix / max_ix) * all_colors.length);\r\n\r\n        this.pushColorEffectCanvas(all_colors[colorIndex % all_colors.length]);\r\n        this.ColorEffect(all_colors[colorIndex % all_colors.length]);\r\n\r\n        this.Position(ix * fw, 0);\r\n        this.draw($object.prectx);\r\n      }\r\n\r\n\r\n      //modify the draw function\r\n      $object.presprite.draw = function(ctx, camera) {\r\n\r\n        var sprite = this;\r\n\r\n        this.Layer($object.layer);\r\n\r\n        this.ScrollFactor(0);\r\n\r\n        var frame = false;\r\n\r\n        if (sprite.active) {\r\n\r\n          if (sprite.selected_animation instanceof Object && sprite.selected_animation.hasOwnProperty('selected_frame')) {\r\n            frame = sprite.selected_animation.selected_frame;\r\n          }\r\n\r\n          //match frame position w/ sprite position\r\n          frame.Position(sprite.position);\r\n\r\n          var xpos = frame.position.x,\r\n            ypos = frame.position.y;\r\n\r\n          var p = sprite.position;\r\n\r\n          var x = p.x,\r\n            y = p.y,\r\n            scrollFactor = sprite.scrollFactor >= -1.0 && sprite.scrollFactor <= 1.0 ? sprite.scrollFactor : 1.0;\r\n\r\n          if (sprite.noScroll) {\r\n            scrollFactor = 0;\r\n          }\r\n\r\n          //optional animation : gameSize\r\n\r\n          var targetSize = sprite.size || sprite.selected_animation.size;\r\n          var realWidth = targetSize.x;\r\n          var realHeight = targetSize.y;\r\n\r\n\r\n          var origin = sprite.origin || new Gamelab.Vector(realWidth / 2, realHeight / 2);\r\n\r\n          //optional animation : offset\r\n\r\n          var rotation;\r\n\r\n          if (typeof(sprite.rotation) == 'object') {\r\n            rotation = sprite.rotation.x;\r\n\r\n          } else {\r\n            rotation = sprite.rotation;\r\n          }\r\n\r\n          var pct = this.ticker / (this.life + 1);\r\n\r\n          if (pct > 1.0 || isNaN(pct))\r\n            pct = 1.0;\r\n\r\n          if (!(this.effectCanvasList instanceof Array))\r\n            alert('not an array');\r\n\r\n          var index = Math.floor((this.effectCanvasList.length - 1) * pct);\r\n\r\n          if (isNaN(index) || index > this.effectCanvasList.length)\r\n            index = 0;\r\n\r\n          var targetCanvas = this.effectCanvasList[index];\r\n\r\n          if (targetCanvas instanceof HTMLCanvasElement)\r\n          {\r\n            let imageFrameArgs = {\r\n                image:targetCanvas,\r\n                framePos:frame.framePos,\r\n                frameSize:frame.frameSize,\r\n                position:new Gamelab.Vector2D(Math.round(xpos + (origin.x)), Math.round(ypos + (origin.y))),\r\n                size:new Gamelab.Vector2D(realWidth, realHeight),\r\n                rotation:rotation % 360,\r\n                canvasContext:ctx,\r\n                flipX:sprite.flipX,\r\n                flipY:sprite.flipY,\r\n                origin:origin,\r\n                globalAlpha:this.opacity,\r\n                globalComposite:false\r\n            };\r\n            Gamelab.Canvas.draw_image_frame(imageFrameArgs);\r\n          }\r\n\r\n        }\r\n      };\r\n\r\n      if (this.testDom) {\r\n        testDom.style.zIndex = 9999;\r\n        testDom.style.top = '20%';\r\n        testDom.style.left = '20%';\r\n        testDom.appendChild($object.precanvas);\r\n        document.body.appendChild(testDom);\r\n      }\r\n\r\n    });\r\n\r\n\r\n\r\n    return this;\r\n  }\r\n\r\n  DefaultValues() {\r\n\r\n    var def_life = 50;\r\n\r\n    if (!(this.options.composite || this.options.globalComposite || this.options.gobalCompositeOperation))\r\n      this.Composite('source-over');\r\n\r\n    if (!this.options.scale)\r\n      this.Scale(0.6, 0.8, 'quadratic', def_life);\r\n\r\n    if (!this.options.speed)\r\n      this.Speed(7.5, 1.0, 'linear', def_life);\r\n\r\n    if (!(this.options.alpha || this.options.opacity))\r\n      this.Alpha(1.0, 0.1, 'quintic', def_life);\r\n\r\n    if (!this.options.color)\r\n      this.Color(false);\r\n  }\r\n\r\n  NormalizeOptions(options) {\r\n\r\n    if (typeof options.angle == 'number')\r\n      options.angle = {\r\n        a: options.angle\r\n      };\r\n\r\n    if (typeof options.scale == 'number')\r\n      options.scale = {\r\n        a: options.scale\r\n      };\r\n\r\n    if (typeof options.speed == 'number')\r\n      options.speed = {\r\n        a: options.speed\r\n      };\r\n\r\n    if (typeof options.alpha == 'number')\r\n      options.alpha = {\r\n        a: options.alpha\r\n      };\r\n\r\n    if (typeof options.color == 'string')\r\n      options.color = {\r\n        a: options.color\r\n      };\r\n\r\n  }\r\n\r\n  Options(options) {\r\n\r\n    this.Composite(options.composite || options.globalComposite || options.gobalCompositeOperation || 'source-over');\r\n\r\n    if (options.life)\r\n      this.Life(options.life.a, options.life.b, options.life.transition, 500);\r\n\r\n\r\n    var life = this.life.Clone().getValue();\r\n\r\n    if (options.angle)\r\n      this.Angle(options.angle.a, options.angle.b, options.angle.transition, life);\r\n\r\n    if (options.scale)\r\n      this.Scale(options.scale.a, options.scale.b, options.scale.transition, life);\r\n\r\n    if (options.speed)\r\n      this.Speed(options.speed.a, options.speed.b, options.speed.transition, life);\r\n\r\n    if (options.alpha)\r\n      this.Alpha(options.alpha.a, options.alpha.b, options.alpha.transition, life);\r\n\r\n    if (options.color)\r\n      this.Color(options.color.a, options.color.b, options.color.transition, life);\r\n  }\r\n\r\n\r\n  //flipX :: reverse the x-speed of sprite over x-axis\r\n  FlipX(value) {\r\n    this.flipX = value;\r\n\r\n    if (this.flipX) {\r\n      if (this.options.speed.a > 0) {\r\n        this.options.speed.a = -this.options.speed.a;\r\n      }\r\n      if (this.options.speed.b > 0) {\r\n        this.options.speed.b = -this.options.speed.b;\r\n      }\r\n    } else {\r\n      if (this.options.speed.a < 0) {\r\n        this.options.speed.a = -this.options.speed.a;\r\n      }\r\n      if (this.options.speed.b < 0) {\r\n        this.options.speed.b = -this.options.speed.b;\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  //Define the src (image) of the particle\r\n  Src(src) {\r\n\r\n    this.sourceSprites = [];\r\n    this.options.src = src;\r\n\r\n    var options = this.options;\r\n\r\n    var maxlife;\r\n\r\n    if(options.life instanceof Object)\r\n    {\r\n       maxlife = options.life.a && !options.life.b ? options.life.a : options.life.a > options.life.b ? options.life.a : options.life.b;\r\n    }\r\n\r\n    else if(typeof options.life == 'number')\r\n    {\r\n      maxlife = options.life;\r\n    }\r\n\r\n    this.options.max = maxlife * 60;\r\n\r\n      if(this.options.max > 2000)\r\n      {\r\n        this.options.max = 2000;\r\n      }\r\n\r\n    for (var x = 0; x < this.options.max; x++) {\r\n      var sprite = new Gamelab.Sprite(this.options.src).Scale(this.options.scale.a);\r\n\r\n      var particle = this;\r\n\r\n      if (x == 0)\r\n        sprite.onLoad(function() {\r\n          particle.referenceSize = this.size;\r\n        });\r\n\r\n      sprite.options = this.options;\r\n      this.sourceSprites.push(sprite);\r\n    }\r\n\r\n\r\n    this.sourceSprites.oldest = function() {\r\n\r\n      var maxTicker = 0,\r\n        nextObjectIndex = 0;\r\n\r\n      for (var x = 0; x < this.length; x++) {\r\n        if (typeof this[x] == 'object' && this[x].ticker >= maxTicker) {\r\n          maxTicker = this[x].ticker;\r\n          nextObjectIndex = x;\r\n        }\r\n      }\r\n      return this[nextObjectIndex];\r\n    };\r\n\r\n    this.sourceSprites.countLiving = function() {\r\n      var total = 0;\r\n      for (var x = 0; x < this.length; x++) {\r\n        if (this[x].ticker >= 1) {\r\n          total++;\r\n        }\r\n      }\r\n\r\n    //  console.log('TOTAL LIVING blts::' + total);\r\n      return total;\r\n    };\r\n\r\n\r\n    return this;\r\n  }\r\n\r\n  //Total particles to draw from\r\n  Stock(stock) {\r\n    this.options.stock = stock;\r\n    return this;\r\n  }\r\n\r\n\r\n  OffsetAllByX(x) {\r\n\r\n    var particle = this;\r\n\r\n    this.sprites.forEach(function(sprite) {\r\n      if (!sprite.detached_particle && sprite.flipX == particle.flipX)\r\n        sprite.position.x += x;\r\n      else {\r\n        sprite.detached_particle = true;\r\n      }\r\n    });\r\n\r\n    return this;\r\n  }\r\n\r\n  //composite :: example value = 'lighter'\r\n  Composite(c) {\r\n    this.options.globalCompositeOperation = c;\r\n    return this;\r\n  }\r\n\r\n  //Life span\r\n  Life(a, b, transition, duration = 500) {\r\n    this.life = new Gamelab.FeildSpan(a, b, transition, duration);\r\n    return this;\r\n  }\r\n\r\n  Color(a, b, transition, life) {\r\n    if(!a)\r\n    {\r\n      this.options.color = false;\r\n      return false;\r\n    }\r\n    this.options.color = new Gamelab.ColorFeildSpan(a, b, transition, life).PrepareColors();\r\n  }\r\n\r\n  //scale transition\r\n  Scale(a, b, transition, life) {\r\n    this.options.scale = new Gamelab.FeildSpan(a, b, transition, life);\r\n    return this;\r\n  }\r\n\r\n  //allowable angles\r\n  Angle(a, b, transition, life) {\r\n    this.options.angle = new Gamelab.FeildSpan(a, b, transition, life);\r\n    return this;\r\n  }\r\n\r\n  //alpha transition\r\n  Alpha(a, b, transition, life) {\r\n    this.options.alpha = new Gamelab.FeildSpan(a, b, transition, life);\r\n    return this;\r\n  }\r\n\r\n  //speed transition\r\n  Speed(a, b, transition, life) {\r\n    this.options.speed = new Gamelab.FeildSpan(a, b, transition, life);\r\n    return this;\r\n  }\r\n\r\n  LockRotation(r) {\r\n    this.lockedRotation = r;\r\n    return this;\r\n  }\r\n\r\n\r\n  addParticles(total) {\r\n\r\n    var options = this.options;\r\n\r\n    var positions = [];\r\n\r\n    if (options.shape instanceof Gamelab.Circle)\r\n      positions = ['border', 'perimeter'].indexOf(options.pointMode) >= 0 ? options.shape.getRandomCircumferencePoints(total) : options.shape.getRandomPoints(total);\r\n    for (var x = 0; x < total; x++) {\r\n\r\n      this.total += 1;\r\n      var sprite;\r\n\r\n      var ix = x + this.sourceSprites.countLiving();\r\n\r\n      if(ix < this.sourceSprites.length)\r\n      sprite = this.sourceSprites[ix];\r\n      else{\r\n        sprite = this.sourceSprites.oldest();\r\n      }\r\n    //  console.info(sprite);\r\n    //  console.info(this.sourceSprites);\r\n      if (this.total >= this.sourceSprites.length) {\r\n        //console.info(sprite);\r\n      }\r\n      this.lastSprite = sprite;\r\n    //  console.info(sprite);\r\n    //  console.log(ix);\r\n    //  console.log(this.sourceSprites.length);\r\n      sprite.ticker = 0;\r\n      sprite.speed = new Gamelab.Vector(0, 0);\r\n\r\n\r\n      //temp scroll factor -zero\r\n\r\n      sprite.ScrollFactor(0);\r\n\r\n      if (this.presprite && this.options.color && this.options.color.hasVariance()) {\r\n        sprite.effectCanvasList = this.presprite.effectCanvasList;\r\n        sprite.draw = this.presprite.draw;\r\n      }\r\n\r\n      if (this.gameWindow.has(sprite))\r\n        this.gameWindow.remove(sprite);\r\n\r\n      if (this.sprites.indexOf(sprite) >= 0)\r\n        this.sprites.splice(this.sprites.indexOf(sprite), 1);\r\n\r\n      if (sprite.constructor.name !== 'Sprite') {\r\n        console.error('not a sprite');\r\n      }\r\n\r\n      sprite.detached_particle = false;\r\n      sprite.flipX = this.flipX;\r\n\r\n      var particle = this;\r\n\r\n      sprite.flyByRotation = function(angle, speed) {\r\n        this.speed = Gamelab.Trig.rotational_speed(angle, speed);\r\n        this.position = this.position.add(this.speed);\r\n      };\r\n\r\n      sprite.speed = new Gamelab.Vector(0, 0);\r\n\r\n      sprite.gunOptions = {};\r\n\r\n      sprite.gunOptions.life = this.life.Clone();\r\n\r\n      sprite.life = sprite.gunOptions.life.getValue();\r\n\r\n      if (isNaN(sprite.life) || sprite.life == 0)\r\n        console.error('Not a number OR isZero --sprite.life');\r\n\r\n      sprite.gunOptions.angle = options.angle.Duration(sprite.life).Clone();\r\n\r\n      if (options.color && options.color.hasVariance())\r\n      sprite.gunOptions.color = options.color.Duration(sprite.life).Clone();\r\n\r\n      sprite.gunOptions.alpha = options.alpha.Duration(sprite.life).Clone();\r\n\r\n      sprite.gunOptions.speed = options.speed.Duration(sprite.life).Clone();\r\n\r\n      sprite.gunOptions.scale = options.scale.Duration(sprite.life).Clone();\r\n\r\n      sprite.opacity = sprite.gunOptions.alpha.getValue();\r\n\r\n      if (this.options.color && !this.presprite && this.options.color.hasVariance()) {\r\n        sprite.color = sprite.gunOptions.color.getValue();\r\n      }\r\n\r\n\r\n      sprite.scale = sprite.gunOptions.scale.getValue();\r\n\r\n      if (!this.presprite && this.options.color && this.options.color.hasVariance())\r\n        sprite.ColorEffect(sprite.color);\r\n\r\n\r\n      sprite.globalCompositeOperation = options.globalCompositeOperation || 'lighter';\r\n\r\n\r\n      var angleDiff = Math.abs(options.angle.a - options.angle.b);\r\n\r\n      if(sprite.hasOwnProperty('r'))\r\n      {\r\n       sprite.fly_angle = sprite.r;\r\n      }\r\n      else{\r\n        sprite.fly_angle = sprite.gunOptions.angle.getValue();\r\n      }\r\n\r\n\r\n      sprite.Scale(sprite.scale);\r\n\r\n      if (positions.length >= 1) {\r\n        if (x < positions.length) {\r\n          sprite.Position(this.position.add(positions[x]));\r\n\r\n          if(positions[x] && positions[x].hasOwnProperty('r') && !isNaN(positions[x].r) &&\r\n           positions[x].r >= -360 && positions[x].r <= 360)\r\n          {\r\n            sprite.r = positions[x].r;\r\n          }\r\n        } else {\r\n          sprite.Position(this.position);\r\n        }\r\n\r\n      } else {\r\n        sprite.Position(this.trackablePosition || this.position);\r\n      }\r\n\r\n      var gameWindow = this.gameWindow;\r\n\r\n\r\n      if (this.lockedRotation) {\r\n        sprite.Rotation(this.lockedRotation);\r\n      }\r\n\r\n      sprite.update = function() {\r\n\r\n        this.ticker += 1;\r\n\r\n        this.life -= 1;\r\n\r\n        if (this.life <= 0) {\r\n          //console.log('REMOVING PARTICLE');\r\n          particle.sprites.splice(particle.sprites.indexOf(this), 1);\r\n          gameWindow.remove(this);\r\n        }\r\n\r\n        this.scale = this.gunOptions.scale.getValue();\r\n\r\n        this.Scale(this.scale);\r\n\r\n        if (!particle.isPrerendered && particle.options.color && particle.options.color.hasVariance()) {\r\n          this.color = this.gunOptions.color.getValue();\r\n          this.ColorEffect(this.color);\r\n        }\r\n\r\n        this.Opacity(this.gunOptions.alpha.getValue());\r\n\r\n        this.gunSpeed = this.gunOptions.speed.getValue();\r\n\r\n        this.flyByRotation(this.r ? this.r % 360 : this.fly_angle % 360, this.gunSpeed);\r\n\r\n        if (particle.trackableSpeed) {\r\n          this.position = this.position.add(particle.trackableSpeed);\r\n        }\r\n        if (particle.trackablePosition) {\r\n          this.position = particle.trackablePosition;\r\n        }\r\n      };\r\n\r\n      this.sprites.push(sprite);\r\n      this.gameWindow.add(sprite);\r\n    }\r\n  }\r\n\r\n  resetTicker() {\r\n    this.ticker = 0;\r\n    return this;\r\n  }\r\n\r\n\r\n  assignTrackableSpeed(speed) {\r\n\r\n    this.trackableSpeed = speed;\r\n    return this;\r\n  }\r\n\r\n\r\n  assignTrackablePosition(position) {\r\n\r\n    this.trackablePosition = position;\r\n    return this;\r\n  }\r\n\r\n  assignLinesAndSelector(lineList, lineSelector) {\r\n    this.lines = lines;\r\n    return this;\r\n  }\r\n\r\n\r\n  enter(number) {\r\n\r\n    this.ticker += 1;\r\n\r\n    this.addParticles(number);\r\n\r\n    //return an api for assigning various updates::\r\n\r\n    var $p = this;\r\n\r\n    return this;\r\n\r\n  }\r\n}\r\n\r\nGamelab.Particle = Particle;\r\n\r\nclass Effect extends Particle {\r\n\r\n  constructor() {\r\n    super(...arguments);\r\n\r\n  }\r\n}\r\n\r\nGamelab.Effect = Effect;\r\n;/**\n * Creates a GravityForce instance.\n *\n *@param   {Object} args the object of arguments\n * @param   {string} args.name optional\n * @param   {string} args.description optional\n * @param   {Array} args.subjects the subjects to be pulled by the GravityForce\n * @param   {Array} args.clasticObjects any clastic object or array-of-objects that should have collision-stop behavior with subjects\n * @param   {Vector} args.max the max speed of the gravity-force, similar to concept of 'terminal velocity'\n * @param   {number} args.accel the increment of acceleration for each update called, while subjects are falling\n *\n * @returns {GravityForce} a GravityForce object\n */\n\n(function () {\n    console.log('Force class... creating');\n\n    class GravityForce {\n        constructor(args = {}) {\n            this.name = args.name || \"\";\n\n            this.description = args.description || \"\";\n\n            this.subjects = args.subjects || [];\n\n            this.clasticObjects = args.clasticObjects || [];\n\n            this.topClastics = args.topClastics || [];\n\n            this.max = args.max || new Gamelab.Vector(3, 3, 3);\n            this.accel = args.accel || new Gamelab.Vector(1.3, 1.3, 1.3);\n\n\n            for (var x in this.clasticObjects) {\n                if (!this.clasticObjects[x] instanceof Gamelab.Sprite) {\n                    this.clasticObjects[x] = Gamelab.getById(this.clasticObjects[x].id);\n                }\n\n            }\n\n\n            for (var x in this.topClastics) {\n                if (!this.topClastics[x] instanceof Gamelab.Sprite) {\n                    this.topClastics[x] = Gamelab.getById(this.topClastics[x].id);\n                }\n\n            }\n\n\n            for (var x in this.subjects) {\n                if (!this.subjects[x] instanceof Gamelab.Sprite) {\n                    this.subjects[x] = Gamelab.getById(this.subjects[x].id);\n                }\n\n            }\n\n        }\n\n        getArg(args, key, fallback) {\n\n            if (args.hasOwnProperty(key)) {\n                return args[key];\n            }\n            else {\n                return fallback;\n\n            }\n        }\n\n\n        /**\n         * Updates position for all objects effected by this instance.\n         * @memberof GravityForce\n         */\n\n        update() {\n\n            var subjects = this.subjects;\n\n            var clasticObjects = this.clasticObjects;\n\n            var topClastics = this.topClastics;\n\n            var accel = this.accel || {};\n\n            var max = this.max || {};\n\n            Gamelab.each(subjects, function (ix, itemx) {\n\n                if(!itemx.jumping && !itemx.flying)\n                itemx.accelY(accel, max);\n\n                itemx.__inAir = true;\n\n\n            });\n        }\n    };\n\n    let Force = GravityForce;\n\n    Gamelab.Force = Force;\n\n    Gamelab.GForce = Force;\n\n    Gamelab.GravityForce = GravityForce;\n\n})();\n;\r\nconsole.log('TODO:: complete Gamelab.Gravity class');\r\n\r\nclass Gravity {\r\n  constructor(){\r\n\r\n  }\r\n  //pull single object or list of objects\r\n  pull(object, accel=1.0, max=100){\r\n    var list = object instanceof Array ? object : [object];\r\n    list.forEach(function(item){\r\n        if(item.speed.y < max)\r\n        {\r\n          item.__inAir = true;\r\n          item.speed.y += accel;\r\n        }\r\n        else\r\n        {\r\n            item.speed.y = max;\r\n        }\r\n\r\n    });\r\n  }\r\n}\r\n\r\nGamelab.Gravity = Gravity;\r\n;class Elipsoid {\r\n  constructor() {\r\n    this.position = new Gamelab.Vector(0, 0);\r\n    this.rotation = new Gamelab.Vector(0, 0);\r\n    this.size = new Gamelab.Vector(0, 0);\r\n    this.origin = new Gamelab.Vector(0, 0);\r\n    this.gradient = undefined;\r\n    this.borderGradient = undefined;\r\n    this.active = true;\r\n    this.invisible = false;\r\n    this.fill = false;\r\n  }\r\n  Rotation(r) {\r\n    this.rotation = new Gamelab.Vector(r);\r\n    return this;\r\n  }\r\n  Origin(x, y) {\r\n    this.origin = new Gamelab.Vector(x, y);\r\n    return this;\r\n  }\r\n  Position(x, y) {\r\n    this.position = new Gamelab.Vector(x, y);\r\n    return this;\r\n  }\r\n  Size(x, y) {\r\n    this.size = new Gamelab.Vector(x, y);\r\n    return this;\r\n  }\r\n  Fill(fill){\r\n    this.fill = fill || true;\r\n    return this;\r\n  }\r\n  BorderGradient(a, b) {\r\n    this.borderGradientColorA = a;\r\n    this.borderGradientColorB = b;\r\n    return this;\r\n  }\r\n  Gradient(a, b) {\r\n    this.gradientColorA = a;\r\n    this.gradientColorB = b;\r\n    this.Fill(true);\r\n    return this;\r\n  }\r\n  BorderThickness(bt) {\r\n    this.borderThickness = bt;\r\n    return this;\r\n  }\r\n  draw(ctx, camera) {\r\n\r\n    ctx.save();\r\n\r\n    let startX = this.position.x-this.origin.x;\r\n\r\n    if (!this.invisible && this.active) {\r\n      this.ctx = ctx;\r\n      let gradient = this.ctx.createLinearGradient(startX, 0, startX + this.size.x, 0);\r\n      gradient.addColorStop(0, this.gradientColorA || 'white');\r\n      gradient.addColorStop(1.0, this.gradientColorB || 'white');\r\n      this.gradient = gradient;\r\n\r\n      let borderGradient = this.ctx.createLinearGradient(startX, 0, startX + this.size.x, 0);\r\n      borderGradient.addColorStop(0, this.borderGradientColorA || 'white');\r\n      borderGradient.addColorStop(1.0, this.borderGradientColorB || 'white');\r\n      this.borderGradient = borderGradient;\r\n\r\n      ctx.translate(this.position.x + this.origin.x, this.position.y + this.origin.y);\r\n      ctx.rotate(Math.PI / 180 * this.rotation.x);\r\n\r\n      ctx.translate(0, ctx.width);\r\n\r\n      if (this.flipX) {\r\n        ctx.scale(-1, 1);\r\n      } else {\r\n\r\n      }\r\n\r\n      if (this.flipY) {\r\n        ctx.scale(1, -1);\r\n      } else {\r\n\r\n      }\r\n\r\n\r\n\r\n      ctx.strokeStyle = this.borderGradient || 'white';\r\n      ctx.lineWidth = this.borderThickness || 4.0;\r\n\r\n      ctx.beginPath();\r\n      ctx.arc(this.position.x+this.origin.x,this.position.y+this.origin.y,this.size.x / 2.0,2 * Math.PI, false);\r\n\r\n      if(this.fill)\r\n      {\r\n        ctx.fillStyle = this.gradient || 'white';\r\n        ctx.fill();\r\n      }\r\n\r\n    }\r\n\r\n    ctx.restore();\r\n\r\n  }\r\n}\r\n\r\n\r\n\r\nclass Rectangle {\r\n  constructor() {\r\n    this.position = new Gamelab.Vector(0, 0);\r\n    this.rotation = new Gamelab.Vector(0, 0);\r\n    this.size = new Gamelab.Vector(0, 0);\r\n    this.origin = new Gamelab.Vector(0, 0);\r\n    this.gradient = undefined;\r\n    this.borderGradient = undefined;\r\n    this.active = true;\r\n    this.invisible = false;\r\n    this.fill = false;\r\n  }\r\n  Rotation(r) {\r\n    this.rotation = new Gamelab.Vector(r);\r\n    return this;\r\n  }\r\n  Origin(x, y) {\r\n    this.origin = new Gamelab.Vector(x, y);\r\n    return this;\r\n  }\r\n  Position(x, y) {\r\n    this.position = new Gamelab.Vector(x, y);\r\n    return this;\r\n  }\r\n  Size(x, y) {\r\n    this.size = new Gamelab.Vector(x, y);\r\n    return this;\r\n  }\r\n  Fill(fill){\r\n    this.fill = fill || true;\r\n    return this;\r\n  }\r\n  BorderGradient(a, b) {\r\n    this.borderGradientColorA = a;\r\n    this.borderGradientColorB = b;\r\n    return this;\r\n  }\r\n  Gradient(a, b) {\r\n    this.gradientColorA = a;\r\n    this.gradientColorB = b;\r\n    this.Fill(true);\r\n    return this;\r\n  }\r\n  BorderThickness(bt) {\r\n    this.borderThickness = bt;\r\n    return this;\r\n  }\r\n  draw(ctx, camera) {\r\n\r\n    ctx.save();\r\n\r\n    let startX = this.position.x-this.origin.x;\r\n\r\n    if (!this.invisible && this.active) {\r\n      this.ctx = ctx;\r\n      let gradient = this.ctx.createLinearGradient(startX, 0, startX + this.size.x, 0);\r\n      gradient.addColorStop(0, this.gradientColorA || 'white');\r\n      gradient.addColorStop(1.0, this.gradientColorB || 'white');\r\n      this.gradient = gradient;\r\n\r\n      let borderGradient = this.ctx.createLinearGradient(startX, 0, startX + this.size.x, 0);\r\n      borderGradient.addColorStop(0, this.borderGradientColorA || 'white');\r\n      borderGradient.addColorStop(1.0, this.borderGradientColorB || 'white');\r\n      this.borderGradient = borderGradient;\r\n\r\n      ctx.translate(this.position.x + this.origin.x, this.position.y + this.origin.y);\r\n      ctx.rotate(Math.PI / 180 * this.rotation.x);\r\n\r\n      ctx.translate(0, ctx.width);\r\n\r\n      if (this.flipX) {\r\n        ctx.scale(-1, 1);\r\n      } else {\r\n\r\n      }\r\n\r\n      if (this.flipY) {\r\n        ctx.scale(1, -1);\r\n      } else {\r\n\r\n      }\r\n\r\n      if(this.fill)\r\n      {\r\n        ctx.fillStyle = this.gradient || 'white';\r\n        ctx.fillRect(this.position.x-this.origin.x,this.position.y-this.origin.y,this.size.x,this.size.y);\r\n      }\r\n\r\n      ctx.strokeStyle = this.borderGradient || 'white';\r\n      ctx.lineWidth = this.borderThickness || 4.0;\r\n\r\n      ctx.beginPath();\r\n      ctx.strokeRect(this.position.x-this.origin.x,this.position.y-this.origin.y,this.size.x,this.size.y);\r\n\r\n    }\r\n\r\n    ctx.restore();\r\n\r\n  }\r\n}\r\n\r\n\r\n\r\nGamelab.Rectangle = Rectangle;\r\nGamelab.RectangularLine = Rectangle;\r\n\r\nGamelab.CircleShape = Elipsoid;\r\nGamelab.Elipsoid = Elipsoid;\r\n;/**\r\n * Creates a new Sprite.\r\n *\r\n * <info-bit>Gamelab.Sprite is a container for 2D Animations.\r\n * -apply Sprite class to create a 2D game-object.\r\n *\r\n * Sprites hold reference to their-own Animations and Sounds.</info-bit>\r\n * <iframe style='width:400px; height:450px; overflow:hidden;' src='../client/examples/js-class/Sprite.html'> </iframe>\r\n\r\n * @param   {string} src the srcPath for the image of the Sprite\r\n * @param   {number} scale=1.0 the scale to be applied to size of each animation-frame\r\n *\r\n * @returns {Sprite} a Gamelab.Sprite object\r\n *\r\n */\r\n\r\n\r\nclass Sprite {\r\n  constructor(src = {}, scale) {\r\n\r\n    var args = typeof src == 'object' ? src : {};\r\n\r\n    this.handleAnimationArgs(args);\r\n\r\n    this.animations = [];\r\n\r\n    this.sounds = [];\r\n    this.filters = [];\r\n    this.effects = [];\r\n\r\n    this.actions = {};\r\n\r\n    this.layer = 0;\r\n    this.type = 'Sprite';\r\n\r\n    //create size property\r\n    this.size = new Gamelab.Vector(0, 0);\r\n    this.active = true; //defaults to active or visible\r\n    this.ticker = 0;\r\n\r\n    this.scale = scale || 1.0;\r\n\r\n    //apply canvas-src if passed\r\n    this.handleCanvasArgs(src);\r\n\r\n    //apply remaining args\r\n    this.apply_args(args);\r\n\r\n    if (!this.selected_animation)\r\n      this.SingleFrame();\r\n  }\r\n\r\n  then(callback) {\r\n    this.onLoad(function(){\r\n      callback(this);\r\n    });\r\n  }\r\n\r\n  forEachPixel(callback) {\r\n    this.anime.forEachPixel(callback);\r\n  }\r\n\r\n  handleCanvasArgs(src) {\r\n\r\n    var $sprite = this;\r\n\r\n    if (src instanceof HTMLCanvasElement) {\r\n      this.src = src;\r\n      this.selected_animation = new Gamelab.GridAnimation(src);\r\n      this.image = this.selected_animation.image;\r\n\r\n\r\n      this.animations = [];\r\n      this.animations.push(this.selected_animation);\r\n      this.SingleFrame();\r\n    } else if (typeof src == 'string') {\r\n      this.src = src;\r\n\r\n      var srcTail = this.src.split('/').pop();\r\n      //set name to part of file-name, if name falsy\r\n      if (srcTail) {\r\n        this.name = this.name || srcTail.split('.')[0];\r\n      }\r\n\r\n      this.selected_animation = new Gamelab.GridAnimation(src);\r\n      this.image = this.selected_animation.image;\r\n      this.animations = [];\r\n      this.animations.push(this.selected_animation);\r\n\r\n\r\n            this.image.domElement.onerror = function(){\r\n              $sprite.isBroken = true;\r\n            };\r\n\r\n      this.SingleFrame();\r\n    }\r\n  }\r\n\r\n  handleAnimationArgs(args) {\r\n    if (args instanceof Gamelab.GridAnimation) //instantiate from animation\r\n    {\r\n      console.info('args was Gamelab.GridAnimation', args);\r\n      args = {\r\n        selected_animation: args,\r\n        image: args.image,\r\n        size: new Gamelab.Vector(args.frameSize)\r\n      };\r\n    }\r\n  }\r\n\r\n  Origin(o) {\r\n    this.origin = new Gamelab.Vector(o);\r\n    if (this.anime) {\r\n      this.anime.origin = new Gamelab.Vector(o);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  Layer(l) {\r\n    this.layer = l;\r\n    return this;\r\n  }\r\n\r\n  Size(x, y, z) {\r\n    this.size = new Gamelab.Vector(x, y, z);\r\n    if (this.selected_animation && this.selected_animation.frames instanceof Array) {\r\n      this.selected_animation.Size(vector);\r\n    }\r\n    return this.size;\r\n  }\r\n\r\n  static_image_load(img) {\r\n    this.size = new Gamelab.Vector(img.width * this.scale, img.height * this.scale).round();\r\n  }\r\n\r\n  pushColorEffectCanvas(color) {\r\n\r\n    this.effectCanvasList = this.effectCanvasList || [];\r\n\r\n    var canvas = document.createElement('CANVAS');\r\n    var img = this.image.domElement;\r\n\r\n    canvas.width = img.width;\r\n    canvas.height = img.height;\r\n\r\n    var ctx = canvas.getContext('2d');\r\n    ctx.drawImage(img, 0, 0, img.width, img.height);\r\n    ctx.fillStyle = color;\r\n    ctx.globalAlpha = 0.67;\r\n    ctx.globalCompositeOperation = \"source-atop\";\r\n    ctx.fillRect(0, 0, img.width, img.height);\r\n    ctx.globalCompositeOperation = \"source-over\";\r\n    this.effectCanvasList.push(canvas);\r\n    return this;\r\n  }\r\n\r\n  GlobalComposite(g) {\r\n    this.globalCompositeOperation = g;\r\n    return this;\r\n  }\r\n\r\n  ColorEffect(color, opacity = 0.666) {\r\n    this.clearEffects();\r\n    this.effectCanvas = this.effectCanvas || document.createElement('CANVAS');\r\n\r\n    var img = this.image.domElement;\r\n    this.effectCanvas.width = img.width;\r\n    this.effectCanvas.height = img.height;\r\n\r\n    this.effectCtx = this.effectCtx || this.effectCanvas.getContext('2d');\r\n    this.effectCtx.drawImage(img, 0, 0, img.width * this.scale, img.height * this.scale);\r\n\r\n    this.effectCtx.fillStyle = color;\r\n    this.effectCtx.globalAlpha = opacity;\r\n    this.effectCtx.globalCompositeOperation = \"source-atop\";\r\n    this.effectCtx.fillRect(0, 0, img.width, img.height);\r\n    this.effectCtx.globalCompositeOperation = \"source-over\";\r\n    this.data = this.effectCtx.getImageData(0, 0, this.effectCanvas.width, this.effectCanvas.height);\r\n    return this;\r\n  }\r\n\r\n  DrawToCanvas() {\r\n    this.clearEffects();\r\n    this.effectCanvas = this.effectCanvas || document.createElement('CANVAS');\r\n    var img = this.image.domElement;\r\n    this.effectCanvas.width = img.width;\r\n    this.effectCanvas.height = img.height;\r\n    this.effectCtx = this.effectCtx || this.effectCanvas.getContext('2d');\r\n    this.effectCtx.drawImage(img, 0, 0, img.width, img.height);\r\n    this.image.domElement = this.effectCanvas;\r\n    return this;\r\n  }\r\n\r\n  doCanvasEffects() {\r\n\r\n    if (!this.stored) {\r\n      this.clearEffects();\r\n    }\r\n\r\n    this.effectCanvas = this.effectCanvas || document.createElement('CANVAS');\r\n    this.effectCanvasList = this.effectCanvasList || [];\r\n\r\n    var img = this.image.domElement;\r\n\r\n    this.img = img;\r\n    this.effectCanvas.width = img.width;\r\n    this.effectCanvas.height = img.height;\r\n    this.effectCtx = this.effectCtx || this.effectCanvas.getContext('2d');\r\n    this.effectCtx.drawImage(img, 0, 0, img.width, img.height);\r\n\r\n    this.data = this.effectCtx.getImageData(0, 0, this.effectCanvas.width, this.effectCanvas.height);\r\n    this.effectCanvasList.push(this.effectCanvas);\r\n\r\n    this.stored = true;\r\n    this.effectFrames = [];\r\n  }\r\n\r\n  resetEffectFrames() {\r\n    this.effectFrames = [];\r\n    return this;\r\n  }\r\n\r\n  addFilterFrame(api, callback) {\r\n\r\n    this.effectCanvasList = this.effectCanvasList || [];\r\n    this.effectFrames = this.effectFrames || [];\r\n    this.effectCanvasTimer = 0;\r\n\r\n    if (api.timer == 0) {\r\n      //alert('doing effects');\r\n      this.doCanvasEffects();\r\n    }\r\n\r\n    var data = this.effectCtx.getImageData(0, 0, this.effectCanvas.width, this.effectCanvas.height);\r\n    api.next(data);\r\n    this.effectFrames.push(data);\r\n    //    console.log('added effect data');\r\n  }\r\n\r\n  DoubleBackFilterFrames() {\r\n    this.effectFrames = this.effectFrames.concat(this.effectFrames.slice().reverse());\r\n    return;\r\n  }\r\n\r\n  addImageFrame(image, callback) {\r\n    this.effectCanvasTimer = 0;\r\n    this.effectCanvas.width = this.size.x;\r\n    this.effectCanvas.height = this.size.y;\r\n    this.effectCtx.drawImage(image, 0, 0, this.size.x, this.size.y);\r\n    var data = this.effectCtx.getImageData(0, 0, this.effectCanvas.width, this.effectCanvas.height);\r\n    console.info('effect', data);\r\n    this.effectFrames.push(data);\r\n    console.log('added effect data');\r\n  }\r\n\r\n  clearEffects() {\r\n    if (this.effectCanvas && this.effectCtx)\r\n      this.effectCtx.clearRect(0, 0, this.effectCanvas.width, this.effectCanvas.height);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * runs a function for the onload event of this sprite's image\r\n   *\r\n   * @function\r\n   * @param {Function} f the function to be called on load\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  onLoad(f) {\r\n\r\n    if (this.src instanceof HTMLCanvasElement) {\r\n      var f = f || function() {};\r\n      f.bind(this).call(false);\r\n    }\r\n\r\n    if (this.image && this.image.domElement) {\r\n      var img = this.image.domElement,\r\n        load = img.onload;\r\n      f = f || function() {};\r\n      f.bind(this);\r\n      this.load_call = f;\r\n      var $sprite = this;\r\n      img.onload = function() {\r\n\r\n        $sprite.load_total += 1;\r\n\r\n        load.bind($sprite).call(false, $sprite);\r\n        //  $sprite.static_image_load(img);\r\n        $sprite.load_call(false, $sprite);\r\n      };\r\n\r\n      img.onerror = function(err) {\r\n        $sprite.isBroken = true;\r\n        $sprite.load_call(true, $sprite);\r\n      }\r\n    } else if (this.anime && this.anime.frames instanceof Array) {\r\n      this.load_call = f;\r\n      f.bind(this).call();\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  Opacity(o) {\r\n\r\n    this.opacity = o;\r\n    return this;\r\n  }\r\n\r\n  /**********\r\n   * @ignore\r\n   **********/\r\n\r\n  apply_args(args = {}) {\r\n\r\n    this.FromData(args, true); //Using a FUNCTIONAL COPY --heavy to process\r\n\r\n    function array_instance(list) {\r\n      return list.slice(0);\r\n    };\r\n\r\n    var $sprite = this;\r\n\r\n    if (args.image instanceof Gamelab.GameImage && !this.image) {\r\n      this.image = args.image;\r\n      this.image.domElement.onerror = function(){\r\n          $sprite.sourceError();\r\n      }\r\n    }\r\n\r\n    if (typeof args.name == 'string')\r\n      this.name = args.name;\r\n\r\n    //life is either provided or assumed to be approx 4 seconds\r\n    this.life = args.life || 4000 / 50;\r\n    this.description = args.description || \"__spriteDesc\";\r\n    this.opacity = args.opacity || 1.0;\r\n    this.color = args.color || '#ffffff';\r\n\r\n\r\n    /**\r\n     * @property {String} id the unique identifier of the Sprite --called automatically on constructor.\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n    this.id = this.create_id();\r\n\r\n    /**\r\n     * @property {Array} animations the array of animations attached to the Sprite\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n    var listnames = ['animations', 'bones', 'meshes', 'scripts', 'events', 'sounds'];\r\n\r\n    var $object = this;\r\n\r\n    listnames.forEach(function(ln) {\r\n\r\n      $object[ln] = array_instance(Gamelab.getArg(args, ln, []));\r\n\r\n    });\r\n\r\n\r\n    /**\r\n     * @property {Array} scripts the array of scripts attached to the Sprite\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n    this.motions = Gamelab.getArg(args, 'motions', []);\r\n    this.particles = Gamelab.getArg(args, 'particles', []);\r\n    this.shots = Gamelab.getArg(args, 'shots', []);\r\n    this.init_ext = Gamelab.getArg(args, 'init_ext', []);\r\n    this.group = Gamelab.getArg(args, 'group', 'one');\r\n    this.scrollFactor = args.scrollFactor || 1.0;\r\n    this.noScroll = args.noScroll || false;\r\n\r\n    if (this.noScroll) {\r\n      this.scrollFactor = 0;\r\n    }\r\n\r\n\r\n    /**\r\n     * @property {Vector} speed the speed of the Sprite\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n    this.speed = new Gamelab.Vector(Gamelab.getArg(args, 'speed', new Gamelab.Vector(0, 0)));\r\n\r\n    /**\r\n     * @property {Vector} size the vector-size of the Sprite\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n    this.size = new Gamelab.Vector(Gamelab.getArg(args, 'size', new Gamelab.Vector(0, 0)));\r\n\r\n\r\n    /**\r\n     * @property {Vector} position the position of the Sprite\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n    this.position = new Gamelab.Vector(Gamelab.getArg(args, 'position', new Gamelab.Vector(0, 0, 0)));\r\n    this.realPosition = new Gamelab.Vector(Gamelab.getArg(args, 'realPosition', new Gamelab.Vector(0, 0, 0)));\r\n    this.collision_bounds = Gamelab.getArg(args, 'collision_bounds', new Gamelab.VectorBounds(new Gamelab.Vector(0, 0, 0), new Gamelab.Vector(0, 0, 0)));\r\n\r\n\r\n    this.GROUNDED = false;\r\n\r\n    /**\r\n     *\r\n     *\r\n     * @property {Vector} rotation the rotation of the Sprite\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n    this.rotation = new Gamelab.Vector(Gamelab.getArg(args, 'rotation', new Gamelab.Vector(0, 0, 0)));\r\n\r\n\r\n    /**\r\n     * @property {number} scale the scale of the Sprite, controls draw-size\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n    this.scale = args.scale || 1.0;\r\n    this.acceleration = Gamelab.getArg(args, 'acceleration', new Gamelab.Vector(0, 0, 0));\r\n    this.rot_speed = new Gamelab.Vector(Gamelab.getArg(args, 'rot_speed', new Gamelab.Vector(0, 0)));\r\n    this.rot_accel = new Gamelab.Vector(Gamelab.getArg(args, 'rot_accel', new Gamelab.Vector(0, 0)));\r\n    this.padding = Gamelab.getArg(args, 'padding', new Gamelab.Vector(0, 0, 0));\r\n\r\n\r\n    var __inst = this;\r\n\r\n    //Apply / instantiate Sound(), Gamelab.Motion(), and Gamelab.GridAnimation() args...\r\n\r\n\r\n    Gamelab.each(this.sounds, function(ix, item) {\r\n      __inst.sounds[ix] = new Gamelab.Sound(item);\r\n    });\r\n\r\n    Gamelab.each(this.animations, function(ix, item) {\r\n      __inst.animations[ix] = new Gamelab.GridAnimation(item);\r\n    });\r\n\r\n    //Apply initializers:\r\n\r\n    Gamelab.each(this.init_ext, function(ix, item) {\r\n      __inst.addInitializer(item);\r\n    });\r\n\r\n    if (!this.selected_animation && args.selected_animation) {\r\n\r\n      //console.dev('applying animation:' + jstr(args.selected_animation));\r\n      this.selected_animation = new Gamelab.GridAnimation(args.selected_animation);\r\n\r\n      this.animations = [];\r\n      if (this.animations.indexOf(this.selected_animation) == -1)\r\n        this.animations.push(this.selected_animation);\r\n    }\r\n  }\r\n\r\n  RealPosition() {\r\n    return this.realPosition;\r\n  }\r\n\r\n  Origin(x, y) {\r\n    this.origin = new Gamelab.Vector(x, y);\r\n    var sprite = this;\r\n    this.animations.forEach(function($anime) {\r\n      $anime.Origin(sprite.origin);\r\n    });\r\n  }\r\n\r\n\r\n  /**\r\n   * Clones a sprite from existing data\r\n   *\r\n   * @function\r\n   * @param {Object} object the data to be cloned\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  Clone(sprite) {\r\n    var clone = new sprite.constructor(sprite.src);\r\n    clone.Anime(new sprite.anime.constructor(sprite.anime));\r\n    clone.apply_args(sprite);\r\n    return clone;\r\n  }\r\n\r\n  draw(ctx, camera) {\r\n\r\n    if(this.isBroken && !this.hasError)\r\n    {\r\n      var $sprite = this;\r\n      this.errorTimer = 0;\r\n      window.setInterval(function(){\r\n\r\n          $sprite.errorTimer += 1;\r\n\r\n          if($sprite.errorTimer % 300 == 0)\r\n          {\r\n            console.error('The html-image is broken for sprite:' + $sprite.name);\r\n          }\r\n\r\n      });\r\n    }\r\n\r\n    if(this.isBroken)\r\n    {\r\n      return;\r\n    }\r\n\r\n    var sprite;\r\n\r\n    if (this.constructor.name == 'SpriteBrush') {\r\n      sprite = this.selected_sprite;\r\n    } else {\r\n      sprite = this;\r\n    }\r\n\r\n    camera = camera || false;\r\n\r\n    if (!camera && Gamelab.game_windows[0] && Gamelab.game_windows[0].camera)\r\n      camera = Gamelab.game_windows[0].camera;\r\n\r\n    else if (!camera) {\r\n      camera = {\r\n        position: new Gamelab.Vector(0, 0, 0)\r\n      };\r\n    }\r\n\r\n    if (sprite.invisible)\r\n      return;\r\n\r\n    if (sprite.active && (this.DRAWOFFSCREEN || sprite.onScreen(Gamelab.WIDTH, Gamelab.HEIGHT))) {\r\n      this.draw_current_frame(ctx, camera);\r\n    }\r\n  }\r\n\r\n  setSoleUpdate(callback) {\r\n    this.update = function() {\r\n      callback.bind(this).call();\r\n    };\r\n  }\r\n\r\n  onCollision(object, callback) {\r\n    this.onUpdate(function() {\r\n      var collisions = Gamelab.Collision.spriteBoxCollideArray([this], object);\r\n      collisions.forEach(function(c) {\r\n        callback(c.object, c.collider);\r\n      });\r\n    });\r\n  }\r\n\r\n\r\n\r\n  onListCollision(object, callback) {\r\n    this.onUpdate(function() {\r\n      callback(Gamelab.Collision.spriteCollideArray([this], object));\r\n    });\r\n  }\r\n\r\n\r\n    /*****************************\r\n     *  accel\r\n     *  -accelerate any acceleration -key\r\n     ***************************/\r\n\r\n\r\n    /**\r\n     * decelerate speed on the x-Axis, toward zero\r\n     * @function\r\n     * @memberof Sprite\r\n     * @param {number} amt the increment of deceleration, negatives ignored\r\n     *\r\n     **********/\r\n\r\n    decelY(amt) {\r\n\r\n      amt = Math.abs(amt);\r\n\r\n      if (Math.abs(this.speed.y) <= amt) {\r\n        this.speed.y = 0;\r\n\r\n      } else if (this.speed.y > amt) {\r\n\r\n        this.speed.y -= amt;\r\n      } else if (this.speed.y < amt * -1) {\r\n\r\n        this.speed.y += amt;\r\n      }\r\n\r\n    }\r\n\r\n    /*****************************\r\n     *  decelX\r\n     *  -decelerate on the X axis\r\n     *  -args: 1 float:amt\r\n     ***************************/\r\n\r\n\r\n    /**\r\n     * decelerate speed on the x-Axis, toward zero\r\n     * @function\r\n     * @memberof Sprite\r\n     * @param {number} amt the increment of deceleration, negatives ignored\r\n     *\r\n     **********/\r\n\r\n    decelX(amt) {\r\n\r\n      amt = Math.abs(amt);\r\n\r\n\r\n      if (this.speed.x > amt) {\r\n\r\n        this.speed.x -= amt;\r\n      } else if (this.speed.x < amt * -1) {\r\n\r\n        this.speed.x += amt;\r\n      }\r\n\r\n      if (Math.abs(this.speed.x) <= amt) {\r\n\r\n        this.speed.x = 0;\r\n\r\n      }\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * decelerate rspeed on the x-Axis, toward zero\r\n     * @function\r\n     * @memberof Sprite\r\n     * @param {number} amt the increment of deceleration, negatives ignored\r\n     *\r\n     **********/\r\n\r\n  /**\r\n   * accelerate toward a max value on any object-property\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Object} prop The object to control\r\n   * @param {string} key the target property-key for object argument\r\n   * @param {number} accel the additive increase to the property on each call\r\n   * @param {number} max the max value to accelerate towards\r\n   **********/\r\n\r\n  accel(object, key, accel, max) {\r\n\r\n    var prop = object;\r\n\r\n    accel = Math.abs(accel);\r\n\r\n    if (typeof(max) == 'number') {\r\n      max = {\r\n        x: max\r\n      };\r\n    }\r\n\r\n    let speed = prop[key];\r\n\r\n    // this.assertSpeed();\r\n\r\n    let diff = max.x - prop[key];\r\n\r\n    if (diff > 0) {\r\n      prop[key] += Math.abs(diff) >= accel ? accel : diff;\r\n\r\n    };\r\n\r\n    if (diff < 0) {\r\n      prop[key] -= Math.abs(diff) >= accel ? accel : diff;\r\n\r\n    };\r\n\r\n  }\r\n\r\n\r\n  /*****************************\r\n   *  decel\r\n   *  -deceleration -key\r\n   ***************************/\r\n\r\n  /**\r\n   * decelerate toward a max value on any object-property\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Object} prop the object to control\r\n   * @param {string} key the property-key for targeted property of prop argument\r\n   *\r\n   * @param {number} decel the increment of deceleration\r\n   *\r\n   * @param {number} max the max value to decelerate towards\r\n   *\r\n   *\r\n   **********/\r\n\r\n  decel(prop, key, rate) {\r\n\r\n    if (typeof(rate) == 'object') {\r\n\r\n      rate = rate.rate;\r\n\r\n    }\r\n\r\n    rate = Math.abs(rate);\r\n\r\n    if (Math.abs(prop[key]) <= rate) {\r\n      prop[key] = 0;\r\n    } else if (prop[key] > 0) {\r\n      prop[key] -= rate;\r\n\r\n    } else if (prop[key] < 0) {\r\n      prop[key] += rate;\r\n\r\n    } else {\r\n\r\n      prop[key] = 0;\r\n\r\n    }\r\n  }\r\n\r\n\r\n  /*****************************\r\n   *  accelY\r\n   *  -accelerate on Y-Axis with 'accel' and 'max' (speed) arguments\r\n   *  -example-use: gravitation of sprite || up / down movement\r\n   ***************************/\r\n\r\n  /**\r\n   * accelerate speed on the y-axis\r\n   *\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {number} accel the increment of acceleration\r\n   * @param {number} max the maximum for speed\r\n   *\r\n   **********/\r\n\r\n  accelY(accel, max) {\r\n\r\n    accel = Math.abs(accel);\r\n\r\n    if (typeof(max) == 'number') {\r\n      max = {\r\n        y: max\r\n      };\r\n\r\n    }\r\n\r\n    this.assertSpeed();\r\n\r\n    let diff = max.y - this.speed.y;\r\n\r\n    if (diff > 0) {\r\n      this.speed.y += Math.abs(diff) >= accel ? accel : diff;\r\n\r\n    };\r\n\r\n    if (diff < 0) {\r\n      this.speed.y -= Math.abs(diff) >= accel ? accel : diff;\r\n\r\n    };\r\n\r\n  }\r\n\r\n  /*****************************\r\n   *  accelX\r\n   *  -accelerate on x-Axis\r\n   *  -example-use: running of sprite || left / right movement\r\n   ***************************/\r\n\r\n\r\n  /**\r\n   * accelerate speed on the x-Axis\r\n   *\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {number} accel the increment of acceleration\r\n   * @param {number} max the maximum for speed\r\n   *\r\n   **********/\r\n\r\n\r\n  accelX(accel, max) {\r\n\r\n    accel = Math.abs(accel);\r\n\r\n    if (typeof(max) == 'number') {\r\n      max = {\r\n        x: max\r\n      };\r\n\r\n    }\r\n\r\n    this.assertSpeed();\r\n\r\n    let diff = max.x - this.speed.x;\r\n\r\n    if (diff > 0) {\r\n      this.speed.x += Math.abs(diff) >= accel ? accel : diff;\r\n\r\n    };\r\n\r\n    if (diff < 0) {\r\n      this.speed.x -= Math.abs(diff) >= accel ? accel : diff;\r\n\r\n    };\r\n\r\n  }\r\n\r\n\r\n\r\n  draw_current_frame(ctx, camera) {\r\n\r\n    var sprite;\r\n\r\n    if(this.isBroken)\r\n    {\r\n      return;\r\n    }\r\n\r\n    if (this.constructor.name == 'SpriteBrush') {\r\n      sprite = this.selected_sprite;\r\n    } else {\r\n      sprite = this;\r\n    }\r\n\r\n    var frame = false,\r\n      frameList = [];\r\n\r\n    if (this.effectCanvas) {\r\n      this.size = new Gamelab.Vector(this.effectCanvas.width * this.scale, this.effectCanvas.height * this.scale),\r\n        this.Origin(this.size.div(2.0));\r\n\r\n      console.log('drawing effect canvas');\r\n\r\n      let imageFrameArgs = {\r\n        image: this.effectCanvas,\r\n        framePos: new Gamelab.Vector(0, 0),\r\n        frameSize: this.size,\r\n        position: new Gamelab.Vector2D(Math.round(this.position.x + (this.origin.x)), Math.round(this.position.y + (this.origin.y))),\r\n        size: this.size,\r\n        rotation: this.rotation.x,\r\n        canvasContext: ctx,\r\n        flipX: this.flipX,\r\n        flipY: this.flipY,\r\n        origin: this.origin,\r\n        globalAlpha: this.opacity,\r\n        globalComposite: this.globalCompositeOperation || false\r\n      };\r\n\r\n      return Gamelab.Canvas.draw_image_frame(imageFrameArgs);\r\n    }\r\n\r\n    if (sprite.active) {\r\n\r\n      if (sprite.selected_animation instanceof Array && sprite.selected_animation.length >= 1) {\r\n        sprite.selected_animation.forEach(function(anime) {\r\n          frameList.push(anime.selected_frame);\r\n        });\r\n      }\r\n\r\n      if (sprite.selected_animation instanceof Object && sprite.selected_animation.hasOwnProperty('selected_frame')) {\r\n        frame = sprite.selected_animation.selected_frame;\r\n      }\r\n\r\n      var p = sprite.position;\r\n\r\n      var camera_pos = camera.position || {\r\n        x: 0,\r\n        y: 0,\r\n        z: 0\r\n      };\r\n\r\n      if (!sprite.hasOwnProperty('scrollFactor')) {\r\n        sprite.scrollFactor = 1.0;\r\n      }\r\n\r\n      var x = p.x,\r\n        y = p.y,\r\n        scrollFactor = sprite.scrollFactor >= -1.0 && sprite.scrollFactor <= 1.0 ? sprite.scrollFactor : 1.0;\r\n\r\n      if (sprite.noScroll) {\r\n        scrollFactor = 0;\r\n      }\r\n\r\n\r\n      //optional animation : gameSize\r\n\r\n      var targetSize = sprite.size || sprite.selected_animation.size;\r\n\r\n      var realWidth = targetSize.x;\r\n      var realHeight = targetSize.y;\r\n\r\n\r\n      var origin = sprite.origin || new Gamelab.Vector(realWidth / 2, realHeight / 2);\r\n\r\n      //optional animation : offset\r\n\r\n      var rotation;\r\n\r\n      if (typeof(sprite.rotation) == 'object') {\r\n        rotation = sprite.rotation.x;\r\n\r\n      } else {\r\n        rotation = sprite.rotation;\r\n      }\r\n\r\n\r\n      if (this.image && this.image.domElement instanceof HTMLCanvasElement) {\r\n        var x = this.position.x,\r\n          y = this.position.y;\r\n\r\n        x -= camera_pos.x * scrollFactor || 0;\r\n        y -= camera_pos.y * scrollFactor || 0;\r\n        //  console.log('sprite:: canvas draw!! ');\r\n\r\n        let imageFrameArgs = {\r\n          image: this.image.domElement,\r\n          framePos: new Gamelab.Vector(0, 0),\r\n          frameSize: this.size,\r\n          position: new Gamelab.Vector2D(Math.round(x + (origin.x)), Math.round(y + (origin.y))),\r\n          size: new Gamelab.Vector2D(realWidth, realHeight),\r\n          rotation: rotation % 360,\r\n          canvasContext: ctx,\r\n          flipX: sprite.flipX,\r\n          flipY: sprite.flipY,\r\n          origin: origin,\r\n          globalAlpha: this.opacity,\r\n          globalComposite: this.globalCompositeOperation || false\r\n        };\r\n\r\n        return Gamelab.Canvas.draw_image_frame(imageFrameArgs);\r\n\r\n      }\r\n\r\n\r\n      if (!(sprite.selected_animation && sprite.selected_animation.selected_frame)) {\r\n        return;\r\n      }\r\n\r\n      var frame = sprite.selected_animation.selected_frame;\r\n\r\n      if (frame && frame.image && frame.image.data) {\r\n\r\n        ctx.putImageData(frame.image.data, x, y, 0, 0, sprite.size.x, sprite.size.y);\r\n\r\n      } else {\r\n\r\n        if (frameList.length >= 1) {\r\n\r\n          frameList.forEach(function(frame) {\r\n\r\n            var realWidth = frame.size.x;\r\n            var realHeight = frame.size.y;\r\n\r\n            var xpos = frame.position.x,\r\n              ypos = frame.position.y;\r\n\r\n            x += sprite.position.x;\r\n            y += sprite.position.y;\r\n\r\n            x -= camera_pos.x * scrollFactor || 0;\r\n            y -= camera_pos.y * scrollFactor || 0;\r\n\r\n            sprite.realPosition = new Gamelab.Vector(x, y);\r\n\r\n            if (frame.rotation && typeof frame.rotation.x == 'number') {\r\n              rotation = frame.rotation.x;\r\n            }\r\n\r\n            if (frame.origin) {\r\n              origin = frame.origin;\r\n              //console.log('drawing with origin:' + origin.x + ':' + origin.y);\r\n            }\r\n\r\n            if (frame && frame.image) {\r\n              let imageFrameArgs = {\r\n                image: sprite.effectCanvas ? sprite.effectCanvas : frame.image.domElement,\r\n                framePos: frame.framePos,\r\n                frameSize: frame.frameSize,\r\n                position: new Gamelab.Vector2D(Math.round(xpos + (origin.x)), Math.round(ypos + (origin.y))),\r\n                size: new Gamelab.Vector2D(realWidth, realHeight),\r\n                rotation: rotation % 360,\r\n                canvasContext: ctx,\r\n                flipX: sprite.flipX,\r\n                flipY: sprite.flipY,\r\n                origin: origin,\r\n                globalAlpha: this.opacity,\r\n                globalComposite: this.globalCompositeOperation || false\r\n              };\r\n\r\n              return Gamelab.Canvas.draw_image_frame(imageFrameArgs);\r\n            }\r\n\r\n          });\r\n\r\n        } else {\r\n          var fx = frame.position.x,\r\n            fy = frame.position.y,\r\n            pos = new Gamelab.Vector(x + fx, y + fy);\r\n\r\n          pos.x -= camera_pos.x * scrollFactor || 0;\r\n          pos.y -= camera_pos.y * scrollFactor || 0;\r\n          sprite.realPosition = pos;\r\n          if (frame.image.domElement instanceof HTMLImageElement || frame.image.domElement instanceof HTMLCanvasElement) {\r\n\r\n            let imageFrameArgs = {\r\n              image: this.effectCanvas ? this.effectCanvas : frame.image.domElement,\r\n              framePos: frame.framePos,\r\n              frameSize: frame.frameSize,\r\n              position: new Gamelab.Vector2D(Math.round(pos.x + (origin.x)), Math.round(pos.y + (origin.y))),\r\n              size: new Gamelab.Vector2D(realWidth, realHeight),\r\n              rotation: rotation % 360,\r\n              canvasContext: ctx,\r\n              flipX: sprite.flipX,\r\n              flipY: sprite.flipY,\r\n              origin: origin,\r\n              globalAlpha: this.opacity,\r\n              globalComposite: this.globalCompositeOperation || false\r\n            };\r\n\r\n            return Gamelab.Canvas.draw_image_frame(imageFrameArgs);\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * adds an animation to the sprites\r\n   *\r\n   * @function\r\n   * @param {Object} object the animation to be added\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n\r\n  Add(object) {\r\n\r\n    if (object instanceof Gamelab.GridAnimation) {\r\n      this.animations.add(object);\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  get animation() {\r\n    return this.selected_animation;\r\n  }\r\n\r\n  get anime() {\r\n    return this.selected_animation;\r\n  }\r\n\r\n  Anime(anime) {\r\n    if (anime)\r\n      this.selected_animation = anime;\r\n    return this;\r\n  }\r\n\r\n\r\n  Animation(anime) {\r\n    if (anime)\r\n      this.selected_animation = anime;\r\n    return this;\r\n  }\r\n\r\n\r\n  FromData(data = {}, fxlCopy = false) {\r\n    for (var x in data) {\r\n      if (fxlCopy || typeof(data[x]) !== 'function')\r\n        this[x] = data[x];\r\n    }\r\n\r\n    if (data.update) {\r\n      this.update = data.update;\r\n    }\r\n    return this;\r\n  }\r\n\r\n  FromSourceImage(src) {\r\n    return new this.constructor(src);\r\n  }\r\n\r\n  /**************************************************************\r\n   * scales the sprite.size property according to image-size.\r\n   * @param {number} scaleFloat a 0-1+ value\r\n   *\r\n   * @function\r\n   * @memberof Sprite\r\n   **************************************************************/\r\n\r\n  Scale(scaleFloat, frameSize = {}) {\r\n\r\n    this.scale = scaleFloat;\r\n\r\n    if (this.anime && this.anime.frameSize && this.anime.frameSize.above_zero_xy()) {\r\n      frameSize = this.anime.frameSize;\r\n    }\r\n\r\n    var size_x = frameSize.x || this.image.domElement.width,\r\n      size_y = frameSize.y || this.image.domElement.height;\r\n\r\n    var size = new Gamelab.Vector(size_x * scaleFloat, size_y * scaleFloat);\r\n\r\n\r\n    if (!this.size || isNaN(this.size.x) || isNaN(this.size.y))\r\n      this.size = new Gamelab.Vector(0, 0);\r\n\r\n\r\n    var diffpos = size.sub(this.size).half();\r\n\r\n    this.position.x -= diffpos.x;\r\n    this.position.y -= diffpos.y;\r\n    this.size = size;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**************************************************************\r\n   * applies a float value arg to Sprite.scrollFactor\r\n   * @param {number} s a 0-1+ value\r\n   *\r\n   * @function\r\n   * @memberof Sprite\r\n   **************************************************************/\r\n\r\n\r\n  ScrollFactor(s) {\r\n    this.scrollFactor = s;\r\n    return this;\r\n  }\r\n\r\n  engage(obj) //engages an object having an engage function\r\n  {\r\n    obj.parent = this;\r\n    if (obj.engage) {\r\n      obj.engage();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * pass argument v to the sprite.life property.\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {number} v number of render-updates that this Sprite will last. --update occurs 60+ times per second, or less, depending on performance\r\n   * @returns {Sprite} the sprite object --enables chainable function calls\r\n   **********/\r\n\r\n  Life(v) {\r\n    this.life = v;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * initializes sprites. triggers all functions previously passed to the addInitializer function.\r\n   * Use this function when a sprite, instantiated from json-data, carries initializers.\r\n   * --This feature is built for the purpose of data-persistence. --sprites from json-file may carry behaviors onto the scene.\r\n   *\r\n   * @function\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  init() {\r\n\r\n\r\n  }\r\n\r\n  /**\r\n   * extends the init function.\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {function} fun the function to be passed into the init function of the sprite\r\n   **********/\r\n\r\n  addInitializer(fun) {\r\n\r\n    if (!(typeof fun == 'function'))\r\n      return;\r\n\r\n    let boundFun = fun.bind(this)\r\n    if (this.init_ext.indexOf(boundFun) < 0) {\r\n      this.init_ext.push(boundFun)\r\n    };\r\n  }\r\n\r\n  /*****************************\r\n   * Getters\r\n   ***************************/\r\n\r\n  /**\r\n   * returns the 'id' property of the sprite\r\n   * @function\r\n   * @memberof Sprite\r\n   * @returns {string}\r\n   **********/\r\n\r\n  get_id() {\r\n    return this.id;\r\n  }\r\n\r\n  /**********\r\n   * @ignore\r\n   **********/\r\n\r\n  to_map_object(size, framesize) {\r\n\r\n    this.__mapSize = new Gamelab.Vector(size || this.size);\r\n\r\n    this.frameSize = new Gamelab.Vector(framesize || this.size);\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n  /*****************************\r\n   * Setters and Creators\r\n   ***************************/\r\n\r\n  /**\r\n   * creates a unique string id property for the sprite.\r\n   * @function\r\n   * @memberof Sprite\r\n   * @returns {string}\r\n   **********/\r\n\r\n  create_id() {\r\n\r\n    return Gamelab.create_id();\r\n\r\n  }\r\n\r\n  /**\r\n   * returns a maximum scaled size, according to max dimensions of width and height\r\n   * @param {number} mx the maximum size.x for the returned size\r\n   * @param {number} my the maximum size.y for the returned size\r\n   * @function\r\n   * @memberof Sprite\r\n   * @returns {Vector} a vector of x,y,z? values\r\n   **********/\r\n\r\n  getSizeByMax(mx, my) {\r\n\r\n    var size = new Gamelab.Vector(this.size);\r\n    var wth = size.y / size.x;\r\n    var htw = size.x / size.y;\r\n\r\n    if (size.x > mx) {\r\n      size.x = mx;\r\n      size.y = size.x * wth;\r\n    }\r\n\r\n    if (size.y > my) {\r\n      size.y = my;\r\n      size.x = size.y * htw;\r\n    }\r\n\r\n    return size;\r\n  }\r\n\r\n  /*****************************\r\n   *  assert the existence of a speed{} property\r\n   *  sprite.speed (vector) is created if not existing in sprite\r\n   *  @memberof Sprite\r\n   ***************************/\r\n\r\n  assertSpeed() {\r\n    if (!this.speed) {\r\n      this.speed = new Gamelab.Vector(0, 0, 0);\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * set the 'selected_animation' property to a single-frame-animation\r\n   * @function\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  SingleFrame() {\r\n\r\n    if (!this.image || !this.image.domElement) {\r\n      return this;\r\n    }\r\n\r\n    var __inst = this,\r\n      load = this.image.domElement.onload || function() {};\r\n\r\n    if (this.size && this.size.x !== 0 && this.size.y !== 0)\r\n      return;\r\n\r\n    var _obj = this;\r\n\r\n    if (this.image.domElement instanceof HTMLCanvasElement) {\r\n      if (_obj.size && _obj.size.x !== 0 && _obj.size.y !== 0) {\r\n\r\n      } else {\r\n        __inst.size = new Gamelab.Vector(__inst.image.domElement.width, __inst.image.domElement.height);\r\n        __inst.selected_animation = new Gamelab.GridAnimation(this.image.domElement).FrameSize(__inst.size);\r\n        __inst.animations = [];\r\n        __inst.animations.push(__inst.selected_animation);\r\n        __inst.Scale(__inst.scale || 1.0);\r\n      }\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    this.image.domElement.onerror = function(){\r\n      _obj.isBroken = true;\r\n    };\r\n\r\n    this.image.domElement.onload = function() {\r\n\r\n      load(false, __inst);\r\n\r\n      if (_obj.size && _obj.size.x !== 0 && _obj.size.y !== 0) {\r\n\r\n      } else {\r\n        __inst.size = new Gamelab.Vector(__inst.image.domElement.width, __inst.image.domElement.height);\r\n        __inst.selected_animation = new Gamelab.GridAnimation(__inst.image).FrameSize(__inst.size);\r\n        __inst.animations = [];\r\n        __inst.animations.push(__inst.selected_animation);\r\n        __inst.Scale(__inst.scale || 1.0);\r\n      }\r\n    };\r\n\r\n    Gamelab.log('set single-frame animation');\r\n    return this;\r\n  }\r\n\r\n\r\n  /**\r\n   * set the 'life' property to a specified integer\r\n   * @function\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  LifeSpan(value) {\r\n    this.life = value;\r\n  }\r\n\r\n  /**\r\n   * set the 'life' property to a specified integer\r\n   * @function\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  Life(value) //same as LifeSpan\r\n  {\r\n    this.life = value;\r\n  }\r\n\r\n  /**\r\n   * tells if sprite has been taken out of game\r\n   * @function\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  isDead(gw) {\r\n    gw = gw || Gamelab.game_windows[0];\r\n    return this.hasOwnProperty('life') && this.life <= 0;\r\n  }\r\n\r\n  /**\r\n   * sets life to 0, then ending the sprite\r\n   * @function\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  die(gw) {\r\n    this.life = 0;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * indicates if any portion of the sprite is within screen bounds --uses Gamelab.WIDTH, Gamelab.HEIGHT OR any w,h arguments passed to this method\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {number} w optional screen-width argument, defaults to Gamelab.WIDTH\r\n   * @param {number} h optional screen-height argument, defaults to Gamelab.HEIGHT\r\n   * @returns {boolean} a true or false value to show if any part of the sprite is on-screen\r\n   **********/\r\n\r\n  onScreen(w, h, gw) {\r\n\r\n    w = w || Gamelab.WIDTH;\r\n    h = h || Gamelab.HEIGHT;\r\n    gw = gw || Gamelab.game_windows[0];\r\n\r\n    var camera = gw && gw.camera ? gw.camera : Gamelab && Gamelab.camera ? Gamelab.camera : {\r\n        position: new Gamelab.Vector(0, 0, 0)\r\n      },\r\n      scrollFactor = this.noScroll ? 0 : this.scrollFactor;\r\n\r\n    var sprite = this,\r\n      p = sprite.position,\r\n      camera_pos = camera.position || {\r\n        x: 0,\r\n        y: 0,\r\n        z: 0\r\n      };\r\n\r\n    if (!sprite.hasOwnProperty('scrollFactor')) {\r\n      sprite.scrollFactor = 1.0;\r\n    }\r\n\r\n    var x = p.x,\r\n      y = p.y,\r\n      scrollFactor = sprite.scrollFactor >= -1.0 && sprite.scrollFactor <= 1.0 ? sprite.scrollFactor : 1.0;\r\n\r\n    if (sprite.noScroll) {\r\n      scrollFactor = 0;\r\n    }\r\n\r\n    x -= camera_pos.x * scrollFactor || 0;\r\n    y -= camera_pos.y * scrollFactor || 0;\r\n\r\n    return x + sprite.size.x > -1000 - w && x < w + 1000 &&\r\n      y + sprite.size.y > -1000 - h && y < h + 1000;\r\n  }\r\n\r\n  /*****************************\r\n   * Updates\r\n   ***************************/\r\n\r\n  /*****************************\r\n   * update()\r\n   * -starts empty:: is applied recursively by Gamelab.js as the main sprite-update\r\n   ***************************/\r\n\r\n  /**\r\n   * the main update for the sprite --applied recursively by GameWindow\r\n   * @function\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  update(sprite) {}\r\n\r\n\r\n  updateBySpeed() {\r\n    this.position.x += this.speed.x;\r\n    this.position.y += this.speed.y;\r\n  }\r\n\r\n\r\n  /**\r\n   * addAction\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {name} name the name of the action\r\n   * @param {options} options the object of options\r\n   * @param {caller} caller the caller function\r\n   * @param {name} name the name of the action\r\n   **********/\r\n\r\n   addAction (name, options, caller) {\r\n\r\n     if (typeof options == 'function') {\r\n       caller = options;\r\n       options = undefined;\r\n     }\r\n\r\n     var actionObject;\r\n\r\n     if (typeof name == 'object' && name.constructor.name == 'Action') {\r\n       actionObject = name;\r\n     } else {\r\n\r\n       actionObject = new StateAction().Name(name).Options(options).Call(caller);\r\n\r\n     }\r\n\r\n     actionObject.Parent(this);\r\n\r\n     this.actions[name] = actionObject;\r\n\r\n   }\r\n\r\n   /**\r\n    * callAction\r\n    * @function\r\n    * @memberof Sprite\r\n    * @param {name} name the name of the action\r\n    **********/\r\n\r\n   callAction (name) {\r\n\r\n     //look for an action.function() by this name\r\n     //or object with engage() function:\r\n     //(allows props to be attached to the parent object)\r\n\r\n     if (this.actions[name] && typeof this.actions[name] == 'function') {\r\n       this.actions[name]();\r\n     } else if (this.actions[name] && typeof this.actions[name] == 'object' &&\r\n       typeof this.actions[name].commit == 'function') {\r\n\r\n\r\n       this.actions[name].commit();\r\n\r\n     }\r\n\r\n   }\r\n\r\n  /*****************************\r\n   *  onUpdate(fun)\r\n   * -args: 1 function(sprite){ } //the self-instance/sprite is passed into the function()\r\n   * -overrides and maintains existing code for update(){} function\r\n   ***************************/\r\n\r\n\r\n  /**\r\n   * extends the update of this sprite with a new function to be called during the update\r\n   * --repeated calls will extend, (not replace) the update --Allows multiple extensions of the update\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {function} fun the function to be appended to sprite.update\r\n   *\r\n   *  * @example\r\n   * // extend the behavior of your sprite\r\n   * mySprite.onUpdate(function(spr)\r\n   *\r\n   *                    console.log('extended update'); //runs automatically whenever sprite.update runs\r\n   *\r\n   *                   });\r\n   *\r\n   **********/\r\n\r\n\r\n  onUpdate(fun) {\r\n\r\n    fun = fun.bind(this);\r\n\r\n    let update = this.update.bind(this);\r\n\r\n    let __inst = this;\r\n\r\n    this.update = function(__inst) {\r\n\r\n      update(__inst);\r\n\r\n      fun(__inst);\r\n\r\n    };\r\n  }\r\n\r\n  /*****************************\r\n   *  travelLineTwoWay()\r\n   *  -sprite travels line: any Line() or object with property of line\r\n   ***************************/\r\n\r\n  /********************************************************************************\r\n   * sprite travels on a line in a back-and-forth motion --to the end of the line, and back.\r\n   * #Dev-todo:MORE ON THIS\r\n   * @function\r\n   * @memberof Sprite\r\n   *********************************************************************************/\r\n\r\n  travelLineTwoWay(lineObject, speed, curveKey, offset) {\r\n\r\n    speed = speed || 1;\r\n\r\n    var motionCurveOptions = [\"linear\", \"quadratic\", \"cubic\"];\r\n    curveKey = curveKey || \"linear\";\r\n    var line = lineObject;\r\n\r\n    if (lineObject.line) {\r\n      line = lineObject.line;\r\n    }\r\n\r\n    this.__crtLineIx = this.__crtLineIx || 0;\r\n\r\n    var __inst = this,\r\n      pctFloat = __inst.__crtLineIx % ((line.points.length - 1) / 2) / ((line.points.length - 1) / 2);\r\n\r\n    if (__inst.__crtLineIx >= ((line.points.length - 1) / 2)) {\r\n      pctFloat = 1.0 - pctFloat;\r\n    }\r\n\r\n    var ixChange = Gamelab.Curves.InOut[curveKey](pctFloat) * speed * 0.5;\r\n\r\n    if (curveKey == 'linear') {\r\n      ixChange = speed;\r\n    }\r\n\r\n    ixChange = Math.ceil(ixChange);\r\n\r\n    if (ixChange < 1) {\r\n      ixChange = 1;\r\n    }\r\n\r\n    __inst.position = new Gamelab.Vector(line.points[__inst.__crtLineIx]);\r\n\r\n    //console.log(ixChange);\r\n\r\n    __inst.__crtLineIx += ixChange;\r\n\r\n    if (__inst.__crtLineIx >= line.points.length) {\r\n      line.points = line.points.reverse();\r\n      __inst.__crtLineIx = 0;\r\n    }\r\n\r\n    if (offset instanceof Gamelab.Vector) {\r\n      this.position = this.position.add(offset);\r\n    }\r\n  }\r\n\r\n\r\n  /*****************************\r\n   *  travelLineOnLoop()\r\n   *  -sprite travels line: any Line() or object with property of line\r\n   ***************************/\r\n\r\n  /**\r\n   * the sprite travels one line in a looping motion --useful for traveling Square, Circle, or other enclosed Lines.\r\n   * #Dev-todo:MORE ON THIS\r\n   * @function\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  travelLineOnLoop(lineObject, speed, curveKey, offset) {\r\n\r\n    speed = speed || 1;\r\n\r\n    var motionCurveOptions = [\"linear\", \"quadratic\", \"cubic\"];\r\n\r\n    curveKey = curveKey || \"linear\";\r\n\r\n    var line = lineObject;\r\n\r\n    if (lineObject.line) {\r\n      line = lineObject.line;\r\n    }\r\n\r\n    this.__crtLineIx = this.__crtLineIx || 0;\r\n\r\n    var __inst = this,\r\n\r\n      pctFloat = __inst.__crtLineIx % ((line.points.length - 1) / 2) / ((line.points.length - 1) / 2);\r\n\r\n    if (__inst.__crtLineIx >= ((line.points.length - 1) / 2)) {\r\n      pctFloat = 1.0 - pctFloat;\r\n\r\n    }\r\n\r\n    var ixChange = Gamelab.Curves.InOut[curveKey](pctFloat) * speed * 0.5;\r\n\r\n    if (curveKey == 'linear') {\r\n      ixChange = speed;\r\n    }\r\n\r\n    ixChange = Math.ceil(ixChange);\r\n\r\n    if (ixChange < 1) {\r\n      ixChange = 1;\r\n    }\r\n\r\n    __inst.position = new Gamelab.Vector(line.points[__inst.__crtLineIx]);\r\n\r\n    // console.log(ixChange);\r\n\r\n    __inst.__crtLineIx += ixChange;\r\n\r\n    if (__inst.__crtLineIx >= line.points.length) {\r\n      __inst.__crtLineIx = 0;\r\n    }\r\n\r\n    if (offset instanceof Gamelab.Vector) {\r\n      this.position = this.position.add(offset);\r\n    }\r\n  }\r\n\r\n  /*****************************\r\n   *  shoot(sprite)\r\n   *  -fire a shot from the sprite:: as in a firing gun or spaceship\r\n   *  -takes options{} for number of shots anglePerShot etc...\r\n   *  -TODO: complete and test this code\r\n   ***************************/\r\n\r\n\r\n  /**\r\n   * fire a Shot, or bullet-Sprite from the Sprite\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Object} options an object of arguments\r\n   * @param {Gamelab.GridAnimation} animation the animation to fire from the Sprite\r\n   * @param {number} speed the speed of the shot that is projected\r\n   * @param {Gamelab.Vector} position the initial position of the shot: defaults to current Sprite position\r\n   * @param {Gamelab.Vector} size the Vector size of the shot\r\n   * @param {Gamelab.Vector} rot_offset the rotational offset to apply: controls direction of the shot\r\n   **********/\r\n\r\n  shoot(options, gw) {\r\n    //character shoots an animation\r\n    gw = gw || Gamelab.game_windows[0];\r\n    this.prep_key = 'shoot';\r\n\r\n    let animation = options.bullet || options.animation || options.anime || new Gamelab.GridAnimation();\r\n    let speed = options.speed || options.velocity || 1;\r\n\r\n\r\n    let size = options.size || new Gamelab.Vector(10, 10, 0);\r\n    let position = new Gamelab.Vector(options.position) || new Gamelab.Vector(this.position);\r\n\r\n\r\n    let rot_offset = options.rot_offset || options.rotation || 0;\r\n    let total = options.total || 1;\r\n    let rot_disp = options.rot_disp || 0; //the full rotational-dispersion of the bullets\r\n\r\n    let life = options.life || 900;\r\n    let shots = [];\r\n    for (var x = 0; x < total; x++) {\r\n\r\n      var __playerInst = this;\r\n      if (Gamelab.isAtPlay) {\r\n        var bx = position.x,\r\n          by = position.y,\r\n          bw = size.x,\r\n          bh = size.y;\r\n\r\n        var shot = new Gamelab.Sprite().FromData({\r\n          active: true,\r\n          position: new Gamelab.Vector(position),\r\n          size: new Gamelab.Vector(size),\r\n          speed: speed,\r\n          image: animation.image,\r\n          rotation: new Gamelab.Vector(0, 0, 0),\r\n          flipX: false,\r\n          life: options.life,\r\n          noScroll: true\r\n        });\r\n\r\n\r\n        shot.Animation(animation);\r\n\r\n        rot_offset = new Gamelab.Vector(rot_offset, 0, 0);\r\n        shot.position.x = bx, shot.position.y = by;\r\n\r\n        //Danger On this line: annoying math --dispersing rotation of bullets by rot_disp\r\n\r\n        var div = rot_disp / total;\r\n        var rotPlus = div * x + div / 2 - rot_disp / 2;\r\n\r\n        shot.rotation.x = rot_offset.x + rotPlus;\r\n        //  shot.origin = new Gamelab.Vector(position);\r\n\r\n        shot.speed = new Gamelab.Vector(Math.cos((shot.rotation.x) * 3.14 / 180) * speed, Math.sin((shot.rotation.x) * 3.14 / 180) * speed);\r\n        shots.push(shot);\r\n\r\n        shot.onUpdate(function(spr) {\r\n          // console.log('update:rotation:' + shot.rotation.x);\r\n        });\r\n        gw.add(shot);\r\n      }\r\n    }\r\n    return shots;\r\n  }\r\n\r\n  /**\r\n   * create a sub-sprite belonging to the current sprite\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Object} options an object of arguments\r\n   * @param {Animation} animation the animation to fire from the Sprite\r\n   * @param {number} speed the speed of the shot that is projected\r\n   * @param {Vector} position the initial position of the shot: defaults to current Sprite position\r\n   * @param {Vector} size the Vector size of the shot\r\n   * @param {Vector} offset the positional offset to apply\r\n   * @returns {Sprite} a Gamelab.Sprite object\r\n   **********/\r\n\r\n  subsprite(options, gw) {\r\n\r\n    gw = gw || Gamelab.game_windows[0];\r\n\r\n    let animation = options.animation || new Gamelab.GridAnimation();\r\n    let position = options.position || new Gamelab.Vector(this.position);\r\n    let offset = options.offset || new Gamelab.Vector(0, 0, 0);\r\n    let size = new Gamelab.Vector(options.size || this.size);\r\n\r\n    if (Gamelab.isAtPlay) {\r\n\r\n      var subsprite = gw.add(new Gamelab.Sprite().FromData({\r\n        active: true,\r\n        position: position,\r\n        size: size,\r\n        offset: offset,\r\n        image: animation.image,\r\n        rotation: new Gamelab.Vector(0, 0, 0),\r\n        flipX: false,\r\n        scrollFactor: this.scrollFactor,\r\n        noScroll: this.noScroll\r\n      }));\r\n\r\n      subsprite.Animation(animation);\r\n\r\n      return subsprite;\r\n\r\n    } else {\r\n      console.error('No subsprite when not at play');\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * switch to the next frame on sprite.selected_animation\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Animation} animation the optional animation to switch to before animate is called, defaults to the existing sprite.selected_animation\r\n   **********/\r\n\r\n  animate(animation) {\r\n    if (Gamelab.isAtPlay) {\r\n      if (animation) {\r\n        this.Animation(animation)\r\n      }\r\n\r\n      if (this.effectFrames instanceof Array && this.effectFrames.length && this.effectFrames.length >= 1) {\r\n        this.effectCanvasTimer += 1;\r\n\r\n        console.log('drawing from effect');\r\n\r\n        var data = this.effectFrames[this.effectCanvasTimer % this.effectFrames.length];\r\n        //  this.clearEffects();\r\n        this.effectCtx.putImageData(data, 0, 0);\r\n        console.log('animated data');\r\n      } else if (this.effectCanvas) {\r\n        this.effectCanvasTimer += 1;\r\n        //do nothing\r\n      } else if (this.selected_animation) {\r\n        this.selected_animation.run();\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * run a function when the sprite.selected_animation is complete\r\n   *\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Function} fun the function to call when the animation is complete\r\n   *\r\n   **********/\r\n  onAnimationComplete(fun) {\r\n    this.selected_animation.onComplete(fun);\r\n  }\r\n\r\n  grounded(value) {\r\n    if (value)\r\n      this.GROUNDED = value;\r\n    return this.GROUNDED;\r\n  }\r\n\r\n\r\n  /**\r\n   * get the vector-position at the center of the sprite, based on its current position and size\r\n   * @function\r\n   * @memberof Sprite\r\n   *\r\n   * @returns (Vector) a vector-position pinpointing the current-center of the sprite\r\n   *\r\n   **********/\r\n  center() {\r\n    return new Gamelab.Vector(this.position.x + this.size.x / 2, this.position.y + this.size.y / 2, 0);\r\n  }\r\n\r\n\r\n  /*****************************\r\n   *  System Use / Collision\r\n   ***************************/\r\n\r\n\r\n  /*****************************\r\n   * @ignore\r\n   ***************************/\r\n\r\n  shortest_stop(item, callback) {\r\n    var diff_min_y = item.min ? item.min.y : Math.abs(item.position.y - this.position.y + this.size.y);\r\n    var diff_min_x = item.min ? item.min.x : Math.abs(item.position.x - this.position.x + this.size.x);\r\n    var diff_max_y = item.max ? item.max.y : Math.abs(item.position.y + item.size.y - this.position.y);\r\n    var diff_max_x = item.max ? item.max.x : Math.abs(item.position.x + item.size.x - this.position.y);\r\n\r\n    var dimens = {\r\n      top: diff_min_y,\r\n      left: diff_min_x,\r\n      bottom: diff_max_y,\r\n      right: diff_max_x\r\n    };\r\n\r\n    var minkey = \"\",\r\n      min = 10000000;\r\n\r\n    for (var x in dimens) {\r\n      if (dimens[x] < min) {\r\n        min = dimens[x];\r\n        minkey = x; // a key of top left bottom or right\r\n      }\r\n    }\r\n\r\n    callback(minkey);\r\n  }\r\n\r\n  setGrounded(grounded) {\r\n\r\n    this.grounded = grounded;\r\n\r\n    this.__inAir = !this.grounded;\r\n\r\n  }\r\n\r\n  /*************\r\n   * #BE CAREFUL\r\n   * -with this function :: change sensitive / tricky / 4 way collision\r\n   * *************/\r\n\r\n  /**\r\n   * determine if sprite overlaps on x-axis with another sprite\r\n   *\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Sprite} item the Sprite to compare with\r\n   * @param {number} padding the 0-1.0 float value of padding to use on self when testing overlap\r\n   * @returns {boolean} a true || false var showing if overlap has occured\r\n   *\r\n   **********/\r\n\r\n  overlap_x(item, padding) {\r\n    if (!padding) {\r\n      padding = 0;\r\n    }\r\n\r\n    var p1 = this.position,\r\n      p2 = item.position;\r\n    var paddingX = Math.round(padding * this.size.x),\r\n      paddingY = Math.round(padding * this.size.y),\r\n      left = item.position.x,\r\n      right = item.position.x + item.size.x;\r\n\r\n      var pLeft = this.position.x + paddingX,\r\n      pRight = this.position.x + this.size.x - paddingX;\r\n\r\n    return right > pLeft && left < pRight;\r\n\r\n  }\r\n\r\n  /*************\r\n   * #BE CAREFUL\r\n   * -with this function :: change sensitive / tricky / 4 way collision\r\n   * *************/\r\n\r\n  /**\r\n   * determine if sprite overlaps on y-axis with another sprite\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Sprite} item the Sprite to compare with\r\n   * @param {number} padding the 0-1.0 float value of padding to use on self when testing overlap\r\n   * @returns {boolean} a true || false var showing if overlap has occured\r\n   *\r\n   **********/\r\n\r\n   overlap_y(item, padding) {\r\n     if (!padding) {\r\n       padding = 0;\r\n     }\r\n\r\n     var p1 = this.position,\r\n       p2 = item.position;\r\n     var paddingX = Math.round(padding * this.size.x),\r\n\r\n       paddingY = Math.round(padding * this.size.y),\r\n       top = item.position.y + paddingY,\r\n       bottom = item.position.y + item.size.y - paddingY;\r\n\r\n     return bottom > p1.y && top < p1.y + this.size.y;\r\n   }\r\n\r\n   item_pos_y(item, padding) {\r\n     if (!padding) {\r\n       padding = 0;\r\n     }\r\n\r\n     var paddingY = Math.round(padding * this.size.y),\r\n       top = item.position.y + paddingY;\r\n\r\n     return top - this.size.y;\r\n   }\r\n\r\n\r\n  /*************\r\n   * #BE CAREFUL\r\n   * -with this function :: change sensitive / tricky / 4 way collision\r\n   * *************/\r\n\r\n\r\n  /**\r\n   * stop collision on x-axis with another sprite\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Sprite} item the Sprite with which to collide-stop on the x-axis\r\n   **********/\r\n\r\n  collide_stop_x(item) {\r\n\r\n    var apart = false;\r\n    var ct = 500;\r\n\r\n    while (!apart && ct > 0) {\r\n      ct--;\r\n\r\n      var diffX = this.center().sub(item.center()).x;\r\n      var distX = Math.abs(this.size.x / 2 + item.size.x / 2 - Math.round(this.size.x * this.padding.x));\r\n\r\n      if (Math.abs(diffX) < distX) {\r\n        this.position.x -= diffX > 0 ? -1 : 1;\r\n      } else {\r\n        this.speed.x = 0;\r\n        apart = true;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * collide-stop only from the top (of the sprite passed as argument) ::\r\n   *\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Sprite} item the Sprite to collide with\r\n   *\r\n   **********/\r\n\r\n  get_highest_ground_from_array(items, paddingX) {\r\n\r\n    this.solidGroundPosition = new Gamelab.Vector(Infinity, Infinity);\r\n\r\n    this.solidGroundSprite = undefined;\r\n\r\n    paddingX = paddingX || this.padding.x;\r\n\r\n    for(var x = 0; x < items.length; x++)\r\n    {\r\n      var item = items[x];\r\n\r\n      if (this.overlap_x(item, paddingX)) {\r\n\r\n        var paddingY = this.padding.y * this.size.y;\r\n\r\n        var p1 = this.position,\r\n          p2 = item.position;\r\n\r\n        if (this.position.y < p2.y) {\r\n\r\n          var nextY = p2.y;\r\n\r\n          if(nextY < this.solidGroundPosition.y)\r\n          {\r\n            this.solidGroundPosition.y = nextY;\r\n            this.solidGroundSprite = item;\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n    }\r\n\r\n    return this.solidGroundSprite;\r\n  }\r\n\r\n\r\n\r\n  /**\r\n   * restore a sprite from existing json-data --applies to data-persistence\r\n   *\r\n   * @function\r\n   * @memberof Sprite\r\n   *\r\n   * @returns (Sprite)\r\n   **********/\r\n\r\n  restoreFrom(data) {\r\n    data.image = new GameImage(data.src || data.image.src);\r\n    return new Gamelab.Sprite(data);\r\n  }\r\n\r\n  ColoredRect(color, w, h) {\r\n    var canvas = document.createElement('canvas');\r\n    canvas.width = w;\r\n    canvas.height = h;\r\n    var ctx = canvas.getContext('2d');\r\n    this.canvas = canvas;\r\n    ctx.fillStyle = color;\r\n    ctx.fillRect(0, 0, w, h);\r\n    this.image = new Gamelab.GameImage(canvas);\r\n    this.ctx = ctx;\r\n    this.size = new Gamelab.Vector(w, h);\r\n    return this;\r\n  }\r\n\r\n  AsCanvasTiles(tilesX, tilesY, unitWidth, unitHeight) {\r\n\r\n    var canvas = document.createElement('canvas');\r\n\r\n    var width = unitWidth * tilesX + unitWidth,\r\n      height = unitHeight * tilesY + unitHeight;\r\n\r\n    canvas.width = width;\r\n    canvas.height = height;\r\n\r\n    this.size = new Gamelab.Vector(w, h);\r\n\r\n    var ctx = canvas.getContext('2d');\r\n\r\n    this.canvas = canvas;\r\n    this.srcImageSave = new Gamelab.GameImage(this.image.domElement.src);\r\n\r\n    var $object = this;\r\n\r\n    this.srcImageSave.domElement.onload = function() {\r\n\r\n      for (var x = 0; x < tilesX; x++) {\r\n        for (var y = 0; y < tilesY; y++) {\r\n          ctx.drawImage(this, x * $object.size.x, y * $object.size.y, unitWidth, unitHeight);\r\n        }\r\n      }\r\n    };\r\n\r\n\r\n    this.image = new Gamelab.GameImage(canvas);\r\n\r\n\r\n\r\n    this.ctx = ctx;\r\n    return this;\r\n  }\r\n\r\n\r\n  /*****************************\r\n   * @ignore\r\n   * #IN-TESTING\r\n   *  fromFile(file_path)\r\n   *  -TODO : complete this function based on code to load Sprite() from file, located in the spritemaker.html file\r\n   *  -TODO: test this function\r\n   ***************************/\r\n\r\n  fromFile(file_path) {\r\n    if (typeof file_path == 'string') {\r\n      var __inst = this;\r\n      $.getJSON(file_path, function(data) {\r\n        __inst = new Gamelab.Sprite(data);\r\n      });\r\n    }\r\n  }\r\n\r\n  /*****************************\r\n   * return a decycled json-string for the sprite --without circular references\r\n   * @returns {string} a json string\r\n   ***************************/\r\n\r\n  toJSONString() {\r\n    return jstr(JSON.decycle(this));\r\n  }\r\n\r\n};\r\n\r\nGamelab.Sprite = Sprite;\r\n;/**\r\n * Creates a new BoneSprite.\r\n *\r\n * <info-bit>Gamelab.BoneSprite is a container for 2D Animations.\r\n * -apply Sprite class to create a 2D game-object.\r\n *\r\n * BoneSprites are a group of moving animations.</info-bit>\r\n * <iframe style='width:400px; height:450px; overflow:hidden;' src='../client/examples/js-class/Sprite.html'> </iframe>\r\n\r\n * @param   {string} src the srcPath for the image of the Sprite\r\n * @param   {number} scale=1.0 the scale to be applied to size of each animation-frame\r\n *\r\n * @returns {Sprite} a Gamelab.BoneSprite object\r\n */\r\n\r\nclass BoneSprite extends Sprite {\r\n  constructor(src = {}, scale = 1.0) {\r\n    super(src, scale);\r\n    this.bones = [];\r\n  }\r\n  addBone(oncreate) {\r\n    var bone = new Bone(this, this.size);\r\n    oncreate.bind(bone).call();\r\n    this.bones.push(bone);\r\n  }\r\n  updateBones(){\r\n\r\n    this.bones[0].SetParentPosition(this.position);\r\n\r\n    var boffset = this.bones[0].CalcOffset();\r\n\r\n    var count = 0;\r\n\r\n    for(var x = 0; x < this.bones.length; x+= 2)\r\n    {\r\n\r\n      if(this.bones[x] && this.bones[x + 1])\r\n      {\r\n        var b1 = this.bones[x], b2 = this.bones[x + 1];\r\n        boffset = b1.CalcOffset();\r\n        b2.SetParentPosition(boffset);\r\n        b2.CalcOffset(b1);\r\n      }\r\n    }\r\n\r\n  }\r\n  draw_current_frame(ctx, camera) {\r\n\r\n\r\n    var sprite = this;\r\n    var frameList = [];\r\n    if (sprite.active) {\r\n\r\n      if (sprite.selected_animation instanceof Array && sprite.selected_animation.length >= 1) {\r\n        sprite.selected_animation.forEach(function(anime) {\r\n\r\n          anime.selected_frame.parent = anime;\r\n          frameList.push(anime.selected_frame);\r\n\r\n        });\r\n      }\r\n\r\n      var origin = sprite.origin || new Gamelab.Vector(0, 0);\r\n      var rotation = sprite.rotation.x;\r\n\r\n      frameList.reverse().forEach(function(frame){\r\n\r\n        var realWidth = frame.size.x;\r\n        var realHeight = frame.size.y;\r\n\r\n        var x = frame.position.x,\r\n          y = frame.position.y;\r\n\r\n        if (frame.rotation && typeof frame.rotation.x == 'number') {\r\n          rotation = frame.rotation.x;\r\n        }\r\n\r\n        if (frame.origin) {\r\n          origin = frame.origin;\r\n          //console.log('drawing with origin:' + origin.x + ':' + origin.y);\r\n        }\r\n\r\n        var frame_offset = new Gamelab.Vector(0, 0);\r\n\r\n        if(frame.parent && frame.parent.frameOffset instanceof Gamelab.Vector)\r\n        {\r\n          //console.log('object.bonesprite.js:: frame-parent-offset');\r\n          frame_offset = frame.parent.frameOffset;\r\n        }\r\n\r\n        if (frame && frame.image)\r\n          Gamelab.Canvas.draw_image_frame(frame.image.domElement, new Gamelab.Vector(frame.framePos).add(frame_offset), frame.frameSize, new Gamelab.Vector2D(Math.round(x + (origin.x)), Math.round(y + (origin.y))), new Gamelab.Vector2D(realWidth, realHeight), rotation % 360, ctx, sprite.flipX, sprite.flipY, origin);\r\n      });\r\n\r\n    }\r\n\r\n  }\r\n};\r\n\r\nlet CompositeSprite = BoneSprite;\r\n\r\nGamelab.BoneSprite = BoneSprite;\r\nGamelab.CompositeSprite = CompositeSprite;\r\n;/**\r\n * Creates a new SpriteFill.\r\n */\r\nclass SpriteFill extends Sprite {\r\n  constructor(src = {}, scale = 1.0) {\r\n    super(src, scale);\r\n    this.sourceSprites = [];\r\n    this.overlaySprites = [];\r\n    this.shape = [];\r\n  }\r\n  //draw function is overwritten to nothing. --limits console errors --todo --complete\r\n  draw() {\r\n    return 0;\r\n  }\r\n  addSprite(src, scale, callback) {\r\n    this.sourceSprites.push(new Gamelab.Sprite(src, scale));\r\n    if (callback) callback.bind(this).call();\r\n  }\r\n  addOverlaySprite(src, scale, callback) {\r\n    console.info(`SpriteFill().addOverlay(): --adds an overlay.\r\n      Every overlay must fit with every sourceSprite, matching non-transparent pixels only`);\r\n    this.overlaySprites.push(new Gamelab.Sprite(src, scale));\r\n    if (callback) callback.bind(this).call();\r\n  }\r\n  SelectionMode(mode) {\r\n    this.selection_mode = mode || this.selected_mode || 'random';\r\n    return this.selection_mode;\r\n  }\r\n  BuildShape(onCreateShape) {\r\n    if (onCreateShape) onCreateShape.bind(this).call();\r\n    return this.shape;\r\n  }\r\n  enclose_rectangle() {\r\n    var rect = new Gamelab.Rectangle(Infinity, Infinity, -Infinity, -Infinity);\r\n    this.shape.forEach(function(point) {\r\n      if (point.x < rect.min.x) {\r\n        rect.min.x = point.x;\r\n      }\r\n      if (point.y < rect.min.y) {\r\n        rect.min.y = point.y;\r\n      }\r\n      if (point.x > rect.max.x) {\r\n        rect.max.x = point.x;\r\n      }\r\n      if (point.y > rect.max.y) {\r\n        rect.max.y = point.y;\r\n      }\r\n    });\r\n    return rect;\r\n  }\r\n\r\n  Fill() {\r\n    var bounds = this.enclose_rectangle();\r\n    //step 1: fill the shape with rectangles:\r\n    var tracker = new Gamelab.Vector(),\r\n      sprite = this.sourceSprites[0],\r\n      currentSize = new Gamelab.Vector(sprite.size),\r\n      currentIndex = 0;\r\n\r\n    this.offscreenCanvas = new Gamelab.OffscreenCanvas(document.createElement('CANVAS'), bounds.min.x, bounds.min.y);\r\n\r\n    var ctx = this.offscreenCanvas.ctx;\r\n\r\n    //apply loop through x, y bounds, fill with sprites\r\n    for (var x = bounds.min.x; x < bounds.max.x; x += currentSize.x) {\r\n      for (var y = bounds.min.y; y < bounds.max.y; y += currentSize.y) {\r\n        var nextSprite = new Gamelab.Sprite().FromData(this.sourceSprites[currentIndex]);\r\n        this.sprites.push(nextSprite);\r\n        currentSize = new Gamelab.Vector(nextSprite.size);\r\n        currentIndex += 1;\r\n        nextSprite.onLoad(function() {\r\n          this.draw(ctx);\r\n        });\r\n      }\r\n    }\r\n    return this.offscreenCanvas;\r\n  }\r\n};\r\n\r\nGamelab.SpriteFill = SpriteFill;;/**\r\n * Creates a new Interactive.\r\n *\r\n * @param   {string} src the srcPath for the image of the Item\r\n * @param   {number} scale=1.0 the scale to be applied to size of each animation-frame\r\n *\r\n * @returns {Interactive} a Gamelab.Interactive object\r\n *\r\n */\r\n\r\nclass Interactive extends Sprite {\r\n  constructor(src = {}, scale) {\r\n    super(src, scale);\r\n  }\r\n}\r\n\r\nGamelab.Interactive = Interactive;;/**\r\n * Creates a new Item.\r\n *\r\n * @param   {string} src the srcPath for the image of the Item\r\n * @param   {number} scale=1.0 the scale to be applied to size of each animation-frame\r\n *\r\n * @returns {Item} a Gamelab.Item object\r\n *\r\n */\r\n\r\nclass Item extends Sprite {\r\n  constructor(src = {}, scale) {\r\n    super(src, scale);\r\n    this.imageOptions = [];\r\n    this.collisionObjects = [];\r\n    this.collisionBehavior = 'COLLECT';\r\n    this.collectionAnimation = undefined;\r\n  }\r\n  appendImageOption(src, scale) {\r\n    this.imageProfiles.push({\r\n      src,\r\n      scale\r\n    });\r\n  }\r\n  appendCollisionProfile(collisionObjects, collisionBehavior) {\r\n    this.collisionObjects = collisionObjects;\r\n    this.collisionBehavior = collisionBehavior;\r\n  }\r\n}\r\n\r\nGamelab.Item = Item;\r\n;\r\n\r\nclass ScriptedSprite {\r\n\r\n  constructor() {\r\n\r\n  }\r\n\r\n  \r\n\r\n}\r\n;class ScrollingBackground extends Sprite {\n\n    constructor(arg1={}, size) {\n\n        super(arg1, size);\n\n        this.src = arg1;\n\n        let args = typeof(arg1) == 'object' ? arg1 : {};\n\n        this.size = size;\n\n        this.type = args.type || \"parallax\" || \"basic\" || false;\n\n        this.source_objects = args.objects || args.source_objects || [];\n\n        this.members = [];\n\n        this.rows = args.rows || 1;//The Y number of repititions\n\n        this.cols = args.cols || 1; //The X number of repetitions of the images\n\n        this.flip = args.flip || false;\n\n        this.fill = args.fill || false;\n\n        this.flip = args.flip || false;\n\n    }\n\n    Flip(value)\n    {\n        if(value == undefined)\n        {\n            this.flip = true;\n        }\n        else if (value == true || value == false) {\n            this.flip = value;\n\n        }\n\n        return this;\n    }\n\n    Rows(r)\n    {\n        this.rows = r;\n        return this;\n    }\n\n    Cols(c)\n    {\n        this.cols = c;\n        return this;\n    }\n\n    Fill(approxRows, approxCols, gw)\n    {\n\n        approxRows = approxRows || this.rows || 1;\n\n        approxCols = approxCols || this.cols || 1;\n\n        gw = gw || Gamelab.game_windows[0];\n\n        var w= gw.canvas.width, h = gw.canvas.height,\n            xBacksTotal = Math.floor(approxRows / 2), yBacksTotal =  Math.floor(approxCols / 2);\n\n        var __inst = this;\n\n        //create first row:\n\n        for(var y = -yBacksTotal; y <= yBacksTotal + 1; y++)\n        {\n            console.log('adding background:' + y);\n\n            for(var x = -xBacksTotal; x <= xBacksTotal + 1; x++)\n            {\n\n                console.log('adding background');\n\n                this.members.push(new Sprite(this.src));\n\n                var b = this.members[this.members.length - 1];\n\n                b.Size(this.size);\n\n                console.info(this);\n\n                var __inst = this;\n\n                b.position.x = x * this.size.x;\n\n                b.position.y = y * this.size.y;\n\n                b.minX = -xBacksTotal * b.size.x + b.size.x;\n\n                b.maxX = (xBacksTotal + 1) * b.size.x ;\n\n                b.minY = -yBacksTotal * b.size.y + b.size.y;\n\n                b.maxY = yBacksTotal * b.size.y ;\n\n\n                if(x % 2 == 0)\n                {\n                    b.flipX = true;\n\n                }\n\n                if(y % 2 == 0)\n                {\n                    b.flipY = true;\n\n                }\n\n\n                b.onUpdate(function(spr){\n\n                    spr.campos = gw.camera.position;\n\n                    var cx = spr.campos.x - (spr.campos.x  % spr.size.x), cy = spr.campos.y - ( spr.campos.y % spr.size.y );\n\n                    if(spr.position.x - cx < spr.minX)\n                    {\n                        spr.position.x = spr.maxX + cx;\n                    }\n\n                    if(spr.position.x - cx > spr.maxX)\n                    {\n                        spr.position.x = spr.minX + cx;\n                    }\n\n                    if(spr.position.y - cy < spr.minY)\n                    {\n                        spr.position.y = spr.maxY + cy;\n                    }\n\n                    if(spr.position.y - cy > spr.maxY)\n                    {\n                        spr.position.y = spr.minY + cy;\n                    }\n\n                });\n\n                gw.add(b); //add to window\n\n            }\n\n        }\n\n        return this;\n    }\n\n    add(object)\n    {\n        var cleanCheck = object instanceof Gamelab.Sprite || object instanceof Array && object[0] instanceof Gamelab.Sprite; //is Sprite\n\n        if(!cleanCheck)\n        {\n            return console.error('Must have: valid contents (Gamelab.Sprite OR [] of Gamelab.Sprite())');\n        }\n\n        if(object instanceof Array)\n        {\n            this.source_objects.concat(object)\n        }\n        else\n        {\n            this.source_objects.push(object);\n        }\n\n        return this;\n    }\n\n}\n\nGamelab.ScrollingBackground = ScrollingBackground;\n;\r\nclass SpriteAlgorythm {\r\n\r\n  constructor(options, callback) {\r\n\r\n    this.options = options;\r\n\r\n    this.setCallback(callback);\r\n\r\n  }\r\n\r\n  setCallback() {\r\n\r\n    this.Engage = callback;\r\n\r\n  }\r\n\r\n  Engage() {\r\n\r\n\r\n\r\n  }\r\n\r\n}\r\n\r\n\r\nGamelab.SpriteAlgorythm = SpriteAlgorythm;\r\n;/**\r\n * Creates a new SpriteBrush.\r\n */\r\n\r\nclass SpriteBrush{\r\n  constructor(onCreate, mode = 'random') {\r\n    this.sprites = [];\r\n    this.overlaySprites = [];\r\n    this.mode = mode;\r\n    this.index = -1;\r\n    this.total = 0;\r\n    this.selected_sprite = {};\r\n    this.id = Gamelab.create_id();\r\n    onCreate = onCreate || function(){};\r\n    onCreate.bind(this);\r\n  }\r\n\r\n  addSprite(src, scale, callback) {\r\n    this.sprites.push(new Gamelab.Sprite(src, scale));\r\n    if(callback) callback.bind(this).call();\r\n  }\r\n  addOverlaySprite(src, scale, callback) {\r\n    console.info(`SpriteFill().addOverlay(): --adds an overlay.\r\n      Every overlay must fit with every sourceSprite, matching non-transparent pixels only`);\r\n    this.overlaySprites.push(new Gamelab.Sprite(src, scale));\r\n    if(callback) callback.bind(this).call();\r\n  }\r\n\r\n  removeAll(){\r\n    this.sprites = [];\r\n    this.overlaySprites = [];\r\n  }\r\n\r\n  next(){\r\n    this.index += 1;\r\n    switch(this.mode.toLowerCase())\r\n    {\r\n        case 'random':\r\n        var index = Math.floor(Math.random() * this.sprites.length);\r\n        this.selected_sprite = this.sprites[index];\r\n        return this.selected_sprite;\r\n        break;\r\n\r\n        case 'consecutive':\r\n        this.selected_sprite = this.sprites[this.index % this.sprites.length];\r\n        return this.selected_sprite;\r\n        break;\r\n    }\r\n  }\r\n\r\n  Clone(spritebrush)\r\n  {\r\n    var outputSprite = new Gamelab.SpriteBrush();\r\n    outputSprite.id = spritebrush.id;\r\n    var oix = 0;\r\n\r\n    spritebrush.sprites.forEach(function(sprite){\r\n        outputSprite.addSprite(sprite.src, sprite.size);\r\n        oix += 1;\r\n    });\r\n\r\n    spritebrush.overlaySprites.forEach(function(sprite){\r\n        outputSprite.addOverlaySprite(sprite.src, sprite.size);\r\n        oix += 1;\r\n    });\r\n    return outputSprite;\r\n  }\r\n\r\n  FromData(spritebrush)\r\n  {\r\n    var outputSprite = new Gamelab.SpriteBrush();\r\n\r\n    outputSprite.id = spritebrush.id;\r\n\r\n    var oix = 0;\r\n\r\n    spritebrush.sprites.forEach(function(sprite){\r\n\r\n        outputSprite.addSprite(sprite.src, sprite.size);\r\n\r\n        oix += 1;\r\n    });\r\n\r\n    spritebrush.overlaySprites.forEach(function(sprite){\r\n\r\n        outputSprite.addOverlaySprite(sprite.src, sprite.size);\r\n\r\n        oix += 1;\r\n    });\r\n\r\n    return outputSprite;\r\n  }\r\n};\r\n\r\nGamelab.SpriteBrush = SpriteBrush;\r\n;class SpriteFactory {\r\n\r\n  constructor(onCreate) {\r\n\r\n    this.sprites = [];\r\n    this.livingTotal = 0;\r\n    this.livingSprites = [];\r\n\r\n    this.lockoutTime = 0;\r\n\r\n    this.livingSprites.oldest = function() {\r\n      var maxTicker = 0,\r\n        nextObjectIndex = 0;\r\n      for (var x = 0; x < this.length; x++) {\r\n        if (typeof this[x] == 'object' && this[x].ticker >= maxTicker) {\r\n          maxTicker = this[x].ticker;\r\n          nextObjectIndex = x;\r\n        }\r\n      }\r\n      return this[nextObjectIndex];\r\n    };\r\n\r\n    this.livingSprites.countLiving = function() {\r\n      var total = 0;\r\n      for (var x = 0; x < this.length; x++) {\r\n        if (this[x].ticker > 0) {\r\n          total++;\r\n        }\r\n      }\r\n      return total;\r\n    };\r\n\r\n    this.sprites.oldest = function() {\r\n      var maxTicker = 0,\r\n        nextObjectIndex = 0;\r\n      for (var x = 0; x < this.length; x++) {\r\n        if (typeof this[x] == 'object' && this[x].ticker >= maxTicker) {\r\n          maxTicker = this[x].ticker;\r\n          nextObjectIndex = x;\r\n        }\r\n      }\r\n      return this[nextObjectIndex];\r\n    };\r\n\r\n    this.sprites.countLiving = function() {\r\n      var total = 0;\r\n      for (var x = 0; x < this.length; x++) {\r\n        if (this[x].ticker >= 1) {\r\n          total++;\r\n        }\r\n      }\r\n      console.log('TOTAL LIVING blts::' + total);\r\n      return total;\r\n    };\r\n\r\n    if (typeof onCreate == 'function')\r\n      onCreate.bind(this).call();\r\n\r\n  }\r\n\r\n  Frequency(f) {\r\n    this.frequency = f;\r\n    return this;\r\n  }\r\n\r\n  MenuSprite(sprite) {\r\n\r\n    if (sprite)\r\n      this.menu_sprite = sprite;\r\n\r\n    return this.menu_sprite;\r\n  }\r\n\r\n  PrepareSprites(total = 1, exampleSprite, onCreateSprite) {\r\n    for (var x = 0; x < total; x++) {\r\n      var s = new Gamelab.Sprite().FromData(exampleSprite);\r\n      this.sprites.push(s);\r\n    }\r\n    this.createSprite = onCreateSprite;\r\n    return this;\r\n  }\r\n\r\n  PrepareSpritesByArrayOrder(total = 1, exampleSprites, loadFxn) {\r\n\r\n    if (!exampleSprites instanceof Array)\r\n      exampleSprites = [exampleSprites];\r\n\r\n    for (var x = 0; x < total; x++) {\r\n      var s = new Gamelab.Sprite().FromData(exampleSprites[x % exampleSprites.length]);\r\n      s.onLoad(loadFxn || function() {});\r\n      this.sprites.push(s);\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  lockout(numberUpdates) {\r\n    if (this.lockoutTime <= 0) {\r\n      this.lockoutTime = numberUpdates;\r\n    }\r\n  }\r\n\r\n  Life(l) {\r\n    this.life = l;\r\n    return this;\r\n  }\r\n\r\n  enter(number = 1, gameWindow) {\r\n    var $controller = this;\r\n\r\n    if (this.lockoutTime > 0) {\r\n      this.lockoutTime -= 1.0;\r\n\r\n      if (this.lockoutTime >= 1.0) {\r\n        return;\r\n      }\r\n      //continue to with enter() fxn\r\n    }\r\n\r\n    for (var x = 0; x < number; x++) {\r\n      //get next in stock::\r\n      var livingCount = this.sprites.countLiving();\r\n\r\n      var s = new Gamelab.Sprite().Clone(this.sprites[0]);\r\n\r\n      s.Life(this.life);\r\n\r\n      if (this.createSprite) {\r\n        this.createSprite.bind(s).call();\r\n      }\r\n\r\n      this.livingSprites.push(s);\r\n\r\n      gameWindow.add(s);\r\n      this.livingTotal += 1;\r\n\r\n      if (this.onfire)\r\n        this.onfire(s);\r\n\r\n    }\r\n\r\n    return {\r\n\r\n      assignTrackableSpeed: function(speed) {\r\n\r\n        $p.trackableSpeed = speed;\r\n        return this;\r\n      },\r\n\r\n      assignLinesAndSelector: function(lineList, lineSelector) {\r\n        $p.lines = lines;\r\n        return this;\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  onUpdate(update) {\r\n    this.onupdate = update;\r\n    return this;\r\n  }\r\n\r\n  onFire(callback) {\r\n\r\n    this.onfire = callback;\r\n    return this;\r\n  }\r\n\r\n  fire(gameWindow) {\r\n    this.enter(1, gameWindow);\r\n  }\r\n\r\n}\r\n\r\nGamelab.SpriteFactory = SpriteFactory;;/**\r\n * Creates a new SpriteGroup.\r\n *\r\n * <info-bit>Gamelab.SpriteGroup is a container for RELATIVE-POSITIONED 2D Animations.\r\n * -apply Sprite class to create a 2D game-object.\r\n */\r\n\r\nclass SpriteGroup {\r\n  constructor(src = {}, scale = 1.0) {\r\n    this.sprites = [];\r\n    this.mainSprite = new Gamelab.Sprite(src, scale);\r\n  }\r\n\r\n  BasePosition(px, py){\r\n    this.basePosition = new Gamelab.Vector(px, py);\r\n    return this;\r\n  }\r\n\r\n  add(sprite){\r\n    this.sprites.push(sprite);\r\n    return this;\r\n  }\r\n};\r\n\r\nGamelab.SpriteGroup = SpriteGroup;\r\n;/**\r\n * Creates a new Terrain.\r\n *\r\n * @param   {string} src the srcPath for the image of the Terrain\r\n * @param   {number} scale=1.0 the scale to be applied to size of each animation-frame\r\n *\r\n * @returns {Terrain} a Gamelab.Terrain object\r\n *\r\n */\r\n\r\nclass Terrain extends Sprite {\r\n  constructor(src = {}, scale) {\r\n    super(src, scale);\r\n    this.imageOptions = [];\r\n    //1. Terrain can draw from a set of optional source images\r\n    //2. Terrain has values for collision\r\n    //3. Terrain can quickly instantiate objects for running, jumping, climbing\r\n    this.collisionObjects = [];\r\n    this.collisionBehavior = 'STOP';\r\n  }\r\n  Clone(sprite) {\r\n    console.log('using Clone() function');\r\n    var clone = new Gamelab.Terrain(sprite.src);\r\n    clone.Anime(new Gamelab.GridAnimation(sprite.anime));\r\n    clone.apply_args(sprite);\r\n    return clone;\r\n  }\r\n  multiply(top, left, skipTop, skipLeft) {\r\n\r\n  }\r\n  appendImageOption(src, scale) {\r\n    this.imageProfiles.push({\r\n      src,\r\n      scale\r\n    });\r\n  }\r\n  appendCollisionProfile(collisionObjects, collisionBehavior) {\r\n    this.collisionObjects = collisionObjects;\r\n    this.collisionBehavior = collisionBehavior;\r\n  }\r\n}\r\n\r\n\r\nclass CookieCutterTerrain extends Sprite {\r\n  constructor(src) {\r\n    super();\r\n    this.baseSprite = new Gamelab.Sprite(src);\r\n  }\r\n  repeat(x, y) {\r\n\r\n  }\r\n  //cut the terrain by non-transparent pixels of the image\r\n  cutByImage() {\r\n\r\n  }\r\n  cutByLine() {\r\n\r\n  }\r\n  highlightLine() {\r\n\r\n  }\r\n  plantSprite() {\r\n\r\n  }\r\n  scatterSprites() {\r\n\r\n  }\r\n}\r\n\r\nGamelab.Terrain = Terrain;\r\nGamelab.CookieCutterTerrain = Terrain;\r\n;(function() {\r\n  console.log('Animation class... creating');\r\n\r\n  /**\r\n   *\r\n   * Creates an instance of Animation with one or more Frames.\r\n   *\r\n   * <example-marker data-class='Animation' data-info='Use JQuery fnxs to load content into the div outside of this p-element. Do not use iframe' > </example-marker>\r\n   *\r\n   * @param   {string=} [src] the src-image-path for this Animation\r\n   * @returns {Animation} an Animation object\r\n   *\r\n   * @example\r\n   *\r\n   * //constructor call: Creates a single-frame Animation from src\r\n   * var singleFrameAnime = new Animation('directory/myFile.png');\r\n   *\r\n   * @example\r\n   * //constructor call with chainable function-calls: Creates multi-frame Animation from src, then sets properties with chainable-function-calls.\r\n   * var multiFrameAnime = new Gamelab.StaticAnimation('../images/characters/full/spaceman1.png') //constructor is called\r\n   * .FrameSize(130, 130)\r\n   * .FrameBounds(new Gamelab.Vector(9, 0), new Gamelab.Vector(23, 0), new Gamelab.Vector(23, 0))\r\n   * .Seesaw() //The Animation will play back-and-forth repeatedly (cycle through frames forwards, then backwards and so on.\r\n   * .Duration(900); //Animation lasts 900 millis OR just under 1 second\r\n   *\r\n   *  @design\r\n   *\r\n   * //single-responsibility : to define a list of frames, then progress that list of frames with a 'selected_frame' property\r\n   * var singleFrameAnime = new Animation('directory/myFile.png');\r\n   */\r\n\r\n  class StaticAnimation {\r\n    constructor(src = {}) {\r\n      var args = typeof(src) == 'object' ? src : {};\r\n      //Gamelab.Modifiers.informable(this, args);\r\n      /**\r\n       * @property {Vector} frameSize the frameSize of the Animation\r\n       * @memberof Animation\r\n       **********/\r\n\r\n      this.frameSize = this.frameSize || new Gamelab.Vector(args.frameSize || new Gamelab.Vector(0, 0));\r\n      this.size = this.size || new Gamelab.Vector(args.size || new Gamelab.Vector(0, 0));\r\n\r\n      this.type = 'Animation';\r\n\r\n      if (typeof src == 'string' || src instanceof HTMLCanvasElement) {\r\n        this.src = src;\r\n        this.image = new Gamelab.GameImage(src);\r\n        this.init_singleFrame();\r\n      } else if (args instanceof Gamelab.GameImage) {\r\n        //console.log('Animation(): args are an instance of GameImage');\r\n        this.image = args;\r\n      } else if (args instanceof HTMLImageElement) {\r\n        //console.log('Animation(): args was an instance of HTMLImageElement');\r\n        this.image = new Gamelab.GameImage(args);\r\n      } else if (args instanceof Gamelab.GridAnimation) {\r\n        this.image = args.image;\r\n      } else if (typeof(args) == 'object' && args.src) {\r\n        this.src = args.src;\r\n        this.image = new Gamelab.GameImage(args.src);\r\n      }\r\n\r\n      this.min_cix = 0;\r\n\r\n      this.visible = args.visible || true;\r\n\r\n      if (args.frameBounds && args.frameBounds.min && args.frameBounds.max) {\r\n        /**\r\n         * @property {VectorFrameBounds} frameBounds the frameBounds of the Animation, has three Vectors\r\n         * @memberof Animation\r\n         **********/\r\n        this.frameBounds = new Gamelab.VectorFrameBounds(args.frameBounds.min, args.frameBounds.max, args.frameBounds.termPoint);\r\n\r\n      } else {\r\n        this.frameBounds = new Gamelab.VectorFrameBounds(new Gamelab.Vector(0, 0, 0), new Gamelab.Vector(0, 0, 0), new Gamelab.Vector(0, 0, 0));\r\n      }\r\n\r\n      this.scale = 1.0;\r\n\r\n      this.origin = new Gamelab.Vector(0, 0, 0);\r\n\r\n      this.position = new Gamelab.Vector(0, 0);\r\n\r\n      this.rotation = new Gamelab.Vector(0, 0, 0);\r\n\r\n      this.frameOffset = this.getArg(args, 'frameOffset', new Gamelab.Vector(0, 0, 0));\r\n\r\n      this.flipX = this.getArg(args, 'flipX', false);\r\n\r\n      this.cix = 0;\r\n\r\n      /**\r\n       * @property {Frame} selected_frame the selected_frame of the Animation, a Gamelab.Frame\r\n       * @memberof Animation\r\n       **********/\r\n\r\n      this.selected_frame = false;\r\n      this.timer = 0;\r\n      this.duration = args.duration || 2000;\r\n      this.seesaw_mode = args.seesaw_mode || false;\r\n      this.reverse_frames = args.reverse_frames || false;\r\n      this.run_ext = args.run_ext || [];\r\n      this.complete_ext = args.complete_ext || [];\r\n\r\n      this.Scale(this.scale);\r\n      // this.colorMap = this.createColorMap(5);\r\n    }\r\n\r\n    set img_src(value) {\r\n      this.src = value;\r\n    }\r\n\r\n    get img_src() {\r\n      return this.src;\r\n    }\r\n\r\n    Origin(x, y, z) {\r\n      this.origin = new Gamelab.Vector(x, y, z);\r\n      this.frames.forEach(function($f) {\r\n        $f.origin = new Gamelab.Vector(x, y, z);\r\n      });\r\n      if (this.selected_frame) {\r\n        this.selected_frame.origin = new Gamelab.Vector(x, y, z);\r\n      }\r\n      return this;\r\n    }\r\n\r\n    Position(x, y, z) {\r\n      this.position = new Gamelab.Vector(x, y, z);\r\n\r\n      this.frames.forEach(function($f) {\r\n        $f.position = new Gamelab.Vector(x, y, z);\r\n      });\r\n\r\n      return this;\r\n    }\r\n\r\n    Size(x, y) {\r\n\r\n      this.size = new Gamelab.Vector(x, y);\r\n      this.frames.forEach(function(f) {\r\n\r\n        f.Size(x, y);\r\n\r\n      });\r\n      return this;\r\n    }\r\n\r\n    Bone(b) {\r\n      this.bone = b;\r\n      return this;\r\n    }\r\n\r\n    ParentBone(b) {\r\n      this.parentBone = b;\r\n      return this;\r\n    }\r\n\r\n    Rotation(x, y, z) {\r\n\r\n      this.rotation = new Gamelab.Vector(x, y, z);\r\n\r\n      this.frames.forEach(function($frame) {\r\n        $frame.Rotation(x, y, z);\r\n      });\r\n\r\n      return this;\r\n    }\r\n\r\n    add(frame) {\r\n      this.frames.push(frame);\r\n    }\r\n\r\n    Src(src, options = {}) {\r\n      if (typeof src == 'string') {\r\n        console.log('setting GameImage with string:' + src);\r\n        this.src = src;\r\n        this.image = new Gamelab.GameImage(src);\r\n      } else if (src instanceof GameImage) {\r\n        //console.log('Animation(): args are an instance of GameImage');\r\n        this.image = src;\r\n      } else if (src instanceof HTMLImageElement) {\r\n        //console.log('Animation(): args are an instance of HTMLImageElement');\r\n        this.image = new Gamelab.GameImage(src);\r\n      }\r\n\r\n      if (!options.frameBounds)\r\n        this.init_singleFrame();\r\n\r\n      return this;\r\n    }\r\n\r\n    Scale(s) {\r\n      this.scale = s;\r\n      if (this.image && this.image.domElement && this.image.domElement.width > 0) {\r\n        this.size = new Gamelab.Vector(this.image.domElement.width * s, this.image.domElement.height * s).round();\r\n        this.Size(this.size);\r\n      }\r\n      if (this.frames instanceof Array)\r\n        this.frames.forEach(function(f) {\r\n          f.Scale(s);\r\n        });\r\n      return this;\r\n    }\r\n\r\n    Size(x, y, z) {\r\n      this.size = new Gamelab.Vector(x, y, z);\r\n      this.frames.forEach(function(f) {\r\n        f.size = new Gamelab.Vector(x, y, z);\r\n      });\r\n      return this;\r\n    }\r\n\r\n    Image(src) {\r\n\r\n      if (typeof(src) == 'string') {\r\n        //console.log('setting GameImage with string:' + src);\r\n        this.src = src;\r\n        this.image = new Gamelab.GameImage(src);\r\n      } else if (src instanceof Gamelab.GameImage) {\r\n        //console.log('Animation(): args are an instance of GameImage');\r\n        this.image = src;\r\n      } else if (src instanceof HTMLImageElement) {\r\n        console.log('Animation(): args was an instance of HTMLImageElement');\r\n\r\n        this.image = new Gamelab.GameImage(src);\r\n      }\r\n      this.init_singleFrame();\r\n      return this;\r\n    }\r\n\r\n    /*****\r\n     * Overridable / Extendable functions\r\n     * -allows stacking of external object-function calls\r\n     ******/\r\n\r\n\r\n    /**\r\n     * Provides a function to be called when this Animation.image loads.\r\n     *\r\n     * @function\r\n     * @params {Function} call the function to be called on load\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    onLoad(call) {\r\n      var $anime = this;\r\n      call = call || function() {};\r\n      this.load_call = call;\r\n      this.image.domElement.onload = function() {\r\n        call.bind($anime).call();\r\n      };\r\n    }\r\n\r\n    /**\r\n     * Provides a function to be called whenever this Animation starts. Function should run every time the Animation reaches frame-index 0\r\n     *\r\n     * @function\r\n     * @params {Function} call the function to be called on start\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    onRun(call) {\r\n\r\n      if (this.run_ext.indexOf(call) == -1) {\r\n        this.run_ext.push(call.bind(this));\r\n      }\r\n    }\r\n\r\n\r\n    /**\r\n     * Provides a function to be called whenever this Animation completes. Function should run every time the Animation reaches it's last frame-index.\r\n     *\r\n     * @function\r\n     * @params {Function} call the function to be called on complete\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    onComplete(call) {\r\n\r\n      if (this.complete_ext.indexOf(call) == -1) {\r\n        this.complete_ext.push(call.bind(this));\r\n      }\r\n    }\r\n\r\n\r\n    /**\r\n     * Provides a single and only function to be called whenever this Animation completes. Function should run every time the Animation reaches it's last frame-index.\r\n     *\r\n     * @function\r\n     * @params {Function} call the function to be called on complete\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    soleComplete(call) {\r\n      this.complete_ext = [];\r\n      if (this.complete_ext.indexOf(call) == -1) {\r\n        this.complete_ext.push(call.bind(this));\r\n      }\r\n    }\r\n\r\n    call_on_run() {\r\n      //call any function extension that is present\r\n      for (var x = 0; x < this.run_ext.length; x++) {\r\n        this.run_ext[x](this);\r\n      }\r\n    }\r\n\r\n    call_on_complete() {\r\n      //call any function extension that is present\r\n      for (var x = 0; x < this.complete_ext.length; x++) {\r\n        this.complete_ext[x](this);\r\n      }\r\n    }\r\n\r\n\r\n    Visible(v) {\r\n      this.visible = v;\r\n      return this;\r\n    }\r\n\r\n\r\n    FrameSize(w, h) {\r\n      this.frameSize = new Gamelab.Vector(w, h);\r\n      this.__isInit = true;\r\n      return this;\r\n    }\r\n\r\n    Hang() {\r\n      this._hang = true;\r\n      return this;\r\n    }\r\n\r\n    ResetHang() {\r\n      this._hang = false;\r\n      this.cix = this.min_cix;\r\n    }\r\n\r\n    FrameOffset(x, y) {\r\n      this.frameOffset = new Gamelab.Vector(x, y);\r\n      return this;\r\n    }\r\n\r\n    Seesaw() {\r\n      if (!this.seesaw_mode) {\r\n        this.seesaw_mode = true;\r\n      }\r\n      return this;\r\n    }\r\n\r\n    Duration(millis) {\r\n      this.duration = millis;\r\n      return this;\r\n    }\r\n\r\n\r\n    /**\r\n     * Reverses all frames of the animation. Frames are then expected to run backwards.\r\n     *\r\n     * @function\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    ReverseFrames() {\r\n\r\n      this.reverse_frames = true;\r\n      return this;\r\n    }\r\n\r\n    /**\r\n     * Sets the animation a a single frame / full-image. Use before img is loaded\r\n     *\r\n     * @function\r\n     * @param {Vector} frameSize optional size param\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    SingleFrame() {\r\n      this.init_singleFrame();\r\n      return this;\r\n    }\r\n\r\n    getArg(args, key, fallback) {\r\n\r\n      if (args.hasOwnProperty(key)) {\r\n        return args[key];\r\n      } else {\r\n        return fallback;\r\n      }\r\n    }\r\n\r\n    init() {\r\n      return this;\r\n    }\r\n\r\n    scaleOf(sized_Object) {\r\n\r\n      var s = TypeCode.getPreferredPropertyByKey(sized_Object, 'size', 'argument had nested size variable. Using this instead.');\r\n\r\n      return s.div(this.frameSize);\r\n\r\n    }\r\n\r\n    init_colorMap(spatialDiv) {\r\n      TypeCode.info('init_colorMap()');\r\n\r\n      if (!TypeCode.allDefined([this.image, this.image.domElement]))\r\n        return [];\r\n\r\n      this.canvasObject = this.canvasObject || new Gamelab.OffscreenCanvasRendering(this.image);\r\n      this.colorMap = this.colorMap || this.ColoredPixelGrid(spatialDiv);\r\n      return this.colorMap;\r\n    }\r\n\r\n\r\n    ColoredPixelGrid(spatialDiv = 5.0) {\r\n\r\n      var image = this.image.domElement,\r\n        ctx = this.canvasObject.ctx,\r\n        grid = [],\r\n        frameSizeDiv = this.selected_frame.frameSize.div(spatialDiv).round();\r\n\r\n      for (var x = 0; x <= image.width; x += frameSizeDiv.x) {\r\n        for (var y = 0; y <= image.height; y += frameSizeDiv.y) {\r\n          // Fetch pixel at current position\r\n          var pixel = ctx.getImageData(x, y, 1, 1);\r\n          // Check that opacity is above zero\r\n          if (pixel.data[3] != 0) {\r\n            var vector = new Gamelab.Vector(x, y),\r\n              gridObject = {\r\n                position: vector.sub(frameSizeDiv.div(2.0)),\r\n                size: frameSizeDiv\r\n              };\r\n\r\n            grid.push(gridObject);\r\n          }\r\n        }\r\n      }\r\n\r\n      return grid;\r\n    }\r\n\r\n    /**\r\n     * Returns the existing ColorMap for this animation.\r\n     *\r\n     * @function\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    getCurrentPixelMap(spatialDiv) {\r\n\r\n      TypeCode.info('getCurrentPixelMap()');\r\n      var map = [];\r\n      var frame = this.selected_frame;\r\n      let __inst = this;\r\n\r\n      this.colorMap = this.init_colorMap(spatialDiv);\r\n\r\n      for (var x in this.colorMap) {\r\n        var c = this.colorMap[x];\r\n\r\n        if (Gamelab.Collision.boxCollide(frame.framePos, frame.frameSize, c.position, c.size)) {\r\n          map.push(c);\r\n        }\r\n      }\r\n      return map;\r\n    }\r\n\r\n    /**\r\n     * Sets the frame to a specific array-index.\r\n     *\r\n     * @function\r\n     * @param {number} ix the frame-index to apply.\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    setFrame(ix) {\r\n      this.selected_frame = this.frames[ix];\r\n    }\r\n\r\n\r\n    /**\r\n     * extends the update of this animation with a new function to be called during the update\r\n     * --repeated calls will extend, (not replace) the update --Allows multiple extensions of the update\r\n     * @function\r\n     * @memberof Animation\r\n     * @param {function} fun the function to be appended to sprite.update\r\n     *\r\n     *  * @example\r\n     * // extend the behavior of your animation\r\n     * myAnime.onUpdate(function(spr)\r\n     *\r\n     *                    console.log('extended update'); //runs automatically whenever animation.update runs\r\n     *\r\n     *                   });\r\n     *\r\n     **********/\r\n    onUpdate(fun) {\r\n      fun = fun.bind(this);\r\n      let update = this.update_frame.bind(this);\r\n      let __inst = this;\r\n      this.update_frame = function(__inst) {\r\n        update(__inst);\r\n        fun(__inst);\r\n      };\r\n    }\r\n    soleUpdate(fun) {\r\n      fun = fun.bind(this);\r\n      let __inst = this;\r\n      this.update_frame = function(__inst) {\r\n        fun(__inst);\r\n      };\r\n    }\r\n    update_frame() {\r\n      this.selected_frame = this.frames[Math.round(this.cix) % this.frames.length];\r\n    }\r\n    reset() {\r\n      this.cix = 0;\r\n    }\r\n    /**\r\n     * Applies a continuous animation. Use this in parent-sprite's update if continuous animation is required.\r\n     * Also works as a single call at any time during game-update.\r\n     *\r\n     * @function\r\n     * @memberof Animation\r\n     **********/\r\n    run() {\r\n      if (this.__frametype == 'single') {\r\n        return 0;\r\n      }\r\n      this.cix += 1;\r\n      this.update_frame();\r\n    }\r\n    /**\r\n     * animate():: same as run()\r\n     *\r\n     * @function\r\n     * @memberof Animation\r\n     **********/\r\n    animate() {\r\n\r\n      if (this.__frametype == 'single') {\r\n        return 0;\r\n      }\r\n\r\n      if (!this.applied) {\r\n        this.applied = true;\r\n      }\r\n\r\n      if (this.cix % this.frames.length == 0) {\r\n        this.engage();\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Engages, or updates the animation for a one full frame-cycle.\r\n     *\r\n     * @function\r\n     * @param {number} duration the number of milliseconds the animation should take.\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    engage(duration) {\r\n      this.call_on_run();\r\n      duration = duration || this.duration || this.frames.length * 20;\r\n      if (this.__frametype == 'single') {\r\n        return 0;\r\n      }\r\n\r\n      //note support of min_cix (eg: min_cix of 1 if top-row starts 1 frame later than bottom)\r\n      if (this.cix >= this.frames.length - 1 || this.cix < this.min_cix && !this._hang) {\r\n        this.cix = this.min_cix;\r\n      }\r\n      let __inst = this;\r\n\r\n      //we have a target\r\n      this.tween = new TWEEN.Tween(this)\r\n        .easing(__inst.curve || TWEEN.Easing.Linear.None)\r\n        .to({\r\n          cix: this.min_cix + (this.frames.length - 1)\r\n        }, duration)\r\n        .onUpdate(function() {\r\n          //console.log(objects[0].position.x,objects[0].position.y);\r\n          //__inst.cix = Math.ceil(__inst.cix);\r\n          __inst.update_frame();\r\n        })\r\n        .onComplete(function() {\r\n          //console.log(objects[0].position.x, objects[0].position.y);\r\n          if (!__inst._hang)\r\n            __inst.cix = __inst.min_cix;\r\n          __inst.call_on_complete();\r\n          __inst.isComplete = true;\r\n        });\r\n\r\n      if (this.cix == this.min_cix)\r\n        this.tween.start();\r\n\r\n    }\r\n  };\r\n\r\n  /** @memberof Gamelab */\r\n  Gamelab.StaticAnimation = StaticAnimation;\r\n  Gamelab.StaticAnimation.continuous = Gamelab.StaticAnimation.run; //'continuous is an alternate reference to 'run'.'\r\n  Gamelab.StaticAnimation.update = Gamelab.StaticAnimation.update_frame; //alt ref\r\n  Gamelab.StaticAnimation.continue = Gamelab.StaticAnimation.run; //'continue is an alternate reference to 'run'.'\r\n})();\r\n;class Text {\r\n\r\n  constructor(value) {\r\n    this.Text(value);\r\n    this.FontSize(15);\r\n    this.FontFamily('Arial');\r\n    this.color = 'white';\r\n    this.shadowColor = 'black';\r\n    this.shadowBlur = 0;\r\n    this.position = new Gamelab.Vector(0, 0);\r\n  }\r\n\r\n  Text(t) {\r\n    this.text = t;\r\n    this.value = t;\r\n    return this;\r\n  }\r\n\r\n  Shadow(color, blur) {\r\n    this.shadowColor = color;\r\n    this.shadowBlur = blur;\r\n    return this;\r\n  }\r\n\r\n  Font(fsize, ffamily) {\r\n    this.FontSize(fsize);\r\n    this.FontFamily(ffamily)\r\n    return this;\r\n  }\r\n\r\n  Color(c) {\r\n    this.color = c;\r\n    return this;\r\n  }\r\n\r\n  FontSize(value) {\r\n    if (typeof value !== 'string')\r\n      value = value + '';\r\n    value = value.replace('px', '') + 'px';\r\n    this.fontSize = value;\r\n    return this;\r\n  }\r\n  FontFamily(value) {\r\n    this.fontFamily = value;\r\n    return this;\r\n  }\r\n  getOffsetPos(pos) {\r\n    var offset = this.window_offset || new Gamelab.Vector(0, 0);\r\n    return pos.add(offset);\r\n  }\r\n\r\n  draw(ctx, camera) {\r\n    console.log(\"DRAWING object.text.js\");\r\n    var x = this.position.x + camera.position.x,\r\n      y = this.position.y + camera.position.y;\r\n\r\n    if (ctx.save) {\r\n      ctx.save();\r\n    }\r\n\r\n    ctx.fillStyle = this.color;\r\n    ctx.font = this.fontSize + ' ' + this.fontFamily;\r\n\r\n    var size = ctx.measureText(this.text);\r\n\r\n    ctx.shadowColor = this.shadowColor;\r\n    ctx.shadowBlur = this.shadowBlur;\r\n\r\n    //use the width of capital M as approximate text height\r\n\r\n    this.size = new Gamelab.Vector(size.width, ctx.measureText('M').width);\r\n\r\n    var pos = new Gamelab.Vector(x, y),\r\n      realPos = this.getOffsetPos(pos);\r\n\r\n    ctx.fillText(this.text, realPos.x, realPos.y);\r\n    ctx.restore();\r\n  }\r\n}\r\n\r\n\r\nGamelab.Text = Text;\r\n;;Gamelab.assign3DGroupMesh = function(key, mesh, sprite) {\r\n  Gamelab.ThreejsGroups = Gamelab.ThreejsGroups || [];\r\n  Gamelab.ThreejsGroups[key] = Gamelab.ThreejsGroups[key] || new THREE.Object3D();\r\n  Gamelab.ThreejsGroups[key].countOps = Gamelab.ThreejsGroups[key].countOps || 1.0;\r\n  Gamelab.ThreejsGroups[key].countOps += 1.0;\r\n  Gamelab.ThreejsGroups[key].add(mesh);\r\n  mesh.layer = sprite.layer;\r\n  return Gamelab.ThreejsGroups[key];\r\n};\r\n\r\nclass Sprite3D {\r\n  constructor(gamelabSprite, scale) {\r\n    var sprite = gamelabSprite,\r\n      texture = new THREE.TextureLoader().load(sprite.src);\r\n    texture.wrapS = texture.wrapT = THREE.ClampToEdgeWrapping;\r\n    var w = sprite.image.domElement.width,\r\n      h = sprite.image.domElement.height;\r\n\r\n    this.w = w;\r\n    this.h = h;\r\n\r\n    var geometry = new THREE.PlaneGeometry(w, h, 256, Math.round(256 * (w / h)));\r\n\r\n    this.geometry = geometry;\r\n\r\n    this.vertices = this.geometry.vertices;\r\n\r\n    var material = new THREE.MeshPhongMaterial({\r\n      map: texture,\r\n      transparent: true\r\n    });\r\n    //material.colorWrite = false;\r\n    material.side = THREE.DoubleSide;\r\n\r\n    var mesh = new THREE.Mesh(geometry, material);\r\n\r\n    material.needsUpdate = true;\r\n\r\n    sprite.threejsScale = scale * sprite.scale;\r\n\r\n    this.spriteScale = scale;\r\n\r\n    mesh.scale.set(sprite.threejsScale, sprite.threejsScale, 1);\r\n\r\n    this.size3D = new Gamelab.Vector(w * this.threejsScale, h * this.threejsScale);\r\n\r\n    this.size3d = this.size3D;\r\n\r\n    // Add to pivot group\r\n    var member = new THREE.Object3D();\r\n\r\n    member.add(mesh);\r\n\r\n    this.mesh = mesh;\r\n\r\n    this.member = member;\r\n    sprite.builderGroup = sprite.builderGroup || 'MASTER';\r\n    this.threejsGroup = Gamelab.assign3DGroupMesh(sprite.builderGroup, this.member, sprite);\r\n    this.threejsMesh = mesh;\r\n\r\n    var realSize = new Gamelab.Vector(sprite.image.domElement.width, sprite.image.domElement.height, 1).mult(sprite.threejsScale);\r\n\r\n    this.group = this.threejsGroup;\r\n\r\n    this.threejsGroup.needsUpdate = true;\r\n\r\n    var t3d = this;\r\n\r\n    sprite.onLoad(function() {\r\n\r\n      var size2D = t3d.visibleSize(camera, renderer).size;\r\n\r\n      while (size2D.x > sprite.size.x) {\r\n        scale -= 0.02;\r\n        t3d.Scale(scale);\r\n        size2D = t3d.visibleSize(camera, renderer).size;\r\n        camera.updateMatrixWorld();\r\n      }\r\n\r\n      while (size2D.x < this.size.x) {\r\n        scale += 0.02;\r\n        t3d.Scale(scale);\r\n        size2D = t3d.visibleSize(camera, renderer).size;\r\n        camera.updateMatrixWorld();\r\n      }\r\n    });\r\n\r\n\r\n  }\r\n  ScreenSize(camera) {\r\n    var mesh = this.mesh;\r\n    var vertices = mesh.geometry.vertices;\r\n    var vertex = new THREE.Vector3();\r\n    var min = new THREE.Vector3(1, 1, 1);\r\n    var max = new THREE.Vector3(-1, -1, -1);\r\n\r\n    for (var i = 0; i < vertices.length; i++) {\r\n      var vertexWorldCoord = vertex.copy(vertices[i]).applyMatrix4(mesh.matrixWorld);\r\n      var vertexScreenSpace = vertexWorldCoord.project(camera);\r\n      min.min(vertexScreenSpace);\r\n      max.max(vertexScreenSpace);\r\n    }\r\n\r\n    return new THREE.Box2(min, max);\r\n  }\r\n  Scale(scaleValue) {\r\n    this.threejsScale = scaleValue * this.spriteScale;\r\n    this.mesh.scale.set(this.threejsScale, this.threejsScale, 1);\r\n    this.size3D = new Gamelab.Vector(this.w * this.threejsScale, this.h * this.threejsScale);\r\n    return this;\r\n  }\r\n  visibleSize(camera, renderer) {\r\n    var obj = this.threejsGroup;\r\n    var box = new THREE.Box3().setFromObject(this.mesh);\r\n    var size = box.getSize();\r\n    console.log(size);\r\n\r\n    // Calc distance of obj from camera\r\n    var distance = camera.position.distanceTo(obj.position);\r\n    console.log('distance: ', distance);\r\n    distance = camera.position.z - obj.position.z - (size.z / 2);\r\n\r\n    var aspect = renderer.domElement.width / renderer.domElement.height;\r\n    // Calc height and width\r\n    var vFOV = THREE.Math.degToRad(camera.fov); // convert vertical fov to radians\r\n    var height = 2 * Math.tan(vFOV / 2) * distance; // visible height\r\n    var width = height * aspect; //camera.aspect;           // visible width\r\n\r\n    var ratio = distance / height; // height per 1 of z-depth\r\n    console.log('depath ratio: ', ratio);\r\n\r\n    width = size.x / ratio * aspect;\r\n    height = size.y / ratio * aspect;\r\n\r\n    // Calc position\r\n    var vector = new THREE.Vector3();\r\n    var viewProjectionMatrix = new THREE.Matrix4();\r\n    var viewMatrix = new THREE.Matrix4();\r\n    viewMatrix.copy(camera.matrixWorldInverse);\r\n    viewProjectionMatrix.multiplyMatrices(camera.projectionMatrix, viewMatrix);\r\n    var widthHalf = 0.5 * renderer.domElement.width;\r\n    var heightHalf = 0.5 * renderer.domElement.height;\r\n    obj.updateMatrixWorld();\r\n    vector.setFromMatrixPosition(obj.matrixWorld);\r\n    //vector.project(camera);\r\n    vector.applyMatrix4(viewProjectionMatrix);\r\n\r\n    vector.x = (vector.x * widthHalf) + widthHalf;\r\n    vector.y = -(vector.y * heightHalf) + heightHalf;\r\n    /*\r\n        vector.x = 2 * (vector.x / renderer.domElement.width) - 1;\r\n        vector.y = 1 - 2 * ( vector.y / renderer.domElement.height );*/\r\n    var x = vector.x;\r\n    var y = vector.y;\r\n\r\n    var result = {\r\n      position: new Gamelab.Vector(x - width / 2, y - height / 2),\r\n      size: new Gamelab.Vector(width, height)\r\n    };\r\n    console.info(result);\r\n    return result;\r\n  }\r\n\r\n  fitCamera(camera, scene, offset) {\r\n\r\n    offset = offset || 1.25;\r\n\r\n    const boundingBox = new THREE.Box3();\r\n\r\n    var object = this.mesh;\r\n\r\n    // get bounding box of object - this will be used to setup controls and camera\r\n    boundingBox.setFromObject(object);\r\n\r\n    const center = boundingBox.getCenter();\r\n\r\n    const size = boundingBox.getSize();\r\n\r\n    // get the max side of the bounding box (fits to width OR height as needed )\r\n    const maxDim = Math.max(size.x, size.y, size.z);\r\n    const fov = camera.fov * (Math.PI / 180);\r\n    let cameraZ = Math.abs(maxDim / 2 * Math.tan(fov * 2)); //Applied fifonik correction\r\n\r\n    cameraZ *= offset; // zoom out a little so that objects don't fill the screen\r\n\r\n    // <--- NEW CODE\r\n    //Method 1 to get object's world position\r\n    scene.updateMatrixWorld(); //Update world positions\r\n    var objectWorldPosition = new THREE.Vector3();\r\n    objectWorldPosition.setFromMatrixPosition(object.matrixWorld);\r\n\r\n    //Method 2 to get object's world position\r\n    //objectWorldPosition = object.getWorldPosition();\r\n\r\n    const directionVector = camera.position.sub(objectWorldPosition); //Get vector from camera to object\r\n    const unitDirectionVector = directionVector.normalize(); // Convert to unit vector\r\n    camera.position = unitDirectionVector.multiplyScalar(cameraZ); //Multiply unit vector times cameraZ distance\r\n    camera.lookAt(objectWorldPosition); //Look at object\r\n    // --->\r\n\r\n    const minZ = boundingBox.min.z;\r\n    const cameraToFarEdge = (minZ < 0) ? -minZ + cameraZ : cameraZ - minZ;\r\n\r\n    camera.far = cameraToFarEdge * 3;\r\n    camera.updateProjectionMatrix();\r\n  }\r\n  get2DSize(camera, div) {\r\n    this.size3D = new THREE.Vector3(this.size3D.x, this.size3D.y, 0);\r\n    var size = new Gamelab.Vector(Gamelab.ThreeJsMath.getScreenXY(this.size3D, camera, div));\r\n    return size;\r\n  }\r\n}\r\n\r\nlet Sprite3d = Sprite3D;\r\n\r\nGamelab.Sprite3D = Sprite3D;\r\nGamelab.Sprite3d = Sprite3d;;class FeatureSymbol {\r\n  constructor(key) {\r\n    this.key = key || \"@NONE\";\r\n    this.symbol = Symbol(key);\r\n  }\r\n}\r\n\r\nGamelab.FeatureSymbol = FeatureSymbol;\r\n\r\nGamelab.FeatureInjectors = Gamelab.FeatureInjectors || {};\r\n\r\nGamelab.FeatureInject = function(constructor, args) {\r\n\r\n  //console.log('Gamelab.FeatureInject()');\r\n\r\n  var GClassFeatures = {};\r\n\r\n\r\n  for (var y in Gamelab.ObjectFeatureMap) {\r\n\r\n    if (Gamelab[y] && typeof Gamelab[y] == 'function') {\r\n\r\n      var constructor = Gamelab[y];\r\n\r\n      GClassFeatures[y] = {};\r\n\r\n      //  console.log('Feature Symbol-key:' + Gamelab.ObjectFeatureMap[x][y]);\r\n\r\n      GClassFeatures[y].featureSymbols = GClassFeatures[y].featureSymbols || [];\r\n\r\n      for (var z in Gamelab.ObjectFeatureMap[y]) {\r\n\r\n        GClassFeatures[y].featureSymbols.push(new Gamelab.FeatureSymbol(Gamelab.ObjectFeatureMap[y][z]));\r\n\r\n        GClassFeatures[y].featureSymbols.hasKey = function(key) {\r\n\r\n          for (var x = 0; x < this.length; x++) {\r\n            if (typeof this[x].key !== 'string')\r\n              continue;\r\n\r\n            if (this[x].key.indexOf('@') == -1)\r\n              console.error('feature-keys must contain @');\r\n\r\n            //  console.log('eval key:' + this[x].key.split('@')[1]);\r\n\r\n            if (this[x].key.split('@')[1] == key)\r\n              return true;\r\n          }\r\n\r\n          return false;\r\n        };\r\n\r\n        GClassFeatures[y].featureSymbols.hasSymbol = function(symbol) {\r\n          for (var x in this) {\r\n            if (this[x].symbol == symbol)\r\n              return true;\r\n          }\r\n\r\n          return false;\r\n        };\r\n\r\n        //  console.info('adding feature-symbol:' + Gamelab.ObjectFeatureMap[x][y]);\r\n      }\r\n    } else {\r\n      console.error('Gamelab.ObjectFeatureMap: member by name of ' + x + ' does not exist as member of Gamelab');\r\n    }\r\n  }\r\n\r\n\r\n  console.info('FEATURES:', GClassFeatures);\r\n\r\n\r\n  for (var x in Gamelab.FeatureInjectors) {\r\n\r\n    //  console.log(Gamelab.FeatureInjectors[x]);\r\n\r\n    var props = TypeCode.getProtoFuncs(Gamelab.FeatureInjectors[x]);\r\n\r\n    for (var y = 0; y < props.length; y++) {\r\n      console.log(x + \":\" + props[y]);\r\n      for (var z in GClassFeatures)\r\n        if (GClassFeatures[z] && GClassFeatures[z].featureSymbols.hasKey(props[y])) {\r\n          Gamelab.FeatureInjectors[x][props[y]](Gamelab[z].prototype, args);\r\n        }\r\n    }\r\n  }\r\n\r\n};\r\n\r\n\r\nclass CssFeatures {\r\n\r\n  colored(obj){\r\n    obj.Color = function(c)\r\n    {\r\n      this.color = c;\r\n      return this;\r\n    }\r\n  }\r\n\r\n  color_transition(min_color, max_color){\r\n    this.min_color = min_color;\r\n    this.max_color = max_color;\r\n    return this;\r\n  }\r\n\r\n  text(obj){\r\n    obj.Text = function(value)\r\n    {\r\n      this.text = value;\r\n      return this;\r\n    }\r\n  }\r\n\r\n  opaque(obj){\r\n    obj.Opacity = function(o){\r\n      this.opacity = o;\r\n      return this;\r\n    }\r\n  }\r\n};\r\n\r\n\r\nclass DataFunctions {\r\n\r\n  data(obj){\r\n\r\n    obj.Name = function(n) {\r\n      this.name = n;\r\n      return this;\r\n    };\r\n\r\n    obj.Description = function(d){\r\n      this.description = d;\r\n      return this;\r\n    };\r\n\r\n    obj.Context = function(c) {\r\n      this.context = c;\r\n      return this;\r\n    };\r\n\r\n    obj.create_id = function(){\r\n      return Gamelab.create_id();\r\n    }\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n/***************************\r\nGeometryFeatures:\r\n  A functional dependency injector\r\n  injects properties and functions according to Symbols\r\n**************************/\r\nclass VectorFunctions {\r\n  constructor() {\r\n\r\n    this.name = 'VectorFunctionals';\r\n\r\n  }\r\n\r\n  collideable(obj) {\r\n    obj.collision_callback = function() {};\r\n    obj.onCollide = args.onCollide || function(collideables, callback) {\r\n      if (typeof(collideables) == 'function') {\r\n        callback = collideables;\r\n      }\r\n      this.collision_callback = callback || function() {};\r\n    };\r\n  }\r\n\r\n  spatial(obj) {\r\n\r\n    obj.Size = function(x, y, z) {\r\n\r\n      if (typeof(x) == 'object')\r\n        this.size = new Gamelab.Vector(x);\r\n\r\n      else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n        this.size = new Gamelab.Vector(x, y, z);\r\n\r\n      else //use x accross the vector\r\n        this.size = new Gamelab.Vector(x, x, x);\r\n\r\n      return this;\r\n    };\r\n\r\n    obj.Pos = function(x, y, z) {\r\n\r\n      if (typeof(x) == 'object')\r\n        this.position = new Gamelab.Vector(x);\r\n\r\n      else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n        this.position = new Gamelab.Vector(x, y, z);\r\n\r\n      else //use x accross the vector\r\n        this.position = new Gamelab.Vector(x, x, x);\r\n\r\n      return this;\r\n    };\r\n\r\n    obj.Rot = function(x, y, z) {\r\n\r\n      if (typeof(x) == 'object')\r\n        this.rotation = new Gamelab.Vector(x);\r\n\r\n      else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n        this.rotation = new Gamelab.Vector(x, y, z);\r\n\r\n      else //use x accross the vector\r\n        this.rotation = new Gamelab.Vector(x, x, x);\r\n\r\n      return this;\r\n    };\r\n\r\n    obj.Position = obj.Pos;\r\n\r\n    obj.Rotate = obj.Rot;\r\n\r\n    obj.Rotation = obj.Rot;\r\n\r\n  }\r\n\r\n  relative_spatial(obj){\r\n\r\n\r\n        obj.Size = function(x, y, z) {\r\n\r\n          if (typeof(x) == 'object')\r\n            this.size = new Gamelab.Vector(x);\r\n\r\n          else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n            this.size = new Gamelab.Vector(x, y, z);\r\n\r\n          else //use x accross the vector\r\n            this.size = new Gamelab.Vector(x, x, x);\r\n\r\n          return this;\r\n        };\r\n\r\n        obj.Pos = function(x, y, z) {\r\n\r\n          var bpx = 0;\r\n          if(this.basePosition &&  this.basePosition.x)\r\n          bpx = this.basePosition.x;\r\n\r\n          if (typeof(x) == 'object')\r\n            this.position = new Gamelab.Vector(bpx + x);\r\n\r\n          else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n            this.position = new Gamelab.Vector(bpx + x, y, z);\r\n\r\n          else //use x accross the vector\r\n            this.position = new Gamelab.Vector(bpx + x, x, x);\r\n\r\n          return this;\r\n        };\r\n\r\n        obj.Rot = function(x, y, z) {\r\n\r\n          var bx = 0;\r\n          if(this.baseRotation &&  this.baseRotation.x)\r\n          bx = this.baseRotation.x;\r\n\r\n          if (typeof(x) == 'object')\r\n            this.rotation = new Gamelab.Vector(bx + x);\r\n\r\n          else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n            this.rotation = new Gamelab.Vector(bx + x, y, z);\r\n\r\n          else //use x accross the vector\r\n            this.rotation = new Gamelab.Vector(bx + x, x, x);\r\n\r\n          return this;\r\n        };\r\n\r\n        obj.Position = obj.Pos;\r\n\r\n        obj.Rotate = obj.Rot;\r\n\r\n        obj.Rotation = obj.Rot;\r\n\r\n  }\r\n\r\n  posable(obj) {\r\n\r\n    obj.Pos = function(x, y, z) {\r\n\r\n      if (typeof(x) == 'object')\r\n        this.position = new Gamelab.Vector(x);\r\n\r\n      else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n        this.position = new Gamelab.Vector(x, y, z);\r\n\r\n      else //use x accross the vector\r\n        this.position = new Gamelab.Vector(x, x, x);\r\n\r\n      return this;\r\n    };\r\n\r\n    obj.Position = obj.Pos;\r\n\r\n  }\r\n\r\n  sizeable(obj) {\r\n\r\n    obj.Size = function(x, y, z) {\r\n\r\n      if (typeof(x) == 'object')\r\n        this.size = new Gamelab.Vector(x);\r\n\r\n      else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n        this.size = new Gamelab.Vector(x, y, z);\r\n\r\n      else //use x accross the vector\r\n        this.size = new Gamelab.Vector(x, x, x);\r\n\r\n      return this;\r\n    };\r\n\r\n    obj.Position = obj.Pos;\r\n\r\n  }\r\n\r\n  rotable(obj) {\r\n    obj.Rot = function(x, y, z) {\r\n\r\n      if (typeof(x) == 'object')\r\n        this.rotation = new Gamelab.Vector(x);\r\n\r\n      else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n        this.rotation = new Gamelab.Vector(x, y, z);\r\n\r\n      else //use x accross the vector\r\n        this.rotation = new Gamelab.Vector(x, x, x);\r\n\r\n      if (typeof this.Transpose == 'function') {\r\n        this.Transpose();\r\n      }\r\n\r\n      return this;\r\n    };\r\n\r\n    obj.Rotate = obj.Rot;\r\n\r\n    obj.Rotation = obj.Rot;\r\n\r\n  }\r\n\r\n  minable(obj) {\r\n    obj.Min = function(x, y, z) {\r\n\r\n      if (typeof(x) == 'object')\r\n        this.min = new Gamelab.Vector(x);\r\n\r\n      else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n        this.min = new Gamelab.Vector(x, y, z);\r\n\r\n      else //use x accross the vector\r\n        this.min = new Gamelab.Vector(x, x, x);\r\n\r\n      return this;\r\n    };\r\n\r\n    obj.Minimum = obj.Min;\r\n\r\n  }\r\n\r\n  maxable(obj) {\r\n    obj.Max = function(x, y, z) {\r\n\r\n      if (typeof(x) == 'object')\r\n        this.max = new Gamelab.Vector(x);\r\n\r\n      else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n        this.max = new Gamelab.Vector(x, y, z);\r\n\r\n      else //use x accross the vector\r\n        this.max = new Gamelab.Vector(x, x, x);\r\n\r\n      return this;\r\n    };\r\n\r\n    obj.Maximum = obj.Max;\r\n\r\n  }\r\n\r\n  boundable(obj) {\r\n    this.minable(obj);\r\n\r\n    this.maxable(obj);\r\n  }\r\n\r\n  selftransposable(obj) {\r\n    //apply the transposition\r\n    obj.Transpose = function(rotation, position) {\r\n\r\n      this.rotation = new Gamelab.Vector(rotation || this.rotation);\r\n\r\n      this.position = new Gamelab.Vector(position || this.position);\r\n\r\n      //TODO: Modify this trig function and its call below to an optional 3D rotation\r\n\r\n      for (var x = 0; x < this.points.length; x++) {\r\n\r\n        var p = this.points[x];\r\n\r\n        var np = Gamelab.Trig.rotate_from_xy(0, 0, p.x, p.y, this.rotation.x);\r\n\r\n        this.points[x] = this.position.add(np);\r\n\r\n      }\r\n      return this;\r\n    };\r\n\r\n  }\r\n\r\n  pointarrayflippable(obj) {\r\n    //apply the transposition\r\n    obj.FlipX = function() {\r\n\r\n      var middle = Math.floor(this.points.length / 2); //account for FlipX with length of --odd number\r\n\r\n      var x, y;\r\n\r\n      for (x = this.points.length - 1, y = 0; x > middle, y < middle; x--, y++) {\r\n\r\n        var p1 = this.points[x],\r\n          p2 = this.points[y];\r\n\r\n        [p1.x, p2.x] = [p2.x, p1.x];\r\n\r\n      }\r\n\r\n      return this;\r\n    };\r\n\r\n\r\n    //apply the transposition\r\n    obj.FlipY = function() {\r\n\r\n      var middle = Math.floor(this.points.length / 2); //account for FlipX with length of --odd number\r\n\r\n      var x, y;\r\n\r\n      for (x = this.points.length - 1, y = 0; x > middle, y < middle; x--, y++) {\r\n\r\n        var p1 = this.points[x],\r\n          p2 = this.points[y];\r\n\r\n        [p1.y, p2.y] = [p2.y, p1.y];\r\n\r\n      }\r\n\r\n      return this;\r\n    };\r\n\r\n  }\r\n\r\n  informable(obj, args) {\r\n    obj.name = Gamelab.getArg(args, 'name', \"__ObjectName\");\r\n\r\n    obj.description = Gamelab.getArg(args, 'description', false);\r\n\r\n    obj.group = Gamelab.getArg(args, 'group', 'one');\r\n  }\r\n\r\n  tweenable(obj) {\r\n\r\n    obj.curve_string = obj.curve_string || \"linearNone\";\r\n\r\n    obj.setTweenCurve = function(c) {\r\n\r\n      c = c || \"linear_none\";\r\n\r\n      var cps = c.split('_');\r\n\r\n      //alert(cps);\r\n\r\n      var s1 = cps[0].toLowerCase(),\r\n        s2 = cps[1].toLowerCase();\r\n\r\n      var curve = TWEEN.Easing.Linear.None;\r\n\r\n      obj.curve_string = 'linear_none'\r\n\r\n      Gamelab.each(TWEEN.Easing, function(ix, easing) {\r\n\r\n        Gamelab.each(TWEEN.Easing[ix], function(iy, easeType) {\r\n\r\n          if (ix == s1 && iy == s2) {\r\n\r\n            // alert('setting curve');\r\n\r\n            curve = TWEEN.Easing[ix][iy];\r\n\r\n            obj.curve_string = ix + '_' + iy;\r\n\r\n          }\r\n\r\n        });\r\n\r\n      });\r\n\r\n      obj.curve = curve;\r\n\r\n      return curve;\r\n\r\n    };\r\n\r\n    obj.curvesToArray = function() {\r\n\r\n      var c = [];\r\n\r\n      Gamelab.each(TWEEN.Easing, function(ix, easing) {\r\n\r\n        Gamelab.each(easing, function(iy, easeType) {\r\n\r\n          if (['in', 'out', 'inout', 'none'].indexOf(iy.toLowerCase()) >= 0) {\r\n\r\n            c.push(ix + \"_\" + iy);\r\n\r\n          }\r\n\r\n        });\r\n\r\n      });\r\n\r\n      return c;\r\n\r\n    }\r\n  }\r\n\r\n};\r\n\r\nGamelab.FeatureInjectors.CssFeatures = new CssFeatures();\r\n\r\nGamelab.FeatureInjectors.VectorFunctions = new VectorFunctions();\r\n\r\nGamelab.FeatureInjectors.DataFunctions = new DataFunctions();\r\n;/**\r\n * Creates Gamelab.js Canvas: The canvas-renderer for Gamelab games.\r\n\r\n @description\r\n This Canvas library handles the low-level drawing of Gamelab.Animation objects on HTML5Canvas.\r\n -Draws Sprites according to their rotation, size, and properties.\r\n * @returns {CanvasLib} a CanvasLib object.\r\n */\r\n\r\n(function() {\r\n\r\n  console.log('CanvasStack class... creating');\r\n\r\n  class GamelabCanvas {\r\n\r\n    constructor() {\r\n      this.__levelMaker = false;\r\n      //draw is synonymous w/ drawSprite\r\n      this.draw = this.draw_object;\r\n    }\r\n\r\n    isStopped() {\r\n      return Gamelab.stopDraw || false;\r\n    }\r\n\r\n    drawLine(a, b, strokeStyle){\r\n\r\n      if (this.isStopped())\r\n        return;\r\n\r\n      var ctx = Gamelab.game_windows[0].ctx;\r\n      ctx.strokeStyle = strokeStyle || 'aqua';\r\n      ctx.beginPath();\r\n      ctx.moveTo(a.x, a.y);\r\n      ctx.lineTo(b.x, b.y);\r\n      ctx.stroke();\r\n    }\r\n\r\n    arc(p1, p2, strokeStyle) {\r\n\r\n      if (this.isStopped())\r\n        return;\r\n\r\n      var ctx = Gamelab.game_windows[0].ctx;\r\n\r\n      ctx.strokeStyle = options.strokeStyle || 'aqua';\r\n\r\n      ctx.beginPath();\r\n      ctx.arc(p1.x, p1.y, p2.x, p2.y, Math.PI * 2, true);\r\n      ctx.stroke();\r\n    }\r\n\r\n    draw_image_frame(imageFrameOptions) {\r\n\r\n      var {\r\n        image,\r\n        framePos,\r\n        frameSize,\r\n        position,\r\n        size,\r\n        rotation,\r\n        canvasContext,\r\n        flipX,\r\n        flipY,\r\n        origin,\r\n        globalAlpha,\r\n        globalComposite\r\n        }\r\n        =\r\n        imageFrameOptions;\r\n\r\n      if (this.isStopped())\r\n        return;\r\n\r\n      var fx = framePos.x,\r\n        fy = framePos.y,\r\n        fw = frameSize.x,\r\n        fh = frameSize.y,\r\n        x = position.x,\r\n        y = position.y,\r\n        width = size.x,\r\n        height = size.y;\r\n\r\n      //save canvas state before draw\r\n      canvasContext.save();\r\n\r\n      origin = origin || new Gamelab.Vector(width / 2, height / 2);\r\n\r\n      //degrees rotation:\r\n      var deg = rotation;\r\n      deg = deg % 360;\r\n      var rad = Math.floor((deg * Math.PI * 1000) / 180) / 1000;\r\n      //Set the origin to the center of the image\r\n      canvasContext.translate(x, y);\r\n      canvasContext.rotate(rad);\r\n      //Rotate the canvas around the origin\r\n\r\n\r\n      canvasContext.translate(0, canvasContext.width);\r\n\r\n      if (flipX) {\r\n        canvasContext.scale(-1, 1);\r\n      } else {\r\n\r\n      }\r\n\r\n      if (flipY) {\r\n        canvasContext.scale(1, -1);\r\n      } else {\r\n\r\n      }\r\n      canvasContext.globalAlpha = globalAlpha || 1.0;\r\n\r\n      if(globalComposite)\r\n      {\r\n        //canvasContext.globalCompositeOperation = globalComposite;\r\n      }\r\n      //draw the image\r\n      canvasContext.drawImage(image, fx, fy, fw, fh, -origin.x, -origin.y, width, height);\r\n      //reset the canvas\r\n      canvasContext.globalAlpha = 1.0;\r\n      canvasContext.restore();\r\n    }\r\n\r\n    draw_data(x, y, w, h, data, ctx) {\r\n      if (this.isStopped())\r\n        return;\r\n\r\n      ctx.putImageData(data, x, y, 0, 0, w, h);\r\n    }\r\n  }\r\n\r\n\r\n  Gamelab.Canvas = new GamelabCanvas();\r\n\r\n  Gamelab.GamelabCanvas = GamelabCanvas;\r\n\r\n  class OffscreenCanvasRendering {\r\n    constructor(psuedoImage) {\r\n      this.htmlImage = psuedoImage.domElement || psuedoImage;\r\n      this.testCanvas = document.createElement(\"CANVAS\");\r\n      this.testCtx = this.testCanvas.getContext(\"2d\");\r\n      this.testCanvas.width = this.htmlImage.width;\r\n      this.testCanvas.height = this.htmlImage.height;\r\n      this.testCanvas.style.zIndex = '9999';\r\n      this.testCtx.drawImage(this.htmlImage, 0, 0);\r\n      return {\r\n        canvas: this.testCanvas,\r\n        ctx: this.testCtx\r\n      }\r\n    }\r\n\r\n  };\r\n\r\n  Gamelab.OffscreenCanvasRendering = OffscreenCanvasRendering;\r\n\r\n})();\r\n;if (typeof JSON.decycle !== 'function') {\r\n    JSON.decycle = function decycle(object) {\r\n        \"use strict\";\r\n\r\n        var objects = [],   // Keep a reference to each unique object or array\r\n            paths = [];     // Keep the path to each unique object or array\r\n\r\n        return (function derez(value, path) {\r\n\r\n\r\n            var i,          // The loop counter\r\n                name,       // Property name\r\n                nu;         // The new object or array\r\n\r\n            switch (typeof value) {\r\n            case 'object':\r\n\r\n                if (!value) {\r\n                    return null;\r\n                }\r\n\r\n\r\n                for (i = 0; i < objects.length; i += 1) {\r\n                    if (objects[i] === value) {\r\n                        return {$ref: paths[i]};\r\n                    }\r\n                }\r\n\r\n// Otherwise, accumulate the unique value and its path.\r\n\r\n                objects.push(value);\r\n                paths.push(path);\r\n\r\n// If it is an array, replicate the array.\r\n\r\n                if (Object.prototype.toString.apply(value) === '[object Array]') {\r\n                    nu = [];\r\n                    for (i = 0; i < value.length; i += 1) {\r\n                        nu[i] = derez(value[i], path + '[' + i + ']');\r\n                    }\r\n                } else {\r\n\r\n// If it is an object, replicate the object.\r\n\r\n                    nu = {};\r\n                    for (name in value) {\r\n                        if (Object.prototype.hasOwnProperty.call(value, name)) {\r\n                            nu[name] = derez(value[name],\r\n                                path + '[' + JSON.stringify(name) + ']');\r\n                        }\r\n                    }\r\n                }\r\n                return nu;\r\n            case 'number':\r\n            case 'string':\r\n            case 'boolean':\r\n                return value;\r\n            }\r\n        }(object, '$'));\r\n    };\r\n}\r\n\r\nif (typeof JSON.retrocycle !== 'function') {\r\n    JSON.retrocycle = function retrocycle($) {\r\n        \"use strict\";\r\n\r\n        var px =\r\n            /^\\$(?:\\[(?:\\d?|\\\"(?:[^\\\\\\\"\\u0000-\\u001f]|\\\\([\\\\\\\"\\/bfnrt]|u[0-9a-zA-Z]{4}))*\\\")\\])*$/;\r\n\r\n        (function rez(value) {\r\n\r\n            var i, item, name, path;\r\n\r\n            if (value && typeof value === 'object') {\r\n                if (Object.prototype.toString.apply(value) === '[object Array]') {\r\n                    for (i = 0; i < value.length; i += 1) {\r\n                        item = value[i];\r\n                        if (item && typeof item === 'object') {\r\n                            path = item.$ref;\r\n                            if (typeof path === 'string' && px.test(path)) {\r\n                                value[i] = eval(path);\r\n                            } else {\r\n                                rez(item);\r\n                            }\r\n                        }\r\n                    }\r\n                } else {\r\n                    for (name in value) {\r\n                        if (typeof value[name] === 'object') {\r\n                            item = value[name];\r\n                            if (item) {\r\n                                path = item.$ref;\r\n                                if (typeof path === 'string' && px.test(path)) {\r\n                                    value[name] = eval(path);\r\n                                } else {\r\n                                    rez(item);\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }($));\r\n        return $;\r\n    };\r\n}\r\n\r\nvar json_stringify = JSON.stringify;\r\n\r\nJSON.stringify = function(object, arg2, arg3)\r\n{\r\n  var clean_object = JSON.decycle(object);\r\n  return json_stringify(clean_object, arg2, arg3);\r\n};\r\n\r\nvar json_parse = JSON.parse;\r\n\r\nJSON.parse = function(object, arg2, arg3){\r\n  var retro_object = JSON.retrocycle(object);\r\n  return json_parse(retro_object);\r\n};\r\n;/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\n\r\n/***************\r\n *\r\n * @ignore\r\n *\r\n * *****************/\r\n\r\nvar Stats = function () {\r\n\r\n\tvar mode = 0;\r\n\r\n\tvar container = document.createElement( 'div' );\r\n\tcontainer.style.cssText = 'position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000';\r\n\tcontainer.addEventListener( 'click', function ( event ) {\r\n\r\n\t\tevent.preventDefault();\r\n\t\tshowPanel( ++ mode % container.children.length );\r\n\r\n\t}, false );\r\n\r\n\t//\r\n\r\n\tfunction addPanel( panel ) {\r\n\r\n\t\tcontainer.appendChild( panel.dom );\r\n\t\treturn panel;\r\n\r\n\t}\r\n\r\n\tfunction showPanel( id ) {\r\n\r\n\t\tfor ( var i = 0; i < container.children.length; i ++ ) {\r\n\r\n\t\t\tcontainer.children[ i ].style.display = i === id ? 'block' : 'none';\r\n\r\n\t\t}\r\n\r\n\t\tmode = id;\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tvar beginTime = ( performance || Date ).now(), prevTime = beginTime, frames = 0;\r\n\r\n\tvar fpsPanel = addPanel( new Stats.Panel( 'FPS', '#0ff', '#002' ) );\r\n\tvar msPanel = addPanel( new Stats.Panel( 'MS', '#0f0', '#020' ) );\r\n\r\n\tif ( self.performance && self.performance.memory ) {\r\n\r\n\t\tvar memPanel = addPanel( new Stats.Panel( 'MB', '#f08', '#201' ) );\r\n\r\n\t}\r\n\r\n\tshowPanel( 0 );\r\n\r\n\treturn {\r\n\r\n\t\tREVISION: 16,\r\n\r\n\t\tdom: container,\r\n\r\n\t\taddPanel: addPanel,\r\n\t\tshowPanel: showPanel,\r\n\r\n\t\tbegin: function () {\r\n\r\n\t\t\tbeginTime = ( performance || Date ).now();\r\n\r\n\t\t},\r\n\r\n\t\tend: function () {\r\n\r\n\t\t\tframes ++;\r\n\r\n\t\t\tvar time = ( performance || Date ).now();\r\n\r\n\t\t\tmsPanel.update( time - beginTime, 200 );\r\n\r\n\t\t\tif ( time >= prevTime + 1000 ) {\r\n\r\n\t\t\t\tfpsPanel.update( ( frames * 1000 ) / ( time - prevTime ), 100 );\r\n\r\n\t\t\t\tprevTime = time;\r\n\t\t\t\tframes = 0;\r\n\r\n\t\t\t\tif ( memPanel ) {\r\n\r\n\t\t\t\t\tvar memory = performance.memory;\r\n\t\t\t\t\tmemPanel.update( memory.usedJSHeapSize / 1048576, memory.jsHeapSizeLimit / 1048576 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn time;\r\n\r\n\t\t},\r\n\r\n\t\tupdate: function () {\r\n\r\n\t\t\tbeginTime = this.end();\r\n\r\n\t\t},\r\n\r\n\t\t// Backwards Compatibility\r\n\r\n\t\tdomElement: container,\r\n\t\tsetMode: showPanel\r\n\r\n\t};\r\n\r\n};\r\n\r\nStats.Panel = function ( name, fg, bg ) {\r\n\r\n\tvar min = Infinity, max = 0, round = Math.round;\r\n\tvar PR = round( window.devicePixelRatio || 1 );\r\n\r\n\tvar WIDTH = 80 * PR, HEIGHT = 48 * PR,\r\n\t\t\tTEXT_X = 3 * PR, TEXT_Y = 2 * PR,\r\n\t\t\tGRAPH_X = 3 * PR, GRAPH_Y = 15 * PR,\r\n\t\t\tGRAPH_WIDTH = 74 * PR, GRAPH_HEIGHT = 30 * PR;\r\n\r\n\tvar canvas = document.createElement( 'canvas' );\r\n\tcanvas.width = WIDTH;\r\n\tcanvas.height = HEIGHT;\r\n\tcanvas.style.cssText = 'width:80px;height:48px';\r\n\r\n\tvar context = canvas.getContext( '2d' );\r\n\tcontext.font = 'bold ' + ( 9 * PR ) + 'px Helvetica,Arial,sans-serif';\r\n\tcontext.textBaseline = 'top';\r\n\r\n\tcontext.fillStyle = bg;\r\n\tcontext.fillRect( 0, 0, WIDTH, HEIGHT );\r\n\r\n\tcontext.fillStyle = fg;\r\n\tcontext.fillText( name, TEXT_X, TEXT_Y );\r\n\tcontext.fillRect( GRAPH_X, GRAPH_Y, GRAPH_WIDTH, GRAPH_HEIGHT );\r\n\r\n\tcontext.fillStyle = bg;\r\n\tcontext.globalAlpha = 0.9;\r\n\tcontext.fillRect( GRAPH_X, GRAPH_Y, GRAPH_WIDTH, GRAPH_HEIGHT );\r\n\r\n\treturn {\r\n\r\n\t\tdom: canvas,\r\n\r\n\t\tupdate: function ( value, maxValue ) {\r\n\r\n\t\t\tmin = Math.min( min, value );\r\n\t\t\tmax = Math.max( max, value );\r\n\r\n\t\t\tcontext.fillStyle = bg;\r\n\t\t\tcontext.globalAlpha = 1;\r\n\t\t\tcontext.fillRect( 0, 0, WIDTH, GRAPH_Y );\r\n\t\t\tcontext.fillStyle = fg;\r\n\t\t\tcontext.fillText( round( value ) + ' ' + name + ' (' + round( min ) + '-' + round( max ) + ')', TEXT_X, TEXT_Y );\r\n\r\n\t\t\tcontext.drawImage( canvas, GRAPH_X + PR, GRAPH_Y, GRAPH_WIDTH - PR, GRAPH_HEIGHT, GRAPH_X, GRAPH_Y, GRAPH_WIDTH - PR, GRAPH_HEIGHT );\r\n\r\n\t\t\tcontext.fillRect( GRAPH_X + GRAPH_WIDTH - PR, GRAPH_Y, PR, GRAPH_HEIGHT );\r\n\r\n\t\t\tcontext.fillStyle = bg;\r\n\t\t\tcontext.globalAlpha = 0.9;\r\n\t\t\tcontext.fillRect( GRAPH_X + GRAPH_WIDTH - PR, GRAPH_Y, PR, round( ( 1 - ( value / maxValue ) ) * GRAPH_HEIGHT ) );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n};\r\n;/**\r\n * Tween.js - Licensed under the MIT license\r\n * https://github.com/tweenjs/tween.js\r\n * ----------------------------------------------\r\n *\r\n * See https://github.com/tweenjs/tween.js/graphs/contributors for the full list of contributors.\r\n * Thank you all, you're awesome!\r\n */\r\n\r\n\r\n/*\r\n*\r\n* @ignore\r\n*\r\n* */\r\n\r\nvar TWEEN = TWEEN || (function () {\r\n\r\n\tvar _tweens = [];\r\n\r\n\treturn {\r\n\r\n\t\tgetAll: function () {\r\n\r\n\t\t\treturn _tweens;\r\n\r\n\t\t},\r\n\r\n\t\tremoveAll: function () {\r\n\r\n\t\t\t_tweens = [];\r\n\r\n\t\t},\r\n\r\n\t\tadd: function (tween) {\r\n\r\n\t\t\t_tweens.push(tween);\r\n\r\n\t\t},\r\n\r\n\t\tremove: function (tween) {\r\n\r\n\t\t\tvar i = _tweens.indexOf(tween);\r\n\r\n\t\t\tif (i !== -1) {\r\n\t\t\t\t_tweens.splice(i, 1);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tupdate: function (time, preserve) {\r\n\r\n\t\t\tif (_tweens.length === 0) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tvar i = 0;\r\n\r\n\t\t\ttime = time !== undefined ? time : TWEEN.now();\r\n\r\n\t\t\twhile (i < _tweens.length) {\r\n\r\n\t\t\t\tif (_tweens[i].update(time) || preserve) {\r\n\t\t\t\t\ti++;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t_tweens.splice(i, 1);\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\t};\r\n\r\n})();\r\n\r\n//removed polyfill\r\n\r\nTWEEN.now = Date.now;\r\n\r\nTWEEN.Tween = function (object) {\r\n\r\n\tvar _object = object;\r\n\tvar _valuesStart = {};\r\n\tvar _valuesEnd = {};\r\n\tvar _valuesStartRepeat = {};\r\n\tvar _duration = 1000;\r\n\tvar _repeat = 0;\r\n\tvar _repeatDelayTime;\r\n\tvar _yoyo = false;\r\n\tvar _isPlaying = false;\r\n\tvar _reversed = false;\r\n\tvar _delayTime = 0;\r\n\tvar _startTime = null;\r\n\tvar _easingFunction = TWEEN.Easing.Linear.None;\r\n\tvar _interpolationFunction = TWEEN.Interpolation.Linear;\r\n\tvar _chainedTweens = [];\r\n\tvar _onStartCallback = null;\r\n\tvar _onStartCallbackFired = false;\r\n\tvar _onUpdateCallback = null;\r\n\tvar _onCompleteCallback = null;\r\n\tvar _onStopCallback = null;\r\n\r\n\t// Set all starting values present on the target object\r\n\tfor (var field in object) {\r\n\t\t_valuesStart[field] = parseFloat(object[field], 10);\r\n\t}\r\n\r\n\tthis.to = function (properties, duration) {\r\n\r\n\t\tif (duration !== undefined) {\r\n\t\t\t_duration = duration;\r\n\t\t}\r\n\r\n\t\t_valuesEnd = properties;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.start = function (time) {\r\n\r\n\t\tTWEEN.add(this);\r\n\r\n\t\t_isPlaying = true;\r\n\r\n\t\t_onStartCallbackFired = false;\r\n\r\n\t\t_startTime = time !== undefined ? time : TWEEN.now();\r\n\t\t_startTime += _delayTime;\r\n\r\n\t\tfor (var property in _valuesEnd) {\r\n\r\n\t\t\t// Check if an Array was provided as property value\r\n\t\t\tif (_valuesEnd[property] instanceof Array) {\r\n\r\n\t\t\t\tif (_valuesEnd[property].length === 0) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Create a local copy of the Array with the start value at the front\r\n\t\t\t\t_valuesEnd[property] = [_object[property]].concat(_valuesEnd[property]);\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// If `to()` specifies a property that doesn't exist in the source object,\r\n\t\t\t// we should not set that property in the object\r\n\t\t\tif (_object[property] === undefined) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\t_valuesStart[property] = _object[property];\r\n\r\n\t\t\tif ((_valuesStart[property] instanceof Array) === false) {\r\n\t\t\t\t_valuesStart[property] *= 1.0; // Ensures we're using numbers, not strings\r\n\t\t\t}\r\n\r\n\t\t\t_valuesStartRepeat[property] = _valuesStart[property] || 0;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.stop = function () {\r\n\r\n\t\tif (!_isPlaying) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tTWEEN.remove(this);\r\n\t\t_isPlaying = false;\r\n\r\n\t\tif (_onStopCallback !== null) {\r\n\t\t\t_onStopCallback.call(_object, _object);\r\n\t\t}\r\n\r\n\t\tthis.stopChainedTweens();\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.end = function () {\r\n\r\n\t\tthis.update(_startTime + _duration);\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.stopChainedTweens = function () {\r\n\r\n\t\tfor (var i = 0, numChainedTweens = _chainedTweens.length; i < numChainedTweens; i++) {\r\n\t\t\t_chainedTweens[i].stop();\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.delay = function (amount) {\r\n\r\n\t\t_delayTime = amount;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.repeat = function (times) {\r\n\r\n\t\t_repeat = times;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.repeatDelay = function (amount) {\r\n\r\n\t\t_repeatDelayTime = amount;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.yoyo = function (yoyo) {\r\n\r\n\t\t_yoyo = yoyo;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\r\n\tthis.easing = function (easing) {\r\n\r\n\t\t_easingFunction = easing;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.interpolation = function (interpolation) {\r\n\r\n\t\t_interpolationFunction = interpolation;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.chain = function () {\r\n\r\n\t\t_chainedTweens = arguments;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.onStart = function (callback) {\r\n\r\n\t\t_onStartCallback = callback;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.onUpdate = function (callback) {\r\n\r\n\t\t_onUpdateCallback = callback;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.onComplete = function (callback) {\r\n\r\n\t\t_onCompleteCallback = callback;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.onStop = function (callback) {\r\n\r\n\t\t_onStopCallback = callback;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.update = function (time) {\r\n\r\n\t\tvar property;\r\n\t\tvar elapsed;\r\n\t\tvar value;\r\n\r\n\t\tif (time < _startTime) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tif (_onStartCallbackFired === false) {\r\n\r\n\t\t\tif (_onStartCallback !== null) {\r\n\t\t\t\t_onStartCallback.call(_object, _object);\r\n\t\t\t}\r\n\r\n\t\t\t_onStartCallbackFired = true;\r\n\t\t}\r\n\r\n\t\telapsed = (time - _startTime) / _duration;\r\n\t\telapsed = elapsed > 1 ? 1 : elapsed;\r\n\r\n\t\tvalue = _easingFunction(elapsed);\r\n\r\n\t\tfor (property in _valuesEnd) {\r\n\r\n\t\t\t// Don't update properties that do not exist in the source object\r\n\t\t\tif (_valuesStart[property] === undefined) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tvar start = _valuesStart[property] || 0;\r\n\t\t\tvar end = _valuesEnd[property];\r\n\r\n\t\t\tif (end instanceof Array) {\r\n\r\n\t\t\t\t_object[property] = _interpolationFunction(end, value);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// Parses relative end values with start as base (e.g.: +10, -3)\r\n\t\t\t\tif (typeof (end) === 'string') {\r\n\r\n\t\t\t\t\tif (end.charAt(0) === '+' || end.charAt(0) === '-') {\r\n\t\t\t\t\t\tend = start + parseFloat(end, 10);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tend = parseFloat(end, 10);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Protect against non numeric properties.\r\n\t\t\t\tif (typeof (end) === 'number') {\r\n\t\t\t\t\t_object[property] = start + (end - start) * value;\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif (_onUpdateCallback !== null) {\r\n\t\t\t_onUpdateCallback.call(_object, value);\r\n\t\t}\r\n\r\n\t\tif (elapsed === 1) {\r\n\r\n\t\t\tif (_repeat > 0) {\r\n\r\n\t\t\t\tif (isFinite(_repeat)) {\r\n\t\t\t\t\t_repeat--;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Reassign starting values, restart by making startTime = now\r\n\t\t\t\tfor (property in _valuesStartRepeat) {\r\n\r\n\t\t\t\t\tif (typeof (_valuesEnd[property]) === 'string') {\r\n\t\t\t\t\t\t_valuesStartRepeat[property] = _valuesStartRepeat[property] + parseFloat(_valuesEnd[property], 10);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (_yoyo) {\r\n\t\t\t\t\t\tvar tmp = _valuesStartRepeat[property];\r\n\r\n\t\t\t\t\t\t_valuesStartRepeat[property] = _valuesEnd[property];\r\n\t\t\t\t\t\t_valuesEnd[property] = tmp;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t_valuesStart[property] = _valuesStartRepeat[property];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (_yoyo) {\r\n\t\t\t\t\t_reversed = !_reversed;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (_repeatDelayTime !== undefined) {\r\n\t\t\t\t\t_startTime = time + _repeatDelayTime;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t_startTime = time + _delayTime;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif (_onCompleteCallback !== null) {\r\n\r\n\t\t\t\t\t_onCompleteCallback.call(_object, _object);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (var i = 0, numChainedTweens = _chainedTweens.length; i < numChainedTweens; i++) {\r\n\t\t\t\t\t// Make the chained tweens start exactly at the time they should,\r\n\t\t\t\t\t// even if the `update()` method was called way past the duration of the tween\r\n\t\t\t\t\t_chainedTweens[i].start(_startTime + _duration);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t};\r\n\r\n};\r\n\r\n\r\nTWEEN.Easing = {\r\n\r\n\tLinear: {\r\n\r\n\t\tNone: function (k) {\r\n\r\n\t\t\treturn k;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tQuadratic: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\treturn k * k;\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\treturn k * (2 - k);\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tif ((k *= 2) < 1) {\r\n\t\t\t\treturn 0.5 * k * k;\r\n\t\t\t}\r\n\r\n\t\t\treturn - 0.5 * (--k * (k - 2) - 1);\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tCubic: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\treturn k * k * k;\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\treturn --k * k * k + 1;\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tif ((k *= 2) < 1) {\r\n\t\t\t\treturn 0.5 * k * k * k;\r\n\t\t\t}\r\n\r\n\t\t\treturn 0.5 * ((k -= 2) * k * k + 2);\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tQuartic: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\treturn k * k * k * k;\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\treturn 1 - (--k * k * k * k);\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tif ((k *= 2) < 1) {\r\n\t\t\t\treturn 0.5 * k * k * k * k;\r\n\t\t\t}\r\n\r\n\t\t\treturn - 0.5 * ((k -= 2) * k * k * k - 2);\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tQuintic: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\treturn k * k * k * k * k;\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\treturn --k * k * k * k * k + 1;\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tif ((k *= 2) < 1) {\r\n\t\t\t\treturn 0.5 * k * k * k * k * k;\r\n\t\t\t}\r\n\r\n\t\t\treturn 0.5 * ((k -= 2) * k * k * k * k + 2);\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tSinusoidal: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\treturn 1 - Math.cos(k * Math.PI / 2);\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\treturn Math.sin(k * Math.PI / 2);\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\treturn 0.5 * (1 - Math.cos(Math.PI * k));\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tExponential: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\treturn k === 0 ? 0 : Math.pow(1024, k - 1);\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\treturn k === 1 ? 1 : 1 - Math.pow(2, - 10 * k);\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tif (k === 0) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\r\n\t\t\tif (k === 1) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\r\n\t\t\tif ((k *= 2) < 1) {\r\n\t\t\t\treturn 0.5 * Math.pow(1024, k - 1);\r\n\t\t\t}\r\n\r\n\t\t\treturn 0.5 * (- Math.pow(2, - 10 * (k - 1)) + 2);\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tCircular: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\treturn 1 - Math.sqrt(1 - k * k);\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\treturn Math.sqrt(1 - (--k * k));\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tif ((k *= 2) < 1) {\r\n\t\t\t\treturn - 0.5 * (Math.sqrt(1 - k * k) - 1);\r\n\t\t\t}\r\n\r\n\t\t\treturn 0.5 * (Math.sqrt(1 - (k -= 2) * k) + 1);\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tElastic: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\tif (k === 0) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\r\n\t\t\tif (k === 1) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\r\n\t\t\treturn -Math.pow(2, 10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI);\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\tif (k === 0) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\r\n\t\t\tif (k === 1) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\r\n\t\t\treturn Math.pow(2, -10 * k) * Math.sin((k - 0.1) * 5 * Math.PI) + 1;\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tif (k === 0) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\r\n\t\t\tif (k === 1) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\r\n\t\t\tk *= 2;\r\n\r\n\t\t\tif (k < 1) {\r\n\t\t\t\treturn -0.5 * Math.pow(2, 10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI);\r\n\t\t\t}\r\n\r\n\t\t\treturn 0.5 * Math.pow(2, -10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI) + 1;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tBack: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\tvar s = 1.70158;\r\n\r\n\t\t\treturn k * k * ((s + 1) * k - s);\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\tvar s = 1.70158;\r\n\r\n\t\t\treturn --k * k * ((s + 1) * k + s) + 1;\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tvar s = 1.70158 * 1.525;\r\n\r\n\t\t\tif ((k *= 2) < 1) {\r\n\t\t\t\treturn 0.5 * (k * k * ((s + 1) * k - s));\r\n\t\t\t}\r\n\r\n\t\t\treturn 0.5 * ((k -= 2) * k * ((s + 1) * k + s) + 2);\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tBounce: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\treturn 1 - TWEEN.Easing.Bounce.Out(1 - k);\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\tif (k < (1 / 2.75)) {\r\n\t\t\t\treturn 7.5625 * k * k;\r\n\t\t\t} else if (k < (2 / 2.75)) {\r\n\t\t\t\treturn 7.5625 * (k -= (1.5 / 2.75)) * k + 0.75;\r\n\t\t\t} else if (k < (2.5 / 2.75)) {\r\n\t\t\t\treturn 7.5625 * (k -= (2.25 / 2.75)) * k + 0.9375;\r\n\t\t\t} else {\r\n\t\t\t\treturn 7.5625 * (k -= (2.625 / 2.75)) * k + 0.984375;\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tif (k < 0.5) {\r\n\t\t\t\treturn TWEEN.Easing.Bounce.In(k * 2) * 0.5;\r\n\t\t\t}\r\n\r\n\t\t\treturn TWEEN.Easing.Bounce.Out(k * 2 - 1) * 0.5 + 0.5;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nTWEEN.Interpolation = {\r\n\r\n\tLinear: function (v, k) {\r\n\r\n\t\tvar m = v.length - 1;\r\n\t\tvar f = m * k;\r\n\t\tvar i = Math.floor(f);\r\n\t\tvar fn = TWEEN.Interpolation.Utils.Linear;\r\n\r\n\t\tif (k < 0) {\r\n\t\t\treturn fn(v[0], v[1], f);\r\n\t\t}\r\n\r\n\t\tif (k > 1) {\r\n\t\t\treturn fn(v[m], v[m - 1], m - f);\r\n\t\t}\r\n\r\n\t\treturn fn(v[i], v[i + 1 > m ? m : i + 1], f - i);\r\n\r\n\t},\r\n\r\n\tBezier: function (v, k) {\r\n\r\n\t\tvar b = 0;\r\n\t\tvar n = v.length - 1;\r\n\t\tvar pw = Math.pow;\r\n\t\tvar bn = TWEEN.Interpolation.Utils.Bernstein;\r\n\r\n\t\tfor (var i = 0; i <= n; i++) {\r\n\t\t\tb += pw(1 - k, n - i) * pw(k, i) * v[i] * bn(n, i);\r\n\t\t}\r\n\r\n\t\treturn b;\r\n\r\n\t},\r\n\r\n\tCatmullRom: function (v, k) {\r\n\r\n\t\tvar m = v.length - 1;\r\n\t\tvar f = m * k;\r\n\t\tvar i = Math.floor(f);\r\n\t\tvar fn = TWEEN.Interpolation.Utils.CatmullRom;\r\n\r\n\t\tif (v[0] === v[m]) {\r\n\r\n\t\t\tif (k < 0) {\r\n\t\t\t\ti = Math.floor(f = m * (1 + k));\r\n\t\t\t}\r\n\r\n\t\t\treturn fn(v[(i - 1 + m) % m], v[i], v[(i + 1) % m], v[(i + 2) % m], f - i);\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif (k < 0) {\r\n\t\t\t\treturn v[0] - (fn(v[0], v[0], v[1], v[1], -f) - v[0]);\r\n\t\t\t}\r\n\r\n\t\t\tif (k > 1) {\r\n\t\t\t\treturn v[m] - (fn(v[m], v[m], v[m - 1], v[m - 1], f - m) - v[m]);\r\n\t\t\t}\r\n\r\n\t\t\treturn fn(v[i ? i - 1 : 0], v[i], v[m < i + 1 ? m : i + 1], v[m < i + 2 ? m : i + 2], f - i);\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tUtils: {\r\n\r\n\t\tLinear: function (p0, p1, t) {\r\n\r\n\t\t\treturn (p1 - p0) * t + p0;\r\n\r\n\t\t},\r\n\r\n\t\tBernstein: function (n, i) {\r\n\r\n\t\t\tvar fc = TWEEN.Interpolation.Utils.Factorial;\r\n\r\n\t\t\treturn fc(n) / fc(i) / fc(n - i);\r\n\r\n\t\t},\r\n\r\n\t\tFactorial: (function () {\r\n\r\n\t\t\tvar a = [1];\r\n\r\n\t\t\treturn function (n) {\r\n\r\n\t\t\t\tvar s = 1;\r\n\r\n\t\t\t\tif (a[n]) {\r\n\t\t\t\t\treturn a[n];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (var i = n; i > 1; i--) {\r\n\t\t\t\t\ts *= i;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ta[n] = s;\r\n\t\t\t\treturn s;\r\n\r\n\t\t\t};\r\n\r\n\t\t})(),\r\n\r\n\t\tCatmullRom: function (p0, p1, p2, p3, t) {\r\n\r\n\t\t\tvar v0 = (p2 - p0) * 0.5;\r\n\t\t\tvar v1 = (p3 - p1) * 0.5;\r\n\t\t\tvar t2 = t * t;\r\n\t\t\tvar t3 = t * t2;\r\n\r\n\t\t\treturn (2 * p1 - 2 * p2 + v0 + v1) * t3 + (- 3 * p1 + 3 * p2 - 2 * v0 - v1) * t2 + v0 * t + p1;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n\r\n\r\n\r\n//Attach to the global Gamelab object\r\n\r\n/***************\r\n *\r\n * @memberOf Gamelab\r\n *\r\n * *****************/\r\n\r\nGamelab.TWEEN = TWEEN;\r\n\r\n\r\n/*\r\n\r\n// UMD (Universal Module Definition)\r\n(function (root) {\r\n\r\n    if (typeof define === 'function' && define.amd) {\r\n\r\n        // AMD\r\n        define([], function () {\r\n            return TWEEN;\r\n        });\r\n\r\n    } else if (typeof module !== 'undefined' && typeof exports === 'object') {\r\n\r\n        // Node.js\r\n        module.exports = TWEEN;\r\n\r\n    } else if (root !== undefined) {\r\n\r\n        // Global variable\r\n        root.TWEEN = TWEEN;\r\n\r\n    }\r\n\r\n})(this);\r\n\r\n*/\r\n;\n//Call Gamelab.FeatureInject::\n\nGamelab.FeatureInject();\n\n\n// UMD (Universal Module Definition)\n(function (root) {\n\n    if (typeof define === 'function' && define.amd) {\n\n        // AMD\n        define([], function () {\n            return Gamelab;\n        });\n\n    } else if (typeof module !== 'undefined' && typeof exports === 'object') {\n\n        // Node.js\n        module.exports = Gamelab;\n\n    } else if (root !== undefined) {\n\n        // Global variable\n        root.Gamelab = Gamelab;\n\n    }\n\n})(this);\n"]}