<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Machine Sprite</title>
    <script src="./../../dist/gamelab/gamelab.js"></script>
      <script src="./../../res/libraries/dat.gui.js"></script>
    <!-- gamelab-example.css style -->
    <link rel="stylesheet" href="./../../res/styles/gamelab-example.css">
  </head>
  <body>
    <header>
      <img src="./../../res/images/gamelab-logo.png" alt="" id="logo">
      <span class="title">Machine Sprite</span>
    </header>
    <script>

    //Get each colored-pixel-chunk of the image by a certain size criteria
    //process the pixel chunks as frames and add to a sprite

      //Create the game-window
      var gameWindow = new Gamelab.GameWindow().Background('black');

      var controller = new dat.GUI();

      const machine = {
                  targetChunkSize:980
      };


      const Tool = {

          FloodSelect:function(x, y){

            var imageData = gameWindow.ctx.getImageData(x, y, 1, 1);

            var firstColor = false;

            while(!firstColor)
            {
                x+= 1;
                if(x >= gameWindow.canvas.width)
                {
                    y += 1;
                    x = 0;
                }

                imageData = gameWindow.ctx.getImageData(x, y, 1, 1);
                firstColor = imageData.data[3] > 0;
            }

            //Then test every pixel around that, and continue

            alert(jstr(imageData));

          }

      };


      Gamelab.ready(function () {

        var sprite = new Gamelab.Sprite('./../res/images/classic-sprite/wolverine-adamantium-rage.gif');
        var selection = new Gamelab.Sprite('./../res/images/ui/hover_selection.png').Scale(0.4);

        gameWindow.add(sprite);
        gameWindow.add(selection);


        gameWindow.canvas.onclick = function(evt){

          console.log('selecting');
          Tool.FloodSelect(evt.clientX, evt.clientY);

        };

        setTimeout(function(){

        Tool.FloodSelect(1, 1);

      }, 2000);

      });


      //start gameWindow
      gameWindow.start();
    </script>

  </body>
</html>
