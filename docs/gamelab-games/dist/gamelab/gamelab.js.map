{"version":3,"sources":["../../src/__concat/gamelab.js"],"names":["arrays","delay","fxn","timing","setTimeout","repeat","setInterval","clog","a","b","c","console","log","dlog","Gamelab","config","DEV","numbers","getMinAndMaxByPair","error","min","max","TypeCode","info","arg1","arg2","warn","number","fallback","string","arrayWrap","obj","Array","allDefined","obj_all","list","failed","x","getPreferredPropertyByKey","property","key","warning","hasOwnProperty","psuedoTypeCheck","psuedotype","throwing","getAllFuncs","Object","getOwnPropertyNames","filter","p","getProtoFuncs","__proto__","truthOrDie","exitMessage","findError","Error","e","truthyPropsPerArray","propKeys","kill","keys","prop","y","typeArgsExtract","type","typeOrHalt","typeOrError","check","object","propKey","propValue","Gamelab_Module","module","settings","DEBUG","gui_mode","recursionCount","errorLimit","errors","stopDraw","defSize","WIDTH","document","body","clientWidth","HEIGHT","clientHeight","getGameWindow","ix","game_windows","gs_renderables","gs_events","spriteTypes","systemSpriteTypes","__gameWindowList","all","all_objects","forEach","item","concat","drawables","init","testSquare","Sprite","onButton","gpix","callback","GamepadEvent","Gamepads","Keys","objectDestroyed","dead","gw","objects","getObjectById","id","length","interlog","message","div","isNaN","create_id","S4","Math","random","toString","substring","quit","m","initializers","addInitializer","i","push","_gameWindow","setGameWindow","gameWindow","ExtendEvents","extendedObject","extendedKey","extendor","extendorKey","evtLink","GSEventLink","parent","onRun","onComplete","assignAll","args","__gamelabInstance","each","loadSprites","sprites","LEN","COUNT","spr","onLoad","constructor","name","onResult","ready_callstack","ready","reload","callReady","funx","call","InputSystem","__running","getArg","k","normalArgs","normal","str","toLowerCase","replace","isNormalStringMatch","str1","str2","instance_type_pairs","objectList","constructor_name","getById","select","group","query","__inst","GamelabApi","get","post","contents","jstr","GSO","run_ext","complete_ext","caller","callkey","indexOf","exports","JSON","stringify","$Q","selector","s","mainSelector","before","trim","msfChar","__targetClassName","output","cleanSelectorString","after","criterion","between","cparts","split","__targetGroup","__targetName","getParts","on","evt_key","selectorObject","controller_ix","boolTrigger","boolCall","boolEvent","BoolEvent","On","Call","padding","evt_profile","cix","contains_any","button_mode","GamepadAdapter","item1","iy","item2","onUpdate","update","sprite","hasBoxCollision","condition","evt_parts","run","mykey","parseFloat","propkey","complete","c1","test_str","start_pos","end_pos","contains","contains_all","cList","c2","test_selector_method","Q_TestStrings","test","Mouse","Position","Speed","setPosition","isIdle","speed","events","mousemove","mousepos","leftclick","rightclick","middleclick","wheelup","wheelDown","keymap","keyReplace","String","fromCharCode","extendKey","onFinish","down","extend","downCall","upCall","up","MOUSE","window","im","kmapItem","onkeydown","onkeyup","event","gs_key_string","keyCode","evt_object","canvases","querySelectorAll","getMousePos","pageX","pageY","clientX","scrollLeft","documentElement","clientY","scrollTop","offsetLeft","style","top","mouseMoving","pos","el","applyMouseMove","addEventListener","onmousedown","value","which","preventDefault","onmouseup","file_system","localizedSource","src","hostUrl","gs_folder_ix","loadJSON","filepath","readTextFile","file","rawFile","XMLHttpRequest","open","onreadystatechange","readyState","status","responseText","send","loadLevel","jsonText","data","parse","$","xitem","yitem","iz","zitem","add","loadJSONLevel","loadJson","lib","Screen","size","Vector","center","round","EventInterfaceMap","Animation","Motion","Shot","Terrain","Interactive","Global","instance","f","fkey","ObjectFeatureMap","SpriteGroup","SpriteBrush","Frame","Particle","RectangularLine","Circle","Line2d","Text","InputIFM","GamepadButtons","GamepadSticks","Keyboard","MouseMove","MouseButton","MouseWheel","LeapMotion","UIEditables","UIOption","hint","script","UIPrefab","MainSelect","FormEditables","UIPrefabMainSelect","Background","getCustomPrefabMeta","UIObjectPrefabs","Camera","z","position","radians","degrees","PI","radius","r","count","points","pt_angle","cos","sin","pt_radius_sq","sqrt","Collision","boxCollide","pos1","size1","pos2","size2","spriteMouseCollide","obj1","obj2","scale","camPos","S","paddingX","paddingY","left","right","bottom","spriteCollide","spriteCollideArray","collisions","spritesX","spritesY","collider","spriteCollideTop","pixelCollide","sourceSprite","targetSprite","hitBox","source","target","height","width","pixelMap","selected_animation","sourcePixel","sourceArea","relatedPixel","t","targetPixel","targetArea","RGBColor","g","ColorCalc","hexToRgba","ColorStrings","match","parseInt","color","sumOfSquares","pow","tolerance","matches","total_diff","diff","abs","ColorCalculator","hexToRgbArray","hex","result","exec","rgbFromString","rgba_string","join","scaledRGBAFromHex","hexcolor_a","hexcolor_b","scalePoint","rgba_a","rgba_b","finalRgba","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","map_orange","map_green","map_red","map_blue","map_darkgreen","map_yellow","map_aqua","map_grey","map_gray","map_darkgrey","map_darkgray","map_black","RE_RGB","Colors","fromString","maxErrors","Curves","linearNone","zero","easeInQuadratic","easeOutQuadratic","easeInOutQuadratic","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuartic","easeOutQuartic","easeInOutQuartic","easeInQuintic","easeOutQuintic","easeInOutQuintic","inOutCurves","quadratic","cubic","quartic","quintic","linear","Smooth","InOut","FeildSpan","transition","duration","undefined","ticker","Duration","d","Clone","Reset","getValue","option","tvalue","curveMethod","Twix","None","In","testValue","finalValue","portion","curveStep","ColorFeildSpan","colors","hasVariance","PrepareColors","getPortion","floor","FiringClock","skip","repeats","callback_arguments","chance","every","skipMin","skipMax","lockout","Infinity","l","millis","hasChance","skipTime","GameWindow","canvas","bool_events","paused","drawFromWindows","engaged","createElement","setAttribute","append","context","getContext","camera","Size","update_ext","resize_ext","onresize","isAbsoluteSize","bind","ctx","onerror","clearTimeout","domElement","array","o","offscreen","display","w","h","getImageData","__trackStat","srcImage_Path","Pos","evt","rect","getBoundingClientRect","wheelDelta","total_x","total_y","grid","GridUnit","isPaused","sortDrawables","arr","sort","def_update","graphic","bool","before_draw_ext","reset_draw","HTMLCanvasElement","drawImage","__gameWindow","draw","after_draw_ext","getComplete","complete_callback","completion","boundCall","beforeDraw","parentNode","removeChild","afterDraw","$gw","GSEvent","apply","background","backgroundColor","splice","$window","life","remove","die_callback","removeDeadObjects","time","options","dev","start","animate","requestAnimationFrame","__stats","begin","__statsMS","__statsMB","isAtPlay","TWEEN","autoClear","clearRect","end","Stats","showPanel","dom","appendChild","marginLeft","Module","uri","load","fileObject","reader","FileReader","onload","readAsText","__object","executeNow","endsWith","createTextNode","construct","head","Code","$mouse","delta","sign","deltaY","OffscreenCanvas","RData","applyParentAndChildRelationship","child","trackBy","UniqueList","addUnique","children","RelationalData","Data","Rectangle","x1","y1","x2","y2","Min","Max","VectorBounds","VectorFrameBounds","termPoint","GeoMath","rotatePointsXY","angle","theta","point","Renderable","GameImage","onCreate","I","__error","Script","Scriptable","siblings","url","MOD","Texel","TexelArray","texels","$object","v","jsonData","Trigonometry","rotate_from_xy","cx","cy","nx","ny","rotational_speed","find_point_on_circle","Trig","linkedCurves","Linear","Quadratic","Out","Seamless","Cubic","Quartic","Quintic","LinkedCurves","TranceCurves","Exponential","power","Power","TrigFunctions","Sine","Cosine","Tangent","SpecialFunctions","Sawtooth","Square","Triangle","Floor","Sign","core","XYFunctions","SigmaFunctions","GammaFunctions","single_numeric_x","copied","valid_check","multiple","ceil","speedValue","targetInc","sub","mult","dist","v1","v2","minFloat","maxFloat","rotation","p1","p2","atan2","minimize","key1","key2","maximize","Vector3","Vector2","Rotation","Vector2d","Vector2D","VectorMath","MouseMoveEvent","Callback","cb","MousePosEvent","MouseLeftClickEvent","MouseRightClickEvent","parent_id","child_id","parent_key","child_key","InputEvent","btnix","button_ix","gamepad_ix","six","stickix","stick_ix","inputKey","keyboardKeys","keyitem","KeyboardEvent","gps","gamepadKeys","CollisionEvent","callbackFunction","$collision","$obj","$sprite","$sib","onBool","boolFunction","Bool","Event","BoxCollisionEvent","gamepads","__gamepads","intervals","controller_stack","__gamepadMaster","xbox_pc","button_0","button_1","button_2","button_3","button_4","button_5","button_6","button_7","button_8","button_9","button_10","button_11","button_12","button_13","button_14","button_15","selectSettings","gamepad","index","buttons","axes","mainLoop","clearInterval","navigator","getGamepads","process","selectedSettings","game_pad_index","game_pad","$adapter","gp","stick_left","stick_right","extendFunc","f1","f2","fc","normal_key","current_cb","parts","gpEvents","process_buttons","process_axes","axis1","axia2","pressed","clearance_1","gpc","bkey","GamepadEvents","Sound","sound","volume","srcList","SoundList","Volume","loop","val","soundOff","play","sounds","Audio","Ai","fun","AI","frameSize","image","init_singleFrame","HTMLImageElement","min_cix","visible","frameBounds","origin","frameOffset","apply2DFrames","flipX","selected_frame","frames","timer","seesaw_mode","reverse_frames","Scale","$f","bone","parentBone","$frame","$anime","load_call","__isInit","FrameSize","FrameBounds","_hang","xFinal","yFinal","maxFrame","fcount","quitLoop","framePos","Image","FramePos","Origin","frames_reversed","slice","reverse","pop","sized_Object","canvasObject","OffscreenCanvasRendering","colorMap","ColoredPixelGrid","frameSizeDiv","pixel","vector","gridObject","map","frame","init_colorMap","update_frame","__frametype","applied","engage","call_on_run","tween","Tween","easing","curve","Easing","to","call_on_complete","isComplete","prototype","DefineGridFrames","continuous","continue","Bone","rotatedOffset","offset","fullPosition","RotateTarget","BoneState","boneList","states","Box2D","StoreOffscreen","toDataURL","unitSize","getColoredPixelGrid","nonColorMap","getNonColoredPixelGrid","altImage","getFullPixelGrid","testCtx","fullPixelMap","lineWidth","phase_index","colorStops","gradient_call","shadowBlur","shadowColor","opacity","minBlur","maxBlur","stepFunction","blurStepFunction","blurTimer","gameObject","lineCollisionCallback","gop","gos","COLLIDE","LINE","x_total","out_of_1","next_x","next_y","last_point","next_point","angleBetween","window_offset","layer","gc","globalComposite","save","strokeStyle","beginPath","lastPoint","gradient","real_pos","lineTo","blurTime","blurLen","globalCompositeOperation","globalAlpha","stroke","fillStyle","closePath","fill","restore","Line2D","Mesh","vertices","trackableSpeed","referenceSize","startSize","Life","DefaultValues","NormalizeOptions","Options","sourceSprites","livingSprites","total","inTestMode","prerendered","precanvas","testDom","overflow","prectx","portions","presprites","fw","fh","isPrerendered","V","presprite","testSize","colorOptions","colorOptionSet","all_colors","max_ix","effectDataList","colorIndex","pushColorEffectCanvas","ColorEffect","Layer","ScrollFactor","active","xpos","ypos","scrollFactor","noScroll","targetSize","realWidth","realHeight","pct","effectCanvasList","alert","targetCanvas","Canvas","draw_image_frame","flipY","zIndex","def_life","composite","gobalCompositeOperation","Composite","alpha","Alpha","Color","Angle","maxlife","particle","oldest","maxTicker","nextObjectIndex","countLiving","stock","detached_particle","lockedRotation","positions","shape","pointMode","getRandomCircumferencePoints","getRandomPoints","lastSprite","has","flyByRotation","gunOptions","angleDiff","fly_angle","trackablePosition","Opacity","gunSpeed","lineList","lineSelector","lines","addParticles","$p","Effect","arguments","invisible","gradientColorA","gradientColorB","thickness","createLinearGradient","addColorStop","strokeRect","handleAnimationArgs","animations","handleCanvasArgs","apply_args","SingleFrame","srcTail","img","fillRect","clearEffects","effectCanvas","effectCtx","stored","effectFrames","api","effectCanvasTimer","doCanvasEffects","next","load_total","err","anime","FromData","array_instance","description","listnames","ln","motions","particles","shots","init_ext","realPosition","collision_bounds","GROUNDED","acceleration","rot_speed","rot_accel","TweenMotion","GSProton","clone","Anime","selected_sprite","DRAWOFFSCREEN","onScreen","draw_current_frame","frameList","camera_pos","putImageData","fx","fy","fxlCopy","scaleFloat","above_zero_xy","size_x","size_y","diffpos","half","boundFun","framesize","__mapSize","mx","my","wth","htw","_obj","lineObject","curveKey","motionCurveOptions","line","__crtLineIx","pctFloat","ixChange","prep_key","animation","bullet","velocity","rot_offset","rot_disp","__playerInst","bx","by","bw","bh","shot","rotPlus","subsprite","diff_min_y","diff_min_x","diff_max_y","diff_max_x","dimens","minkey","apart","ct","diffX","distX","tilesX","tilesY","unitWidth","unitHeight","srcImageSave","file_path","getJSON","decycle","SpriteEffects","effects","ImageEffects","parentSprite","AnimationEffects","FontSize","FontFamily","text","blur","fsize","ffamily","fontSize","fontFamily","font","measureText","realPos","getOffsetPos","fillText","GravityForce","subjects","clasticObjects","topClastics","accel","itemx","jumping","flying","accelY","__inAir","groundMaxY","itemy","collide_stop_top","Force","GForce","Gravity","scrollCycle","BoneSprite","bones","oncreate","SetParentPosition","boffset","CalcOffset","b1","b2","frame_offset","mode","overlaySprites","spritebrush","outputSprite","oix","addSprite","addOverlaySprite","SpriteFactory","livingTotal","frequency","menu_sprite","exampleSprite","onCreateSprite","createSprite","exampleSprites","loadFxn","$controller","livingCount","onfire","assignTrackableSpeed","assignLinesAndSelector","onupdate","enter","SpriteFill","selection_mode","selected_mode","onCreateShape","bounds","enclose_rectangle","tracker","currentSize","currentIndex","offscreenCanvas","nextSprite","mainSprite","px","py","basePosition","FeatureSymbol","symbol","Symbol","FeatureInjectors","FeatureInject","GClassFeatures","featureSymbols","hasKey","hasSymbol","props","CssFeatures","min_color","max_color","DataFunctions","Name","n","Description","Context","VectorFunctions","collision_callback","onCollide","collideables","Rot","Rotate","bpx","baseRotation","Transpose","Minimum","Maximum","minable","maxable","np","FlipX","middle","FlipY","curve_string","setTweenCurve","cps","s1","s2","easeType","curvesToArray","GamelabCanvas","__levelMaker","draw_object","isStopped","arc","canvasContext","deg","rad","translate","rotate","psuedoImage","htmlImage","testCanvas","paths","derez","path","nu","$ref","retrocycle","rez","eval","json_stringify","arg3","clean_object","json_parse","retro_object","container","cssText","addPanel","panel","beginTime","performance","Date","now","prevTime","fpsPanel","Panel","msPanel","self","memory","memPanel","REVISION","usedJSHeapSize","jsHeapSizeLimit","setMode","fg","bg","PR","devicePixelRatio","TEXT_X","TEXT_Y","GRAPH_X","GRAPH_Y","GRAPH_WIDTH","GRAPH_HEIGHT","textBaseline","maxValue","_tweens","getAll","removeAll","preserve","_object","_valuesStart","_valuesEnd","_valuesStartRepeat","_duration","_repeat","_repeatDelayTime","_yoyo","_isPlaying","_reversed","_delayTime","_startTime","_easingFunction","_interpolationFunction","Interpolation","_chainedTweens","_onStartCallback","_onStartCallbackFired","_onUpdateCallback","_onCompleteCallback","_onStopCallback","field","properties","stop","stopChainedTweens","numChainedTweens","amount","times","repeatDelay","yoyo","interpolation","chain","onStart","onStop","elapsed","charAt","isFinite","tmp","Sinusoidal","Circular","Elastic","Back","Bounce","fn","Utils","Bezier","pw","bn","Bernstein","CatmullRom","p0","Factorial","p3","v0","t2","t3","root","define","amd"],"mappings":";;;;;;;;;;;;AAAA;;AAEA,IAAIA,SAAS,EAAb;AAIA,C,CAAC;AACD,IAAIC,QAAQ,SAARA,KAAQ,CAACC,GAAD,EAAMC,MAAN,EAAiB;AAC3BC,aAAWF,GAAX,EAAgBC,MAAhB;AACD,CAFD;;AAIA,IAAIE,SAAS,SAATA,MAAS,CAACH,GAAD,EAAMC,MAAN,EAAiB;AAC5BG,cAAYJ,GAAZ,EAAiBC,MAAjB;AACD,CAFD;AAGA,CAAC,IAAII,OAAO,SAAPA,IAAO,CAACC,CAAD,EAAIC,CAAJ,EAAOC,CAAP,EAAa;AACvBC,UAAQC,GAAR,CAAYJ,CAAZ,EAAeC,CAAf,EAAkBC,CAAlB;AACD,CAFA;;AAID,IAAIG,OAAO,SAAPA,IAAO,GAAM;AACf,MAAIC,QAAQC,MAAR,CAAeC,GAAnB,EACEL,QAAQC,GAAR,CAAYJ,CAAZ,EAAeC,CAAf,EAAkBC,CAAlB;AACH,CAHD;AAIA;AACA;;AAEA,IAAIO,UAAU;;AAEZC,sBAAmB,4BAASV,CAAT,EAAYC,CAAZ,EAAc;;AAE/B,QAAG,EAAED,KAAKC,CAAP,CAAH,EACA,OAAOE,QAAQQ,KAAR,CAAc,wBAAd,CAAP;;AAEA,QAAG,OAAOX,CAAP,IAAY,QAAZ,IAAwB,CAACC,CAA5B,EACA,OAAO,EAACW,KAAIZ,CAAL,EAAQa,KAAIb,CAAZ,EAAP,CADA,KAEK,IAAGA,KAAKC,CAAR,EACL;AACE,aAAO;AACLW,aAAIX,CADC,EACEY,KAAIb;AADN,OAAP;AAGD,KALI,MAOL;AACE,aAAO;AACLY,aAAIZ,CADC,EACEa,KAAIZ;AADN,OAAP;AAGD;AACF;;AArBW,CAAd;AAwBA,CAAC,IAAIa,WAAW;;AAEdN,OAAI,KAFU;;AAId;AACAO,QAAM,cAASC,IAAT,EAAeC,IAAf,EAAqB;;AAEzB,QAAG,CAAC,KAAKT,GAAT,EACA;;AAEAL,YAAQY,IAAR,CAAaC,IAAb,EAAmBC,IAAnB;AAED,GAZa;;AAcdb,OAAI,aAASY,IAAT,EAAeC,IAAf,EAAoB;;AAEtB,QAAG,CAAC,KAAKT,GAAT,EACA;;AAEEL,YAAQC,GAAR,CAAYY,IAAZ,EAAkBC,IAAlB;AAEH,GArBa;;AAuBd;AACAN,SAAM,eAASK,IAAT,EAAeC,IAAf,EAAoB;;AAExB,QAAG,CAAC,KAAKT,GAAT,EACA;;AAEEL,YAAQQ,KAAR,CAAcK,IAAd,EAAoBC,IAApB;AAEH,GA/Ba;;AAkCdC,QAAK,cAASF,IAAT,EAAeC,IAAf,EAAoB;;AAEvB,QAAG,CAAC,KAAKT,GAAT,EACA;;AAEEL,YAAQQ,KAAR,CAAcK,IAAd,EAAoBC,IAApB;AAEH,GAzCa;;AA2Cd;AACAE,UAAQ,gBAASA,OAAT,EAA+B;AAAA,QAAdC,QAAc,uEAAH,CAAG;;;AAErCD,cAAS,OAAOA,OAAP,IAAkB,QAAlB,GAA6BA,OAA7B,GAAsCC,QAA/C;AAED,GAhDa;;AAkDd;AACAC,UAAQ,gBAASA,OAAT,EAAiBD,QAAjB,EAA2B;;AAEjCC,cAAS,OAAOA,OAAP,IAAkB,QAAlB,GAA6BA,OAA7B,GAAsCD,QAA/C;AAED,GAvDa;;AAyDd;AACAE,aAAW,mBAASC,GAAT,EAAc;AACvB,QAAIA,eAAeC,KAAnB,EACE,OAAOD,GAAP,CADF,KAGE,OAAO,CAACA,GAAD,CAAP;AACH,GA/Da;;AAiEd;AACAE,cAAY,oBAASC,OAAT,EAAkB;;AAE5B,QAAIC,OAAO,KAAKL,SAAL,CAAeI,OAAf,CAAX;;AAEA,QAAIE,SAAS,KAAb;;AAEA,SAAK,IAAIC,CAAT,IAAcF,IAAd,EAAoB;AAClB,UAAI,CAACA,KAAKE,CAAL,CAAL,EAAc;AACZD,iBAAS,IAAT;AACAzB,gBAAQQ,KAAR,CAAc,sCAAd;AACD;AACF;;AAED,WAAO,CAACiB,MAAR;AACD,GAhFa;;AAkFd;AACAE,6BAA0B,mCAASC,QAAT,EAAmBC,GAAnB,EAAwBC,OAAxB,EAAgC;;AAExD,QAAGF,SAASG,cAAT,CAAwBF,GAAxB,CAAH,EACA;AACE,WAAKd,IAAL,CAAUe,OAAV;AACA,aAAOF,SAASC,GAAT,CAAP;AACD,KAJD,MAMK;AACH,aAAOD,QAAP;AACD;AACF,GA9Fa;;AAiGd;AACAI,mBAAiB,yBAASZ,GAAT,EAAiD;AAClE;AAAA,QAD+Ba,UAC/B,uEAD4C,EAC5C;AAAA,QADgDC,QAChD,uEAD2D,KAC3D;;AACE,QAAIV,OAAO,KAAKL,SAAL,CAAeC,GAAf,CAAX;;AAEA,SAAK,IAAIM,CAAT,IAAcF,IAAd,EAAoB;AAClB,UAAI,QAAOA,KAAKE,CAAL,CAAP,MAAoBO,UAApB,IAAkC,EAAET,KAAKE,CAAL,aAAmBO,UAArB,CAAtC,EAAwE;AACtE,YAAI,CAACC,QAAL,EACE,OAAOlC,QAAQQ,KAAR,CAAcA,KAAd,CAAP,CADF,KAGE,MAAM,IAAIR,QAAQQ,KAAZ,CAAkBA,KAAlB,CAAN;AACH;AACF;;AAED,WAAO,IAAP;AACD,GAhHa;;AAkHd2B,eAAa,qBAASf,GAAT,EAAc;;AAEzB,WAAOgB,OAAOC,mBAAP,CAA2BjB,GAA3B,EAAgCkB,MAAhC,CAAuC,UAAUC,CAAV,EAAa;AACvD,aAAO,OAAOnB,IAAImB,CAAJ,CAAP,KAAkB,UAAzB;AACH,KAFM,CAAP;AAID,GAxHa;;AA0HdC,iBAAe,uBAASpB,GAAT,EAAc;;AAE3B,WAAOgB,OAAOC,mBAAP,CAA2BjB,IAAIqB,SAA/B,EAA0CH,MAA1C,CAAiD,UAAUC,CAAV,EAAa;AACjE,aAAO,OAAOnB,IAAImB,CAAJ,CAAP,KAAkB,UAAzB;AACH,KAFM,CAAP;AAID,GAhIa;;AAkIdG,cAAW,oBAASlB,IAAT,EAAemB,WAAf,EAA4B;AACvC;AACE,aAASC,SAAT,CAAmBxB,GAAnB,EAAwBZ,KAAxB,EAA+B;AAC7B,aAAOY,OAAO,IAAIyB,KAAJ,CAAUrC,KAAV,CAAd;AACD;;AAED,SAAK,IAAIkB,CAAT,IAAcF,IAAd,EAAoB;;AAEhB,UAAIsB,IAAIF,UAAUpB,KAAKE,CAAL,CAAV,EAAmBiB,WAAnB,CAAR;;AAEA,UAAIG,aAAaD,KAAjB,EAAwB;AACpB7C,gBAAQ6C,KAAR,CAAcC,CAAd;AACH;AACF;AACJ,GAhJa;;AAkJdC,uBAAqB,6BAAS3B,GAAT,EAAc4B,QAAd,EAAwBC,IAAxB,EAA8B;;AAEjD,QAAIzB,OAAO,KAAKL,SAAL,CAAeC,GAAf,CAAX;AAAA,QACE8B,OAAO,KAAK/B,SAAL,CAAe6B,QAAf,CADT;;AAGA,QAAIxC,QAAQ,oDAAZ;;AAEA,aAASoC,SAAT,CAAmBxB,GAAnB,EAAwB+B,IAAxB,EAA8B;AAC5B,aAAO/B,IAAI+B,IAAJ,KAAa,IAAIN,KAAJ,CAAUrC,KAAV,CAApB;AACD;;AAED,QAAIiB,SAAS,KAAb;;AAEA,SAAK,IAAIC,CAAT,IAAcF,IAAd,EAAoB;AAClB,WAAK,IAAI4B,CAAT,IAAcF,IAAd,EAAoB;AAClB,YAAIJ,IAAIF,UAAUpB,KAAKE,CAAL,CAAV,EAAmBwB,KAAKE,CAAL,CAAnB,CAAR;AACA,YAAIN,aAAaD,KAAjB,EAAwB;AACtBpB,mBAAS,IAAT;AACA,cAAIwB,IAAJ,EACE,MAAMH,CAAN,CADF,KAGE9C,QAAQQ,KAAR,CAAcsC,CAAd;AACH;AACF;AACF;;AAED,WAAO,CAACrB,MAAR;AACD,GA7Ka;;AA+Kd4B,mBAAiB,yBAASjC,GAAT,EAAckC,IAAd,EAAoB;AACrC;AACE,QAAIlC,eAAekC,IAAnB,EAAyB;AACvB,aAAOlC,GAAP;AACD,KAFD,MAEO;AACLA,YAAM,CAACA,GAAD,CAAN;AACD;AACD,WAAOA,GAAP;AACD,GAvLa;;AAyLdmC,cAAY,oBAASnC,GAAT,EAAckC,IAAd,EAAoB;AAChC;AACE,QAAIlC,eAAekC,IAAnB,EAAyB;AACvB,aAAOlC,GAAP;AACD,KAFD,MAEO;AACL,YAAM,IAAIyB,KAAJ,CAAU,6BAAV,CAAN;AACA7C,cAAQY,IAAR,CAAaQ,GAAb;AACApB,cAAQY,IAAR,CAAa0C,OAAO,GAApB;AACD;AACD,WAAOlC,GAAP;AACD,GAnMa;;AAqMdoC,eAAa,qBAASpC,GAAT,EAAckC,IAAd,EAAoB;AACjC;AACE,QAAIlC,eAAekC,IAAnB,EAAyB;AACvB,aAAOlC,GAAP;AACD,KAFD,MAEO;AACLpB,cAAQC,GAAR,CAAY,IAAI4C,KAAJ,CAAU,6BAAV,CAAZ;AACA7C,cAAQY,IAAR,CAAaQ,GAAb;AACApB,cAAQY,IAAR,CAAa0C,OAAO,GAApB;AACD;AACD,WAAOlC,GAAP;AACD,GA/Ma;;AAiNdqC,SAAM,eAASC,MAAT,EAAiBC,OAAjB,EAA0BC,SAA1B,EACN;AACE,QAAG,CAACF,OAAOC,OAAP,CAAJ,EACA;AACGD,aAAOC,OAAP,IAAkBC,SAAlB;AACF;AACF;AAvNa,CAAf;AAyND,C,CAAC;;;;AAID;;;;AAKA;AACA,IAAIC,iBAAiB,SAAjBA,cAAiB,GAAW;;AAE9B,MAAIC,SAAS;;AAEXC,cAAU;;AAERC,aAAO,KAFC;;AAIRC,gBAAU,IAJF;;AAMRC,sBAAgB,CANR;;AAQRC,kBAAY;AARJ,KAFC;;AAaXC,YAAQ,CAbG;;AAeXC,cAAS,KAfE;;AAiBXC,WAjBW,qBAiBD;AACR,UAAI,KAAKC,KAAL,IAAc,CAAlB,EAAqB;AACnB,aAAKA,KAAL,GAAaC,SAASC,IAAT,CAAcC,WAA3B;AACD;;AAED,UAAI,KAAKC,MAAL,IAAe,CAAnB,EAAsB;AACpB,aAAKA,MAAL,GAAcH,SAASC,IAAT,CAAcG,YAA5B;AACD;AAEF,KA1BU;AA4BXC,iBA5BW,2BA4BW;AAAA,UAARC,EAAQ,uEAAH,CAAG;;AACpB,aAAO,KAAKC,YAAL,CAAkB,CAAlB,CAAP;AACD,KA9BU;;;AAgCXR,WAAO,CAhCI;;AAkCXI,YAAQ,CAlCG;;AAoCXI,kBAAc,EApCH;;AAsCXC,oBAAgB,EAtCL;;AAwCXC,eAAW,EAxCA;;AA0CXC,iBAAa,EA1CF;;AA4CXC,uBAAmB,CAAC,QAAD,EAAW,OAAX,EAAoB,YAApB,EAAkC,aAAlC,EAAiD,SAAjD,EAA4D,QAA5D,EAAsE,WAAtE,CA5CR;;AA8CXC,sBAAkB,EA9CP;;AAgDXC,SAAK,eAAW;AACd,UAAIC,cAAc,EAAlB;AACA,WAAKP,YAAL,CAAkBQ,OAAlB,CAA0B,UAASC,IAAT,EAAe;AACvCF,sBAAcA,YAAYG,MAAZ,CAAmBD,KAAKE,SAAxB,CAAd;AACD,OAFD;AAGA1F,cAAQY,IAAR,CAAa,gBAAb,EAA+B0E,WAA/B;AACA,aAAOA,WAAP;AACD,KAvDU;;AAyDXK,UAAM,gBAAW;;AAEf,WAAKC,UAAL,GAAkB,IAAIzF,QAAQ0F,MAAZ,EAAlB;AAID,KA/DU;;AAiEXC,cAAS,oBAA0B;AAAA,UAAjBC,IAAiB,uEAAZ,CAAY;AAAA,UAATC,QAAS;;AACjC,UAAG,OAAOD,IAAP,IAAe,UAAlB,EACA;AACEC,mBAAWD,IAAX;AACAA,eAAO,CAAP;AACD;AACD,UAAI5F,QAAQ8F,YAAZ,GAA2BC,QAA3B,CAAoC,CAACH,IAAD,CAApC,EAA4CI,IAA5C;AACD,KAxEU;;AA0EXC,mBA1EW,2BA0EKhF,GA1EL,EA0EU;AACnB,UAAIiF,OAAO,IAAX;;AAEA,WAAK,IAAI3E,CAAT,IAAc,KAAKqD,YAAnB,EAAiC;AAC/B,YAAIuB,KAAK,KAAKvB,YAAL,CAAkBrD,CAAlB,CAAT;;AAEA,aAAK,IAAI0B,CAAT,IAAckD,GAAGC,OAAjB,EAA0B;AACxB,cAAID,GAAGC,OAAH,CAAWnD,CAAX,MAAkBhC,GAAtB,EACEiF,OAAO,KAAP;AACH;AACF;AACD,aAAOA,IAAP;AACD,KAtFU;AAwFXG,iBAxFW,yBAwFGC,EAxFH,EAwFO;AAChB,WAAK,IAAI/E,IAAI,CAAb,EAAgBA,IAAI,KAAK4D,WAAL,CAAiBoB,MAArC,EAA6ChF,GAA7C,EAAkD;AAChD,YAAI,KAAK4D,WAAL,CAAiB5D,CAAjB,EAAoB+E,EAApB,IAA0BA,EAA9B,EAAkC;AAChC,iBAAO,KAAKnB,WAAL,CAAiB5D,CAAjB,CAAP;AACD;AACF;AACF,KA9FU;;;AAgGXiF,cAAU,kBAASC,OAAT,EAAkBC,GAAlB,EAAuB;AACjC;AACE,WAAK3C,cAAL;AACA,UAAI,CAAC4C,MAAMD,GAAN,CAAD,IAAe,KAAK9C,QAAL,CAAcG,cAAd,GAA+B2C,GAA/B,IAAsC,CAAzD,EAA4D;AAC1D;AACD;AACF,KAtGU;;AAyGXE,eAAW,qBAAW;AACpB,UAAIC,KAAK,SAALA,EAAK,GAAW;AAClB,eAAO,CAAE,CAAC,IAAIC,KAAKC,MAAL,EAAL,IAAsB,OAAvB,GAAkC,CAAnC,EAAsCC,QAAtC,CAA+C,EAA/C,EAAmDC,SAAnD,CAA6D,CAA7D,CAAP;AACD,OAFD;AAGA,aAAQJ,OAAOA,IAAP,GAAc,GAAd,GAAoBA,IAApB,GAA2B,GAA3B,GAAiCA,IAAjC,GAAwC,GAAxC,GAA8CA,IAA9C,GAAqD,GAArD,GAA2DA,IAA3D,GAAkEA,IAAlE,GAAyEA,IAAjF;AACD,KA9GU;;AAiHXxG,WAAO,eAAS6G,IAAT,EAAeT,OAAf,EAAwB;;AAE7B,UAAIS,IAAJ,EAAU;AACR,cAAM,IAAIxE,KAAJ,CAAU+D,OAAV,CAAN;AACD,OAFD,MAEO;AACL5G,gBAAQQ,KAAR,CAAc,OAAOoG,OAArB;AACD;AACF,KAxHU;;AA0HXhG,UAAM,cAAS0G,CAAT,EAAY;;AAEhB,UAAInH,QAAQ6D,KAAZ,EAAmB;AACjBhE,gBAAQY,IAAR,CAAa,UAAU0G,CAAvB;AACD;AACF,KA/HU;;AAkIXrH,SAAK,aAASqH,CAAT,EAAY;;AAEf,UAAInH,QAAQ6D,KAAZ,EAAmB;AACjBhE,gBAAQC,GAAR,CAAY,aAAaqH,CAAzB;AACD;AACF,KAvIU;;AAyIXC,kBAAc,EAzIH;;AA2IXC,oBAAgB,wBAASC,CAAT,EAAY;;AAE1B,WAAKF,YAAL,CAAkBG,IAAlB,CAAuBD,CAAvB;AAED,KA/IU;;AAiJXE,iBAAa,EAjJF;;AAmJXC,mBAAe,uBAASC,UAAT,EAAqB;AAClC,WAAKF,WAAL,GAAmBE,UAAnB;AACD,KArJU;;AAuJXC,kBAAc,sBAASC,cAAT,EAAyBC,WAAzB,EAAsCC,QAAtC,EAAgDC,WAAhD,EAA6D;AACzE,UAAIC,UAAU,IAAIC,WAAJ,CAAgBL,cAAhB,EAAgCC,WAAhC,EAA6CC,QAA7C,EAAuDC,WAAvD,CAAd;;AAEA,WAAK5C,WAAL,CAAiBoC,IAAjB,CAAsB,IAAIU,WAAJ,CAAgBL,cAAhB,EAAgCC,WAAhC,EAA6CC,QAA7C,EAAuDC,WAAvD,CAAtB;;AAEA,UAAIG,SAASN,cAAb;;AAEA;;AAEA,UAAIM,MAAJ,EAAY;AACVrI,gBAAQC,GAAR,CAAY,8BAA8B+H,WAA9B,GAA4C,GAA5C,GAAkDE,WAA9D;;AAEA,YAAIG,OAAOC,KAAX,EAAkB;AAClB;AACED,mBAAOC,KAAP,CAAaL,QAAb,EAAuBC,WAAvB;AAED;AACD,YAAIG,OAAOE,UAAX,EAAuB;AACvB;AACEF,mBAAOE,UAAP,CAAkBN,QAAlB,EAA4BC,WAA5B;AAED;AACF;AACF,KA9KU;;AAiLXM,eAAW,mBAAS9E,MAAT,EAAiB+E,IAAjB,EAAuBvF,IAAvB,EAA6B;;AAEtCwF,wBAAkBC,IAAlB,CAAuBzF,IAAvB,EAA6B,UAAS4B,EAAT,EAAaU,IAAb,EAAmB;;AAE9C9B,eAAOoB,EAAP,IAAa2D,KAAK3D,EAAL,CAAb;AAED,OAJD;AAMD,KAzLU;;AA4LX8D,iBAAY,qBAASC,OAAT,EAAkB7C,QAAlB,EAA2B;;AAErC,UAAI8C,MAAMD,QAAQnC,MAAlB;AAAA,UAA0BqC,QAAQ,CAAlC;;AAEA,UAAGF,mBAAmBxH,KAAtB,EACA;AACQwH,gBAAQtD,OAAR,CAAgB,UAASyD,GAAT,EAAa;;AAE3BA,cAAIC,MAAJ,CAAW,YAAU;;AAEnBF,qBAAS,CAAT;;AAEA,gBAAGA,SAASD,GAAZ,EACA;AACE9C,uBAAS6C,OAAT;AACD;AAEF,WATD;AAWD,SAbD;AAcP,OAhBD,MAmBK,IAAG,QAAOA,OAAP,yCAAOA,OAAP,MAAkB,QAArB,EACL;AACEC,cAAM1G,OAAOc,IAAP,CAAY2F,OAAZ,EAAqBnC,MAA3B;;AAEA,aAAI,IAAIhF,CAAR,IAAamH,OAAb,EACA;AACE,cAAIG,MAAMH,QAAQnH,CAAR,CAAV;AACA,cAAGsH,IAAIE,WAAJ,CAAgBC,IAAhB,IAAwB,QAAxB,IACFH,IAAIE,WAAJ,CAAgBC,IAAhB,IAAwB,YADtB,IAEFH,IAAIE,WAAJ,CAAgBC,IAAhB,IAAwB,aAFtB,IAGHH,IAAIE,WAAJ,CAAgBC,IAAhB,IAAwB,WAHxB,EAIA;AACEH,gBAAIC,MAAJ,CAAW,YAAU;;AAEnBF,uBAAS,CAAT;;AAEA,kBAAGA,SAASD,GAAZ,EACA;AACE9C,yBAAS6C,OAAT;AACD;AACF,aARD;AASD;AACF;AACF;AACF,KA3OU;;AA6OXF,UAAM,cAASnH,IAAT,EAAe4H,QAAf,EAAyBb,UAAzB,EAAqC;AACzC,WAAK,IAAId,CAAT,IAAcjG,IAAd,EAAoB;AAClB4H,iBAAS3B,CAAT,EAAYjG,KAAKiG,CAAL,CAAZ;AACD;;AAED,UAAI,OAAOc,UAAP,KAAuB,UAA3B,EAAuC;AACrCA,mBAAW,KAAX,EAAkB/G,IAAlB;AACD;AAEF,KAtPU;;AAwPX6H,qBAAiB,EAxPN;;AA0PXC,WAAO,eAAStD,QAAT,EAAmB;;AAExB,WAAKqD,eAAL,CAAqB3B,IAArB,CAA0B1B,QAA1B;AAED,KA9PU;AA+PXuD,YAAQ,kBAAW;;AAEjB,WAAKC,SAAL;AAED,KAnQU;;AAqQXA,eAAW,qBAAW;;AAEpB,UAAIC,OAAO,KAAKJ,eAAhB;;AAEA,UAAIxB,aAAa,KAAK9C,YAAL,CAAkB,CAAlB,CAAjB;AAAA,UACEjB,SAAS,IADX;;AAGA;;AAEA,WAAK6E,IAAL,CAAUc,IAAV,EAAgB,UAAS3E,EAAT,EAAa4E,IAAb,EAAmB;;AAEjCA,aAAK5F,MAAL,EAAa+D,UAAb;AAED,OAJD;;AAMA,WAAK8B,WAAL,CAAiBhE,IAAjB;;AAEA,WAAKiE,SAAL,GAAiB,IAAjB;AAED,KAxRU;;AA0RXC,YAAQ,gBAASpB,IAAT,EAAevF,IAAf,EAAqBjC,QAArB,EAA+B;;AAErC,UAAI,OAAOiC,IAAP,IAAgB,QAApB,EAA8B;AAC5BA,eAAO,CAACA,IAAD,CAAP,CAD4B,CACb;AAChB;AACD,WAAK,IAAIxB,IAAI,CAAb,EAAgBA,IAAIwB,KAAKwD,MAAzB,EAAiChF,GAAjC,EAAsC;AACpC,YAAIoI,IAAI5G,KAAKxB,CAAL,CAAR;;AAEA,YAAI+G,QAAQA,KAAK1G,cAAL,CAAoB+H,CAApB,CAAZ,EAAoC;AAClC,iBAAOrB,KAAKqB,CAAL,CAAP,CADkC,CAClB;AACjB;AACF;AACD,aAAO7I,QAAP;AACD,KAvSU;;AAySX8I,gBAAY,oBAAStB,IAAT,EAAe;;AAEzB,UAAI5I,IAAI,EAAR;;AAEA,eAASmK,MAAT,CAAgBC,GAAhB,EAAqB;AACnB,eAAOA,IAAIC,WAAJ,GAAkBC,OAAlB,CAA0B,GAA1B,EAA+B,EAA/B,EAAmCA,OAAnC,CAA2C,GAA3C,EAAgD,EAAhD,EAAoDA,OAApD,CAA4D,GAA5D,EAAiE,EAAjE,CAAP;AACD;;AAED,WAAK,IAAIzI,CAAT,IAAc+G,IAAd,EAAoB;AAClB5I,UAAEmK,OAAOtI,CAAP,CAAF,IAAe+G,KAAK/G,CAAL,CAAf;AACD;;AAED,aAAO7B,CAAP;AACD,KAtTU;;AAwTXuK,yBAAqB,6BAASC,IAAT,EAAeC,IAAf,EAAqB;;AAExC,aAAOD,KAAKH,WAAL,GAAmBC,OAAnB,CAA2B,GAA3B,EAAgC,EAAhC,KAAuCG,KAAKJ,WAAL,GAAmBC,OAAnB,CAA2B,GAA3B,EAAgC,EAAhC,CAA9C;AAED,KA5TU;;AA8TXI,yBAAqB,+BAAW;;AAE9B;;AAEA;;AAEA,UAAIC,aAAa,EAAjB;;AAEA,WAAK7B,IAAL,CAAU,KAAKrD,WAAf,EAA4B,UAASR,EAAT,EAAaU,IAAb,EAAmB;;AAE7CgF,mBAAW9C,IAAX,CAAgB;AACd+C,4BAAkBjF,KAAK0D,WAAL,CAAiBC,IADrB;AAEd7F,gBAAMkC,KAAKlC;AAFG,SAAhB;AAKD,OAPD;;AASA,aAAOkH,UAAP;AAED,KAjVU;;AAmVXE,aAAS,iBAASjE,EAAT,EAAa;;AAEpB,WAAK,IAAI/E,CAAT,IAAc,KAAK4D,WAAnB,EAAgC;AAC9B,YAAI,KAAKA,WAAL,CAAiB5D,CAAjB,EAAoB+E,EAApB,IAA0BA,EAA9B,EAAkC;AAChC,iBAAO,KAAKnB,WAAL,CAAiB5D,CAAjB,CAAP;AAED;AAEF;AAEF,KA7VU;;AA+VXiJ,YAAQ,gBAASF,gBAAT,EAA2BtB,IAA3B,EAAiCyB,KAAjC,CAAuC,+CAAvC,EAAyF;;AAE/F,UAAIC,QAAQ,EAAZ;;AAEA,UAAIC,SAAS,IAAb;;AAEA,WAAKnC,IAAL,CAAUxI,QAAQkF,GAAR,EAAV,EAAyB,UAASP,EAAT,EAAaU,IAAb,EAAmB;;AAE1C,YAAIiF,oBAAoB,GAApB,IAA2BjF,KAAK0D,WAAL,CAAiBC,IAAjB,IAAyBsB,gBAAxD,EAA0E;;AAExE,cAAIG,SAAS,GAAT,IAAgBE,OAAOV,mBAAP,CAA2BQ,KAA3B,EAAkCpF,KAAKoF,KAAvC,CAApB,EAAmE;;AAEjE,gBAAIzB,QAAQ,GAAR,IAAe2B,OAAOV,mBAAP,CAA2BjB,IAA3B,EAAiC3D,KAAK2D,IAAtC,CAAnB,EAAgE;;AAE9D0B,oBAAMnD,IAAN,CAAWlC,IAAX;AAED;AACF;AACF;AACF,OAbD;;AAeA,aAAOqF,KAAP;AACD;AArXU,GAAb;;AAwXA,SAAO/G,MAAP;AAED,CA5XD;;AA8XA,IAAIiH,aAAa;AACfC,OAAK,eAAW,CAGf,CAJc;;AAMfC,QAAM,cAASvH,MAAT,EAAiB;AACrB;;AAEA,QAAI,CAACA,OAAO+C,EAAZ,EAAgB;AACd/C,aAAO+C,EAAP,GAAYtG,QAAQ4G,SAAR,EAAZ;AAED;;AAED,QAAIoC,OAAOzF,OAAOyF,IAAlB;AAAA,QACE7F,OAAOI,OAAOwF,WAAP,CAAmBC,IAD5B;AAAA,QAEE+B,WAAWC,KAAKzH,MAAL,CAFb;AAAA,QAGE+C,KAAK/C,OAAO+C,EAHd;AAMD;;AApBc,CAAjB;;IAyBM2E,G,CAAI;;AAER,iBAAuB;AAAA,QAAX3C,IAAW,uEAAJ,EAAI;;AAAA;;AAErB,SAAK4C,OAAL,GAAe5C,KAAK4C,OAAL,IAAgB,EAA/B;;AAEA,SAAKC,YAAL,GAAoB7C,KAAK6C,YAAL,IAAqB,EAAzC;AACD;;AAED;;;;;;;0BAKMC,M,EAAQC,O,EAAS;AACrB,WAAKH,OAAL,GAAe,KAAKA,OAAL,IAAgB,EAA/B;;AAEA,UAAI,KAAKA,OAAL,CAAaI,OAAb,CAAqBF,OAAOC,OAAP,CAArB,KAAyC,CAAC,CAA9C,EAAiD;AAC/C,aAAKH,OAAL,CAAa3D,IAAb,CAAkB;AAChB6D,kBAAQA,MADQ;AAEhBC,mBAASA;AAFO,SAAlB;AAID;AACF;;;+BAEUD,M,EAAQC,O,EAAS;AAC1B,WAAKF,YAAL,GAAoB,KAAKA,YAAL,IAAqB,EAAzC;;AAEA,UAAI,KAAKA,YAAL,CAAkBG,OAAlB,CAA0BF,OAAOC,OAAP,CAA1B,KAA8C,CAAC,CAAnD,EAAsD;AACpD,aAAKF,YAAL,CAAkB5D,IAAlB,CAAuB;AACrB6D,kBAAQA,MADa;AAErBC,mBAASA;AAFY,SAAvB;AAID;AACF;;;kCAEa;AACZ;AACA,WAAK,IAAI9J,IAAI,CAAb,EAAgBA,IAAI,KAAK2J,OAAL,CAAa3E,MAAjC,EAAyChF,GAAzC,EAA8C;AAC5C,aAAK2J,OAAL,CAAa3J,CAAb,EAAgB6J,MAAhB,CAAuB,KAAKF,OAAL,CAAa3J,CAAb,EAAgB8J,OAAvC;AACD;AACF;;;uCAEkB;AACjB;AACA,WAAK,IAAI9J,IAAI,CAAb,EAAgBA,IAAI,KAAK4J,YAAL,CAAkB5E,MAAtC,EAA8ChF,GAA9C,EAAmD;AACjD,aAAK4J,YAAL,CAAkB5J,CAAlB,EAAqB6J,MAArB,CAA4B,KAAKD,YAAL,CAAkB5J,CAAlB,EAAqB8J,OAAjD;AACD;AACF;;;;;;AAIH,IAAIrL,UAAU0D,gBAAd;;AAGA1D,QAAQE,GAAR,GAAc,IAAd;;AAGA,IAAI,OAAOyD,MAAP,KAAkB,WAAlB,IAAiCA,OAAO4H,OAA5C,EAAqD;;AAEnD;AACA5H,SAAO4H,OAAP,GAAiBvL,OAAjB;AAED,CALD,MAKO,CAGN;;AAED;;;;;AAKA;;;;AAIA,SAASgL,IAAT,CAAc/J,GAAd,EAAmB;;AAEjB,SAAOuK,KAAKC,SAAL,CAAexK,GAAf,CAAP;AAED;;AAEDjB,QAAQgL,IAAR,GAAeA,IAAf;;AAEA;;;;;AAKA,SAASU,EAAT,CAAYC,QAAZ,EAAsB;;AAEpB;;AAEA9L,UAAQC,GAAR,CAAY6L,QAAZ;;AAEA,MAAIjB,QAAQ,EAAZ;;AAEA;;AAEA,MAAI,OAAOiB,QAAP,KAAoB,QAAxB,EAAkC;;AAEhC,QAAIA,oBAAoBzK,KAAxB,EAA+B,CAE9B,CAFD,MAEO,CAGN;AAEF,GATD,MASO;;AAGL,QAAIyK,YAAYA,aAAa,GAA7B,EAAkC;;AAEhC,UAAIC,IAAID,YAAY,EAApB;;AAEA9L,cAAQY,IAAR,CAAa,cAAcmL,CAA3B;;AAGA,UAAIC,eAAeH,GAAGI,MAAH,CAAU,GAAV,EAAeF,CAAf,EAAkBG,IAAlB,EAAnB;AAAA,UACEC,UAAUH,aAAa5E,SAAb,CAAuB,CAAvB,EAA0B,CAA1B,CADZ;;AAGA,UAAIgF,oBAAoB,GAAxB;;AAEA,UAAIC,SAAS,EAAb;;AAEA,UAAIC,sBAAsB,SAAtBA,mBAAsB,CAASrC,GAAT,EAAc;AACtC,eAAOA,IAAIE,OAAJ,CAAY,GAAZ,EAAiB,EAAjB,CAAP;AACD,OAFD;;AAIA,cAAQgC,QAAQjC,WAAR,EAAR;AACE,aAAK,GAAL;;AAEElK,kBAAQY,IAAR,CAAa,2BAAb;;AAEAwL,8BAAoBE,oBAAoBT,GAAGU,KAAH,CAAS,GAAT,EAAcP,YAAd,CAApB,CAApB;;AAEAhM,kBAAQY,IAAR,CAAa,qBAAqBwL,iBAAlC;;AAEA;;AAEF,aAAK,GAAL;;AAEEpM,kBAAQY,IAAR,CAAa,wDAAb;;AAEAwL,8BAAoB,GAApB;;AAEA;;AAjBJ;;AAqBA,UAAII,YAAYX,GAAGY,OAAH,CAAW,GAAX,EAAgB,GAAhB,EAAqBV,CAArB,CAAhB;AAAA,UACEW,SAASF,UAAUG,KAAV,CAAgB,GAAhB,CADX;;AAGA,UAAIC,gBAAgB,GAApB;AAAA,UACEC,eAAe,GADjB;;AAGA,UAAIC,WAAW,SAAXA,QAAW,GAAW;;AAExB,YAAIJ,OAAOhG,MAAP,IAAiB,CAArB,EAAwB;;AAEtB,kBAAQgG,OAAO,CAAP,EAAUxC,WAAV,EAAR;;AAEE,iBAAK,MAAL;;AAEE;;AAEAlK,sBAAQC,GAAR,CAAY,oCAAoCkL,KAAKuB,MAAL,CAAhD;;AAEAG,6BAAeP,oBAAoBI,OAAO,CAAP,CAApB,CAAf;;AAEA;;AAEF,iBAAK,OAAL;;AAEE1M,sBAAQC,GAAR,CAAY,oCAAoCkL,KAAKuB,MAAL,CAAhD;;AAEAE,8BAAgBN,oBAAoBI,OAAO,CAAP,CAApB,CAAhB;;AAEA;;AAlBJ;AAsBD;;AAED,YAAIA,OAAOhG,MAAP,IAAiB,CAArB,EAAwB;;AAEtBgG,iBAAO,CAAP,IAAYA,OAAO,CAAP,EAAUvC,OAAV,CAAkB,GAAlB,EAAuB,EAAvB,CAAZ;;AAEA,kBAAQuC,OAAO,CAAP,EAAUxC,WAAV,EAAR;;AAEE,iBAAK,MAAL;;AAEE;;AAEAlK,sBAAQC,GAAR,CAAY,oCAAoCkL,KAAKuB,MAAL,CAAhD;;AAEAG,6BAAeP,oBAAoBI,OAAO,CAAP,CAApB,CAAf;;AAEA;;AAEF,iBAAK,OAAL;;AAEE1M,sBAAQC,GAAR,CAAY,oCAAoCkL,KAAKuB,MAAL,CAAhD;;AAEAE,8BAAgBN,oBAAoBI,OAAO,CAAP,CAApB,CAAhB;;AAEA;;AAlBJ;AAsBD;AAEF,OAxDD;;AA0DAI,eAASJ,MAAT;;AAEA7B,cAAQ1K,QAAQwK,MAAR,CAAeyB,iBAAf,EAAkCS,YAAlC,EAAgDD,aAAhD,CAAR;AAED,KA3GD,MA2GO,IAAId,YAAY,GAAhB,EAAqB;;AAE1BjB,cAAQ1K,QAAQkF,GAAR,EAAR;AAED;AAEF;;AAGDwF,QAAMlC,IAAN,GAAa,UAAS3C,QAAT,EAAmB;;AAE9B,QAAIO,UAAU,EAAd;;AAEA,SAAK,IAAI7E,IAAI,CAAb,EAAgBA,IAAI,KAAKgF,MAAzB,EAAiChF,GAAjC,EAAsC;AACpC,UAAI,OAAOA,CAAP,IAAY,QAAhB,EAA0B;;AAExBsE,iBAAStE,CAAT,EAAY,KAAKA,CAAL,CAAZ;AACD;AAEF;AAGF,GAbD;;AAeAmJ,QAAMkC,EAAN,GAAW,UAASC,OAAT,EAAkBC,cAAlB,EAAkCC,aAAlC,EAAiDlH,QAAjD,EAA2D;AACtE;;AAEE,QAAI,OAAOgH,OAAP,IAAkB,UAAlB,IAAgC,OAAOC,cAAP,IAAyB,UAA7D,EAAyE;AACvE;;AAEA,UAAIE,cAAcH,OAAlB;AAAA,UACEI,WAAWH,cADb;AAAA,UAGEI,YAAY,IAAIlN,QAAQmN,SAAZ,GAAwBC,EAAxB,CAA2BJ,WAA3B,EAAwCK,IAAxC,CAA6CJ,QAA7C,CAHd;AAKD;;AAGD,QAAIZ,YAAYX,GAAGY,OAAH,CAAW,GAAX,EAAgB,GAAhB,EAAqBO,OAArB,CAAhB;;AAEA,QAAIR,UAAUf,OAAV,CAAkB,KAAlB,KAA4B,CAAhC,EAAmC;AACjCe,kBAAYA,UAAUrC,OAAV,CAAkB,KAAlB,EAAyB,GAAzB,CAAZ;AACD;;AAED,QAAIqC,UAAUf,OAAV,CAAkB,IAAlB,KAA2B,CAA/B,EAAkC;AAChCe,kBAAYA,UAAUrC,OAAV,CAAkB,IAAlB,EAAwB,GAAxB,EAA6BA,OAA7B,CAAqC,IAArC,EAA2C,CAA3C,CAAZ;AACD;;AAED,QAAIuC,SAASF,UAAUG,KAAV,CAAgB,GAAhB,CAAb;;AAEA,QAAIC,gBAAgB,GAApB;AAAA,QACEC,eAAe,GADjB;;AAGA,QAAIG,QAAQvB,OAAR,CAAgB,GAAhB,KAAwB,CAA5B,EAA+B;AAC7BuB,gBAAUnB,GAAGI,MAAH,CAAU,GAAV,EAAee,OAAf,EAAwBd,IAAxB,EAAV;AAED;;AAGD,QAAIuB,UAAU,CAAd;;AAEA;;AAEA,QAAIP,iBAAiB,OAAOA,aAAP,IAAwB,UAAzC,IAAuD,CAAClH,QAA5D,EAAsE;AACpEA,iBAAWkH,aAAX;AACAA,sBAAgB,CAAhB;AACD;;AAED;;AAEA,QAAID,kBAAkB,OAAOA,cAAP,IAAyB,UAA3C,IAAyD,CAACjH,QAA9D,EAAwE;;AAEtEA,iBAAWiH,cAAX;;AAEAA,uBAAiBpB,GAAG,GAAH,CAAjB;;AAEAqB,sBAAgB,CAAhB;AACD;;AAED,QAAIQ,cAAc,EAAlB;;AAEA;;AAEAA,gBAAYC,GAAZ,GAAkBT,aAAlB;;AAEA;;AAEAQ,gBAAYV,OAAZ,GAAsBA,OAAtB;;AAEA,QAAInB,GAAG+B,YAAH,CAAgB,CAAC,OAAD,EAAU,QAAV,EAAoB,OAApB,EAA6B,KAA7B,CAAhB,EAAqDF,YAAYV,OAAjE,CAAJ,EAA+E;;AAE7E,UAAIa,cAAcH,YAAYV,OAAZ,CAAoBvB,OAApB,CAA4B,QAA5B,KAAyC,CAA3D;;AAEAtL,cAAQ2N,cAAR,CAAuBf,EAAvB,CAA0BW,YAAYV,OAAtC,EAA+C,CAA/C,EAAkD,UAAStL,CAAT,EAAY0B,CAAZ,EAAe;;AAE/D4C,iBAAStE,CAAT,EAAY0B,CAAZ;AAED,OAJD;;AAMApD,cAAQY,IAAR,CAAa,iCAAiC8M,YAAYV,OAA1D;;AAEAhN,cAAQY,IAAR,CAAa,kBAAb;AAED;;AAED;AAhBA,SAiBK,IAAIiL,GAAG+B,YAAH,CAAgB,CAAC,SAAD,EAAY,WAAZ,EAAyB,KAAzB,EAAgC,OAAhC,CAAhB,EAA0DF,YAAYV,OAAtE,CAAJ,EAAoF;;AAEvF;;AAEA;;AAEA;;AAEA,aAAKrE,IAAL,CAAU,UAAS7D,EAAT,EAAaiJ,KAAb,EAAoB;;AAE5B;AACA;;AAEAd,yBAAetE,IAAf,CAAoB,UAASqF,EAAT,EAAaC,KAAb,EAAoB;;AAEtC;AACA;;AAEA,gBAAI,OAAOF,MAAMG,QAAb,IAA0B,UAA9B,EAA0C;;AAExC,kBAAIC,SAAS,SAATA,MAAS,CAASC,MAAT,EAAiB;;AAE5BpO,wBAAQC,GAAR,CAAY,kBAAkBkL,KAAK,CAAC,IAAD,EAAO8C,KAAP,CAAL,CAA9B;;AAEA,oBAAI,KAAKI,eAAL,CAAqBJ,KAArB,EAA4BR,OAA5B,CAAJ,EAA0C;;AAExCzH,2BAAS,IAAT,EAAeiI,KAAf;AAED;AAEF,eAVD;;AAYAF,oBAAMG,QAAN,CAAeC,MAAf;AAED;AAGF,WAxBD;AA0BD,SA/BD;AAkCD,OA1CI,MA0CE;AACLnO,gBAAQY,IAAR,CAAa,0BAAb;;AAEA;;AAEAZ,gBAAQY,IAAR,CAAa,+CAA+C8M,YAAYV,OAAxE;;AAEAhN,gBAAQY,IAAR,CAAa,2BAAb;;AAEA,YAAI0N,YAAY,GAAhB;AAAA,YACEzM,MAAM2K,aAAakB,YAAYV,OADjC;;AAGA,YAAInL,IAAI4J,OAAJ,CAAY,GAAZ,KAAoB,CAApB,IAAyB5J,IAAI4J,OAAJ,CAAY,GAAZ,KAAoB,CAAjD,EAAoD;AAClD5J,gBAAMgK,GAAGY,OAAH,CAAW,GAAX,EAAgB,GAAhB,EAAqB5K,GAArB,CAAN;AAED;;AAED,YAAI0M,YAAY,EAAhB;;AAEA,YAAIC,MAAM,eAAW;AACnBxO,kBAAQQ,KAAR,CAAc,6CAAd;AAED,SAHD;;AAKA,YAAIqB,IAAI4J,OAAJ,CAAY,IAAZ,KAAqB,CAAzB,EAA4B;AAC1B6C,sBAAY,IAAZ;AAGD,SAJD,MAIO,IAAIzM,IAAI4J,OAAJ,CAAY,IAAZ,KAAqB,CAAzB,EAA4B;AACjC6C,sBAAY,IAAZ;AACD,SAFM,MAEA,IAAIzM,IAAI4J,OAAJ,CAAY,GAAZ,KAAoB,CAAxB,EAA2B;AAChC6C,sBAAY,GAAZ;AACD,SAFM,MAEA,IAAIzM,IAAI4J,OAAJ,CAAY,GAAZ,KAAoB,CAAxB,EAA2B;AAChC6C,sBAAY,GAAZ;AACD,SAFM,MAEA,IAAIzM,IAAI4J,OAAJ,CAAY,GAAZ,KAAoB,CAAxB,EAA2B;AAChC6C,sBAAY,GAAZ;AACD;;AAEDC,oBAAY1M,IAAI8K,KAAJ,CAAU2B,SAAV,CAAZ;;AAEA,aAAK,IAAI5M,IAAI,CAAb,EAAgBA,IAAI6M,UAAU7H,MAA9B,EAAsChF,GAAtC,EAA2C;AACzC6M,oBAAU7M,CAAV,IAAe6M,UAAU7M,CAAV,EAAayI,OAAb,CAAqB,GAArB,EAA0B,EAA1B,EAA8BA,OAA9B,CAAsC,GAAtC,EAA2C,EAA3C,EAA+C+B,IAA/C,EAAf,CADyC,CAC6B;AAEvE;;AAED,YAAIuC,KAAJ,EAAWzN,MAAX;;AAEA;;AAEA,YAAI;;AAEFyN,kBAAQF,UAAU,CAAV,CAAR;;AAEAvN,mBAAS0N,WAAWH,UAAU,CAAV,CAAX,CAAT;AAED,SAND,CAME,OAAOzL,CAAP,EAAU;AACV9C,kBAAQC,GAAR,CAAY6C,CAAZ;AACD;;AAED9C,gBAAQY,IAAR,CAAa,uCAAuC0N,SAApD;;AAEA,gBAAQA,SAAR;;AAEE,eAAK,IAAL;;AAGEE,kBAAM,aAASpN,GAAT,EAAcS,GAAd,EAAmB;AACvB,kBAAIT,IAAIS,GAAJ,KAAYb,MAAhB,EAAwB;AACtBgF;AACD;AACF,aAJD;;AAMA;;AAEF,eAAK,IAAL;;AAEEwI,kBAAM,aAASpN,GAAT,EAAcS,GAAd,EAAmB;AACvB,kBAAIT,IAAIS,GAAJ,KAAYb,MAAhB,EAAwB;AACtBgF;AACD;AACF,aAJD;;AAMA;;AAGF,eAAK,GAAL;;AAEEwI,kBAAM,aAASpN,GAAT,EAAcS,GAAd,EAAmB;AACvB,kBAAIT,IAAIS,GAAJ,IAAWb,MAAf,EAAuB;AACrBgF;AACD;AACF,aAJD;;AAMA;;AAEF,eAAK,GAAL;;AAEEwI,kBAAM,aAASpN,GAAT,EAAcS,GAAd,EAAmB;AACvB,kBAAIT,IAAIS,GAAJ,IAAWb,MAAf,EAAuB;AACrBgF;AACD;AACF,aAJD;;AAMA;;AAEF,eAAK,GAAL;;AAEEwI,kBAAM,aAASpN,GAAT,EAAcS,GAAd,EAAmB;AACvB,kBAAIT,IAAIS,GAAJ,KAAYb,MAAhB,EAAwB;AACtBgF;AACD;AACF,aAJD;;AAMA;;AApDJ;;AAyDA;;;;;AAKA,YAAI9C,OAAOuL,MAAM9B,KAAN,CAAY,GAAZ,CAAX;AAAA,YACEgC,UAAU,EADZ;;AAGA,aAAKhG,IAAL,CAAU,UAAS7D,EAAT,EAAaU,IAAb,EAAmB;;AAE3B,cAAI9B,SAAS,EAAb;;AAEA,cAAIR,KAAKwD,MAAL,IAAe,CAAnB,EAAsB;AACpBhD,qBAAS8B,IAAT;;AAEAmJ,sBAAUF,KAAV;AAED,WALD,MAKO,IAAIvL,KAAKwD,MAAL,IAAe,CAAnB,EAAsB;AAC3BhD,qBAAS8B,KAAKtC,KAAK,CAAL,CAAL,CAAT;;AAEAyL,sBAAUzL,KAAK,CAAL,CAAV;AAGD,WANM,MAMA,IAAIA,KAAKwD,MAAL,IAAe,CAAnB,EAAsB;AAC3BhD,qBAAS8B,KAAKtC,KAAK,CAAL,CAAL,EAAcA,KAAK,CAAL,CAAd,CAAT;;AAEAyL,sBAAUzL,KAAK,CAAL,CAAV;AAED,WALM,MAKA;AACLlD,oBAAQQ,KAAR,CAAc,gFAAd;AAED;;AAED,cAAI,OAAOgF,KAAK0I,QAAZ,IAAwB,UAA5B,EAAwC;;AAGtC,gBAAIlF,MAAMxD,IAAV;;AAEAA,iBAAK0I,QAAL,CAAc,UAASE,MAAT,EAAiB;;AAE7BI,kBAAI9K,MAAJ,EAAYiL,OAAZ;AAED,aAJD;AAMD;AAEF,SAtCD;AAwCD;AAEF,GApSD;;AAuSA,SAAO9D,KAAP;AAED;;AAGDgB,GAAGlD,IAAH,GAAU,UAASvH,GAAT,EAAc4E,QAAd,EAAwB4I,QAAxB,EAAkC;;AAE1C,OAAK,IAAIlN,CAAT,IAAcN,GAAd,EAAmB;AACjB4E,aAAS5E,GAAT;AAED;;AAED,MAAI,OAAOwN,QAAP,IAAoB,UAAxB,EAAoC;AAClCA,aAASxN,GAAT;AAED;AAEF,CAZD;;AAeAyK,GAAGI,MAAH,GAAY,UAAS4C,EAAT,EAAaC,QAAb,EAAuB;AACjC,MAAIC,YAAY,CAAhB;AACA,MAAIC,UAAUF,SAASrD,OAAT,CAAiBoD,EAAjB,EAAqBE,SAArB,CAAd;AACA,SAAOD,SAAS1H,SAAT,CAAmB2H,SAAnB,EAA8BC,OAA9B,CAAP;AACD,CAJD;;AAOAnD,GAAGoD,QAAH,GAAc,UAASJ,EAAT,EAAaC,QAAb,EAAuB;AACnC,SAAOA,SAASrD,OAAT,CAAiBoD,EAAjB,KAAwB,CAA/B;AACD,CAFD;;AAIAhD,GAAGqD,YAAH,GAAkB,UAASC,KAAT,EAAgBL,QAAhB,EAA0B;AAC1C,OAAK,IAAIpN,IAAI,CAAb,EAAgBA,IAAIyN,MAAMzI,MAA1B,EAAkChF,GAAlC,EAAuC;AACrC,QAAIoN,SAASrD,OAAT,CAAiB0D,MAAMzN,CAAN,CAAjB,IAA6B,CAAjC,EAAoC;AAClC,aAAO,KAAP;AAED;AACF;;AAED,SAAO,IAAP;AAED,CAVD;;AAYAmK,GAAG+B,YAAH,GAAkB,UAASuB,KAAT,EAAgBL,QAAhB,EAA0B;;AAE1C,OAAK,IAAIpN,IAAI,CAAb,EAAgBA,IAAIyN,MAAMzI,MAA1B,EAAkChF,GAAlC,EAAuC;AACrC,QAAIoN,SAASrD,OAAT,CAAiB0D,MAAMzN,CAAN,CAAjB,KAA8B,CAAlC,EAAqC;AACnC,aAAO,IAAP;AAED;AACF;;AAED,SAAO,KAAP;AAED,CAXD;;AAaAmK,GAAGU,KAAH,GAAW,UAASsC,EAAT,EAAaC,QAAb,EAAuB;AAChC,MAAIC,YAAYD,SAASrD,OAAT,CAAiBoD,EAAjB,IAAuB,CAAvC;AACA,MAAIG,UAAUF,SAASpI,MAAvB;AACA,SAAOoI,SAAS1H,SAAT,CAAmB2H,SAAnB,EAA8BC,OAA9B,CAAP;AACD,CAJD;;AAMAnD,GAAGY,OAAH,GAAa,UAASoC,EAAT,EAAaO,EAAb,EAAiBN,QAAjB,EAA2B;AACtC,MAAIC,YAAYD,SAASrD,OAAT,CAAiBoD,EAAjB,IAAuB,CAAvC;AACA,MAAIG,UAAUF,SAASrD,OAAT,CAAiB2D,EAAjB,EAAqBL,SAArB,CAAd;AACA,SAAOD,SAAS1H,SAAT,CAAmB2H,SAAnB,EAA8BC,OAA9B,CAAP;AACD,CAJD;;AAOA;;;;;AAKAnD,GAAGwD,oBAAH,GAA0B,YAAW;AAAE;AACrC,MAAIC,gBAAgB,CAAC,GAAD,EAAM,SAAN,EAAiB,yBAAjB,EAA4C,+BAA5C,CAApB;;AAEA,OAAK,IAAI5N,IAAI,CAAb,EAAgBA,IAAI4N,cAAc5I,MAAlC,EAA0ChF,GAA1C,EAA+C;AAC7C,QAAI6N,OAAOD,cAAc5N,CAAd,CAAX;;AAEA1B,YAAQY,IAAR,CAAa,aAAa2O,IAA1B;;AAEA1D,OAAG0D,IAAH;AACD;;AAEDvP,UAAQC,GAAR,CAAY,oBAAZ;;AAEA,OAAK8M,EAAL,CAAQ,cAAR;;AAEA/M,UAAQC,GAAR,CAAY,gBAAZ;;AAEA,OAAK8M,EAAL,CAAQ,UAAR;;AAGA/M,UAAQC,GAAR,CAAY,iBAAZ;;AAEA,OAAK8M,EAAL,CAAQ,SAAR;;AAGA/M,UAAQC,GAAR,CAAY,gBAAZ;;AAEA,OAAK8M,EAAL,CAAQ,SAAR;;AAEA/M,UAAQC,GAAR,CAAY,cAAZ;;AAEA,OAAK8M,EAAL,CAAQ,WAAR;AAGD,CAlCD;;AAqCA5M,QAAQ0L,EAAR,GAAaA,EAAb;;AAEA1L,QAAQ0K,KAAR,GAAgBgB,EAAhB;;AAGA;;;;;AAKA1L,QAAQwJ,WAAR,GAAsB;;AAEpB;;AAEA6F,SAAO;AACLC,cAAU;AACR/N,SAAG,CADK;AAER0B,SAAG;AAFK,KADL;AAKLsM,WAAO;AACLhO,SAAG,CADE;AAEL0B,SAAG;AAFE,KALF;AASLuM,eATK,uBASOjO,CATP,EASU0B,CATV,EASa;;AAEhB,WAAKsM,KAAL,CAAWhO,CAAX,GAAeA,IAAI,KAAK+N,QAAL,CAAc/N,CAAjC;;AAEA,WAAKgO,KAAL,CAAWtM,CAAX,GAAeA,IAAI,KAAKqM,QAAL,CAAcrM,CAAjC;;AAEA,WAAKqM,QAAL,CAAc/N,CAAd,GAAkBA,CAAlB;;AAEA,WAAK+N,QAAL,CAAcrM,CAAd,GAAkBA,CAAlB;AAED,KAnBI;;AAoBLwM,YAAQ,kBAAW;AACjB,aAAO,KAAKC,KAAL,CAAWnO,CAAX,IAAgB,CAAhB,IAAqB,KAAKmO,KAAL,CAAWzM,CAAX,IAAgB,CAA5C;AACD;AAtBI,GAJa;;AA6BpB0M,UAAQ;;AAENC,eAAW,EAFL;AAGNC,cAAU,EAHJ;AAINC,eAAW,EAJL;AAKNC,gBAAY,EALN;AAMNC,iBAAa,EANP;AAONC,aAAS,EAPH;AAQNC,eAAW;AARL,GA7BY;;AAwCpBC,UAAQ,EAxCY;;AA0CpBC,cAAY,oBAAStG,GAAT,EAAc;AACxB,WAAOA,IAAIC,WAAJ,GAAkBC,OAAlB,CAA0B,OAA1B,EAAmC,GAAnC,EAAwCA,OAAxC,CAAgD,MAAhD,EAAwDqG,OAAOC,YAAP,CAAoB,EAApB,CAAxD,EAAiFtG,OAAjF,CAAyF,MAAzF,EAAiGqG,OAAOC,YAAP,CAAoB,EAApB,CAAjG,EAA0HtG,OAA1H,CAAkI,IAAlI,EAAwIqG,OAAOC,YAAP,CAAoB,EAApB,CAAxI,EAAiKtG,OAAjK,CAAyK,OAAzK,EAAkLqG,OAAOC,YAAP,CAAoB,EAApB,CAAlL,EAA2MtG,OAA3M,CAAmN,MAAnN,EAA2NqG,OAAOC,YAAP,CAAoB,EAApB,CAA3N,CAAP;AACD,GA5CmB;;AA8CpBC,aAAW,mBAAS1D,OAAT,EAAkBhH,SAAlB,EAA4B2K,QAA5B,EAAsC;;AAE/C3D,cAAU,KAAKuD,UAAL,CAAgBvD,OAAhB,CAAV;;AAEA7M,YAAQwJ,WAAR,CAAoB2G,MAApB,CAA2BtD,OAA3B,IAAsC;;AAEpC4D,YAAM,KAF8B;;AAIpC5K,gBAAU,oBAAW;AACnBA,kBAASgH,OAAT;AACD;AANmC,KAAtC;;AASA,WAAO7M,QAAQwJ,WAAR,CAAoB2G,MAApB,CAA2BtD,OAA3B,CAAP;AAED,GA7DmB;;AA+DpB6D,UAAQ,gBAAS7D,OAAT,EAAkB8D,QAAlB,EAA4BC,MAA5B,EAAoCJ,QAApC,EAA8C;;AAEpD3D,cAAUA,QAAQ9C,WAAR,EAAV;;AAEA;AACA/J,YAAQwJ,WAAR,CAAoBmG,MAApB,CAA2B9C,OAA3B,IAAsC7M,QAAQwJ,WAAR,CAAoBmG,MAApB,CAA2B9C,OAA3B,KAAuC,EAA7E;;AAEA7M,YAAQwJ,WAAR,CAAoBmG,MAApB,CAA2B9C,OAA3B,EAAoCtF,IAApC,CAAyC;;AAEvCkJ,YAAME,QAFiC;;AAIvCE,UAAID;;AAJmC,KAAzC;AAQD,GA9EmB;;AAgFpBpL,QAAM,gBAAW;;AAEf,QAAIsL,QAAQ,KAAKzB,KAAjB;;AAEA0B,WAAOvR,WAAP,CAAmB,YAAW;;AAE5BQ,cAAQwI,IAAR,CAAaxI,QAAQwJ,WAAR,CAAoB2G,MAAjC,EAAyC,UAASa,EAAT,EAAaC,QAAb,EAAuB;;AAE9D,YAAIA,SAASR,IAAT,IAAiB,IAArB,EAA2B;;AAEzBQ,mBAASpL,QAAT;AAED;AAEF,OARD;AAUD,KAZD,EAYG,EAZH;;AAcAxB,aAAS6M,SAAT,GAAqB7M,SAAS8M,OAAT,GAAmB,UAASxO,CAAT,EAAY;;AAElDA,UAAIA,KAAKyO,KAAT,CAFkD,CAElC;;AAEhB,UAAIC,gBAAgB,SAAShB,OAAOC,YAAP,CAAoB3N,EAAE2O,OAAtB,CAA7B;AAAA,UAEEC,aAAavR,QAAQwJ,WAAR,CAAoB,QAApB,EAA8B6H,aAA9B,KAAgDrR,QAAQwJ,WAAR,CAAoB,QAApB,EAA8B6H,cAActH,WAAd,EAA9B,CAF/D;;AAIA,UAAIwH,UAAJ,EAAgB;AACdA,mBAAWd,IAAX,GAAkB9N,EAAEQ,IAAF,IAAU,SAA5B;AAED;AAEF,KAbD;;AAeA,QAAIqO,WAAWnN,SAASoN,gBAAT,CAA0B,mBAA1B,CAAf;;AAGA,aAASC,WAAT,CAAqB/O,CAArB,EAAwB/C,CAAxB,EAA2B;;AAEzB,UAAI2B,CAAJ;AACA,UAAI0B,CAAJ;AACA,UAAIN,EAAEgP,KAAF,IAAWhP,EAAEiP,KAAjB,EAAwB;AACtBrQ,YAAIoB,EAAEgP,KAAN;AACA1O,YAAIN,EAAEiP,KAAN;AACD,OAHD,MAGO;AACLrQ,YAAIoB,EAAEkP,OAAF,GAAYxN,SAASC,IAAT,CAAcwN,UAA1B,GAAuCzN,SAAS0N,eAAT,CAAyBD,UAApE;AACA7O,YAAIN,EAAEqP,OAAF,GAAY3N,SAASC,IAAT,CAAc2N,SAA1B,GAAsC5N,SAAS0N,eAAT,CAAyBE,SAAnE;AACD;AACD1Q,WAAK3B,EAAEsS,UAAP;AACAjP,WAAKrD,EAAEuS,KAAF,CAAQC,GAAb;AACA,aAAO;AACL7Q,WAAGA,CADE;AAEL0B,WAAGA;AAFE,OAAP;AAID;;AAED,QAAIuG,cAAcxJ,QAAQwJ,WAA1B;;AAEA,aAAS6I,WAAT,CAAqBjB,KAArB,EAA4BxR,CAA5B,EAA+B;;AAE7B,UAAI0S,MAAMZ,YAAYN,KAAZ,EAAmBxR,CAAnB,CAAV;;AAEAkR,YAAMtB,WAAN,CAAkB8C,IAAI/Q,CAAtB,EAAyB+Q,IAAIrP,CAA7B;;AAEA,UAAIuG,YAAYmG,MAAZ,CAAmB,WAAnB,CAAJ,EAAqC;AACnC3P,gBAAQwI,IAAR,CAAagB,YAAYmG,MAAZ,CAAmB,WAAnB,CAAb,EAA8C,UAAShL,EAAT,EAAa4N,EAAb,EAAiB;;AAE7DA,aAAG9B,IAAH,CAAQ6B,IAAI/Q,CAAZ,EAAe+Q,IAAIrP,CAAnB;AAED,SAJD;AAKD;AAEF;;AAED;AACAzD,gBAAY,YAAW;;AAErB,UAAIgK,YAAYmG,MAAZ,CAAmB,UAAnB,CAAJ,EAAoC;;AAElC,YAAI2C,MAAMxB,MAAMxB,QAAhB;;AAEAtP,gBAAQwI,IAAR,CAAagB,YAAYmG,MAAZ,CAAmB,UAAnB,CAAb,EAA6C,UAAShL,EAAT,EAAa4N,EAAb,EAAiB;;AAE5DA,aAAG9B,IAAH,CAAQ6B,IAAI/Q,CAAZ,EAAe+Q,IAAIrP,CAAnB;AAED,SAJD;AAKD;AAEF,KAbD,EAaG,EAbH;;AAgBA,SAAK,IAAI1B,IAAI,CAAb,EAAgBA,IAAIiQ,SAASjL,MAA7B,EAAqChF,GAArC,EAA0C;AAAA,UAG/BiR,cAH+B,GAGxC,SAASA,cAAT,CAAwB7P,CAAxB,EAA2B;AACzB0P,oBAAY1P,CAAZ,EAAe/C,CAAf;AACD,OALuC;;AACxC,UAAIA,IAAI4R,SAASjQ,CAAT,CAAR;;AAMA1B,cAAQY,IAAR,CAAa,0DAAb;;AAEA4D,eAASoO,gBAAT,CAA0B,WAA1B,EAAuCD,cAAvC;;AAEA5S,QAAE8S,WAAF,GAAgB,UAAS/P,CAAT,EAAY;AAC1B;;AAEA,YAAIgQ,QAAQhQ,EAAEiQ,KAAd;AACA,YAAIN,MAAMZ,YAAY/O,CAAZ,EAAe/C,CAAf,CAAV;AACA,YAAI4J,cAAcxJ,QAAQwJ,WAA1B;;AAEA7G,UAAEkQ,cAAF;;AAEA,gBAAQlQ,EAAEiQ,KAAV;AACE,eAAK,CAAL;;AAEE,iBAAK,IAAIrR,CAAT,IAAciI,YAAYmG,MAA1B,EAAkC;;AAEhC,kBAAInG,YAAYmG,MAAZ,CAAmBpO,CAAnB,aAAiCL,KAAjC,IAA0CK,KAAK,WAAnD,EAAgE;;AAE9DvB,wBAAQwI,IAAR,CAAagB,YAAYmG,MAAZ,CAAmBpO,CAAnB,CAAb,EAAoC,UAASoD,EAAT,EAAa4N,EAAb,EAAiB;;AAEnDA,qBAAG9B,IAAH,CAAQ6B,IAAI/Q,CAAZ,EAAe+Q,IAAIrP,CAAnB;AACD,iBAHD;AAID;AACF;;AAED;AACF,eAAK,CAAL;AACE;;AAEA,iBAAK,IAAI1B,CAAT,IAAcvB,QAAQwJ,WAAR,CAAoBmG,MAAlC,EAA0C;;AAExC,kBAAInG,YAAYmG,MAAZ,CAAmBpO,CAAnB,aAAiCL,KAAjC,IAA0CK,KAAK,aAAnD,EAAkE;;AAEhEvB,wBAAQwI,IAAR,CAAagB,YAAYmG,MAAZ,CAAmBpO,CAAnB,CAAb,EAAoC,UAASoD,EAAT,EAAa4N,EAAb,EAAiB;;AAEnDA,qBAAG9B,IAAH,CAAQ6B,IAAI/Q,CAAZ,EAAe+Q,IAAIrP,CAAnB;AACD,iBAHD;AAID;AACF;AACD;AACF,eAAK,CAAL;AACE;;;AAGA,iBAAK,IAAI1B,CAAT,IAAcvB,QAAQwJ,WAAR,CAAoBmG,MAAlC,EAA0C;;AAGxC,kBAAInG,YAAYmG,MAAZ,CAAmBpO,CAAnB,aAAiCL,KAAjC,IAA0CK,KAAK,YAAnD,EAAiE;;AAG/DvB,wBAAQwI,IAAR,CAAagB,YAAYmG,MAAZ,CAAmBpO,CAAnB,CAAb,EAAoC,UAASoD,EAAT,EAAa4N,EAAb,EAAiB;;AAEnDA,qBAAG9B,IAAH,CAAQ6B,IAAI/Q,CAAZ,EAAe+Q,IAAIrP,CAAnB;AACD,iBAHD;;AAKA,uBAAO,KAAP;AACD;AAGF;;AAED;AACF;;AAEE,mBAAO,CAAP;AACA;;AAtDJ;;AA2DAN,UAAEkQ,cAAF;AACA,eAAO,CAAP;AACD,OAtED;;AAwEAjT,QAAEkT,SAAF,GAAc,UAASnQ,CAAT,EAAY;;AAExB;;AAEA,YAAIgQ,QAAQhQ,EAAEiQ,KAAd;AACA,YAAIN,MAAMZ,YAAY/O,CAAZ,EAAe/C,CAAf,CAAV;AACA,YAAI4J,cAAcxJ,QAAQwJ,WAA1B;;AAGA7G,UAAEkQ,cAAF;;AAEA,gBAAQlQ,EAAEiQ,KAAV;AACE,eAAK,CAAL;;AAEE,iBAAK,IAAIrR,CAAT,IAAciI,YAAYmG,MAA1B,EAAkC;;AAGhC,kBAAInG,YAAYmG,MAAZ,CAAmBpO,CAAnB,aAAiCL,KAAjC,IAA0CK,KAAK,WAAnD,EAAgE;;AAG9DvB,wBAAQwI,IAAR,CAAagB,YAAYmG,MAAZ,CAAmBpO,CAAnB,CAAb,EAAoC,UAASoD,EAAT,EAAa4N,EAAb,EAAiB;;AAEnDA,qBAAG1B,EAAH,CAAMyB,IAAI/Q,CAAV,EAAa+Q,IAAIrP,CAAjB;AACD,iBAHD;AAID;AAGF;;AAED;AACF,eAAK,CAAL;AACE;;;AAGA,iBAAK,IAAI1B,CAAT,IAAcvB,QAAQwJ,WAAR,CAAoBmG,MAAlC,EAA0C;;AAGxC,kBAAInG,YAAYmG,MAAZ,CAAmBpO,CAAnB,aAAiCL,KAAjC,IAA0CK,KAAK,aAAnD,EAAkE;;AAGhEvB,wBAAQwI,IAAR,CAAagB,YAAYmG,MAAZ,CAAmBpO,CAAnB,CAAb,EAAoC,UAASoD,EAAT,EAAa4N,EAAb,EAAiB;;AAEnDA,qBAAG1B,EAAH,CAAMyB,IAAI/Q,CAAV,EAAa+Q,IAAIrP,CAAjB;AACD,iBAHD;AAID;AAGF;AACD;AACF,eAAK,CAAL;AACE;;;AAGA,iBAAK,IAAI1B,CAAT,IAAcvB,QAAQwJ,WAAR,CAAoBmG,MAAlC,EAA0C;;AAGxC,kBAAInG,YAAYmG,MAAZ,CAAmBpO,CAAnB,aAAiCL,KAAjC,IAA0CK,KAAK,YAAnD,EAAiE;;AAG/DvB,wBAAQwI,IAAR,CAAagB,YAAYmG,MAAZ,CAAmBpO,CAAnB,CAAb,EAAoC,UAASoD,EAAT,EAAa4N,EAAb,EAAiB;;AAEnDA,qBAAG1B,EAAH,CAAMyB,IAAI/Q,CAAV,EAAa+Q,IAAIrP,CAAjB;AACD,iBAHD;;AAMA,uBAAO,KAAP;AAED;AAGF;;AAED;AACF;;AAEE,mBAAO,CAAP;AACA;;AAjEJ;AAsED,OAjFD;AAkFD;AAGF;;AAlVmB,CAAtB;;AAuVA;;AAEAoB,SAASoO,gBAAT,CAA0B,kBAA1B,EAA8C,YAAW;;AAEvDzS,UAAQqJ,SAAR;AAED,CAJD;;AAMArJ,QAAQ+S,WAAR,GAAsB;;AAEpBC,mBAAiB,yBAASC,GAAT,EAAcC,OAAd,EAAuB;;AAEtCA,cAAUA,WAAW,KAArB;;AAEA,QAAIC,eAAeF,IAAI3H,OAAJ,CAAY,aAAZ,CAAnB;;AAEA,WAAO4H,UAAUD,IAAIhM,SAAJ,CAAckM,YAAd,EAA4BF,IAAI1M,MAAhC,CAAjB;AAED,GAVmB;;AAYpB6M,YAAU,kBAASC,QAAT,EAAmBxN,QAAnB,EAA6B;;AAErC,aAASyN,YAAT,CAAsBC,IAAtB,EAA4B1N,QAA5B,EAAsC;AACpC,UAAI2N,UAAU,IAAIC,cAAJ,EAAd;AACAD,cAAQE,IAAR,CAAa,KAAb,EAAoBH,IAApB,EAA0B,KAA1B;AACAC,cAAQG,kBAAR,GAA6B,YAAW;AACtC,YAAIH,QAAQI,UAAR,KAAuB,CAA3B,EAA8B;AAC5B,cAAIJ,QAAQK,MAAR,KAAmB,GAAnB,IAA0BL,QAAQK,MAAR,IAAkB,CAAhD,EAAmD;AACjDhO,qBAAS2N,QAAQM,YAAjB;AACD;AACF;AACF,OAND;AAOAN,cAAQO,IAAR,CAAa,IAAb;AACD;;AAEDT,iBAAa,aAAaD,QAA1B,EAAoCxN,QAApC;AAED,GA7BmB;;AA+BpBmO,aAAW,mBAASC,QAAT,EAAmB9N,EAAnB,EAAuBN,QAAvB,EAAiC;;AAE1C,QAAIqO,OAAO1I,KAAK2I,KAAL,CAAWF,QAAX,CAAX;;AAEA,QAAI,OAAO9N,EAAP,IAAc,UAAd,IAA4B,CAACA,EAAjC,EAAqC;AACnCN,iBAAWM,MAAMN,QAAN,IAAkB,YAAW,CAAE,CAA1C;;AAEAM,WAAKnG,QAAQ4E,YAAR,CAAqB,CAArB,CAAL;AACD;;AAEDwP,MAAE5L,IAAF,CAAO0L,KAAKxL,OAAZ,EAAqB,UAAS/D,EAAT,EAAa0P,KAAb,EAAoB;;AAEvC,UAAI,OAAOA,MAAMpB,GAAb,IAAqB,QAAzB,EAAmC;;AAEjCoB,cAAMpB,GAAN,GAAYjT,QAAQ+S,WAAR,CAAoBC,eAApB,CAAoCqB,MAAMpB,GAA1C,CAAZ;AACD;;AAED1K,wBAAkBC,IAAlB,CAAuB6L,KAAvB,EAA8B,UAASxG,EAAT,EAAayG,KAAb,EAAoB;;AAEhD,YAAIA,MAAMrB,GAAV,EAAe;;AAEbqB,gBAAMrB,GAAN,GAAYjT,QAAQ+S,WAAR,CAAoBC,eAApB,CAAoCsB,MAAMrB,GAA1C,CAAZ;AAED;;AAED1K,0BAAkBC,IAAlB,CAAuB8L,KAAvB,EAA8B,UAASC,EAAT,EAAaC,KAAb,EAAoB;;AAEhD,cAAIA,MAAMvB,GAAV,EAAe;AACbuB,kBAAMvB,GAAN,GAAYjT,QAAQ+S,WAAR,CAAoBC,eAApB,CAAoCwB,MAAMvB,GAA1C,CAAZ;AAED;AAGF,SARD;AAWD,OAnBD;;AAqBAoB,cAAQ,IAAIrU,QAAQ0F,MAAZ,CAAmB2O,KAAnB,CAAR;;AAEAlO,SAAGsO,GAAH,CAAOJ,KAAP;AACA;;;AAGA,UAAI1P,MAAMuP,KAAKxL,OAAL,CAAanC,MAAb,GAAsB,CAAhC,EAAmC;;AAEjC;;AAEAV,iBAAS,KAAT,EAAgBqO,IAAhB;AACD;AAEF,KAzCD;AA2CD,GApFmB;;AAsFpBQ,iBAAe,uBAASrB,QAAT,EAAmBlN,EAAnB,EAAuBN,QAAvB,EAAiC;;AAE9C,QAAI,OAAOM,EAAP,IAAc,UAAd,IAA4B,CAACA,EAAjC,EAAqC;AACnCN,iBAAWM,MAAMN,QAAN,IAAkB,YAAW,CAAE,CAA1C;;AAEAM,WAAKnG,QAAQ4E,YAAR,CAAqB,CAArB,CAAL;AACD;;AAED,SAAKwO,QAAL,CAAcC,QAAd,EAAwB,UAASa,IAAT,EAAe;;AAErC;;AAEAE,QAAE5L,IAAF,CAAO0L,KAAKxL,OAAZ,EAAqB,UAAS/D,EAAT,EAAa0P,KAAb,EAAoB;;AAEvC,YAAI,OAAOA,MAAMpB,GAAb,IAAqB,QAAzB,EAAmC;;AAEjCoB,gBAAMpB,GAAN,GAAYjT,QAAQ+S,WAAR,CAAoBC,eAApB,CAAoCqB,MAAMpB,GAA1C,CAAZ;AACD;;AAED1K,0BAAkBC,IAAlB,CAAuB6L,KAAvB,EAA8B,UAASxG,EAAT,EAAayG,KAAb,EAAoB;;AAEhD,cAAIA,MAAMrB,GAAV,EAAe;;AAEbqB,kBAAMrB,GAAN,GAAYjT,QAAQ+S,WAAR,CAAoBC,eAApB,CAAoCsB,MAAMrB,GAA1C,CAAZ;AAED;;AAED1K,4BAAkBC,IAAlB,CAAuB8L,KAAvB,EAA8B,UAASC,EAAT,EAAaC,KAAb,EAAoB;;AAEhD,gBAAIA,MAAMvB,GAAV,EAAe;AACbuB,oBAAMvB,GAAN,GAAYjT,QAAQ+S,WAAR,CAAoBC,eAApB,CAAoCwB,MAAMvB,GAA1C,CAAZ;AAED;AAGF,WARD;AAWD,SAnBD;;AAqBAoB,gBAAQ,IAAIrU,QAAQ0F,MAAZ,CAAmB2O,KAAnB,CAAR;;AAEAlO,WAAGsO,GAAH,CAAOJ,KAAP;AACA;;;AAGA,YAAI1P,MAAMuP,KAAKxL,OAAL,CAAanC,MAAb,GAAsB,CAAhC,EAAmC;;AAEjC;;AAEAV,mBAAS,KAAT,EAAgBqO,IAAhB;AACD;AAGF,OA1CD;AA6CD,KAjDD;AAmDD;;AAjJmB,CAAtB;;AAyJA;AACAlU,QAAQoT,QAAR,GAAmBpT,QAAQ+S,WAAR,CAAoBK,QAAvC;AACA;AACApT,QAAQ+S,WAAR,CAAoB4B,QAApB,GAA+B3U,QAAQ+S,WAAR,CAAoBK,QAAnD;AACApT,QAAQ2U,QAAR,GAAmB3U,QAAQoT,QAA3B;;AAIApT,QAAQmJ,KAAR,CAAc,UAASyL,GAAT,EAAc;;AAE1B5U,UAAQF,GAAR,CAAY,2BAAZ;AAED,CAJD;;AAOA;;AAEA,IAAI+U,SAAS;;AAEXC,QAAM,gBAAW;AACf,WAAO,IAAI9U,QAAQ+U,MAAZ,CAAmB/U,QAAQoE,KAA3B,EAAkCpE,QAAQwE,MAA1C,CAAP;AACD,GAJU;;AAMXwQ,UAAQ,kBAAW;AACjB,WAAO,IAAIhV,QAAQ+U,MAAZ,CAAmB/U,QAAQoE,KAAR,GAAgB,CAAnC,EAAsCpE,QAAQwE,MAAR,GAAiB,CAAvD,EAA0DyQ,KAA1D,EAAP;AACD;;AARU,CAAb;AAWA;AACA;;;;;;;AAQA,IAAIC,oBAAoB,EAAG;;AAEzBxP,UAAQ,CAAC,WAAD,EAAc,YAAd,CAFc;;AAItByP,aAAW,CAAC,QAAD,EAAW,aAAX,EAA0B,YAA1B,CAJW;;AAMtBC,UAAQ,CAAC,WAAD,EAAc,aAAd,EAA6B,YAA7B,CANc;;AAQtBC,QAAM,CAAC,UAAD,EAAa,YAAb,EAA2B,YAA3B,CARgB;;AAUtBC,WAAS,CAAC,YAAD,CAVa;;AAYtBC,eAAa,CAAC,YAAD,CAZS;;AActBC,UAAQ,CAAC,WAAD,CAdc;;AAgBtBlS,SAAO,eAASmS,QAAT,EAAmB;AACxB,SAAK,IAAIlU,CAAT,IAAc,IAAd,EAAoB;AAClB,UAAIA,KAAK,OAAT,EACE,SADF,KAEK;AACH,YAAI,KAAKA,CAAL,aAAmBL,KAAvB,EAA8B;AAC5B,eAAKK,CAAL,EAAQ6D,OAAR,CAAgB,UAASsQ,CAAT,EAAY;AAC1B,gBAAIC,OAAOD,EAAE1L,OAAF,CAAU,GAAV,EAAe,EAAf,CAAX;AACA,gBAAI,CAACyL,SAASvT,mBAAT,CAA6BoJ,OAA7B,CAAqCqK,IAArC,CAAD,IAA+C,CAAnD,EACE,MAAM,IAAIjT,KAAJ,CAAU,+CAA+CiT,IAAzD,CAAN;AAEH,WALD;AAMD;AACF;AACF;AACF;;AAGH;;;;;AAlCwB,CAAxB,CAuCA,IAAIC,mBAAmB,EAAE;;AAEvBlQ,UAAQ,CAAC,UAAD,EAAa,OAAb,CAFa;;AAIrBmQ,eAAY,CAAC,mBAAD,EAAsB,OAAtB,CAJS;;AAMrBC,eAAa,CAAC,UAAD,EAAa,OAAb,CANQ;;AAQrBC,SAAM,CAAC,UAAD,CARe;;AAUrBC,YAAS,CAAC,UAAD,CAVY;;AAYrBC,mBAAgB,CAAC,UAAD,CAZK;;AAcrBC,UAAO,CAAC,UAAD,CAdc;;AAgBrBf,aAAW,CAAC,WAAD,EAAc,cAAd,EAA8B,eAA9B,EAA+C,OAA/C,CAhBU;;AAkBrBgB,UAAO,CAAC,UAAD,EAAa,sBAAb,EAAqC,mBAArC,EAA2D,OAA3D,CAlBc;;AAoBrBC,QAAK,CAAC,UAAD,EAAa,OAAb,EAAsB,UAAtB;;AApBgB,CAAvB;;AAwBApW,QAAQ4V,gBAAR,GAA2BA,gBAA3B;;AAGA,IAAIS,WAAW;;AAEbC,kBAAgB,CAAC,WAAD,CAFH;;AAIbC,iBAAe,CAAC,UAAD,CAJF;;AAMbC,YAAU,CAAC,QAAD,CANG;;AAQbC,aAAW,CAAC,cAAD,CARE;;AAUbC,eAAa,CAAC,gBAAD,CAVA;;AAYbC,cAAY,CAAC,eAAD,CAZC;;AAcbC,cAAY,CAAC,eAAD;;AAdC,CAAf;;AAmBA,IAAIC,cAAc;;AAEhBnR,UAAQ,CAAC,MAAD,EAAS,UAAT,EAAqB,UAArB,CAFQ;;AAIhByP,aAAW,CAAC,aAAD,EAAgB,KAAhB;;AAJK,CAAlB;;AASA,IAAI2B,WAAW,SAAXA,QAAW,CAAS9N,IAAT,EAAe+N,IAAf,EAAqBC,MAArB,EAA6B;AAC1C,SAAO;AACLhO,cADK;AAEL+N,cAFK;AAGLC;AAHK,GAAP;AAKD,CAND;;AAQA,IAAIC,WAAW;;AAEbC,cAAY;AACV3B,iBAAa;;AAEXvM,YAAM,oBAFK;;AAIX+N,YAAM,iDAJK;;AAMXC,cAAQ;AANG;AADH,GAFC;;AAabG,iBAAe;;AAEb5B,iBAAa;AAFA;AAbF,CAAf;;AAqBA,IAAI6B,qBAAqB;;AAEvBC,cAAY,CAAC,OAAD;;AAFW,CAAzB;;AAOA,IAAIC,sBAAsB,SAAtBA,mBAAsB,GAAW,CAAE;;AAEtC,CAFD;;AAIA;;;;;;;;AAQA,IAAIC,kBAAkB;;AAEpB7R,UAAQ,CAAC,oBAAD,EAAuB,UAAvB,EAAmC,WAAnC,EAAgD,OAAhD;;AAFY,CAAtB;AAKA;AACA,CAAC,CAAC,YAAW;;AAEX;;;;;;;;AAFW,MAUL8R,MAVK;AAWT,oBAAYjW,CAAZ,EAAe0B,CAAf,EAAkBwU,CAAlB,EAAqB;AAAA;;AACnB,UAAI9Q,MAAMpF,CAAN,CAAJ,EAAc;AACZA,YAAI,CAAJ;AACD;;AAED,UAAIoF,MAAM1D,CAAN,CAAJ,EAAc;AACZA,YAAI,CAAJ;AACD;;AAED,UAAI0D,MAAM8Q,CAAN,CAAJ,EAAc;AACZA,YAAI,CAAJ;AACD;;AAEE;;;;;AAKH,WAAKC,QAAL,GAAgB,IAAI1X,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAAhB;;AAEA,WAAK/H,KAAL,GAAa,IAAI1P,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAb;AACD;;AAhCQ;AAAA;AAAA,+BAkCD;AACJ,aAAK2C,QAAL,CAAcnW,CAAd,IAAmB,KAAKmO,KAAL,CAAWnO,CAA9B;AACA,aAAKmW,QAAL,CAAczU,CAAd,IAAmB,KAAKyM,KAAL,CAAWzM,CAA9B;AACH;AArCQ;;AAAA;AAAA;;AAyCXjD,UAAQwX,MAAR,GAAiBA,MAAjB;AAED,CA3CA;AA4CD;AACA;AACA1Q,KAAK6Q,OAAL,GAAe,UAASC,OAAT,EAAkB;AAC/B,SAAOA,UAAU9Q,KAAK+Q,EAAf,GAAoB,GAA3B;AACD,CAFD;;AAIA;AACA/Q,KAAK8Q,OAAL,GAAe,UAASD,OAAT,EAAkB;AAC/B,SAAOA,UAAU,GAAV,GAAgB7Q,KAAK+Q,EAA5B;AACD,CAFD;;IAIM3B,M;AACN,kBAAY4B,MAAZ,EAAmB;AAAA;;AACnB,SAAKA,MAAL,GAAcA,MAAd;AACC;;;;2BACMC,C,EACP;AACE,WAAKD,MAAL,GAAcC,CAAd;AACA,aAAO,IAAP;AACD;;;iDAC4BC,K,EAAM;AACjC,UAAGrR,MAAMqR,KAAN,CAAH,EACA,OAAOnY,QAAQQ,KAAR,CAAc,sCAAd,CAAP;AACA,UAAI4X,SAAS,EAAb;AAAA,UAAiBH,SAAS,KAAKA,MAA/B;AACA,aAAOE,KAAP,EAAc;AACV,YAAIE,WAAWpR,KAAKC,MAAL,KAAgB,CAAhB,GAAoBD,KAAK+Q,EAAxC;AACA,YAAIzV,IAAI,IAAIpC,QAAQ+U,MAAZ,CAAmBjO,KAAKqR,GAAL,CAASD,QAAT,IAAmB,KAAKJ,MAA3C,EAAmDhR,KAAKsR,GAAL,CAASF,QAAT,IAAoB,KAAKJ,MAA5E,CAAR;AACA1V,UAAE2V,CAAF,GAAMG,WAAW,GAAX,GAAiBpR,KAAK+Q,EAA5B;AACAI,eAAO1Q,IAAP,CAAYnF,CAAZ;AACA4V;AACH;AACD,aAAOC,MAAP;AACD;;;sCACyB;AAAA,UAAVD,KAAU,uEAAJ,GAAI;;AACxB,UAAGrR,MAAMqR,KAAN,CAAH,EACA,OAAOnY,QAAQQ,KAAR,CAAc,sCAAd,CAAP;AACA,UAAI4X,SAAS,EAAb;AAAA,UAAiBH,SAAS,KAAKA,MAA/B;AACA,aAAOE,KAAP,EAAc;AACV,YAAIE,WAAWpR,KAAKC,MAAL,KAAgB,CAAhB,GAAoBD,KAAK+Q,EAAxC;AACA,YAAIQ,eAAevR,KAAKC,MAAL,KAAgB+Q,MAAhB,GAAyBA,MAA5C;AACA,YAAIvW,IAAIuF,KAAKwR,IAAL,CAAUD,YAAV,IAA0BvR,KAAKqR,GAAL,CAASD,QAAT,CAAlC;AACA,YAAIjV,IAAI6D,KAAKwR,IAAL,CAAUD,YAAV,IAA0BvR,KAAKsR,GAAL,CAASF,QAAT,CAAlC;AACAD,eAAO1Q,IAAP,CAAY,IAAIvH,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,CAAZ;AACA+U;AACH;AACD,aAAOC,MAAP;AACD;;;0CAEqBF,C,EACtB;AACE,UAAIG,WAAWpR,KAAK6Q,OAAL,CAAaI,CAAb,CAAf;AACA,UAAI3V,IAAI,IAAIpC,QAAQ+U,MAAZ,CAAmBjO,KAAKqR,GAAL,CAASD,QAAT,IAAmB,KAAKJ,MAA3C,EAAmDhR,KAAKsR,GAAL,CAASF,QAAT,IAAoB,KAAKJ,MAA5E,CAAR;AACA,aAAO1V,CAAP;AACD;;;;;;AAMDpC,QAAQkW,MAAR,GAAiBA,MAAjB;AACA;;AAIA,IAAIqC,YAAY;AAEdC,YAFc,sBAEHC,IAFG,EAEGC,KAFH,EAEUC,IAFV,EAEgBC,KAFhB,EAEuB;AACnC,WAAOH,KAAKlX,CAAL,IAAUoX,KAAKpX,CAAL,GAASmX,MAAMnX,CAAzB,IACLkX,KAAKlX,CAAL,IAAUoX,KAAKpX,CAAL,GAASqX,MAAMrX,CADpB,IAELkX,KAAKxV,CAAL,IAAU0V,KAAK1V,CAAL,GAASyV,MAAMzV,CAFpB,IAGLwV,KAAKxV,CAAL,IAAU0V,KAAK1V,CAAL,GAAS2V,MAAM3V,CAH3B;AAID,GAPa;AASd4V,oBATc,8BASKC,IATL,EASWC,IATX,EASiB5S,EATjB,EASoB;;AAEhCA,SAAKA,MAAMnG,QAAQ4E,YAAR,CAAqB,CAArB,CAAX;AACA,QAAIoU,QAAQ7S,GAAG6S,KAAH,IAAY,GAAxB;AACA,QAAIC,SAAS,IAAIjZ,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAb;AACA+D,SAAKxL,OAAL,GAAewL,KAAKxL,OAAL,IAAgB,IAAItN,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAA/B;;AAEA,QAAImE,IAAI,SAAJA,CAAI,CAASvG,KAAT,EAAe;AAAE,aAAOA,QAAQqG,KAAf;AAAuB,KAAhD;;AAEA,QAAIG,WAAWrS,KAAKmO,KAAL,CAAW6D,KAAKxL,OAAL,CAAa/L,CAAb,GAAiB2X,EAAEJ,KAAKhE,IAAL,CAAUvT,CAAZ,CAA5B,CAAf;AAAA,QACE6X,WAAWtS,KAAKmO,KAAL,CAAW6D,KAAKxL,OAAL,CAAarK,CAAb,GAAiBiW,EAAEJ,KAAKhE,IAAL,CAAU7R,CAAZ,CAA5B,CADb;AAAA,QAEEoW,OAAOH,EAAEJ,KAAKpB,QAAL,CAAcnW,CAAhB,IAAqB4X,QAArB,GAAgCF,OAAO1X,CAFhD;AAAA,QAGE+X,QAAQJ,EAAEJ,KAAKpB,QAAL,CAAcnW,CAAhB,IAAqB2X,EAAEJ,KAAKhE,IAAL,CAAUvT,CAAZ,CAArB,GAAsC4X,QAAtC,GAAiDF,OAAO1X,CAHlE;AAAA,QAIE6Q,MAAM8G,EAAEJ,KAAKpB,QAAL,CAAczU,CAAhB,IAAqBgW,OAAOhW,CAA5B,GAAgCmW,QAJxC;AAAA,QAKEG,SAASL,EAAEJ,KAAKpB,QAAL,CAAczU,CAAhB,IAAqBiW,EAAEJ,KAAKhE,IAAL,CAAU7R,CAAZ,CAArB,GAAsCmW,QAAtC,GAAiDH,OAAOhW,CALnE;AAMA,QAAIqW,QAAQP,KAAKrB,QAAL,CAAcnW,CAAtB,IAA2B8X,OAAON,KAAKrB,QAAL,CAAcnW,CAAd,GAAkBwX,KAAKjE,IAAL,CAAUvT,CAA9D,IACFgY,SAASR,KAAKrB,QAAL,CAAczU,CADrB,IAC0BmP,MAAM2G,KAAKrB,QAAL,CAAczU,CAAd,GAAkB8V,KAAKjE,IAAL,CAAU7R,CADhE,EACmE;AACjE,aAAO,IAAP;AACD;AAEF,GA7Ba;AA+BduW,eA/Bc,yBA+BAV,IA/BA,EA+BMC,IA/BN,EA+BY5S,EA/BZ,EA+BgB;AAC5BA,SAAKA,MAAMnG,QAAQ4E,YAAR,CAAqB,CAArB,CAAX;AACA,QAAIoU,QAAQ7S,GAAG6S,KAAH,IAAY,GAAxB;AACA,QAAIC,SAAS,IAAIjZ,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAb;AACA+D,SAAKxL,OAAL,GAAewL,KAAKxL,OAAL,IAAgB,IAAItN,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAA/B;;AAEA,QAAImE,IAAI,SAAJA,CAAI,CAASvG,KAAT,EAAe;AAAE,aAAOA,QAAQqG,KAAf;AAAuB,KAAhD;;AAEA,QAAIG,WAAWrS,KAAKmO,KAAL,CAAW6D,KAAKxL,OAAL,CAAa/L,CAAb,GAAiB2X,EAAEJ,KAAKhE,IAAL,CAAUvT,CAAZ,CAA5B,CAAf;AAAA,QACE6X,WAAWtS,KAAKmO,KAAL,CAAW6D,KAAKxL,OAAL,CAAarK,CAAb,GAAiBiW,EAAEJ,KAAKhE,IAAL,CAAU7R,CAAZ,CAA5B,CADb;AAAA,QAEEoW,OAAOH,EAAEJ,KAAKpB,QAAL,CAAcnW,CAAhB,IAAqB4X,QAArB,GAAgCF,OAAO1X,CAFhD;AAAA,QAGE+X,QAAQJ,EAAEJ,KAAKpB,QAAL,CAAcnW,CAAhB,IAAqB2X,EAAEJ,KAAKhE,IAAL,CAAUvT,CAAZ,CAArB,GAAsC4X,QAAtC,GAAiDF,OAAO1X,CAHlE;AAAA,QAIE6Q,MAAM8G,EAAEJ,KAAKpB,QAAL,CAAczU,CAAhB,IAAqBgW,OAAOhW,CAA5B,GAAgCmW,QAJxC;AAAA,QAKEG,SAASL,EAAEJ,KAAKpB,QAAL,CAAczU,CAAhB,IAAqBiW,EAAEJ,KAAKhE,IAAL,CAAU7R,CAAZ,CAArB,GAAsCmW,QAAtC,GAAiDH,OAAOhW,CALnE;AAMA,QAAIqW,QAAQJ,EAAEH,KAAKrB,QAAL,CAAcnW,CAAhB,CAAR,IAA8B8X,OAAOH,EAAEH,KAAKrB,QAAL,CAAcnW,CAAhB,IAAqB2X,EAAEH,KAAKjE,IAAL,CAAUvT,CAAZ,CAA1D,IACFgY,SAASL,EAAEH,KAAKrB,QAAL,CAAczU,CAAhB,CADP,IAC6BmP,MAAM8G,EAAEH,KAAKrB,QAAL,CAAczU,CAAhB,IAAqBiW,EAAEH,KAAKjE,IAAL,CAAU7R,CAAZ,CAD5D,EAC4E;AAC1E,aAAO,IAAP;AACD;AACF,GAjDa;;;AAoDd;AACAwW,oBArDc,8BAqDKX,IArDL,EAqDWC,IArDX,EAqDiB5S,EArDjB,EAqDqB;;AAE3B,QAAIuT,aAAa,EAAjB;AAAA,QACIC,WAAWb,gBAAgB5X,KAAhB,GAAwB4X,IAAxB,GAA+B,CAACA,IAAD,CAD9C;AAAA,QAEIc,WAAWb,gBAAgB7X,KAAhB,GAAwB6X,IAAxB,GAA+B,CAACA,IAAD,CAF9C;;AAIA,SAAI,IAAIxX,IAAK,CAAb,EAAgBA,IAAIoY,SAASpT,MAA7B,EAAqChF,GAArC,EACA;AACE,WAAI,IAAI0B,IAAK,CAAb,EAAgBA,IAAI2W,SAASrT,MAA7B,EAAqCtD,GAArC,EACA;AACE,YAAG,KAAKuW,aAAL,CAAmBG,SAASpY,CAAT,CAAnB,EAAgCqY,SAAS3W,CAAT,CAAhC,CAAH,EACA;AACEyW,qBAAWnS,IAAX,CAAgB,EAAChE,QAAOoW,SAASpY,CAAT,CAAR,EAAqBsY,UAASD,SAAS3W,CAAT,CAA9B,EAAhB;AACD;AACF;AACF;;AAED,WAAOyW,UAAP;AACH,GAvES;AAyEdI,kBAzEc,4BAyEGhB,IAzEH,EAyESC,IAzET,EAyEe5S,EAzEf,EAyEmB;AAC/BA,SAAKA,MAAMnG,QAAQ4E,YAAR,CAAqB,CAArB,CAAX;;AAEA,QAAIqU,SAAS,IAAIjZ,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAb;;AAEA+D,SAAKxL,OAAL,GAAewL,KAAKxL,OAAL,IAAgB,IAAItN,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAA/B;;AAEA,QAAIoE,WAAWrS,KAAKmO,KAAL,CAAW6D,KAAKxL,OAAL,CAAa/L,CAAb,GAAiBuX,KAAKhE,IAAL,CAAUvT,CAAtC,CAAf;AAAA,QAEE6X,WAAWtS,KAAKmO,KAAL,CAAW6D,KAAKxL,OAAL,CAAarK,CAAb,GAAiB6V,KAAKhE,IAAL,CAAU7R,CAAtC,CAFb;AAAA,QAGEoW,OAAOP,KAAKpB,QAAL,CAAcnW,CAAd,GAAkB4X,QAAlB,GAA6BF,OAAO1X,CAH7C;AAAA,QAKE+X,QAAQR,KAAKpB,QAAL,CAAcnW,CAAd,GAAkBuX,KAAKhE,IAAL,CAAUvT,CAA5B,GAAgC4X,QAAhC,GAA2CF,OAAO1X,CAL5D;AAAA,QAOE6Q,MAAM0G,KAAKpB,QAAL,CAAczU,CAAd,GAAkBgW,OAAOhW,CAAzB,GAA6BmW,QAPrC;AAAA,QAQEG,SAAST,KAAKpB,QAAL,CAAczU,CAAd,GAAkB6V,KAAKhE,IAAL,CAAU7R,CAA5B,GAAgCmW,QAAhC,GAA2CH,OAAOhW,CAR7D;;AAUA,QAAIqW,QAAQP,KAAKrB,QAAL,CAAcnW,CAAtB,IAA2B8X,OAAON,KAAKrB,QAAL,CAAcnW,CAAd,GAAkBwX,KAAKjE,IAAL,CAAUvT,CAA9D,IACFgY,SAASR,KAAKrB,QAAL,CAAczU,CADrB,IAC0BmP,MAAM2G,KAAKrB,QAAL,CAAczU,CAAd,GAAkB8V,KAAKjE,IAAL,CAAU7R,CADhE,EAEE;;AAEA,aAAO,IAAP;AAED;AAEF,GAlGa;;;AAoGd;;;;;;AAMA8W,cA1Gc,wBA0GDC,YA1GC,EA0GaC,YA1Gb,EA0G2B9T,EA1G3B,EA0G+B;AAC3CA,SAAKA,MAAMnG,QAAQ4E,YAAR,CAAqB,CAArB,CAAX;;AAEA,QAAIqU,SAAS,IAAIjZ,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAb;;AAEA;AACA,aAASmF,MAAT,CAAgBC,MAAhB,EAAwBC,MAAxB,EAAgC;AAC9B;AACA,aAAO,EACHD,OAAOlX,CAAP,GAAWkX,OAAOE,MAAnB,GAA8BD,OAAOnX,CAAtC,IACCkX,OAAOlX,CAAP,GAAYmX,OAAOnX,CAAP,GAAWmX,OAAOC,MAD/B,IAEEF,OAAO5Y,CAAP,GAAW4Y,OAAOG,KAAnB,GAA4BF,OAAO7Y,CAFpC,IAGC4Y,OAAO5Y,CAAP,GAAY6Y,OAAO7Y,CAAP,GAAW6Y,OAAOE,KAJ1B,CAAP;AAMD;;AAED,QAAIH,SAAS;;AAETzC,gBAAUsC,aAAatC,QAFd;;AAIT6C,gBAAUP,aAAaQ,kBAAb,CAAgCD;;AAJjC,KAAb;AAAA,QAQEH,SAAS;;AAEP1C,gBAAUuC,aAAavC,QAFhB;;AAIP6C,gBAAUN,aAAaO,kBAAb,CAAgCD;;AAJnC,KARX;;AAgBA;AACA,SAAK,IAAI3O,IAAI,CAAb,EAAgBA,IAAIuO,OAAOI,QAAP,CAAgBhU,MAApC,EAA4CqF,GAA5C,EAAiD;AAC/C,UAAI6O,cAAcN,OAAOI,QAAP,CAAgB3O,CAAhB,CAAlB;AACA;AACA,UAAI8O,aAAa;AACfnZ,WAAGkZ,YAAYlZ,CAAZ,GAAgByY,aAAatC,QAAb,CAAsBnW,CAD1B;AAEf0B,WAAGwX,YAAYxX,CAAZ,GAAgB+W,aAAatC,QAAb,CAAsBzU,CAF1B;AAGfqX,eAAO,CAHQ;AAIfD,gBAAQ;AAJO,OAAjB;;AAOA,UAAIM,YAAJ;;AAEA;AACA,WAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIR,OAAOG,QAAP,CAAgBhU,MAApC,EAA4CqU,GAA5C,EAAiD;AAC/C,YAAIC,cAAcT,OAAOG,QAAP,CAAgBK,CAAhB,CAAlB;AACA;AACA,YAAIE,aAAa;AACfvZ,aAAGsZ,YAAYtZ,CAAZ,GAAgB0Y,aAAavC,QAAb,CAAsBnW,CAD1B;AAEf0B,aAAG4X,YAAY5X,CAAZ,GAAgBgX,aAAavC,QAAb,CAAsBzU,CAF1B;AAGfqX,iBAAO,CAHQ;AAIfD,kBAAQ;AAJO,SAAjB;;AAOA;AACA,YAAIH,OAAOQ,UAAP,EAAmBI,UAAnB,CAAJ,EAAoC;AAClC,iBAAO,IAAP;AACD;AACF;AACF;AACF;AAxKa,CAAhB;;AA4KA9a,QAAQuY,SAAR,GAAoBA,SAApB;AACA;AACA;;IACMwC,Q;AACJ,sBAAwC;AAAA,QAA5BhD,CAA4B,uEAAxB,CAAwB;AAAA,QAArBiD,CAAqB,uEAAjB,CAAiB;AAAA,QAAdrb,CAAc,uEAAV,CAAU;AAAA,QAAPD,CAAO,uEAAH,CAAG;;AAAA;;AACtC,SAAKqY,CAAL,GAASA,CAAT;AACA,SAAKiD,CAAL,GAASA,CAAT;AACA,SAAKrb,CAAL,GAASA,CAAT;AACA,SAAKD,CAAL,GAASA,CAAT;AACD;;AAED;;;;;+BACWoK,G,EAAK;AACd,UAAGA,IAAIwB,OAAJ,CAAY,GAAZ,KAAoB,CAAvB,EAA0B;AAC1B;AACExB,gBAAM9J,QAAQib,SAAR,CAAkBC,SAAlB,CAA4BpR,GAA5B,CAAN;AACD;;AAEDA,YAAMA,IAAIE,OAAJ,CAAY,aAAZ,EAA2B,EAA3B,CAAN;AACAF,YAAMA,IAAIC,WAAJ,EAAN;AACA,UAAIoR,aAAarR,GAAb,CAAJ,EAAuBA,MAAMqR,aAAarR,GAAb,CAAN;;AAEvB,UAAIsR,KAAJ;AACA;AACA,UAAKA,QAAQtR,IAAIsR,KAAJ,CAAU,MAAV,CAAb,EAAiC;;AAE/B,eAAO,IAAIpb,QAAQ+a,QAAZ,CACLM,SAASD,MAAM,CAAN,CAAT,EAAmB,EAAnB,CADK,EAELC,SAASD,MAAM,CAAN,CAAT,EAAmB,EAAnB,CAFK,EAGLC,SAASD,MAAM,CAAN,CAAT,EAAmB,EAAnB,CAHK,EAIL,GAJK,CAAP;AAMD;AACF;;AAED;;;;6BACSlH,I,EAAM;AACb,aAAO,IAAIlU,QAAQ+a,QAAZ,CACLM,SAASnH,KAAK,CAAL,CAAT,EAAkB,EAAlB,CADK,EAELmH,SAASnH,KAAK,CAAL,CAAT,EAAkB,EAAlB,CAFK,EAGLmH,SAASnH,KAAK,CAAL,CAAT,EAAkB,EAAlB,CAHK,EAIL,GAJK,CAAP;AAOD;;AAED;;;;6BACSoH,K,EAAO;AACd,UAAIC,eAAe,CAAnB;AACAA,sBAAgBzU,KAAK0U,GAAL,CAAS,KAAKzD,CAAL,GAASuD,MAAMvD,CAAxB,EAA2B,CAA3B,CAAhB;AACAwD,sBAAgBzU,KAAK0U,GAAL,CAAS,KAAKR,CAAL,GAASM,MAAMN,CAAxB,EAA2B,CAA3B,CAAhB;AACAO,sBAAgBzU,KAAK0U,GAAL,CAAS,KAAK7b,CAAL,GAAS2b,MAAM3b,CAAxB,EAA2B,CAA3B,CAAhB;AACA,aAAOmH,KAAKwR,IAAL,CAAUiD,YAAV,CAAP;AACD;;AAED;;;;uCACmBD,K,EAAOG,S,EAAW;;AAEnC,UAAIC,UAAU;AACZ3D,WAAGuD,MAAMvD,CADG;AAEZiD,WAAGM,MAAMN,CAFG;AAGZrb,WAAG2b,MAAM3b;AAHG,OAAd;;AAMA,UAAIgc,aAAa,CAAjB;;AAEA,WAAK,IAAIpa,CAAT,IAAcma,OAAd,EAAuB;AACrB,YAAIE,OAAO9U,KAAK+U,GAAL,CAASP,MAAM/Z,CAAN,IAAW,KAAKA,CAAL,CAApB,CAAX;;AAEA;;AAEAoa,sBAAcC,IAAd;AACD;;AAED,aAAOD,cAAcF,SAArB;AAED;;;;;;AAEF;;AAGDzb,QAAQ+a,QAAR,GAAmBA,QAAnB;;AAEA;AACA/a,QAAQ8b,eAAR,GAA0B;AAExBC,eAFwB,yBAEVC,GAFU,EAEL;AACnB,QAAIC,SAAS,4CAA4CC,IAA5C,CAAiDF,GAAjD,CAAb;AACA,WAAOC,SAAS,CACdZ,SAASY,OAAO,CAAP,CAAT,EAAoB,EAApB,CADc,EAEdZ,SAASY,OAAO,CAAP,CAAT,EAAoB,EAApB,CAFc,EAGdZ,SAASY,OAAO,CAAP,CAAT,EAAoB,EAApB,CAHc,CAAT,GAIH,IAJJ;AAKC,GATuB;;;AAWxBE,iBAAe,uBAASC,WAAT,EAAsB;AACnC,WAAO,IAAIpc,QAAQ+a,QAAZ,CAAqBqB,WAArB,CAAP;AACD,GAbuB;;AAexBlB,aAAW,mBAASc,GAAT,EAAc;AACvB,QAAIpc,CAAJ;AACA,QAAI,2BAA2BwP,IAA3B,CAAgC4M,GAAhC,CAAJ,EAA0C;AACxCpc,UAAIoc,IAAI/U,SAAJ,CAAc,CAAd,EAAiBuF,KAAjB,CAAuB,EAAvB,CAAJ;AACA,UAAI5M,EAAE2G,MAAF,IAAY,CAAhB,EAAmB;AACjB3G,YAAI,CAACA,EAAE,CAAF,CAAD,EAAOA,EAAE,CAAF,CAAP,EAAaA,EAAE,CAAF,CAAb,EAAmBA,EAAE,CAAF,CAAnB,EAAyBA,EAAE,CAAF,CAAzB,EAA+BA,EAAE,CAAF,CAA/B,CAAJ;AACD;AACDA,UAAI,OAAOA,EAAEyc,IAAF,CAAO,EAAP,CAAX;AACA,aAAO,UAAU,CAAEzc,KAAK,EAAN,GAAY,GAAb,EAAmBA,KAAK,CAAN,GAAW,GAA7B,EAAkCA,IAAI,GAAtC,EAA2Cyc,IAA3C,CAAgD,GAAhD,CAAV,GAAiE,KAAxE;AACD;AACD,UAAM,IAAI3Z,KAAJ,CAAU,SAAV,CAAN;AACD,GA1BuB;;AA4BxB4Z,qBAAkB,2BAASC,UAAT,EAAqBC,UAArB,EAAiCC,UAAjC,EAA4C;;AAE5D;AACA;;AAEA,QAAIC,SAAS,KAAKX,aAAL,CAAmBQ,UAAnB,CAAb;AAAA,QACAI,SAAS,KAAKZ,aAAL,CAAmBS,UAAnB,CADT;;AAIA,QAAII,YAAU;AACZ,SAAEF,OAAO,CAAP,IAAa,CAACA,OAAO,CAAP,IAAYC,OAAO,CAAP,CAAb,IAA0BF,UAA1B,GAAuC,CAAC,GAD3C;AAEZ,SAAEC,OAAO,CAAP,IAAa,CAACA,OAAO,CAAP,IAAYC,OAAO,CAAP,CAAb,IAA0BF,UAA1B,GAAuC,CAAC,GAF3C;AAGZ,SAAEC,OAAO,CAAP,IAAa,CAACA,OAAO,CAAP,IAAYC,OAAO,CAAP,CAAb,IAA0BF,UAA1B,GAAuC,CAAC,GAH3C;AAIZ,SAAE;AAJU,KAAd;;AAOA;AACA,KAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAUrX,OAAV,CAAkB,UAAS7D,CAAT,EAAW;AAC3B,UAAGqb,UAAUrb,CAAV,KAAgB,GAAnB,EACA;AACEqb,kBAAUrb,CAAV,IAAe,GAAf;AACD;AACDqb,gBAAUrb,CAAV,IAAeuF,KAAKmO,KAAL,CAAW2H,UAAUrb,CAAV,CAAX,CAAf;AACD,KAND;;AAQA,WAAO,UAASqb,UAAU,CAAV,CAAT,GAAyB,GAAzB,GAA+BA,UAAU,CAAV,CAA/B,GAA8C,GAA9C,GAAoDA,UAAU,CAAV,CAApD,GAAmE,QAA1E;AACD;;AAtDuB,CAA1B;;AA0DA;AACA,IAAIzB,eAAe;AACjB0B,aAAW,oBADM;AAEjBC,gBAAc,oBAFG;AAGjBC,QAAM,kBAHW;AAIjBC,cAAY,oBAJK;AAKjBC,SAAO,oBALU;AAMjBC,SAAO,oBANU;AAOjBC,UAAQ,oBAPS;AAQjBC,SAAO,cARU;AASjBC,kBAAgB,oBATC;AAUjBC,QAAM,gBAVW;AAWjBC,cAAY,mBAXK;AAYjBC,SAAO,kBAZU;AAajBC,aAAW,oBAbM;AAcjBC,aAAW,mBAdM;AAejBC,cAAY,kBAfK;AAgBjBC,aAAW,mBAhBM;AAiBjBC,SAAO,mBAjBU;AAkBjBC,kBAAgB,oBAlBC;AAmBjBC,YAAU,oBAnBO;AAoBjBC,WAAS,kBApBQ;AAqBjBC,QAAM,kBArBW;AAsBjBC,YAAU,gBAtBO;AAuBjBC,YAAU,kBAvBO;AAwBjBC,iBAAe,mBAxBE;AAyBjBC,YAAU,oBAzBO;AA0BjBC,aAAW,gBA1BM;AA2BjBC,YAAU,oBA3BO;AA4BjBC,aAAW,oBA5BM;AA6BjBC,eAAa,kBA7BI;AA8BjBC,kBAAgB,kBA9BC;AA+BjBC,cAAY,kBA/BK;AAgCjBC,cAAY,mBAhCK;AAiCjBC,WAAS,gBAjCQ;AAkCjBC,cAAY,oBAlCK;AAmCjBC,gBAAc,oBAnCG;AAoCjBC,iBAAe,kBApCE;AAqCjBC,iBAAe,iBArCE;AAsCjBC,iBAAe,iBAtCE;AAuCjBC,iBAAe,kBAvCE;AAwCjBC,cAAY,kBAxCK;AAyCjBC,YAAU,mBAzCO;AA0CjBC,eAAa,kBA1CI;AA2CjBC,WAAS,oBA3CQ;AA4CjBC,WAAS,oBA5CQ;AA6CjBC,cAAY,mBA7CK;AA8CjBC,aAAW,kBA9CM;AA+CjBC,eAAa,oBA/CI;AAgDjBC,eAAa,kBAhDI;AAiDjBC,WAAS,kBAjDQ;AAkDjBC,aAAW,oBAlDM;AAmDjBC,cAAY,oBAnDK;AAoDjBC,QAAM,kBApDW;AAqDjBC,aAAW,mBArDM;AAsDjBC,QAAM,oBAtDW;AAuDjBC,SAAO,gBAvDU;AAwDjBC,eAAa,mBAxDI;AAyDjBC,QAAM,oBAzDW;AA0DjBC,YAAU,oBA1DO;AA2DjBC,WAAS,oBA3DQ;AA4DjBC,aAAW,kBA5DM;AA6DjBC,UAAQ,iBA7DS;AA8DjBC,SAAO,oBA9DU;AA+DjBC,SAAO,oBA/DU;AAgEjBC,YAAU,oBAhEO;AAiEjBC,iBAAe,oBAjEE;AAkEjBC,aAAW,kBAlEM;AAmEjBC,gBAAc,oBAnEG;AAoEjBC,aAAW,oBApEM;AAqEjBC,cAAY,oBArEK;AAsEjBC,aAAW,oBAtEM;AAuEjBC,wBAAsB,oBAvEL;AAwEjBC,aAAW,oBAxEM;AAyEjBC,cAAY,oBAzEK;AA0EjBC,aAAW,oBA1EM;AA2EjBC,aAAW,oBA3EM;AA4EjBC,eAAa,oBA5EI;AA6EjBC,iBAAe,mBA7EE;AA8EjBC,gBAAc,oBA9EG;AA+EjBC,kBAAgB,oBA/EC;AAgFjBC,kBAAgB,oBAhFC;AAiFjBC,kBAAgB,oBAjFC;AAkFjBC,eAAa,oBAlFI;AAmFjBC,QAAM,gBAnFW;AAoFjBC,aAAW,kBApFM;AAqFjBC,SAAO,oBArFU;AAsFjBC,WAAS,kBAtFQ;AAuFjBC,UAAQ,gBAvFS;AAwFjBC,oBAAkB,oBAxFD;AAyFjBC,cAAY,gBAzFK;AA0FjBC,gBAAc,mBA1FG;AA2FjBC,gBAAc,oBA3FG;AA4FjBC,kBAAgB,mBA5FC;AA6FjBC,mBAAiB,oBA7FA;AA8FjBC,qBAAmB,kBA9FF;AA+FjBC,mBAAiB,mBA/FA;AAgGjBC,mBAAiB,mBAhGA;AAiGjBC,gBAAc,kBAjGG;AAkGjBC,aAAW,oBAlGM;AAmGjBC,aAAW,oBAnGM;AAoGjBC,YAAU,oBApGO;AAqGjBC,eAAa,oBArGI;AAsGjBC,QAAM,gBAtGW;AAuGjBC,WAAS,oBAvGQ;AAwGjBC,SAAO,kBAxGU;AAyGjBC,aAAW,mBAzGM;AA0GjBC,UAAQ,kBA1GS;AA2GjBC,aAAW,iBA3GM;AA4GjBC,UAAQ,oBA5GS;AA6GjBC,iBAAe,oBA7GE;AA8GjBC,aAAW,oBA9GM;AA+GjBC,iBAAe,oBA/GE;AAgHjBC,iBAAe,oBAhHE;AAiHjBC,cAAY,oBAjHK;AAkHjBC,aAAW,oBAlHM;AAmHjBC,QAAM,mBAnHW;AAoHjBC,QAAM,oBApHW;AAqHjBC,QAAM,oBArHW;AAsHjBC,cAAY,oBAtHK;AAuHjBC,UAAQ,kBAvHS;AAwHjBC,OAAK,gBAxHY;AAyHjBC,aAAW,oBAzHM;AA0HjBC,aAAW,mBA1HM;AA2HjBC,eAAa,kBA3HI;AA4HjBC,UAAQ,oBA5HS;AA6HjBC,cAAY,mBA7HK;AA8HjBC,YAAU,kBA9HO;AA+HjBC,YAAU,oBA/HO;AAgIjBC,UAAQ,kBAhIS;AAiIjBC,UAAQ,oBAjIS;AAkIjBC,WAAS,oBAlIQ;AAmIjBC,aAAW,mBAnIM;AAoIjBC,aAAW,oBApIM;AAqIjBC,aAAW,oBArIM;AAsIjBC,QAAM,oBAtIW;AAuIjBC,eAAa,kBAvII;AAwIjBC,aAAW,mBAxIM;AAyIjBC,OAAK,oBAzIY;AA0IjBC,QAAM,kBA1IW;AA2IjBC,WAAS,oBA3IQ;AA4IjBC,UAAQ,kBA5IS;AA6IjBC,aAAW,mBA7IM;AA8IjBC,UAAQ,oBA9IS;AA+IjBC,SAAO,oBA/IU;AAgJjBC,SAAO,oBAhJU;AAiJjBC,cAAY,oBAjJK;AAkJjBC,UAAQ,kBAlJS;AAmJjBC,eAAa,mBAnJI;;AAsJjB;AACAC,cAAY,kBAvJK;AAwJjBC,aAAW,iBAxJM;AAyJjBC,WAAS,gBAzJQ;AA0JjBC,YAAU,iBA1JO;AA2JjBC,iBAAe,iBA3JE;AA4JjBC,cAAY,kBA5JK;AA6JjBC,YAAU,kBA7JO;AA8JjBC,YAAU,oBA9JO;AA+JjBC,YAAU,oBA/JO;AAgKjBC,gBAAc,iBAhKG;AAiKjBC,gBAAc,iBAjKG;AAkKjBC,aAAW;AAlKM,CAAnB;;AAqKA,IAAIC,SAAS,8CAAb;;AAEA5mB,QAAQ6mB,MAAR,GAAiB,EAAjB;;AAEA,KAAK,IAAItlB,CAAT,IAAc4Z,YAAd,EAA4B;AAC1B,MAAIA,aAAavZ,cAAb,CAA4BL,CAA5B,CAAJ,EAAoC;AAClCvB,YAAQ6mB,MAAR,CAAetlB,CAAf,IAAoB,IAAIvB,QAAQ+a,QAAZ,GAAuB+L,UAAvB,CAAkCvlB,CAAlC,CAApB;AACD;AACF;AACD;;AAGAvB,QAAQC,MAAR,GAAiBD,QAAQC,MAAR,IAAkB;AAC/BC,OAAI,IAD2B;AAE/B6mB,aAAU;AAFqB,CAAnC;AAIA,CAAC,CAAC,YAAW;AACXlnB,UAAQC,GAAR,CAAY,0BAAZ;;AAEA,MAAIknB,SAAS,EAAE;AACb;AACAC,gBAAY,oBAASrM,CAAT,EAAY;AACtB,aAAOA,CAAP;AACD,KAJU;;AAMXsM,UAAK,cAAStM,CAAT,EAAW;AACd,aAAO,CAAP;AACD,KARU;;AAUX;AACAuM,qBAAiB,yBAASvM,CAAT,EAAY;AAC3B,aAAOA,IAAIA,CAAX;AACD,KAbU;AAcX;AACAwM,sBAAkB,0BAASxM,CAAT,EAAY;AAC5B,aAAOA,KAAK,IAAIA,CAAT,CAAP;AACD,KAjBU;AAkBX;AACAyM,wBAAoB,4BAASzM,CAAT,EAAY;AAC9B,aAAOA,IAAI,EAAJ,GAAS,IAAIA,CAAJ,GAAQA,CAAjB,GAAqB,CAAC,CAAD,GAAK,CAAC,IAAI,IAAIA,CAAT,IAAcA,CAA/C;AACD,KArBU;AAsBX;AACA0M,iBAAa,qBAAS1M,CAAT,EAAY;AACvB,aAAOA,IAAIA,CAAJ,GAAQA,CAAf;AACD,KAzBU;AA0BX;AACA2M,kBAAc,sBAAS3M,CAAT,EAAY;AACxB,aAAQ,EAAEA,CAAH,GAAQA,CAAR,GAAYA,CAAZ,GAAgB,CAAvB;AACD,KA7BU;AA8BX;AACA4M,oBAAgB,wBAAS5M,CAAT,EAAY;AAC1B,aAAOA,IAAI,EAAJ,GAAS,IAAIA,CAAJ,GAAQA,CAAR,GAAYA,CAArB,GAAyB,CAACA,IAAI,CAAL,KAAW,IAAIA,CAAJ,GAAQ,CAAnB,KAAyB,IAAIA,CAAJ,GAAQ,CAAjC,IAAsC,CAAtE;AACD,KAjCU;AAkCX;AACA6M,mBAAe,uBAAS7M,CAAT,EAAY;AACzB,aAAOA,IAAIA,CAAJ,GAAQA,CAAR,GAAYA,CAAnB;AACD,KArCU;AAsCX;AACA8M,oBAAgB,wBAAS9M,CAAT,EAAY;AAC1B,aAAO,IAAK,EAAEA,CAAH,GAAQA,CAAR,GAAYA,CAAZ,GAAgBA,CAA3B;AACD,KAzCU;AA0CX;AACA+M,sBAAkB,0BAAS/M,CAAT,EAAY;AAC5B,aAAOA,IAAI,EAAJ,GAAS,IAAIA,CAAJ,GAAQA,CAAR,GAAYA,CAAZ,GAAgBA,CAAzB,GAA6B,IAAI,IAAK,EAAEA,CAAP,GAAYA,CAAZ,GAAgBA,CAAhB,GAAoBA,CAA5D;AACD,KA7CU;AA8CX;AACAgN,mBAAe,uBAAShN,CAAT,EAAY;AACzB,aAAOA,IAAIA,CAAJ,GAAQA,CAAR,GAAYA,CAAZ,GAAgBA,CAAvB;AACD,KAjDU;AAkDX;AACAiN,oBAAgB,wBAASjN,CAAT,EAAY;AAC1B,aAAO,IAAK,EAAEA,CAAH,GAAQA,CAAR,GAAYA,CAAZ,GAAgBA,CAAhB,GAAoBA,CAA/B;AACD,KArDU;AAsDX;AACAkN,sBAAkB,0BAASlN,CAAT,EAAY;AAC5B,aAAOA,IAAI,EAAJ,GAAS,KAAKA,CAAL,GAASA,CAAT,GAAaA,CAAb,GAAiBA,CAAjB,GAAqBA,CAA9B,GAAkC,IAAI,KAAM,EAAEA,CAAR,GAAaA,CAAb,GAAiBA,CAAjB,GAAqBA,CAArB,GAAyBA,CAAtE;AACD;AAzDU,GAAb;;AA4DA5a,UAAQgnB,MAAR,GAAiBA,MAAjB;;AAEA,MAAIe,cAAc;AAChBC,eAAW,mBAASpN,CAAT,EAAY;AACrB,aAAOA,IAAI,EAAJ,GAAS,IAAIA,CAAJ,GAAQA,CAAjB,GAAqB,CAAC,CAAD,GAAK,CAAC,IAAI,IAAIA,CAAT,IAAcA,CAA/C;AACD,KAHe;AAIhBqN,WAAO,eAASrN,CAAT,EAAY;AACjB,aAAOA,IAAI,EAAJ,GAAS,IAAIA,CAAJ,GAAQA,CAAR,GAAYA,CAArB,GAAyB,CAACA,IAAI,CAAL,KAAW,IAAIA,CAAJ,GAAQ,CAAnB,KAAyB,IAAIA,CAAJ,GAAQ,CAAjC,IAAsC,CAAtE;AACD,KANe;AAOhBsN,aAAS,iBAAStN,CAAT,EAAY;AACnB,aAAOA,IAAI,EAAJ,GAAS,IAAIA,CAAJ,GAAQA,CAAR,GAAYA,CAAZ,GAAgBA,CAAzB,GAA6B,IAAI,IAAK,EAAEA,CAAP,GAAYA,CAAZ,GAAgBA,CAAhB,GAAoBA,CAA5D;AACD,KATe;AAUhBuN,aAAS,iBAASvN,CAAT,EAAY;AACnB,aAAOA,IAAI,EAAJ,GAAS,KAAKA,CAAL,GAASA,CAAT,GAAaA,CAAb,GAAiBA,CAAjB,GAAqBA,CAA9B,GAAkC,IAAI,KAAM,EAAEA,CAAR,GAAaA,CAAb,GAAiBA,CAAjB,GAAqBA,CAArB,GAAyBA,CAAtE;AACD,KAZe;AAahBwN,YAAQ,gBAASxN,CAAT,EAAY;AAClB,aAAOA,CAAP;AACD,KAfe,CAed;AAfc,GAAlB;;AAmBA5a,UAAQgnB,MAAR,CAAeqB,MAAf,GAAwBN,WAAxB;AACA/nB,UAAQgnB,MAAR,CAAesB,KAAf,GAAuBP,WAAvB;AAGD,CAxFA;AAyFD;;IAOMQ,S,GACJ,mBAAY7oB,CAAZ,EAAeC,CAAf,EAAyD;AAAA,MAAvC6oB,UAAuC,uEAA1B,QAA0B;AAAA,MAAhBC,QAAgB,uEAAL,GAAK;;AAAA;;AACvD;;AAEA,MAAG,OAAO/oB,CAAP,IAAY,QAAZ,IAAwBC,KAAK+oB,SAAhC,EACEF,aAAa,OAAb;;AAEF,OAAK9oB,CAAL,GAASA,CAAT;AACA,OAAKC,CAAL,GAASA,CAAT;AACA,OAAK6oB,UAAL,GAAkBA,UAAlB;AACA,OAAKC,QAAL,GAAgBA,QAAhB;AACA,OAAKE,MAAL,GAAc,CAAd;;AAEA,OAAKC,QAAL,GAAgB,UAASC,CAAT,EAAY;AAC1B,SAAKJ,QAAL,GAAgBI,CAAhB;AACA,WAAO,IAAP;AACD,GAHD;;AAKA,OAAKC,KAAL,GAAa,YAAW;AACtB,WAAO,IAAIP,SAAJ,CAAc,KAAK7oB,CAAnB,EAAsB,KAAKC,CAA3B,EAA8B,KAAK6oB,UAAnC,EAA+C,KAAKC,QAApD,CAAP;AACD,GAFD;;AAIA,OAAKloB,GAAL,GAAW,YAAU;AACnB,QAAG,OAAO,KAAKb,CAAZ,IAAiB,QAAjB,IAA6B,OAAO,KAAKC,CAAZ,KAAkB,QAAlD,EACA,OAAO,KAAKD,CAAZ,CADA,KAGA,OAAO,KAAKA,CAAL,IAAU,KAAKC,CAAf,GAAmB,KAAKD,CAAxB,GAA4B,KAAKC,CAAxC;AACD,GALD;;AAOA,OAAKopB,KAAL,GAAa,YAAW;AACtB,SAAKJ,MAAL,GAAc,CAAd;AACA,WAAO,IAAP;AACD,GAHD;;AAKA,OAAKK,QAAL,GAAgB,YAAW;;AAEzB,QAAG,KAAKR,UAAL,IAAmB,OAAtB,EACA,OAAO,KAAK9oB,CAAZ;;AAEA,QAAIupB,SAAS,IAAb;AAAA,QAEEtW,QAAQ,CAFV;AAAA,QAIEiJ,OAAOqN,OAAOvpB,CAAP,GAAWupB,OAAOtpB,CAJ3B;AAKEspB,WAAOR,QAAP,GAAkBQ,OAAOR,QAAP,IAAmB,GAArC;AACA,QAAIS,SAASD,OAAOT,UAApB;;AAEA,QAAIW,WAAJ;;AAEF,SAAK,IAAI5nB,CAAT,IAAc6nB,KAAKpC,MAAnB,EAA2B;AACzB,UAAIzlB,EAAEwI,WAAF,MAAmBkf,OAAOT,UAAP,CAAkBze,WAAlB,EAAvB,EACEof,cAAcC,KAAKpC,MAAL,CAAYzlB,CAAZ,EAAe8nB,IAAf,IAAuBD,KAAKpC,MAAL,CAAYzlB,CAAZ,EAAe+nB,EAApD;AACH;;AAED,QAAGJ,UAAU,aAAV,IAA2B,KAAKK,SAAL,KAAmBb,SAAjD,EACA;AACE,aAAO,KAAKa,SAAZ;AACD,KAHD,MAKK,IAAIL,UAAU,aAAV,IAA2BA,UAAU,QAAzC,EAAmD;;AAEtDD,aAAON,MAAP,IAAiB,CAAjB;;AAEA,UAAIa,aAAaP,OAAOvpB,CAAxB;;AAEA,UAAIupB,OAAOvpB,CAAP,IAAYupB,OAAOtpB,CAAvB,EAA0B;AACxB,eAAOspB,OAAOvpB,CAAP,GAAWoH,KAAK+U,GAAL,CAAU/U,KAAKC,MAAL,KAAgB6U,IAA1B,CAAlB;AACD,OAFD,MAEO;AACL,eAAOqN,OAAOvpB,CAAP,GAAWoH,KAAK+U,GAAL,CAAU/U,KAAKC,MAAL,KAAgB6U,IAA1B,CAAlB;AACD;AAGF,KAbI,MAaE,IAAIuN,WAAJ,EAAiB;;AAEtB,UAAIM,UAAU3iB,KAAKmO,KAAL,CAAYgU,OAAON,MAAP,GAAgBM,OAAOR,QAAxB,GAAoC,GAA/C,IAAsD,GAApE;;AAEAQ,aAAON,MAAP,IAAiB,CAAjB;;AAEA/M,aAAO9U,KAAK+U,GAAL,CAASD,IAAT,CAAP;;AAEA,UAAI8N,YAAY5iB,KAAK+U,GAAL,CAASsN,YAAYM,OAAZ,IAAuB7N,IAAhC,CAAhB;;AAEA,UAAI4N,aAAaP,OAAOvpB,CAAxB;;AAEA8pB,oBAAcP,OAAOvpB,CAAP,GAAWupB,OAAOtpB,CAAlB,GAAsB+pB,YAAY,CAAC,CAAnC,GAAuCA,SAArD;;AAEA,UAAIT,OAAON,MAAP,IAAiBM,OAAOR,QAA5B,EAAsC;AACpC,eAAOQ,OAAOtpB,CAAd;AACD;;AAED,aAAOmH,KAAKmO,KAAL,CAAWuU,aAAa,GAAxB,IAA+B,GAAtC;AACD;AACF,GA1DD;;AA6DA,OAAKD,SAAL,GAAiB,KAAKP,QAAL,EAAjB;AAED,C;;IAKGW,c,GAEJ,wBAAYjqB,CAAZ,EAAeC,CAAf,EAAoE;AAAA,MAAlD6oB,UAAkD,uEAArC,QAAqC;AAAA,MAA3BC,QAA2B,uEAAhB,GAAgB;AAAA,MAAXmB,MAAW,uEAAJ,EAAI;;AAAA;;AAElE,MAAG,OAAOlqB,CAAP,IAAY,QAAZ,IAAwBC,KAAK+oB,SAAhC,EACEF,aAAa,OAAb;;AAEF,OAAK9oB,CAAL,GAASA,CAAT;AACA,OAAKC,CAAL,GAASA,CAAT;AACA,OAAK6oB,UAAL,GAAkBA,UAAlB;AACA,OAAKC,QAAL,GAAgBA,QAAhB;AACA,OAAKE,MAAL,GAAc,CAAd;AACA,OAAKiB,MAAL,GAAcA,MAAd;;AAEA,OAAKhB,QAAL,GAAgB,UAASC,CAAT,EAAY;AAC1B,SAAKJ,QAAL,GAAgBI,CAAhB;AACA,WAAO,IAAP;AACD,GAHD;;AAKA,OAAKC,KAAL,GAAa,YAAW;AACtB,WAAO,IAAIa,cAAJ,CAAmB,KAAKjqB,CAAxB,EAA2B,KAAKC,CAAhC,EAAmC,KAAK6oB,UAAxC,EAAoD,KAAKC,QAAzD,EAAmE,KAAKmB,MAAxE,CAAP;AACD,GAFD;;AAIA,OAAKC,WAAL,GAAmB,YAAU;AACzB,WAAO,KAAKrB,UAAL,KAAoB,OAA3B;AACH,GAFD;;AAIA,OAAKsB,aAAL,GAAqB,YAAU;AAC7B;;AAEA,SAAK,IAAIvoB,IAAI,GAAb,EAAkBA,KAAK,GAAvB,EAA4BA,KAAK,IAAjC,EAAuC;AACrC;AACA,UAAI2nB,SAAS,KAAKV,UAAL,KAAoB,QAApB,GAA+B,KAAKA,UAApC,GAAiD,QAA9D;AACA,UAAIS,SAAS,IAAb;AAAA,UACEtW,QAAQ,CADV;;AAGA,UAAIwW,WAAJ;;AAEAF,aAAOR,QAAP,GAAkBQ,OAAOR,QAAP,IAAmB,GAArC;;AAEA;AACA,UAAI,KAAKD,UAAL,IAAmB,QAAvB,EAAiC;AAC/BU,iBAAS,QAAT;AACD;;AAED,UAAG,KAAKV,UAAL,IAAmB,OAAtB,EACA;AACA,aAAKoB,MAAL,CAAYriB,IAAZ,CAAiBvH,QAAQ8b,eAAR,CAAwBQ,iBAAxB,CAA0C2M,OAAOvpB,CAAjD,EAAoDupB,OAAOvpB,CAA3D,EAA8D,CAA9D,CAAjB;AACA;AACC;;AAED,UAAI+pB,UAAUloB,CAAd;;AAEA,WAAKqoB,MAAL,CAAYriB,IAAZ,CAAiBvH,QAAQ8b,eAAR,CAAwBQ,iBAAxB,CAA0C2M,OAAOvpB,CAAjD,EAAoDupB,OAAOtpB,CAA3D,EAA8D8pB,OAA9D,CAAjB;AACD;;AAED,WAAO,IAAP;AACD,GA9BD;;AAgCA,OAAKV,KAAL,GAAa,YAAW;AACtB,SAAKJ,MAAL,GAAc,CAAd;AACA,WAAO,IAAP;AACD,GAHD;;AAKA,OAAKroB,GAAL,GAAW,YAAU;;AAEnB,QAAG,OAAO,KAAKZ,CAAZ,IAAiB,QAAjB,IAA6B,KAAKC,CAAL,IAAU+oB,SAA1C,EACA,OAAO,KAAKhpB,CAAZ;;AAEA,QAAG,KAAKA,CAAL,IAAU,KAAKC,CAAlB,EACA,OAAO,KAAKD,CAAZ,CADA,KAEI;AACF,aAAO,KAAKC,CAAZ;AACD;AACF,GAVD;;AAYA,OAAKY,GAAL,GAAW,YAAU;;AAEnB,QAAG,OAAO,KAAKb,CAAZ,IAAiB,QAAjB,IAA6B,KAAKC,CAAL,IAAU+oB,SAA1C,EACA,OAAO,KAAKhpB,CAAZ;;AAEA,QAAG,KAAKA,CAAL,IAAU,KAAKC,CAAlB,EACA,OAAO,KAAKD,CAAZ,CADA,KAEI;AACF,aAAO,KAAKC,CAAZ;AACD;AACF,GAVD;;AAYA,OAAKoqB,UAAL,GAAkB,YAAU;AAC1B,WAAO,KAAKpB,MAAL,GAAc,KAAKF,QAA1B;AACD,GAFD;;AAKA;AACA,OAAKO,QAAL,GAAgB,YAAW;AACzB;AACA,QAAIS,UAAU,KAAKd,MAAL,GAAc,KAAKF,QAAjC;;AAEA;AACA,SAAKE,MAAL,IAAe,CAAf;;AAEA;AACA,QAAI,KAAKH,UAAL,IAAmB,QAAvB,EAAiC;AAC/B,aAAO,KAAKoB,MAAL,CAAY9iB,KAAKkjB,KAAL,CAAWljB,KAAKC,MAAL,KAAgB,KAAK6iB,MAAL,CAAYrjB,MAAvC,CAAZ,CAAP;AACD;;AAED,QAAG,KAAKiiB,UAAL,IAAmB,OAAtB,EACA,OAAO,KAAKoB,MAAL,CAAY,CAAZ,CAAP;;AAEA;AACA,WAAO,KAAKA,MAAL,CAAY9iB,KAAKkjB,KAAL,CAAWP,UAAU,GAArB,CAAZ,CAAP;AACD,GAjBD;AAmBD,C;;AAIHzpB,QAAQuoB,SAAR,GAAoBA,SAApB;AACAvoB,QAAQ2pB,cAAR,GAAyBA,cAAzB;AACA;IAAOM,W;AACL,yBAAc;AAAA;;AACZ,SAAKtB,MAAL,GAAc,CAAd;AACA,SAAKuB,IAAL,GAAY,CAAZ;AACA,SAAKzB,QAAL,GAAgB,GAAhB;AACA,SAAK0B,OAAL,GAAe,CAAf;AACA,SAAKtkB,QAAL,GAAgB,YAAW,CAAE,CAA7B;AACA,SAAKukB,kBAAL,GAA0B,EAA1B;AACA,SAAKC,MAAL,GAAc,GAAd;AACA,SAAKC,KAAL,GAAa,GAAb;AACA,SAAKC,OAAL,GAAe,CAAC,CAAhB;AACA,SAAKC,OAAL,GAAe,CAAC,CAAhB;AACA,SAAKC,OAAL,GAAe,CAAf,CAXY,CAWM;AACnB;;;;4BAEM;AACL,WAAK9B,MAAL,GAAc,CAAd;AACA,aAAO,IAAP;AACD;;;+BAES;AACR,WAAKF,QAAL,GAAgBiC,QAAhB;AACA,aAAO,IAAP;AACD;;;6BAEQ9qB,C,EAAG0I,I,EAAM;AAChB,WAAKzC,QAAL,GAAgBjG,CAAhB;AACA,WAAKwqB,kBAAL,GAA0B9hB,IAA1B;AACA,aAAO,IAAP;AACD;;;2BAEM6hB,O,EAAS;AACd,WAAKA,OAAL,GAAeA,OAAf;AACA,aAAO,IAAP;AACD;;;yBAEI7pB,G,EAAKC,G,EAAK;AACb,WAAKgqB,OAAL,GAAejqB,GAAf;AACA,WAAKkqB,OAAL,GAAejqB,GAAf;AACA,aAAO,IAAP;AACD;;;6BAEQsoB,C,EAAG;AACV,WAAKJ,QAAL,GAAgBI,CAAhB;AACA,aAAO,IAAP;AACD;;;4BAEO8B,C,EACR;AACE,WAAKF,OAAL,GAAeE,CAAf;AACA,aAAO,IAAP;AACD;;;0BAEKC,M,EACN;AACE,UAAGA,UAAU,CAAb,EACA,KAAKN,KAAL,GAAaM,MAAb;AACA,aAAO,IAAP;AACD;;;2BAEMhrB,C,EAAG;AACR,WAAKyqB,MAAL,GAAczqB,CAAd;AACA,aAAO,IAAP;AACD;;;gCAEW;AACV,aAAO,KAAK6qB,OAAL,IAAgB,CAAhB,IAAqB3jB,KAAKC,MAAL,KAAgB,GAAhB,IAAuB,KAAKsjB,MAAxD;AACD;;;+BAEU;AACT,aAAO,KAAK1B,MAAL,IAAe,KAAK4B,OAApB,IAA+B,KAAK5B,MAAL,IAAe,KAAK6B,OAA1D;AACD;;;yBAEI3kB,Q,EAAU;;AAEb,WAAK4kB,OAAL;;AAEA,UAAI,CAAC,KAAKI,SAAL,EAAL,EACE;;AAEF,UAAIhlB,QAAJ,EACE,KAAKA,QAAL,GAAgBA,QAAhB;;AAEF,UAAG,KAAK8iB,MAAL,GAAc,KAAK2B,KAAnB,KAA6B,CAAhC,EACA;;AAEA,UAAI,KAAK/qB,MAAL,GAAc,CAAd,IAAmB,KAAKopB,MAAL,IAAe,KAAKF,QAA3C,EAAqD;AACnD,aAAKE,MAAL,GAAc,CAAd;AACA,aAAKppB,MAAL;AACD;;AAED,UAAI,KAAKopB,MAAL,IAAe,KAAKF,QAApB,IAAgC,CAAC,KAAKqC,QAAL,EAArC,EAAsD;AACpD,aAAKjlB,QAAL,CAAc,KAAKukB,kBAAnB;AACD;;AAED,WAAKzB,MAAL,IAAe,CAAf;AACD;;;;;;AAGH3oB,QAAQiqB,WAAR,GAAsBA,WAAtB;AACA,C,CAAC;;;;;;;;IAQKc,U;AACJ,wBAA4C;AAAA,QAAhCC,MAAgC,uEAAvB,KAAuB;AAAA,QAAhBzlB,SAAgB,uEAAJ,EAAI;;AAAA;;AAE1C;;;;;;;AAOA,SAAKA,SAAL,GAAiBA,SAAjB;AACA,SAAK0lB,WAAL,GAAmBjrB,QAAQirB,WAAR,IAAuB,EAA1C;AACA,SAAKrnB,QAAL,GAAgB,EAAhB;;AAGA,SAAKsnB,MAAL,GAAc,KAAd;AACA,SAAKC,eAAL,GAAuB,KAAvB;;AAEA;;;;;;;AAOA,SAAKH,MAAL,GAAcA,UAAU,KAAxB;;AAEA,SAAKI,OAAL,GAAe,IAAf;;AAEA,QAAI,CAACJ,MAAL,EAAa;AACXnrB,cAAQY,IAAR,CAAa,yFAAb;AACA,WAAKuqB,MAAL,GAAc3mB,SAASgnB,aAAT,CAAuB,QAAvB,CAAd;AACA,WAAKL,MAAL,CAAYM,YAAZ,CAAyB,OAAzB,EAAkC,YAAlC;AACAjnB,eAASC,IAAT,CAAcinB,MAAd,CAAqB,KAAKP,MAA1B;AACD;;AAED,SAAKQ,OAAL,GAAe,KAAKR,MAAL,CAAYS,UAAZ,CAAuB,IAAvB,CAAf;;AAEApnB,aAASC,IAAT,CAAc6N,KAAd,CAAoBuF,QAApB,GAA+B,UAA/B;AACArT,aAASC,IAAT,CAAc6N,KAAd,CAAoBmI,KAApB,GAA4B,MAA5B;AACAjW,aAASC,IAAT,CAAc6N,KAAd,CAAoBkI,MAApB,GAA6B,MAA7B;;AAEA;;;;;;;AAQA,SAAKqR,MAAL,GAAc,IAAI1rB,QAAQwX,MAAZ,EAAd;;AAEA,SAAKkU,MAAL,CAAYtR,MAAZ,GAAqB,KAArB;;AAEApa,YAAQ0rB,MAAR,GAAiB,KAAKA,MAAtB;;AAEA,QAAI/gB,SAAS,IAAb;;AAEA,SAAKghB,IAAL;;AAEA,SAAKC,UAAL,GAAkB,EAAlB;AACA,SAAKC,UAAL,GAAkB,EAAlB;;AAEA9a,WAAO+a,QAAP,GAAkB,YAAW;;AAE3B,UAAInhB,OAAOohB,cAAX,EACE;;AAEFphB,aAAOghB,IAAP;;AAEAhhB,aAAOkhB,UAAP,CAAkBzmB,OAAlB,CAA0B,UAASsQ,CAAT,EAAW;;AAEjCA,UAAEsW,IAAF,CAAO,IAAP,EAAaziB,IAAb;AAEH,OAJD;AAMD,KAbD;;AAeA,SAAK0iB,GAAL,GAAW,KAAKjB,MAAL,CAAYS,UAAZ,CAAuB,IAAvB,CAAX;;AAEAzrB,YAAQ4E,YAAR,CAAqB2C,IAArB,CAA0B,IAA1B;;AAGAwJ,WAAOmb,OAAP,GAAiB,YAAW;;AAE1BlsB,cAAQiE,MAAR,IAAkB,CAAlB;;AAEApE,cAAQC,GAAR,CAAY,iBAAZ;;AAEA,UAAIE,QAAQiE,MAAR,GAAiBjE,QAAQC,MAAR,CAAe8mB,SAApC,EAA+C;AAC7C/mB,gBAAQkE,QAAR,GAAmB,IAAnB;;AAEA,YAAIqF,OAAOA,QAAQwH,OAAOzR,UAAP,CAAkB,YAAW;;AAE9C,cAAIiK,IAAJ,EAAU;AACRwH,mBAAOob,YAAP,CAAoB5iB,IAApB;AACD;AACD1J,kBAAQC,GAAR,CAAY,kCAAkCE,QAAQ4D,QAAR,CAAiBI,UAA/D,EAA2E,mBAA3E;AAED,SAPkB,EAOhB,GAPgB,CAAnB;AASD;AAEF,KApBD;;AAsBA,SAAKooB,UAAL,GAAkB,KAAKpB,MAAvB;AAED;;;;8BAESqB,K,EAAM;AACd,WAAKlB,eAAL,GAAuB,EAAvB;AACA,aAAO,IAAP;AACD;;;8BAESmB,C,EAAE;AACV,WAAKC,SAAL,GAAiBD,CAAjB;AACA,WAAKtB,MAAL,CAAYwB,OAAZ,GAAsB,MAAtB;AACA,aAAO,IAAP;AACD;;;+BAEU;AACT,aAAO,KAAKtB,MAAZ;AACD;;;6BAEQ9oB,C,EAAG;AACV,WAAK8oB,MAAL,GAAc9oB,CAAd;AACA,aAAO,IAAP;AACD;;;iCAEYb,C,EAAG0B,C,EAAGwpB,C,EAAGC,C,EAAG;;AAEvB,aAAO,KAAKT,GAAL,CAASU,YAAT,CAAsBprB,CAAtB,EAAyB0B,CAAzB,EAA4BwpB,CAA5B,EAA+BC,CAA/B,CAAP;AAED;;AAGD;;;;;;;;;gCAOY;AACV,aAAO,KAAK1B,MAAZ;AACD;;AAGD;;;;;;;;;6BAQS;AACP,aAAO,IAAIhrB,QAAQ+U,MAAZ,CAAmBjO,KAAKmO,KAAL,CAAW,KAAK+V,MAAL,CAAY1Q,KAAZ,GAAoB,CAA/B,CAAnB,EAAsDxT,KAAKmO,KAAL,CAAW,KAAK+V,MAAL,CAAY3Q,MAAZ,GAAqB,CAAhC,CAAtD,CAAP;AACD;;;gCAIW;;AAEV,WAAKuS,WAAL,GAAmB,IAAnB;AACA,aAAO,IAAP;AACD;;;6BAGQrrB,C,EAAG0B,C,EAAGwpB,C,EAAGC,C,EAAGG,a,EAAe;;AAElC,UAAI/X,OAAO,IAAI9U,QAAQ+U,MAAZ,CAAmB0X,CAAnB,EAAsBC,CAAtB,CAAX;AAAA,UACEhV,WAAW,IAAI1X,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,CADb;;AAGA,UAAIgL,MAAJ;;AAEA,UAAI4e,aAAJ,EAAmB;AACjB5e,iBAAS,IAAIjO,QAAQ0F,MAAZ,CAAmBmnB,aAAnB,CAAT;AACA5e,eAAO0d,IAAP,CAAY7W,IAAZ;AACA7G,eAAO6e,GAAP,CAAWpV,QAAX;;AAEA1X,gBAAQ4E,YAAR,CAAqB,CAArB,EAAwB6P,GAAxB,CAA4BxG,MAA5B;AACD;;AAED,aAAO;AACL6G,cAAMA,IADD;AAEL4C,kBAAUA;AAFL,OAAP;AAID;;;gCAGW7R,Q,EAAU;;AAEpB,UAAImlB,SAAS,KAAKA,MAAlB;;AAEA,WAAKA,MAAL,CAAYvY,gBAAZ,CAA6B,WAA7B,EAA0C,UAASsa,GAAT,EAAc;;AAEtD,YAAIxrB,IAAIwrB,IAAIlb,OAAZ;AAAA,YACE5O,IAAI8pB,IAAI/a,OADV;;AAGA,YAAMgb,OAAOhC,OAAOiC,qBAAP,EAAb;;AAEA1rB,aAAKyrB,KAAK3T,IAAV;AACApW,aAAK+pB,KAAK5a,GAAV;;AAEAvM,iBAAStE,CAAT,EAAY0B,CAAZ;AAED,OAZD;AAaD;;;iCAGY4C,Q,EAAU;AACrB,UAAImlB,SAAS,KAAKA,MAAlB;AACA,WAAKA,MAAL,CAAYvY,gBAAZ,CAA6B,OAA7B,EAAsC,UAASsa,GAAT,EAAc;AAClD,YAAIxrB,IAAIwrB,IAAIlb,OAAZ;AAAA,YACE5O,IAAI8pB,IAAI/a,OADV;AAEA,YAAMgb,OAAOhC,OAAOiC,qBAAP,EAAb;AACA1rB,aAAKyrB,KAAK3T,IAAV;AACApW,aAAK+pB,KAAK5a,GAAV;AACAvM,iBAAStE,CAAT,EAAY0B,CAAZ,EAAe8pB,GAAf;AACD,OAPD;AAQD;;;iCAGYlnB,Q,EAAU/C,I,EAAM;AAC3B,UAAIkoB,SAAS,KAAKA,MAAlB;AACA,WAAKA,MAAL,CAAYvY,gBAAZ,CAA6B,YAA7B,EAA2C,UAASsa,GAAT,EAAc;AACvD,YAAIxrB,IAAIwrB,IAAIlb,OAAZ;AAAA,YACE5O,IAAI8pB,IAAI/a,OADV;AAEA,YAAMgb,OAAOhC,OAAOiC,qBAAP,EAAb;AACA1rB,aAAKyrB,KAAK3T,IAAV;AACApW,aAAK+pB,KAAK5a,GAAV;AACAvM,iBAAStE,CAAT,EAAY0B,CAAZ,EAAe8pB,IAAIG,UAAJ,GAAiB,CAAjB,GAAqB,CAArB,GAAyB,CAAC,CAAzC,EAA4CH,GAA5C;AACA,YAAIjqB,IAAJ,EAAU;AACRiqB,cAAIla,cAAJ;AACA,iBAAO,IAAP;AACD;AACF,OAXD;AAYD;;AAGD;;;;;;;;;8BAOUsa,O,EAASC,O,EAASX,C,EAAGC,C,EAAGG,a,EAAe;;AAE/C,UAAI,EAAE,KAAKQ,IAAL,YAAqBnsB,KAAvB,CAAJ,EAAmC;AACjC,aAAKmsB,IAAL,GAAY,EAAZ;AACD;;AAED,eAASC,QAAT,CAAkB/rB,CAAlB,EAAqB0B,CAArB,EAAwBwpB,CAAxB,EAA2BC,CAA3B,EAA8BG,aAA9B,EAA6C;;AAE3C,YAAI/X,OAAO,IAAI9U,QAAQ+U,MAAZ,CAAmB0X,CAAnB,EAAsBC,CAAtB,CAAX;AAAA,YACEhV,WAAW,IAAI1X,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,CADb;;AAGA,YAAIgL,MAAJ;;AAEA,YAAI4e,aAAJ,EAAmB;AACjB5e,mBAAS,IAAIjO,QAAQ0F,MAAZ,CAAmBmnB,aAAnB,CAAT;AACA5e,iBAAO0d,IAAP,CAAY7W,IAAZ;AACA7G,iBAAO6e,GAAP,CAAWpV,QAAX;;AAEA1X,kBAAQ4E,YAAR,CAAqB,CAArB,EAAwB6P,GAAxB,CAA4BxG,MAA5B;AACD;;AAED,eAAO;AACL6G,gBAAMA,IADD;AAEL4C,oBAAUA;AAFL,SAAP;AAID;;AAED,WAAK,IAAIzU,IAAI,CAAb,EAAgBA,IAAImqB,OAApB,EAA6BnqB,GAA7B,EAAkC;;AAEhC,aAAK,IAAI1B,IAAI,CAAb,EAAgBA,IAAI4rB,OAApB,EAA6B5rB,GAA7B,EAAkC;;AAEhC,eAAK8rB,IAAL,CAAU9lB,IAAV,CAAe,IAAI+lB,QAAJ,CAAa/rB,IAAIkrB,CAAjB,EAAoBxpB,IAAIypB,CAAxB,EAA2BD,CAA3B,EAA8BC,CAA9B,EAAiCG,aAAjC,CAAf;AAED;AAEF;AACD,aAAO,IAAP;AACD;;;gCAEW;AACV,aAAO,KAAK7B,MAAZ;AACD;;AAED;;;;;;;;;6BAQStV,C,EAAG;;AAEV,WAAKkW,UAAL,CAAgBrkB,IAAhB,CAAqBmO,CAArB;AAED;;AAGD;;;;;;;;;6BAQSqC,C,EAAG;;AAEV,WAAK8T,UAAL,CAAgBtkB,IAAhB,CAAqBwQ,CAArB;AAED;;AAED;;;;;;;;;6BAOS;;AAEP,UAAI,KAAKwV,QAAL,EAAJ,EACE;;AAGI,UAAI,KAAK7B,MAAL,IAAe,KAAKA,MAAL,CAAY1d,MAA/B,EACE,KAAK0d,MAAL,CAAY1d,MAAZ;;AAER,UAAIwf,gBAAgB,SAAhBA,aAAgB,CAASC,GAAT,EAAc/rB,GAAd,EAAmB;AACrC,eAAO+rB,IAAIC,IAAJ,CAAS,UAAChuB,CAAD,EAAIC,CAAJ,EAAU;AACxB,iBAAOD,EAAEgC,GAAF,IAAS/B,EAAE+B,GAAF,CAAhB;AACD,SAFM,CAAP;AAGD,OAJD;;AAMA8rB,oBAAc,KAAKjoB,SAAnB,EAA8B,OAA9B;;AAEAvF,cAAQwI,IAAR,CAAa,KAAKjD,SAAlB,EAA6B,UAASZ,EAAT,EAAaU,IAAb,EAAmB;;AAE9C,YAAIA,QAAQ,OAAOA,KAAKsoB,UAAZ,IAA2B,UAAvC,EAAmD;AACjDtoB,eAAKsoB,UAAL,CAAgBtoB,IAAhB;AACD;;AAED,YAAIA,QAAQ,OAAOA,KAAK2I,MAAZ,IAAuB,UAAnC,EAA+C;AAC7C3I,eAAK2I,MAAL,CAAY3I,IAAZ;AACD;;AAGD,YAAIA,QAAQ,CAAC,aAAD,EAAgB,cAAhB,EAAgC,sBAAhC,EAAwDiG,OAAxD,CAAgEjG,KAAK0D,WAAL,CAAiBC,IAAjF,KAA0F,CAAlG,IACF,OAAO3D,KAAKmD,IAAZ,IAAoB,UADtB,EACkC;;AAEhCnD,eAAKmD,IAAL,CAAU,UAAS7D,EAAT,EAAaipB,OAAb,EAAsB;;AAE9BA,oBAAQ5f,MAAR,CAAe4f,OAAf;AAED,WAJD;AAMD;AAEF,OAtBD;;AAwBA5tB,cAAQwI,IAAR,CAAa,KAAKyiB,WAAlB,EAA+B,UAAStmB,EAAT,EAAaU,IAAb,EAAmB;;AAEhD,YAAIA,QAAQA,KAAKwoB,IAAL,EAAZ,EAAyB;AACvBxoB,eAAKQ,QAAL;AACD;AAEF,OAND;;AASA,WAAK,IAAItE,CAAT,IAAc,KAAKqqB,UAAnB,EAA+B;AAC7B,aAAKA,UAAL,CAAgBrqB,CAAhB;AACD;AAGF;;;iCAEY;AACX,WAAKusB,eAAL,GAAuB,YAAW,CAAE,CAApC;AACD;;;gCAEW;AACV,WAAKvoB,SAAL,GAAiB,EAAjB;AACA,WAAK6lB,OAAL,GAAe,KAAf;AACA,WAAK2C,UAAL;AACD;;;6BAEQ;AACP,WAAK3C,OAAL,GAAe,IAAf;AACD;;;yBAEIJ,M,EAAQ;;AAEX,UAAGA,kBAAkBgD,iBAArB,EACA,KAAK/B,GAAL,CAASgC,SAAT,CAAmBjD,MAAnB,EAA2B,CAA3B,EAA8B,CAA9B,EAAiCA,OAAO1Q,KAAxC,EAA+C0Q,OAAO3Q,MAAtD,EADA,KAGK,IAAG,QAAO2Q,MAAP,yCAAOA,MAAP,MAAiB,QAAjB,IAA6BA,OAAOA,MAAP,YAAyBgD,iBAAzD,EACL,KAAK/B,GAAL,CAASgC,SAAT,CAAmBjD,OAAOA,MAA1B,EAAkCA,OAAOA,MAAP,CAAc1Q,KAAhD,EAAuD0Q,OAAOA,MAAP,CAAc3Q,MAArE;;AAEA,UAAI,KAAKkT,QAAL,EAAJ,EACE;;AAEF,UAAIW,eAAe,IAAnB;;AAEA,UAAI,KAAKJ,eAAT,EAA0B;AACxB,aAAKA,eAAL;AACD;;AAED9tB,cAAQwI,IAAR,CAAa,KAAKjD,SAAlB,EAA6B,UAASZ,EAAT,EAAaU,IAAb,EAAmB;;AAE9C,YAAI,OAAOA,KAAK8oB,IAAZ,IAAoB,UAAxB,EAAoC;AAClC9oB,eAAK8oB,IAAL,CAAUD,aAAajC,GAAvB,EAA4BiC,aAAaxC,MAAzC;AACD;AAEF,OAND;;AASA,UAAI,KAAK0C,cAAT,EAAyB;AACvB,aAAKA,cAAL;AACD;AAEF;;;mCAGcC,W,EAAY;AACzB,WAAKA,WAAL,GAAmBA,WAAnB;AACA,aAAO,IAAP;AACD;;;+BAES;;AAER,UAAG,KAAKC,iBAAR,EACA,KAAKA,iBAAL;AAED;;;+BAEUC,U,EAAW;AACpB,WAAKD,iBAAL,GAAyBC,UAAzB;AACA,aAAO,IAAP;AACD;;AAGD;;;;;;;;;iCAOa7Y,C,EAAG;;AAEd,UAAI8Y,YAAY9Y,EAAEsW,IAAF,CAAO,IAAP,CAAhB;;AAEA,UAAI,CAAC,KAAK8B,eAAV,EACE,KAAKA,eAAL,GAAuB,YAAW,CAAE,CAApC;;AAEF,UAAIW,aAAa,KAAKX,eAAL,CAAqB9B,IAArB,CAA0B,IAA1B,CAAjB;;AAEA,WAAK8B,eAAL,GAAuB,YAAW;AAChCW;AACAD;AACD,OAHD;AAKD;;;iCAEW;AACV,WAAKxD,MAAL,CAAY0D,UAAZ,CAAuBC,WAAvB,CAAmC,KAAK3D,MAAxC;AACA,aAAO,IAAP;AACD;;AAED;;;;;;;;;gCAQYtV,C,EAAG;;AAEb,UAAI8Y,YAAY9Y,EAAEsW,IAAF,CAAO,IAAP,CAAhB;;AAEA,UAAI,CAAC,KAAKoC,cAAV,EACE,KAAKA,cAAL,GAAsB,YAAW,CAAE,CAAnC;;AAGF,UAAIQ,YAAY,KAAKR,cAAL,CAAoBpC,IAApB,CAAyB,IAAzB,CAAhB;;AAEA,WAAKoC,cAAL,GAAsB,YAAW;AAC/BQ;AACAJ;AACD,OAHD;AAKD;;AAED;;;;;;;;;;;yBASK/B,C,EAAGC,C,EAAGX,c,EAAgB;AAAE;;AAE3BU,UAAIA,KAAK,KAAKzB,MAAL,CAAY0D,UAAZ,CAAuBnqB,WAAhC;;AAEAmoB,UAAIA,KAAK,KAAK1B,MAAL,CAAY0D,UAAZ,CAAuBjqB,YAAhC;;AAEA,UAAI7E,IAAI,KAAKorB,MAAb;;AAEA,UAAIprB,CAAJ,EAAO;AACLA,UAAE0rB,YAAF,CAAe,OAAf,EAAwBmB,CAAxB;AACD;;AAED,UAAI7sB,CAAJ,EAAO;AACLA,UAAE0rB,YAAF,CAAe,QAAf,EAAyBoB,CAAzB;AACD;;AAED1sB,cAAQoE,KAAR,GAAgBqoB,CAAhB;;AAEAzsB,cAAQwE,MAAR,GAAiBkoB,CAAjB;;AAEA,WAAK1B,MAAL,CAAY1Q,KAAZ,GAAoBmS,CAApB;;AAEA,WAAKzB,MAAL,CAAY3Q,MAAZ,GAAqBqS,CAArB;;AAEA,WAAK5X,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmB0X,CAAnB,EAAsBC,CAAtB,CAAZ;;AAEA,WAAKX,cAAL,GAAsBA,kBAAkB,KAAxC;;AAEA,aAAO,IAAP;AAED;;AAED;;;;;;;;;;;wBASI9qB,G,EAAK;;AAEP,UAAGA,eAAeC,KAAlB,EACA;AACE,YAAI2tB,MAAM,IAAV;AACA5tB,YAAImE,OAAJ,CAAY,UAASknB,CAAT,EAAW;AACnBuC,cAAIpa,GAAJ,CAAQ6X,CAAR;AACH,SAFD;AAGA;AACD;;AAED,UAAI3hB,SAAS,IAAb;;AAEA,UAAI1J,eAAejB,QAAQwX,MAA3B,EAAmC;;AAEjC,aAAKkU,MAAL,GAAczqB,GAAd;AAED,OAJD,MAIO,IAAIA,eAAejB,QAAQ8uB,OAA3B,EAAoC;;AAEzC,YAAI9uB,QAAQyJ,SAAZ,EAAuB;;AAErB,iBAAO5J,QAAQQ,KAAR,CAAc,wGAAd,CAAP;AACD,SAHD,MAGO;;AAELY,cAAI8tB,KAAJ;AAED;AACF,OAVM,MAUA;;AAEL,aAAKxpB,SAAL,CAAegC,IAAf,CAAoBtG,GAApB;AAED;;AAED,aAAOA,GAAP;AAED;;AAED;;;;;;;;;;+BAQWrB,C,EAAG;AACZ,WAAKorB,MAAL,CAAY7Y,KAAZ,CAAkB6c,UAAlB,GAA+BpvB,CAA/B;AACA,WAAKorB,MAAL,CAAY7Y,KAAZ,CAAkB8c,eAAlB,GAAoCrvB,CAApC;AACA,aAAO,IAAP;AACD;;AAED;;;;;;;;;;2BAQOqB,G,EAAK;AACV,UAAI0D,KAAK,KAAKY,SAAL,CAAe+F,OAAf,CAAuBrK,GAAvB,CAAT;AACA,UAAI0D,MAAM,CAAV,EAAa;AACX,aAAKY,SAAL,CAAe2pB,MAAf,CAAsBvqB,EAAtB,EAA0B,CAA1B;AACD;AACF;;;wBAEG1D,G,EAAK;;AAEP,UAAI0D,KAAK,KAAKY,SAAL,CAAe+F,OAAf,CAAuBrK,GAAvB,CAAT;;AAEA,UAAI0D,MAAM,CAAV,EAAa;AACX,eAAO,IAAP;AACD;;AAED,aAAO,KAAP;AACD;;;wCAGmB;;AAElB,UAAIwqB,UAAU,IAAd;;AAEA,WAAK5pB,SAAL,CAAeH,OAAf,CAAuB,UAAS6I,MAAT,EAAiB;;AAEtC,YAAIA,OAAOmhB,IAAP,IAAe,CAAnB,EAAsB;AACpBD,kBAAQE,MAAR,CAAephB,MAAf;AACA,cAAIA,OAAOqhB,YAAX,EAAyB;AACvBrhB,mBAAOqhB,YAAP;AACD;AACF;AACF,OARD;AASD;;;8BAGQ;;AAEP,WAAKC,iBAAL;AAED;;AAGD;;;;;;;;;;0BAQuB;AAAA,UAAnBC,IAAmB,uEAAd,CAAc;AAAA,UAAXC,OAAW,uEAAH,EAAG;;;AAErB,UAAGA,QAAQvvB,GAAR,IAAeuvB,QAAQC,GAA1B,EACA;AACE,aAAKC,KAAL,CAAWH,IAAX;AACD,OAHD,MAMA,KAAKI,OAAL,CAAaJ,IAAb;AAED;;;4BAEOA,I,EAAM;;AAEZ,UAAI,CAAC,KAAKpE,OAAV,EACE;;AAEF,UAAG,KAAKD,eAAL,YAAgCjqB,KAAnC,EACA;AACE,aAAKiqB,eAAL,CAAqB/lB,OAArB,CAA6B,UAASqnB,CAAT,EAAW;AACtC,eAAK0B,IAAL,CAAU1B,CAAV;AACD,SAFD;AAGA;AACD;;AAED,UAAG,KAAK4B,WAAL,IAAoB,KAAKA,WAAL,EAAvB,EACA;AACE;AACD;;AAED,UAAI1jB,SAAS,IAAb;;AAEAklB,4BAAsB,YAAW;AAC/BllB,eAAOilB,OAAP;AACD,OAFD;;AAIA,UAAI,KAAKE,OAAT,EAAkB;AAChB,aAAKA,OAAL,CAAaC,KAAb;AACA,aAAKC,SAAL,CAAeD,KAAf;AACA,aAAKE,SAAL,CAAejiB,MAAf;AACD;;AAEDhO,cAAQkwB,QAAR,GAAmB,IAAnB;;AAEA,WAAKliB,MAAL;;AAEA,UAAI,CAAC,KAAKuf,QAAL,EAAL,EAAsB;AACpB,YAAIxc,OAAOof,KAAX,EACEA,MAAMniB,MAAN,CAAawhB,IAAb;;AAEF,YAAI,KAAK5rB,QAAL,CAAchC,cAAd,CAA6B,WAA7B,KAA6C,KAAKgC,QAAL,CAAcwsB,SAAd,IAA2B,KAA5E,EAAmF,CAElF,CAFD,MAEO;AACL,eAAKnE,GAAL,CAASoE,SAAT,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,KAAKrF,MAAL,CAAY1Q,KAArC,EAA4C,KAAK0Q,MAAL,CAAY3Q,MAAxD;AACD;;AAED,aAAK8T,IAAL;;AAEA,YAAI,KAAK2B,OAAT,EAAkB;AAChB,eAAKA,OAAL,CAAaQ,GAAb;AACA,eAAKN,SAAL,CAAeM,GAAf;AACD;AACF;AACF;;AAED;;;;;;;;;4BAQQ;;AAEN,UAAI,OAAOC,KAAP,IAAiB,UAArB,EAAiC;AACjC;AACE;AACA,eAAKT,OAAL,GAAe,IAAIS,KAAJ,EAAf;AACA,eAAKT,OAAL,CAAaU,SAAb,CAAuB,CAAvB,EAHF,CAG6B;;AAE3B,eAAKV,OAAL,CAAaW,GAAb,CAAiBte,KAAjB,CAAuBkH,IAAvB,GAA8B,KAA9B;;AAEA,eAAKyW,OAAL,CAAaW,GAAb,CAAiBnF,YAAjB,CAA8B,OAA9B,EAAuC,MAAvC;;AAEA,eAAKN,MAAL,CAAY0D,UAAZ,CAAuBgC,WAAvB,CAAmC,KAAKZ,OAAL,CAAaW,GAAhD;;AAEA;AACA,eAAKT,SAAL,GAAiB,IAAIO,KAAJ,EAAjB;AACA,eAAKP,SAAL,CAAeQ,SAAf,CAAyB,CAAzB,EAbF,CAa+B;;AAE7B,eAAKR,SAAL,CAAeS,GAAf,CAAmBte,KAAnB,CAAyBkH,IAAzB,GAAgC,KAAhC;;AAEA,eAAK2W,SAAL,CAAeS,GAAf,CAAmBte,KAAnB,CAAyBwe,UAAzB,GAAsC,MAAtC;;AAEA,eAAKX,SAAL,CAAeS,GAAf,CAAmBnF,YAAnB,CAAgC,OAAhC,EAAyC,MAAzC;;AAEA,eAAKN,MAAL,CAAY0D,UAAZ,CAAuBgC,WAAvB,CAAmC,KAAKV,SAAL,CAAeS,GAAlD;;AAEA;AACA,eAAKR,SAAL,GAAiB,IAAIM,KAAJ,EAAjB;AACA,eAAKN,SAAL,CAAeO,SAAf,CAAyB,CAAzB,EAzBF,CAyB+B;;AAE7B,eAAKP,SAAL,CAAeQ,GAAf,CAAmBte,KAAnB,CAAyBkH,IAAzB,GAAgC,KAAhC;;AAEA,eAAK4W,SAAL,CAAeQ,GAAf,CAAmBnF,YAAnB,CAAgC,OAAhC,EAAyC,MAAzC;;AAEA,eAAK2E,SAAL,CAAeQ,GAAf,CAAmBte,KAAnB,CAAyBwe,UAAzB,GAAsC,OAAtC;;AAEA,eAAK3F,MAAL,CAAY0D,UAAZ,CAAuBgC,WAAvB,CAAmC,KAAKT,SAAL,CAAeQ,GAAlD;AACD;;AAED,WAAKb,OAAL;AACD;;;;;;AAGH5vB,QAAQ+qB,UAAR,GAAqBA,UAArB;AACA,C,CAAC;;;;;;;IAOK6F,M;AAEJ,kBAAYC,GAAZ,EAAiBhrB,QAAjB,EAA2B;AAAA;;AACzB,QAAIgrB,GAAJ,EACE,KAAKC,IAAL,CAAUD,GAAV,EAAehrB,QAAf;AACH;;;;6BAEQkrB,U,EAAYlrB,Q,EAAU;AAC7B,UAAImrB,SAAS,IAAIC,UAAJ,EAAb;AACAD,aAAOE,MAAP,GAAgB,UAASvuB,CAAT,EAAY;AAC1BkD,iBAASmrB,OAAO/U,MAAhB;AACD,OAFD;AAGA+U,aAAOG,UAAP,CAAkBJ,UAAlB;AACD;;;yBAEIF,G,EAAKhrB,Q,EAAU;;AAElB,UAAIurB,WAAW,IAAf;;AAEA,WAAKP,GAAL,GAAWA,GAAX;;AAEAhrB,iBAAWA,YAAY,YAAW,CAAE,CAApC;;AAEAA,iBAAWA,SAASmmB,IAAT,CAAc,IAAd,CAAX;;AAEA,UAAIhV,SAAS3S,SAASgnB,aAAT,CAAuB,QAAvB,CAAb;AAAA,UAEAgG,aAAa,KAFb;;AAIA,UAAIR,IAAI9mB,WAAJ,GAAkBunB,QAAlB,CAA2B,KAA3B,CAAJ,EAAuC;AACrCta,eAAO/D,GAAP,GAAa4d,GAAb;AACD,OAFD,MAEO;AACL;AACA,YAAI3c,OAAO2c,GAAX;AACAQ,qBAAa,IAAb;AACAra,eAAO0Z,WAAP,CAAmBrsB,SAASktB,cAAT,CAAwBrd,IAAxB,CAAnB;AACD;;AAED;AACAnD,aAAOpN,MAAP,GAAgBoN,OAAOpN,MAAP,IAAiB,EAAjC;;AAEA;AACAqT,aAAOka,MAAP,GAAgB,YAAW;;AAEzB,YAAIM,YAAYzgB,OAAOpN,MAAP,CAAc4H,OAA9B;AACA1F,iBAAS2rB,SAAT,EAAoBX,GAApB;AAED,OALD;;AAOA,UAAGQ,UAAH,EACA;AACE/xB,mBAAW,YAAU;AACnB,cAAIkyB,YAAYzgB,OAAOpN,MAAP,CAAc4H,OAA9B;AACA1F,mBAAS2rB,SAAT,EAAoBX,GAApB;AACD,SAHD,EAGG,GAHH;AAID;;AAED;AACAxsB,eAASotB,IAAT,CAAcf,WAAd,CAA0B1Z,MAA1B;AAED;;;;;;AAEF;;AAEDhX,QAAQ4wB,MAAR,GAAiBA,MAAjB;;IAGMc,I;AAEJ,kBAAc;AAAA;AAEb;;;;+BAEUb,G,EAAKhrB,Q,EAAU;;AAExB,UAAIurB,WAAW,IAAf;;AAEA,WAAKP,GAAL,GAAWA,GAAX;;AAEAhrB,iBAAWA,YAAY,YAAW,CAAE,CAApC;;AAEAA,iBAAWA,SAASmmB,IAAT,CAAc,IAAd,CAAX;;AAEA,UAAIhV,SAAS3S,SAASgnB,aAAT,CAAuB,QAAvB,CAAb;AACArU,aAAO/D,GAAP,GAAa4d,GAAb;;AAEA;AACA9f,aAAOpN,MAAP,GAAgBoN,OAAOpN,MAAP,IAAiB,EAAjC;;AAEA;AACAqT,aAAOka,MAAP,GAAgB,YAAW;AACzB,YAAIM,YAAYzgB,OAAOpN,MAAP,CAAc4H,OAA9B;AACA,YAAIoH,KAAJ;AACA,YAAI,OAAO6e,SAAP,IAAoB,UAAxB,EAAoC;AAClC7e,kBAAQ5B,OAAOpN,MAAP,CAAc4H,OAAd,EAAR;AACD;;AAED1F,iBAAS8M,KAAT,EAAgB6e,SAAhB,EAA2BX,GAA3B;AAED,OATD;AAUA;AACAxsB,eAASotB,IAAT,CAAcf,WAAd,CAA0B1Z,MAA1B;AACD;;;;;;AAIHhX,QAAQ0xB,IAAR,GAAeA,IAAf;AACA;;IACMriB,K;AACJ,iBAAY+c,UAAZ,EAAuB;AAAA;;AACrB,SAAK1U,QAAL,GAAgB,IAAI1X,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAAhB;AACA,SAAKqX,UAAL,GAAkBA,WAAWA,UAAX,IAAyBA,UAA3C;AACD;;;;gCACW7iB,I,EACZ;AACE,UAAIooB,SAAS,IAAb;AACA,WAAKvF,UAAL,CAAgB3Z,gBAAhB,CAAiC,WAAjC,EAA8C,UAASsa,GAAT,EAAa;AACvD4E,eAAOja,QAAP,GAAkB,IAAI1X,QAAQ+U,MAAZ,CAAmBgY,IAAIlb,OAAvB,EAAgCkb,IAAI/a,OAApC,CAAlB;AACAzI,aAAKyiB,IAAL,CAAU2F,MAAV,EAAkBA,OAAOja,QAAP,CAAgBnW,CAAlC,EAAqCowB,OAAOja,QAAP,CAAgBzU,CAArD;AACH,OAHD;AAIA,aAAO,IAAP;AACD;;;8BACSsG,I,EACV;AACE,UAAIooB,SAAS,IAAb;AACA,WAAKvF,UAAL,CAAgB3Z,gBAAhB,CAAiC,SAAjC,EAA4C,UAASsa,GAAT,EAAa;AACrDxjB,aAAKyiB,IAAL,CAAU2F,MAAV,EAAkB,IAAlB;AACH,OAFD;AAGA,aAAO,IAAP;AACD;;;gCACWpoB,I,EACZ;AACE,UAAIooB,SAAS,IAAb;AACA,WAAKvF,UAAL,CAAgB3Z,gBAAhB,CAAiC,WAAjC,EAA8C,UAASsa,GAAT,EAAa;AACvDxjB,aAAKyiB,IAAL,CAAU2F,MAAV,EAAkB,KAAlB;AACH,OAFD;AAGA,aAAO,IAAP;AACD;;;gCACWpoB,I,EACZ;AACE,UAAIooB,SAAS,IAAb;AACA,WAAKvF,UAAL,CAAgB3Z,gBAAhB,CAAiC,WAAjC,EAA8C,UAASsa,GAAT,EAAa;AACzD4E,eAAOja,QAAP,GAAkB,IAAI1X,QAAQ+U,MAAZ,CAAmBgY,IAAIlb,OAAvB,EAAgCkb,IAAI/a,OAApC,CAAlB;AACAzI,aAAKyiB,IAAL,CAAU2F,MAAV,EAAkBA,OAAOja,QAAP,CAAgBnW,CAAlC,EAAqCowB,OAAOja,QAAP,CAAgBzU,CAArD;AACD,OAHD;AAIA,aAAO,IAAP;AACD;;;+BACUsG,I,EACX;AACE,UAAIooB,SAAS,IAAb;AACA,WAAKvF,UAAL,CAAgB3Z,gBAAhB,CAAiC,UAAjC,EAA6C,UAASsa,GAAT,EAAa;AACxD4E,eAAOja,QAAP,GAAkB,IAAI1X,QAAQ+U,MAAZ,CAAmBgY,IAAIlb,OAAvB,EAAgCkb,IAAI/a,OAApC,CAAlB;AACAzI,aAAKyiB,IAAL,CAAU2F,MAAV,EAAkBpoB,IAAlB,CAAuBooB,OAAOja,QAAP,CAAgBnW,CAAvC,EAA0CowB,OAAOja,QAAP,CAAgBzU,CAA1D;AACD,OAHD;AAIA,aAAO,IAAP;AACD;;;gCAEWsG,I,EACZ;AACE,UAAIooB,SAAS,IAAb;AACA,WAAKvF,UAAL,CAAgB3Z,gBAAhB,CAAiC,OAAjC,EAA0C,UAASsa,GAAT,EAAa;AACrDA,cAAMA,OAAOhc,OAAOK,KAApB;AACA,YAAG2b,IAAIna,KAAJ,IAAa,CAAhB,EACA,CAAC,YAAU;AACT+e,iBAAOja,QAAP,GAAkB,IAAI1X,QAAQ+U,MAAZ,CAAmBgY,IAAIlb,OAAvB,EAAgCkb,IAAI/a,OAApC,CAAlB;AACAzI,eAAKyiB,IAAL,CAAU2F,MAAV,EAAkBA,OAAOja,QAAP,CAAgBnW,CAAlC,EAAqCowB,OAAOja,QAAP,CAAgBzU,CAArD;AACD,SAHD;AAID,OAPD;AAQD;;;iCACYsG,I,EACb;AACE,UAAIooB,SAAS,IAAb;AACA,WAAKvF,UAAL,CAAgB3Z,gBAAhB,CAAiC,aAAjC,EAAgD,UAASsa,GAAT,EAAa;;AAE3D,SAAC,YAAU;AACT4E,iBAAOja,QAAP,GAAkB,IAAI1X,QAAQ+U,MAAZ,CAAmBgY,IAAIlb,OAAvB,EAAgCkb,IAAI/a,OAApC,CAAlB;AACAzI,eAAKyiB,IAAL,CAAU2F,MAAV,EAAkBA,OAAOja,QAAP,CAAgBnW,CAAlC,EAAqCowB,OAAOja,QAAP,CAAgBzU,CAArD;AACD,SAHD;;AAKA8pB,YAAIla,cAAJ;;AAEA,eAAO,KAAP;AAED,OAXD;AAYD;;;iCACYtJ,I,EAAK;;AAEhB,UAAIooB,SAAS,IAAb;;AAEA5gB,aAAO0B,gBAAP,CAAwB,OAAxB,EAAiC,iBAAS;AACtC,YAAMmf,QAAQ9qB,KAAK+qB,IAAL,CAAUzgB,MAAM0gB,MAAhB,CAAd;AACAvoB,aAAKyiB,IAAL,CAAU2F,MAAV,EAAkBvgB,MAAM0gB,MAAxB;AACH,OAHD;AAKD;;;mCACcvoB,I,EACf;AACE,UAAIooB,SAAS,IAAb;AACA,WAAKvF,UAAL,CAAgB3Z,gBAAhB,CAAiC,OAAjC,EAA0C,UAASsa,GAAT,EAAa;AACrDA,cAAMA,OAAOhc,OAAOK,KAApB;AACA,YAAG2b,IAAIna,KAAJ,IAAa,CAAhB,EACA,CAAC,YAAU;AACT+e,iBAAOja,QAAP,GAAkB,IAAI1X,QAAQ+U,MAAZ,CAAmBgY,IAAIlb,OAAvB,EAAgCkb,IAAI/a,OAApC,CAAlB;AACAzI,eAAKyiB,IAAL,CAAU2F,MAAV,EAAkBA,OAAOja,QAAP,CAAgBnW,CAAlC,EAAqCowB,OAAOja,QAAP,CAAgBzU,CAArD;AACD,SAHD;AAID,OAPD;AAQD;;;;;;AACF;;AAEDjD,QAAQqP,KAAR,GAAgBA,KAAhB;AACA;AACA,CAAC,YAAU;AAAA,MAEH0iB,eAFG;AAIP,6BAAY/G,MAAZ,EAAoBzpB,CAApB,EAAuB0B,CAAvB,EAAyB;AAAA;;AACvB,WAAK+nB,MAAL,GAAcA,MAAd;AACA,WAAKzpB,CAAL,GAASA,CAAT;AACA,WAAK0B,CAAL,GAASA,CAAT;;AAEA,WAAKgpB,GAAL,GAAW,KAAKjB,MAAL,CAAYS,UAAZ,CAAuB,IAAvB,CAAX;AACD;;AAVM;AAAA;AAAA,2BAWFQ,GAXE,EAYP;AACEA,YAAIkC,IAAJ,CAAS,KAAKnD,MAAd,EAAsB,KAAKzpB,CAA3B,EAA8B,KAAK0B,CAAnC;AACD;AAdM;;AAAA;AAAA;;AAkBTjD,UAAQ+xB,eAAR,GAA0BA,eAA1B;AAGD,CArBD;AAsBA;AACA,IAAIC,QAAQ;AACVC,iCADU,2CACsB/pB,MADtB,EAC8BgqB,KAD9B,EACqCC,OADrC,EAC6C;AACrD,QAAIC,aAAa,SAAbA,UAAa,CAAC/wB,IAAD,EAAU;AACzBA,WAAKgxB,SAAL,GAAiB,UAAS/qB,CAAT,EAAW;AAAE,YAAG,KAAKgE,OAAL,CAAahE,CAAb,KAAkB,CAArB,EAAuB;AAAC,eAAKC,IAAL,CAAUD,CAAV;AAAa;AAAE,OAArE;AACA,aAAOjG,IAAP;AACD,KAHD;AAIA6G,WAAOoqB,QAAP,GAAkBpqB,OAAOoqB,QAAP,IAAmB,EAArC;AACApqB,WAAOoqB,QAAP,GAAkBF,WAAWlqB,OAAOoqB,QAAlB,CAAlB;AACAJ,UAAMhqB,MAAN,GAAeA,MAAf;AACAA,WAAOoqB,QAAP,CAAgBD,SAAhB,CAA0BH,KAA1B;AACD;AAVS,CAAZ;;AAcAlyB,QAAQgyB,KAAR,GAAgBA,KAAhB;AACAhyB,QAAQuyB,cAAR,GAAyBP,KAAzB;AACAhyB,QAAQwyB,IAAR,GAAeR,KAAf;AACA;;AAEA;;;;;;;;IAQMS,S;AACF,qBAAYC,EAAZ,EAAgBC,EAAhB,EAAoBC,EAApB,EAAwBC,EAAxB,EAA4B;AAAA;;AAC1B,SAAKC,GAAL,CAASJ,EAAT,EAAaC,EAAb;AACA,SAAKI,GAAL,CAASH,EAAT,EAAaC,EAAb;AACD;;;;wBACGtxB,C,EAAG0B,C,EACP;AACE,WAAK3C,GAAL,GAAW,IAAIN,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,CAAX;AACA,aAAO,IAAP;AACD;;;wBACG1B,C,EAAG0B,C,EACP;AACE,WAAK1C,GAAL,GAAW,IAAIP,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,CAAX;AACA,aAAO,IAAP;AACD;;;;;;AAEL;;AAIA,IAAI+vB,eAAeP,SAAnB;;AAEAzyB,QAAQgzB,YAAR,GAAsBA,YAAtB;;AAEAhzB,QAAQyyB,SAAR,GAAoBA,SAApB;;AAEA;;;;;;;;;;;IAWMQ,iB,GACF,2BAAY3yB,GAAZ,EAAiBC,GAAjB,EAAsB2yB,SAAtB,EAAiC;AAAA;;AAC7B,OAAK5yB,GAAL,GAAWA,GAAX;AACA,OAAKC,GAAL,GAAWA,GAAX;AACA,OAAK2yB,SAAL,GAAiBA,aAAa,IAAIlzB,QAAQ+U,MAAZ,CAAmB,KAAKxU,GAAL,CAASgB,CAA5B,EAA+B,KAAKhB,GAAL,CAAS0C,CAAxC,EAA2C,KAAK1C,GAAL,CAASkX,CAApD,CAA9B;AACH,C;;AAEL;;AAEAzX,QAAQizB,iBAAR,GAA4BA,iBAA5B;;AAGA,IAAIE,UAAU;;AAENC,kBAAe,wBAAS7xB,CAAT,EAAW0B,CAAX,EAAaowB,KAAb,EAAoB;;AAE/B,QAAIC,QAAQD,QAAMvsB,KAAK+Q,EAAX,GAAc,GAA1B;;AAEA,QAAI0b,QAAQ,EAAZ;AACAA,UAAMhyB,CAAN,GAAUA,IAAIuF,KAAKqR,GAAL,CAASmb,KAAT,CAAJ,GAAsBrwB,IAAI6D,KAAKsR,GAAL,CAASkb,KAAT,CAApC;AACAC,UAAMtwB,CAAN,GAAU1B,IAAIuF,KAAKsR,GAAL,CAASkb,KAAT,CAAJ,GAAsBrwB,IAAI6D,KAAKqR,GAAL,CAASmb,KAAT,CAApC;;AAEAC,UAAM9b,CAAN,GAAU,CAAV;;AAEA,WAAO8b,KAAP;AACH;;AAbK,CAAd;;AAiBAvzB,QAAQmzB,OAAR,GAAkBA,OAAlB;AACA,C,CAAC;;;;;;IAMKK,U,GACJ,sBAAuB;AACrB;;AADqB,MAAXlrB,IAAW,uEAAJ,EAAI;;AAAA;AAEtB,C;;AAIH;;;;;;IAMMmrB,S;;;AAEJ,uBAEG;AAAA,QAFSxgB,GAET,uEAFe,EAEf;AAAA,QAFmBygB,QAEnB,uEAF8B,YAAW;AAC1CC,QAAE,mCAAF;AACD,KAAE;;AAAA;;AAAA,sHAEK1gB,GAFL;;AAID,QAAI,QAAOA,GAAP,yCAAOA,GAAP,MAAc,QAAd,IAA0B,EAAEA,eAAe+a,iBAAjB,CAA9B,EAAmE;AAAA;;AACjE,oBAAO/a,GAAP;AACD;;AAED,QAAI,OAAOA,GAAP,IAAc,QAAlB,EAA4B;AAC1B,YAAKmZ,UAAL,GAAkB/nB,SAASgnB,aAAT,CAAuB,KAAvB,CAAlB;AACA,YAAKe,UAAL,CAAgBnZ,GAAhB,GAAsBA,GAAtB;AACD,KAHD,MAGO,IAAIA,eAAe+a,iBAAnB,EAAsC;AAC3C,YAAK5B,UAAL,GAAkBnZ,GAAlB;AACD;;AAGD,UAAKmZ,UAAL,CAAgBF,OAAhB,GAA0B,YAAW;AACnC,WAAK0H,OAAL,GAAe,IAAf;AACA;AACD,KAHD;;AAhBC;AAqBF;;;EAzBqBJ,U;;AA0BvB;;AAEDxzB,QAAQyzB,SAAR,GAAoBA,SAApB;AACA;;IAGMI,M;AAEJ,kBAAYhD,GAAZ,EAAiBhrB,QAAjB,EAA0B;AAAA;;AAExB,SAAKoN,GAAL,GAAW4d,OAAO,EAAlB;;AAEA,QAAGA,OAAOhrB,QAAV,EACA;AACA,WAAKirB,IAAL,CAAUD,GAAV,EAAehrB,QAAf;AACC,KAHD,MAII;AACFhG,cAAQY,IAAR,CAAa,mGAAb;AACD;AAEF;;;;yBAEIowB,G,EAAKhrB,Q,EAAS;;AAEjB,UAAIurB,WAAW,IAAf;;AAEAvrB,iBAAWA,YAAY,YAAU,CAAE,CAAnC;;AAEAA,eAASmmB,IAAT,CAAc,IAAd;;AAEA,UAAIhV,SAAS3S,SAASgnB,aAAT,CAAuB,QAAvB,CAAb;AACArU,aAAO/D,GAAP,GAAa4d,GAAb;;AAEA;AACA7Z,aAAOka,MAAP,GAAgB,YAAU;;AAExB,YAAIM,YAAY7tB,OAAO4H,OAAvB;AACA1F,iBAAS2rB,SAAT;AAED,OALD;;AAOA;AACAntB,eAASotB,IAAT,CAAcf,WAAd,CAA0B1Z,MAA1B;AAED;;;;;;AAEF;;AAEDhX,QAAQ6zB,MAAR,GAAiBA,MAAjB;;IAGMC,U;AAEJ,sBAAYvwB,MAAZ,EAAoBwwB,QAApB,EAA6B;AAAA;;AAE3B,SAAKxwB,MAAL,GAAcA,MAAd;;AAEA,SAAKwwB,QAAL,GAAgBA,QAAhB;AAED;;;;2BAEMxwB,M,EACP;AACE,WAAKA,MAAL,GAAcA,MAAd;AACA,aAAO,IAAP;AACD;;;yBAGIywB,G,EAAKnuB,Q,EAAS;;AAEjB,UAAIurB,WAAW,IAAf;;AAEAvrB,iBAAWA,YAAY,YAAU,CAAE,CAAnC;;AAEAA,iBAAWA,SAASmmB,IAAT,CAAc,IAAd,CAAX;;AAEA,UAAIhV,SAAS3S,SAASgnB,aAAT,CAAuB,QAAvB,CAAb;AACArU,aAAO/D,GAAP,GAAa+gB,GAAb;;AAEA;AACAhd,aAAOka,MAAP,GAAgB,YAAU;;AAExB,YAAIM,YAAYzgB,OAAOpN,MAAP,CAAc4H,OAA9B;;AAEA,YAAI0oB,MAAMzC,UAAUJ,SAAS7tB,MAAnB,EAA2B6tB,SAAS2C,QAApC,CAAV;;AAEAluB,iBAASmmB,IAAT,CAAcoF,QAAd,EAAwB7nB,IAAxB,CAA6B0qB,GAA7B,EAAkC7C,SAAS7tB,MAA3C,EAAmD6tB,SAAS2C,QAA5D;AACD,OAPD;;AASA;AACA1vB,eAASotB,IAAT,CAAcf,WAAd,CAA0B1Z,MAA1B;AAED;;;;;;AAEF;;AAEDhX,QAAQ8zB,UAAR,GAAqBA,UAArB;AACA;;IAIMI,K,GACJ,eAAY3yB,CAAZ,EAAe0B,CAAf,EAAkBwpB,CAAlB,EAAqBC,CAArB,EAAuB;AAAA;;AACrB,OAAK5X,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmB0X,CAAnB,EAAsBC,CAAtB,CAAZ;AACA,OAAKnrB,CAAL,GAASA,CAAT;AACA,OAAK0B,CAAL,GAASA,CAAT;AACD,C;;IAIGkxB,U;AAEJ,sBAAYC,MAAZ,EAAoBV,QAApB,EAA6B;AAAA;;AAEzBA,eAAWA,YAAY,YAAU,CAAE,CAAnC;;AAEA,QAAIrH,QAAQ,IAAZ;;AAEA+H,aAASA,UAAU,EAAnB;;AAEA,SAAKA,MAAL,GAAc,EAAd;;AAEA,SAAK9tB,EAAL,GAAUtG,QAAQ4G,SAAR,EAAV;;AAEA,QAAIytB,UAAU,IAAd;;AAEAD,WAAOhvB,OAAP,CAAe,UAASkvB,CAAT,EAAW;;AAExBD,cAAQD,MAAR,CAAe7sB,IAAf,CAAoB+sB,CAApB;AAED,KAJD;;AAMAZ,aAAS1H,IAAT,CAAc,IAAd,EAAoBziB,IAApB;AACH;;;;0BAEKhG,M,EAAO;AACX,UAAGA,OAAO6wB,MAAP,YAAyBlzB,KAA5B,EACA,OAAO,IAAIlB,QAAQm0B,UAAZ,CAAuB5wB,OAAO6wB,MAA9B,CAAP,CADA,KAGA,OAAOv0B,QAAQQ,KAAR,CAAc,uCAAd,CAAP;AACD;;;yBAEIgF,I,EAAK;AACR,WAAK+uB,MAAL,CAAY7sB,IAAZ,CAAiBlC,IAAjB;AACD;;;wBACGA,I,EACJ;AACE,WAAK+uB,MAAL,CAAY7sB,IAAZ,CAAiBlC,IAAjB;AACD;;;6BAEQ6O,I,EACT;AACE,UAAIqgB,WAAW/oB,KAAK2I,KAAL,CAAW3I,KAAKC,SAAL,CAAeyI,IAAf,CAAX,CAAf;AACA,aAAO,IAAIigB,UAAJ,CAAeI,SAASH,MAAxB,CAAP;AACD;;;;;;AAGHp0B,QAAQk0B,KAAR,GAAgBA,KAAhB;AACAl0B,QAAQm0B,UAAR,GAAqBA,UAArB;AACA;;AAEA,IAAIK,eAAe;;AAEjBC,kBAAe,wBAASC,EAAT,EAAaC,EAAb,EAAiBpzB,CAAjB,EAAoB0B,CAApB,EAAuBowB,KAAvB,EAA8B;AACzC,QAAI1b,UAAW7Q,KAAK+Q,EAAL,GAAU,GAAX,GAAkBwb,KAAhC;AAAA,QACIlb,MAAMrR,KAAKqR,GAAL,CAASR,OAAT,CADV;AAAA,QAEIS,MAAMtR,KAAKsR,GAAL,CAAST,OAAT,CAFV;AAAA,QAGIid,KAAMzc,OAAO5W,IAAImzB,EAAX,CAAD,GAAoBtc,OAAOnV,IAAI0xB,EAAX,CAApB,GAAsCD,EAH/C;AAAA,QAIIG,KAAM1c,OAAOlV,IAAI0xB,EAAX,CAAD,GAAoBvc,OAAO7W,IAAImzB,EAAX,CAApB,GAAsCC,EAJ/C;AAKA,WAAO,IAAI30B,QAAQ+U,MAAZ,CAAmB6f,EAAnB,EAAuBC,EAAvB,CAAP;AACH,GATgB;;AAWjBC,oBAAiB,0BAASzB,KAAT,EAAgB3jB,KAAhB,EAAsB;AACrC;AACA,QAAIiI,UAAW0b,QAAQ,GAAT,GAAgBvsB,KAAK+Q,EAArB,GAA0B,GAAxC;AACA,WAAO,IAAI7X,QAAQ+U,MAAZ,CAAmBjO,KAAKqR,GAAL,CAASR,OAAT,IAAoBjI,KAAvC,EAA8C5I,KAAKsR,GAAL,CAAST,OAAT,IAAoBjI,KAAlE,CAAP;AACD,GAfgB;;AAiBjBqlB,wBAAqB,8BAASxzB,CAAT,EAAY0B,CAAZ,EAAe6U,MAAf,EAAuBF,OAAvB,EAA+B,CAEnD;AAnBgB,CAAnB;;AAuBA5X,QAAQg1B,IAAR,GAAeR,YAAf;AACAx0B,QAAQw0B,YAAR,GAAuBA,YAAvB;AACA;;AAGE,IAAIS,eAAe;;AAEjBjN,aAAW,mBAASpN,CAAT,EAAY;AACrB,WAAOA,IAAI,EAAJ,GAAS,IAAIA,CAAJ,GAAQA,CAAjB,GAAqB,CAAC,CAAD,GAAK,CAAC,IAAI,IAAIA,CAAT,IAAcA,CAA/C;AACD,GAJgB;;AAMjBqN,SAAO,eAASrN,CAAT,EAAY;AACjB,WAAOA,IAAI,EAAJ,GAAS,IAAIA,CAAJ,GAAQA,CAAR,GAAYA,CAArB,GAAyB,CAACA,IAAI,CAAL,KAAW,IAAIA,CAAJ,GAAQ,CAAnB,KAAyB,IAAIA,CAAJ,GAAQ,CAAjC,IAAsC,CAAtE;AACD,GARgB;;AAUjBsN,WAAS,iBAAStN,CAAT,EAAY;AACnB,WAAOA,IAAI,EAAJ,GAAS,IAAIA,CAAJ,GAAQA,CAAR,GAAYA,CAAZ,GAAgBA,CAAzB,GAA6B,IAAI,IAAK,EAAEA,CAAP,GAAYA,CAAZ,GAAgBA,CAAhB,GAAoBA,CAA5D;AACD,GAZgB;;AAcjBuN,WAAS,iBAASvN,CAAT,EAAY;AACnB,WAAOA,IAAI,EAAJ,GAAS,KAAKA,CAAL,GAASA,CAAT,GAAaA,CAAb,GAAiBA,CAAjB,GAAqBA,CAA9B,GAAkC,IAAI,KAAM,EAAEA,CAAR,GAAaA,CAAb,GAAiBA,CAAjB,GAAqBA,CAArB,GAAyBA,CAAtE;AACD,GAhBgB;;AAkBjBwN,UAAQ,gBAASxN,CAAT,EAAY;AAClB,WAAOA,CAAP;AACD,GApBgB,CAoBf;;AApBe,CAAnB;;AAyBF,IAAIwO,OAAO;;AAETpC,UAAO;AACL;AACE;AACAkO,YAAQ;AACN7L,YAAM,cAASzO,CAAT,EAAY;AAChB,eAAOA,CAAP;AACD;AAHK,KAHL;;AASHua,eAAW;AACT7L,UAAI,YAAS1O,CAAT,EAAY;AACd,eAAOA,IAAIA,CAAX;AACD,OAHQ;AAITwa,WAAK,aAASxa,CAAT,EAAY;AACf,eAAOA,KAAK,IAAIA,CAAT,CAAP;AACD,OANQ;AAOTya,gBAAU,kBAASza,CAAT,EAAY;AACpB,eAAOA,IAAI,EAAJ,GAAS,IAAIA,CAAJ,GAAQA,CAAjB,GAAqB,CAAC,CAAD,GAAK,CAAC,IAAI,IAAIA,CAAT,IAAcA,CAA/C;AACD;AATQ,KATR;;AAqBH0a,WAAO;AACLhM,UAAI,YAAS1O,CAAT,EAAY;AACd,eAAOA,IAAIA,CAAJ,GAAQA,CAAf;AACD,OAHI;AAILwa,WAAK,aAASxa,CAAT,EAAY;AACf,eAAQ,EAAEA,CAAH,GAAQA,CAAR,GAAYA,CAAZ,GAAgB,CAAvB;AACD,OANI;AAOLya,gBAAU,kBAASza,CAAT,EAAY;AACpB,eAAOA,IAAI,EAAJ,GAAS,IAAIA,CAAJ,GAAQA,CAAR,GAAYA,CAArB,GAAyB,CAACA,IAAI,CAAL,KAAW,IAAIA,CAAJ,GAAQ,CAAnB,KAAyB,IAAIA,CAAJ,GAAQ,CAAjC,IAAsC,CAAtE;AACD;AATI,KArBJ;;AAiCH2a,aAAS;AACPjM,UAAI,YAAS1O,CAAT,EAAY;AAAE,eAAOA,IAAIA,CAAJ,GAAQA,CAAR,GAAYA,CAAnB;AAAuB,OADlC;AAEPwa,WAAK,aAASxa,CAAT,EAAY;AAAE,eAAO,IAAK,EAAEA,CAAH,GAAQA,CAAR,GAAYA,CAAZ,GAAgBA,CAA3B;AAA+B,OAF3C;AAGPya,gBAAU,kBAASza,CAAT,EAAY;AAAE,eAAOA,IAAI,EAAJ,GAAS,IAAIA,CAAJ,GAAQA,CAAR,GAAYA,CAAZ,GAAgBA,CAAzB,GAA6B,IAAI,IAAK,EAAEA,CAAP,GAAYA,CAAZ,GAAgBA,CAAhB,GAAoBA,CAA5D;AAAgE;AAHjF,KAjCN;;AAuCH4a,aAAS;AACPlM,UAAI,YAAS1O,CAAT,EAAY;AAAE,eAAOA,IAAIA,CAAJ,GAAQA,CAAR,GAAYA,CAAZ,GAAgBA,CAAvB;AAA2B,OADtC;AAEPwa,WAAK,aAASxa,CAAT,EAAY;AAAE,eAAO,IAAK,EAAEA,CAAH,GAAQA,CAAR,GAAYA,CAAZ,GAAgBA,CAAhB,GAAoBA,CAA/B;AAAmC,OAF/C;AAGPya,gBAAU,kBAASza,CAAT,EAAY;AAAE,eAAOA,IAAI,EAAJ,GAAS,KAAKA,CAAL,GAASA,CAAT,GAAaA,CAAb,GAAiBA,CAAjB,GAAqBA,CAA9B,GAAkC,IAAI,KAAM,EAAEA,CAAR,GAAaA,CAAb,GAAiBA,CAAjB,GAAqBA,CAArB,GAAyBA,CAAtE;AAA0E;AAH3F;AAvCN,GAFE;;AAgDT6a,gBAAaR;;AAhDJ,CAAX;;AAsDA,IAAMS,eAAe,EAArB;;AAEAA,aAAaC,WAAb,GAA2B,UAAChjB,KAAD,EAAQijB,KAAR,EAAet1B,GAAf,EAAoBC,GAApB,EAA4B,CAEtD,CAFD;;AAIAm1B,aAAaG,KAAb,GAAqB,UAACljB,KAAD,EAAQijB,KAAR,EAAet1B,GAAf,EAAoBC,GAApB,EAA4B,CAEhD,CAFD;;AAKA,IAAMu1B,gBAAgB,EAAtB;;AAEAA,cAAcC,IAAd,GAAqB,EAArB;;AAEAD,cAAcE,MAAd,GAAuB,EAAvB;;AAEAF,cAAcG,OAAd,GAAwB,EAAxB;;AAGA,IAAMC,mBAAmB,EAAzB;;AAEAA,iBAAiBC,QAAjB,GAA4B,UAACvb,CAAD,EAAO;AAAE,SAAOA,KAAK,GAAL,GAAWA,CAAX,GAAe,CAAtB;AAA0B,CAA/D;;AAEAsb,iBAAiBE,MAAjB,GAA0B,YAAM,CAAE,CAAlC;;AAEAF,iBAAiBG,QAAjB,GAA4B,YAAM,CAAE,CAApC;;AAEAH,iBAAiBI,KAAjB,GAAyB,YAAM,CAAE,CAAjC;;AAEAJ,iBAAiBK,IAAjB,GAAwB,YAAM,CAAE,CAAhC;;AAEAv2B,QAAQw2B,IAAR,GAAex2B,QAAQw2B,IAAR,IAAgB,EAA/B;;AAEAx2B,QAAQw2B,IAAR,CAAaC,WAAb,GAA2B,EAA3B;;AAEAz2B,QAAQw2B,IAAR,CAAaC,WAAb,CAAyBP,gBAAzB,GAA4CA,gBAA5C;;AAIA,IAAMQ,iBAAiB,EAAvB;;AAEA,IAAMC,iBAAiB,EAAvB;AACA,CAAC,CAAC,YAAW;AACX92B,UAAQC,GAAR,CAAY,0BAAZ;;AAEA;;;;;;;;;AAUF,WAAS82B,gBAAT,CAA0Br1B,CAA1B,EAA6B0B,CAA7B,EAAgCwU,CAAhC,EACA;AACE,WAAO,OAAOlW,CAAP,IAAY,QAAZ,IAAwB0B,KAAKylB,SAA7B,IAA0CjR,KAAKiR,SAAtD;AACD;;AAhBY,MAmBL3T,MAnBK;AAoBT,oBAAYxT,CAAZ,EAAe0B,CAAf,EAAkBwU,CAAlB,EAAqBM,CAArB,EAAwB;AAAA;;AAEtB,UAAI8e,SAAS,KAAb;;AAEA,UAAI,QAAOt1B,CAAP,yCAAOA,CAAP,MAAa,QAAb,IAAyBA,EAAEK,cAAF,CAAiB,GAAjB,CAAzB,IAAkDL,EAAEK,cAAF,CAAiB,GAAjB,CAAtD,EAA6E;AAC7E;AACE,eAAKL,CAAL,GAASA,EAAEA,CAAX;AACA,eAAK0B,CAAL,GAAS1B,EAAE0B,CAAX;AACA,eAAKwU,CAAL,GAASlW,EAAEkW,CAAF,IAAO,CAAhB;;AAEA,cAAI,KAAKA,CAAL,IAAU,IAAd,EAAoB;AAClB,iBAAKA,CAAL,GAAS,CAAT;AACD;;AAED,eAAKqf,WAAL;;AAEAD,mBAAS,IAAT;AACD;;AAED,UAAI,CAACA,MAAL,EAAa;;AAEX,YAAGD,iBAAiBr1B,CAAjB,EAAoB0B,CAApB,EAAuBwU,CAAvB,CAAH,EACA;AACE,eAAKlW,CAAL,GAASA,CAAT;AACA,eAAK0B,CAAL,GAAS1B,CAAT;AACA,eAAKkW,CAAL,GAASlW,CAAT;AACD,SALD,MAMI;AACF,cAAIkW,KAAK,IAAT,EAAe;AACbA,gBAAI,CAAJ;AACD;;AAEO,eAAKlW,CAAL,GAASA,CAAT;AACA,eAAK0B,CAAL,GAASA,CAAT;AACA,eAAKwU,CAAL,GAASA,CAAT;AACA,eAAKM,CAAL,GAASA,CAAT;AACT;;AAED,aAAK+e,WAAL;AACD;AACF;;AA5DQ;AAAA;AAAA,oCA8DK;AACZ,YAAI,KAAKv1B,CAAL,IAAUmnB,SAAd,EAAyB;AACvB,eAAKnnB,CAAL,GAAS,CAAT;AACD;AACD,YAAI,KAAK0B,CAAL,IAAUylB,SAAd,EAAyB;AACvB,eAAKzlB,CAAL,GAAS,CAAT;AACD;AACD,YAAI,KAAKwU,CAAL,IAAUiR,SAAd,EAAyB;AACvB,eAAKjR,CAAL,GAAS,CAAT;AACD;AACF;;AAED;;;;;;;;AA1ES;AAAA;AAAA,0BAkFLlW,CAlFK,EAkFF0B,CAlFE,EAkFCwU,CAlFD,EAkFI;AACX,YAAI6c,IAAI,IAAIt0B,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAAR;AACA,eAAO,IAAIzX,QAAQ+U,MAAZ,CAAmB,KAAKxT,CAAL,GAAS+yB,EAAE/yB,CAA9B,EAAiC,KAAK0B,CAAL,GAASqxB,EAAErxB,CAA5C,EAA+C,KAAKwU,CAAL,GAAS6c,EAAE7c,CAA1D,CAAP;AACD;;AAED;;;;;;;;AAvFS;AAAA;AAAA,0BA+FLlW,CA/FK,EA+FF0B,CA/FE,EA+FCwU,CA/FD,EA+FI;AACX,YAAI6c,IAAI,IAAIt0B,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAAR;AACA,eAAO,IAAIzX,QAAQ+U,MAAZ,CAAmB,KAAKxT,CAAL,GAAS+yB,EAAE/yB,CAA9B,EAAiC,KAAK0B,CAAL,GAASqxB,EAAErxB,CAA5C,EAA+C,KAAKwU,CAAL,GAAS6c,EAAE7c,CAA1D,CAAP;AACD;;AAED;;;;;;;;AApGS;AAAA;AAAA,2BA4GJlW,CA5GI,EA4GD0B,CA5GC,EA4GEwU,CA5GF,EA4GK;AACZ,YAAI6c,IAAI,IAAIt0B,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAAR;AACA,eAAO,IAAIzX,QAAQ+U,MAAZ,CAAmB,KAAKxT,CAAL,GAAS+yB,EAAE/yB,CAA9B,EAAiC,KAAK0B,CAAL,GAASqxB,EAAErxB,CAA5C,EAA+C,KAAKwU,CAAL,GAAS6c,EAAE7c,CAA1D,CAAP;AACD;;AAED;;;;;;;;AAjHS;AAAA;AAAA,4BAyHH;AACJ,eAAO,IAAIzX,QAAQ+U,MAAZ,CAAmBjO,KAAK+U,GAAL,CAAS,KAAKta,CAAd,CAAnB,EAAqCuF,KAAK+U,GAAL,CAAS,KAAK5Y,CAAd,CAArC,EAAuD6D,KAAK+U,GAAL,CAAS,KAAKpE,CAAd,CAAvD,CAAP;AACD;;AAED;;;;;;;;AA7HS;AAAA;AAAA,0BAqILlW,CArIK,EAqIF0B,CArIE,EAqICwU,CArID,EAqII;AACX,YAAI6c,IAAI,IAAIt0B,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAAR;AACA,eAAO,IAAIzX,QAAQ+U,MAAZ,CAAmB,KAAKxT,CAAL,GAAS+yB,EAAE/yB,CAA9B,EAAiC,KAAK0B,CAAL,GAASqxB,EAAErxB,CAA5C,EAA+C,KAAKwU,CAAL,GAAS6c,EAAE7c,CAA1D,CAAP;AACD;;AAED;;;;;;;;AA1IS;AAAA;AAAA,8BAkJW;AAAA,YAAdsf,QAAc,uEAAL,GAAK;;AAClB,YAAIlO,IAAIkO,QAAR;AACA,YAAGpwB,MAAMkiB,CAAN,KAAYA,IAAI,CAAnB,EACA;AACEA,cAAI,CAAJ;AACD;;AAED,YAAIpR,IAAI,CAAC9Q,MAAM,KAAK8Q,CAAX,CAAD,GAAiB,KAAKA,CAAtB,GAA0B,CAAlC;AACA,eAAO,IAAIzX,QAAQ+U,MAAZ,CAAmBjO,KAAKmO,KAAL,CAAW,KAAK1T,CAAL,GAASsnB,CAApB,IAAyBA,CAA5C,EAA+C/hB,KAAKmO,KAAL,CAAW,KAAKhS,CAAL,GAAS4lB,CAApB,IAAyBA,CAAxE,EAA2E/hB,KAAKmO,KAAL,CAAW,KAAKwC,CAAL,GAAUoR,CAArB,IAA0BA,CAArG,CAAP;AACD;;AAED;;;;;;;;AA7JS;AAAA;AAAA,8BAqKY;AAAA,YAAdkO,QAAc,uEAAL,GAAK;;AAClB,YAAIlO,IAAIkO,QAAR;AACA,YAAGpwB,MAAMkiB,CAAN,KAAYA,IAAI,CAAnB,EACA;AACEA,cAAI,CAAJ;AACD;;AAED,YAAIpR,IAAI,CAAC9Q,MAAM,KAAK8Q,CAAX,CAAD,GAAiB,KAAKA,CAAtB,GAA0B,CAAlC;AACA,eAAO,IAAIzX,QAAQ+U,MAAZ,CAAmBjO,KAAKkjB,KAAL,CAAW,KAAKzoB,CAAL,GAASsnB,CAApB,IAAyBA,CAA5C,EAA+C/hB,KAAKkjB,KAAL,CAAW,KAAK/mB,CAAL,GAAS4lB,CAApB,IAAyBA,CAAxE,EAA2E/hB,KAAKkjB,KAAL,CAAW,KAAKvS,CAAL,GAAUoR,CAArB,IAA0BA,CAArG,CAAP;AACD;;AAEF;;;;;;;;AAhLS;AAAA;AAAA,6BAwLW;AAAA,YAAdkO,QAAc,uEAAL,GAAK;;AACjB,YAAIlO,IAAIkO,QAAR;AACA,YAAGpwB,MAAMkiB,CAAN,KAAYA,IAAI,CAAnB,EACA;AACEA,cAAI,CAAJ;AACD;;AAED,YAAIpR,IAAI,CAAC9Q,MAAM,KAAK8Q,CAAX,CAAD,GAAiB,KAAKA,CAAtB,GAA0B,CAAlC;AACA,eAAO,IAAIzX,QAAQ+U,MAAZ,CAAmBjO,KAAKkwB,IAAL,CAAU,KAAKz1B,CAAL,GAASsnB,CAAnB,IAAwBA,CAA3C,EAA8C/hB,KAAKkwB,IAAL,CAAU,KAAK/zB,CAAL,GAAS4lB,CAAnB,IAAwBA,CAAtE,EAAyE/hB,KAAKkwB,IAAL,CAAU,KAAKvf,CAAL,GAAUoR,CAApB,IAAyBA,CAAlG,CAAP;AACD;AAjMO;AAAA;AAAA,sCAoMO;;AAEb,eAAO,KAAKtnB,CAAL,GAAS,CAAT,IAAc,KAAK0B,CAAL,GAAS,CAA9B;AAED;;AAEF;;;;;;;;AA1MS;AAAA;AAAA,4BAkNH;AACJ,eAAO,IAAIjD,QAAQ+U,MAAZ,CAAmB,CAAC,KAAKxT,CAAzB,EAA4B,CAAC,KAAK0B,CAAlC,EAAqC,CAAC,KAAKwU,CAA3C,CAAP;AACD;AApNQ;AAAA;AAAA,2BAsNJlW,CAtNI,EAsND0B,CAtNC,EAuNT;AAAA,YADWg0B,UACX,uEADsB,GACtB;;AACE,YAAIC,SAAJ;;AAEA,YAAG,QAAO31B,CAAP,yCAAOA,CAAP,MAAY,QAAZ,IAAwB,OAAO0B,CAAP,IAAY,QAAvC,EACA;AACEg0B,uBAAah0B,CAAb;AACAA,cAAIylB,SAAJ;AACAwO,sBAAY,IAAIl3B,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB41B,GAAtB,CAA0B,IAA1B,EAAgCC,IAAhC,CAAqCH,UAArC,CAAZ;AACD,SALD,MAMI;AACFC,sBAAY,IAAIl3B,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBk0B,GAAzB,CAA6B,IAA7B,EAAmCC,IAAnC,CAAwCH,UAAxC,CAAZ;AACD;AACD,eAAO,KAAKxiB,GAAL,CAASyiB,SAAT,CAAP;AACD;AApOQ;AAAA;AAAA,6BAsOH;AACJ,eAAO,KAAKxwB,GAAL,CAAS,CAAT,CAAP;AACD;;AAED;;;;;;;;AA1OS;AAAA;AAAA,6BAkPFnF,CAlPE,EAkPC0B,CAlPD,EAkPIwU,CAlPJ,EAkPO;AACd,YAAI6c,IAAI,IAAIt0B,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAAR;AACA,eAAO,KAAKlW,CAAL,IAAU+yB,EAAE/yB,CAAZ,IAAiB,KAAK0B,CAAL,IAAUqxB,EAAErxB,CAA7B,IAAkC,KAAKwU,CAAL,IAAU6c,EAAE7c,CAArD;AACD;;AAED;;;;;;;;AAvPS;AAAA;AAAA,+BA+PA6c,CA/PA,EA+PG;AACV,YAAI+C,OAAO,KAAKF,GAAL,CAAS7C,CAAT,CAAX;AACA,eAAOxtB,KAAKwR,IAAL,CAAU+e,KAAK91B,CAAL,GAAS81B,KAAK91B,CAAd,GAAkB81B,KAAKp0B,CAAL,GAASo0B,KAAKp0B,CAA1C,CAAP;AACD;AAlQQ;AAAA;AAAA,iCAqQEq0B,EArQF,EAqQMC,EArQN,EAqQU;AACjB;;AAEA,eAAO,KAAKh2B,CAAL,IAAU+1B,GAAG/1B,CAAb,IAAkB,KAAKA,CAAL,IAAUg2B,GAAGh2B,CAA/B,IACL,KAAK0B,CAAL,IAAUq0B,GAAGr0B,CADR,IACa,KAAKA,CAAL,IAAUs0B,GAAGt0B,CAD1B,IAEL,KAAKwU,CAAL,IAAU6f,GAAG7f,CAFR,IAEa,KAAKA,CAAL,IAAU8f,GAAG9f,CAFjC;AAGD;;AAED;;;;;;;;AA7QS;AAAA;AAAA,gCAqRC+f,QArRD,EAqRWC,QArRX,EAqRqB;AAC5B,YAAI1wB,SAAS,CAACD,KAAKC,MAAL,MAAiB0wB,WAAWD,QAA5B,IAAwCA,QAAzC,IAAqD,IAArD,GAA4D,IAAzE;AACA,eAAO,KAAKJ,IAAL,CAAUrwB,MAAV,CAAP;AACD;;AAED;;;;;;;;;;AA1RS;AAAA;AAAA,4CAoSa2wB,QApSb,EAoSuBhoB,KApSvB,EAoS8B;AACrC,YAAIqI,IAAI2f,QAAR;AACA,YAAI/wB,MAAM+I,KAAN,CAAJ,EAAkB;AAChBA,kBAAQ,CAAR;AACD;AACD,YAAI,QAAOgoB,QAAP,yCAAOA,QAAP,MAAoB,QAApB,IAAgCA,SAASn2B,CAA7C,EAAgD;AAC9CwW,cAAI2f,SAASn2B,CAAb;AACD;;AAED,eAAO,IAAIvB,QAAQ+U,MAAZ,CAAmBjO,KAAKqR,GAAL,CAAUJ,CAAD,GAAM,IAAN,GAAa,GAAtB,IAA6BrI,KAAhD,EAAuD5I,KAAKsR,GAAL,CAAUL,CAAD,GAAM,IAAN,GAAa,GAAtB,IAA6BrI,KAApF,CAAP;AACD;;AAED;;;;;;;;;AAhTS;AAAA;AAAA,mCA0TIioB,EA1TJ,EA0TQC,EA1TR,EA0TY;AACnB,eAAO9wB,KAAK+wB,KAAL,CAAWD,GAAG30B,CAAH,GAAO00B,GAAG10B,CAArB,EAAwB20B,GAAGr2B,CAAH,GAAOo2B,GAAGp2B,CAAlC,IAAuC,GAAvC,GAA6CuF,KAAK+Q,EAAzD;AACD;;AAED;;AA9TS;AAAA;AAAA,8BA+TD;;AAEN,iBAASigB,QAAT,CAAkBv0B,MAAlB,EAA0Bw0B,IAA1B,EAAgCC,IAAhC,EAAsC;AACpC,cAAIz0B,OAAOw0B,IAAP,IAAex0B,OAAOy0B,IAAP,CAAnB,EACEz0B,OAAOy0B,IAAP,IAAez0B,OAAOw0B,IAAP,CAAf;;AAEF,cAAIx0B,OAAOy0B,IAAP,IAAez0B,OAAOw0B,IAAP,CAAnB,EACEx0B,OAAOw0B,IAAP,IAAex0B,OAAOy0B,IAAP,CAAf;AACH;;AAEDF,iBAAS,IAAT,EAAe,GAAf,EAAoB,GAApB;;AAEA,eAAO,IAAP;AACD;;AAGD;;AA/US;AAAA;AAAA,8BAgVD;;AAEN,iBAASG,QAAT,CAAkB10B,MAAlB,EAA0Bw0B,IAA1B,EAAgCC,IAAhC,EAAsC;AACpC,cAAIz0B,OAAOw0B,IAAP,IAAex0B,OAAOy0B,IAAP,CAAnB,EACEz0B,OAAOy0B,IAAP,IAAez0B,OAAOw0B,IAAP,CAAf;;AAEF,cAAIx0B,OAAOy0B,IAAP,IAAez0B,OAAOw0B,IAAP,CAAnB,EACEx0B,OAAOw0B,IAAP,IAAex0B,OAAOy0B,IAAP,CAAf;AACH;;AAEDC,iBAAS,IAAT,EAAe,GAAf,EAAoB,GAApB;;AAEA,eAAO,IAAP;AACD;AA7VQ;;AAAA;AAAA;;AA+VV;;AAED,MAAIC,UAAUnjB,MAAd;AAAA,MACE+X,MAAM/X,MADR;AAAA,MAEE4W,OAAO5W,MAFT;AAAA,MAGEzF,WAAWyF,MAHb;AAAA,MAIEojB,UAAUpjB,MAJZ;AAAA,MAKEqjB,WAAWrjB,MALb;;AAOA/U,UAAQ+U,MAAR,GAAiBA,MAAjB;;AAEA;AACA/U,UAAQq4B,QAAR,GAAmBtjB,MAAnB;AACA/U,UAAQs4B,QAAR,GAAmBvjB,MAAnB;AACA/U,UAAQo4B,QAAR,GAAmBrjB,MAAnB;AACA/U,UAAQ8sB,GAAR,GAAc/X,MAAd;AACA/U,UAAQsP,QAAR,GAAmByF,MAAnB;AACA/U,UAAQ2rB,IAAR,GAAe5W,MAAf;;AAEA;;AAEA,MAAIwjB,aAAa;AAEfnF,kBAFe,0BAEA7xB,CAFA,EAEG0B,CAFH,EAEMowB,KAFN,EAEa;;AAE1B,UAAIC,QAAQD,QAAQvsB,KAAK+Q,EAAb,GAAkB,GAA9B;;AAEA,UAAI0b,QAAQ,EAAZ;AACAA,YAAMhyB,CAAN,GAAUA,IAAIuF,KAAKqR,GAAL,CAASmb,KAAT,CAAJ,GAAsBrwB,IAAI6D,KAAKsR,GAAL,CAASkb,KAAT,CAApC;AACAC,YAAMtwB,CAAN,GAAU1B,IAAIuF,KAAKsR,GAAL,CAASkb,KAAT,CAAJ,GAAsBrwB,IAAI6D,KAAKqR,GAAL,CAASmb,KAAT,CAApC;;AAEAC,YAAM9b,CAAN,GAAU,CAAV;;AAEA,aAAO,IAAIzX,QAAQ+U,MAAZ,CAAmBwe,MAAMhyB,CAAzB,EAA4BgyB,MAAMtwB,CAAlC,EAAqCswB,MAAM9b,CAA3C,CAAP;AACD;AAbc,GAAjB;;AAiBAzX,UAAQu4B,UAAR,GAAqBA,UAArB;AAED,CAvYA;AAwYD,CAAC,CAAC,YAAW;AACX14B,UAAQC,GAAR,CAAY,2BAAZ;;AADW,MAGLgvB,OAHK,GAKT,mBAAuB;;AAErB;;AAFqB,QAAXxmB,IAAW,uEAAJ,EAAI;;AAAA;AAItB,GATQ;;AAAA,MAYLkwB,cAZK;AAaT,4BAAY3yB,QAAZ,EAAsB;AAAA;;AACpBA,iBAAWA,YAAY,UAAStE,CAAT,EAAY0B,CAAZ,EAAe,CAAE,CAAxC;;AAEA,WAAKw1B,QAAL,CAAc5yB,QAAd;AACD;;AAjBQ;AAAA;AAAA,+BAkBA6yB,EAlBA,EAkBI;AACX14B,gBAAQwJ,WAAR,CAAoBkH,MAApB,CAA2B,WAA3B,EAAwC,UAASnP,CAAT,EAAY0B,CAAZ,EAAe;;AAErDy1B,aAAGn3B,CAAH,EAAM0B,CAAN;AAED,SAJD;AAKD;AAxBQ;;AAAA;AAAA;;AAyBV;;AAEDjD,UAAQw4B,cAAR,GAAyBA,cAAzB;;AA3BW,MA6BLG,aA7BK;AA8BT,2BAAY9yB,QAAZ,EAAsB;AAAA;;AACpBA,iBAAWA,YAAY,UAAStE,CAAT,EAAY0B,CAAZ,EAAe,CAAE,CAAxC;;AAEA,WAAKw1B,QAAL,CAAc5yB,QAAd;AACD;;AAlCQ;AAAA;AAAA,+BAmCA6yB,EAnCA,EAmCI;AACX14B,gBAAQwJ,WAAR,CAAoBkH,MAApB,CAA2B,UAA3B,EAAuC,UAASnP,CAAT,EAAY0B,CAAZ,EAAe;;AAEpDy1B,aAAGn3B,CAAH,EAAM0B,CAAN;AAED,SAJD;AAKD;AAzCQ;;AAAA;AAAA;;AA0CV;;AAEDjD,UAAQ24B,aAAR,GAAwBA,aAAxB;;AA5CW,MA8CLC,mBA9CK;AA+CT,iCAAY/yB,QAAZ,EAAsB;AAAA;;AACpBA,iBAAWA,YAAY,UAAStE,CAAT,EAAY0B,CAAZ,EAAe,CAAE,CAAxC;;AAEA,WAAKw1B,QAAL,CAAc5yB,QAAd;AACD;;AAnDQ;AAAA;AAAA,+BAoDA6yB,EApDA,EAoDI;;AAEX14B,gBAAQwJ,WAAR,CAAoBkH,MAApB,CAA2B,WAA3B,EAAwC,UAASnP,CAAT,EAAY0B,CAAZ,EAAe;;AAErDy1B,aAAGn3B,CAAH,EAAM0B,CAAN;AAED,SAJD;AAKD;AA3DQ;;AAAA;AAAA;;AA4DV;;AAEDjD,UAAQ44B,mBAAR,GAA8BA,mBAA9B;;AA9DW,MAgELC,oBAhEK;AAiET,kCAAYhzB,QAAZ,EAAsB;AAAA;;AACpBA,iBAAWA,YAAY,UAAStE,CAAT,EAAY0B,CAAZ,EAAe,CAAE,CAAxC;;AAEA,WAAKw1B,QAAL,CAAc5yB,QAAd;AACD;;AArEQ;AAAA;AAAA,+BAsEA6yB,EAtEA,EAsEI;;AAEX14B,gBAAQwJ,WAAR,CAAoBkH,MAApB,CAA2B,YAA3B,EAAyC,UAASnP,CAAT,EAAY0B,CAAZ,EAAe;;AAEtDy1B,aAAGn3B,CAAH,EAAM0B,CAAN;AAED,SAJD;AAKD;AA7EQ;;AAAA;AAAA;;AA8EV;;AAEDjD,UAAQ64B,oBAAR,GAA+BA,oBAA/B;;AAEA,WAAS5wB,WAAT,CAAqBL,cAArB,EAAqCC,WAArC,EAAkDC,QAAlD,EAA4DC,WAA5D,EAAyE;AACvE,SAAK+wB,SAAL,GAAiBlxB,eAAetB,EAAhC,EAEE,KAAKyyB,QAAL,GAAgBjxB,SAASxB,EAF3B,EAIE,KAAK0yB,UAAL,GAAkBnxB,WAJpB,EAME,KAAKoxB,SAAL,GAAiBlxB,WANnB;AAOD;;AAED;;;;;;;;;;;;;;;AA5FW,MA4GLmxB,UA5GK;AAAA;;AA6GT,wBAAY5wB,IAAZ,EAAkB;AAAA;;AAAA,2HACVA,IADU;;AAGhB,UAAI6wB,QAAQ7wB,KAAK6wB,KAAL,IAAc7wB,KAAK8wB,SAAnB,IAAgC,KAA5C;AAAA,UAEExzB,OAAO0C,KAAK1C,IAAL,IAAa0C,KAAK+wB,UAAlB,IAAgC,CAFzC;AAAA,UAIExzB,WAAWyC,KAAKzC,QAAL,IAAiB,YAAW,CAGtC,CAPH;;AASA,UAAIyzB,MAAMhxB,KAAKixB,OAAL,IAAgBjxB,KAAKgxB,GAArB,IAA4BhxB,KAAKkxB,QAAjC,IAA6C,KAAvD;;AAEA,UAAIC,WAAWH,QAAQ,KAAR,GAAgB,WAAWA,GAA3B,GAAiCH,UAAU,KAAV,GAAkB,YAAYA,KAA9B,GAAsC,KAAtF;;AAEA;;AAEA,UAAIO,eAAel5B,SAASQ,SAAT,CAAmBsH,KAAKvF,IAAL,IAAa,EAAhC,CAAnB;;AAEA;;AAEA,UAAI22B,wBAAwBx4B,KAA5B,EAAmC;;AAEjClB,gBAAQwI,IAAR,CAAakxB,YAAb,EAA2B,UAAS/0B,EAAT,EAAag1B,OAAb,EAAsB;;AAE/C35B,kBAAQwJ,WAAR,CAAoB+G,SAApB,CAA8B,SAASopB,QAAQ5vB,WAAR,EAAvC,EAA8D,YAAW;;AAEvElE,qBAAS8zB,QAAQ5vB,WAAR,EAAT;AAED,WAJD;AAKD,SAPD;AAQD;;AAED,UAAI0vB,YAAY7zB,QAAQ,CAAxB,EAA2B;;AAEzB5F,gBAAQ2N,cAAR,CAAuBf,EAAvB,CAA0B6sB,QAA1B,EAAoC7zB,IAApC,EAA0C,UAASrE,CAAT,EAAY0B,CAAZ,EAAe;;AAEvD4C,mBAAStE,CAAT,EAAY0B,CAAZ;AAED,SAJD;AAKD;AAzCe;AA0CjB;;AAvJQ;AAAA,IA4Gc6rB,OA5Gd;;AAwJV;;AAGD;;;;;;;;;;;AA3JW,MAuKL8K,aAvKK;AAAA;;AAwKT,6BAAoF;AAAA,UAAxE72B,IAAwE,uEAAjEA,gBAAgB7B,KAAhB,GAAwB6B,IAAxB,GAA+B,CAACA,IAAD,CAAkC;AAAA,UAA1B8C,QAA0B,uEAAf,YAAW,CAAE,CAAE;;AAAA;;AAAA,iIAE5E,EAF4E;;AAIlF,aAAK9C,IAAL,GAAYA,IAAZ;;AAEA,aAAK8C,QAAL,GAAgBA,QAAhB;;AANkF;AAQnF;;AAhLQ;AAAA;AAAA,6BAkLF;AACL,YAAI6zB,eAAe,KAAK32B,IAAxB;;AAEA,YAAI4H,SAAS,IAAb;;AAEA,YAAI+uB,wBAAwBx4B,KAA5B,EAAmC;;AAEjClB,kBAAQwI,IAAR,CAAakxB,YAAb,EAA2B,UAAS/0B,EAAT,EAAag1B,OAAb,EAAsB;;AAE/C35B,oBAAQwJ,WAAR,CAAoB+G,SAApB,CAA8B,SAASopB,QAAQ5vB,WAAR,EAAvC,EAA8D,YAAW;;AAEvEY,qBAAO9E,QAAP,CAAgB8zB,QAAQ5vB,WAAR,EAAhB;AAED,aAJD;AAKD,WAPD;AAQD;AACF;AAlMQ;AAAA;AAAA,6BAoMO;AAAA,YAAXhH,IAAW,uEAAJ,EAAI;;AACd,aAAKA,IAAL,GAAYvC,SAASQ,SAAT,CAAmB+B,IAAnB,CAAZ;;AAEA,eAAO,IAAP;AAED;AAzMQ;AAAA;AAAA,6BA2MsB;AAAA,YAA1B8C,QAA0B,uEAAf,YAAW,CAAE,CAAE;;AAC7B,aAAKA,QAAL,GAAgBA,QAAhB;;AAEA,aAAKL,IAAL;;AAEA,eAAO,IAAP;AACD;AAjNQ;;AAAA;AAAA,IAuKiB0zB,UAvKjB;;AAkNV;;AAED;;;;;;;;;;;AApNW,MAgOLpzB,YAhOK;AAAA;;AAiOT,4BAAc;AAAA;;AAAA,+HAEN,EAFM;;AAIZ,aAAK+zB,GAAL,GAAW,CAAC,CAAD,CAAX;AACA,aAAK92B,IAAL,GAAY,EAAZ;;AAEA,aAAK8C,QAAL,GAAgB,YAAU,CAAE,CAA5B;;AAPY;AASb;;AA1OQ;AAAA;AAAA,iCA4OU;AAAA,YAAVg0B,GAAU,uEAAJ,EAAI;;;AAEjB,aAAKA,GAAL,GAAWr5B,SAASQ,SAAT,CAAmB64B,GAAnB,CAAX;;AAEA,eAAO,IAAP;AACD;AAjPQ;AAAA;AAAA,6BAmPF;;AAEL,YAAIC,cAAct5B,SAASQ,SAAT,CAAmB,KAAK+B,IAAL,IAAa,EAAhC,CAAlB;;AAEA,YAAI4H,SAAS,IAAb;;AAEA3K,gBAAQ2N,cAAR,CAAuBf,EAAvB,CAA0BktB,WAA1B,EAAuC,KAAKD,GAA5C,EAAiD,UAASt4B,CAAT,EAAY0B,CAAZ,EAAe;;AAE9D0H,iBAAO9E,QAAP,CAAgBtE,CAAhB,EAAmB0B,CAAnB;AAED,SAJD;AAKD;AA9PQ;AAAA;AAAA,6BAgQO;AAAA,YAAXF,IAAW,uEAAJ,EAAI;;;AAEd,aAAKA,IAAL,GAAYvC,SAASQ,SAAT,CAAmB+B,IAAnB,CAAZ;;AAEA,aAAI,IAAIxB,IAAK,CAAb,EAAgBA,IAAI,KAAKwB,IAAL,CAAUwD,MAA9B,EAAsChF,GAAtC,EACA;AACE,cAAG,OAAO,KAAKwB,IAAL,CAAUxB,CAAV,CAAP,IAAuB,QAA1B,EAAmC;AAAE;AACjC,iBAAKwB,IAAL,CAAUxB,CAAV,IAAgB,KAAKwB,IAAL,CAAUxB,CAAV,IAAe,EAA/B;AACH;AACF;;AAED,eAAO,IAAP;AAED;AA7QQ;AAAA;AAAA,6BA+QsB;AAAA,YAA1BsE,QAA0B,uEAAf,YAAW,CAAE,CAAE;;AAC7B,aAAKA,QAAL,GAAgBA,QAAhB;;AAEA,aAAKL,IAAL;;AAEA,eAAO,IAAP;AAED;AAtRQ;;AAAA;AAAA,IAgOgB0zB,UAhOhB;;AAwRV;;AAxRU,MA0RLa,cA1RK;AAAA;;AA2RT,8BAAuB;AAAA,UAAXzxB,IAAW,uEAAJ,EAAI;;AAAA;;AAAA,6HACfA,IADe;AAGtB;;AAED;;;;;;;;AAhSS;AAAA;AAAA,kCAwSGlC,OAxSH,EAwSY2tB,QAxSZ,EAwSsB;;AAE7B,aAAK3tB,OAAL,GAAe5F,SAASQ,SAAT,CAAmBoF,WAAW,KAAKA,OAAhB,IAA2B,EAA9C,CAAf;;AAEA,aAAK2tB,QAAL,GAAgBvzB,SAASQ,SAAT,CAAmB+yB,YAAY,KAAKA,QAAjB,IAA6B,EAAhD,CAAhB;;AAEA,eAAO,IAAP;AACD;;AAED;;;;;;;AAjTS;AAAA;AAAA,2BAyTJiG,gBAzTI,EAyTc;;AAErB,aAAKn0B,QAAL,GAAgBm0B,oBAAoB,KAAKn0B,QAAzB,IAAqC,YAAW,CAAE,CAAlE;;AAEA,YAAIo0B,aAAa,IAAjB;;AAEA,aAAK7zB,OAAL,CAAahB,OAAb,CAAqB,UAAS80B,IAAT,EAAc;;AAEjCA,eAAKnsB,QAAL,CAAc,YAAU;;AAEtB,gBAAIosB,UAAU,IAAd;;AAEAF,uBAAWlG,QAAX,CAAoB3uB,OAApB,CAA4B,UAASg1B,IAAT,EAAc;AACxC,kBAAGD,QAAQjsB,eAAR,CAAwBksB,IAAxB,CAAH,EACA;AACEH,2BAAWp0B,QAAX,CAAoBs0B,OAApB,EAA6BC,IAA7B;AACD;AACF,aALD;AAMD,WAVD;AAWD,SAbD;;AAgBA,eAAO,IAAP;AAED;AAjVQ;;AAAA;AAAA,IA0RkBtL,OA1RlB;;AAkVV;;AAED;;;;;;;AApVW,MA6VL3hB,SA7VK;AAAA;;AA8VT,uBAAYktB,MAAZ,EAAoBx0B,QAApB,EAA8B;AAAA;;AAAA,yHAEtB,EAFsB;;AAI5B,aAAKgoB,IAAL,GAAYwM,UAAU,YAAW;AAC/Bx6B,gBAAQY,IAAR,CAAa,6HAAb;AACD,OAFD;AAGA;;AAEA,aAAKoF,QAAL,GAAgBA,YAAY,YAAW;AACrChG,gBAAQY,IAAR,CAAa,4GAAb;AACD,OAFD;;AAIAT,cAAQ8E,SAAR,CAAkByC,IAAlB;;AAb4B;AAe7B;;AAED;;;;;;AA/WS;AAAA;AAAA,yBAsXN+yB,YAtXM,EAsXQ;;AAEf,aAAKzM,IAAL,GAAYyM,YAAZ;;AAEA,eAAO,IAAP;AAED;;AAGD;;;;;;;AA/XS;AAAA;AAAA,2BAuYJN,gBAvYI,EAuYc;;AAErB,aAAKn0B,QAAL,GAAgBm0B,oBAAoB,KAAKn0B,QAAzB,IAAqC,YAAW,CAAE,CAAlE;;AAEA,eAAO,IAAP;AAED;AA7YQ;;AAAA;AAAA,IA6VaipB,OA7Vb;;AA8YV;;AAED3hB,YAAUotB,IAAV,GAAiBptB,UAAUC,EAA3B;;AAEApN,UAAQ8uB,OAAR,GAAkBA,OAAlB;;AAEA9uB,UAAQw6B,KAAR,GAAgB1L,OAAhB;;AAEA9uB,UAAQiI,WAAR,GAAsBA,WAAtB;;AAEAjI,UAAQk5B,UAAR,GAAqBA,UAArB;;AAEAl5B,UAAQ8F,YAAR,GAAuBA,YAAvB;;AAEA9F,UAAQ45B,aAAR,GAAwBA,aAAxB;;AAEA55B,UAAQ+5B,cAAR,GAAyBA,cAAzB;;AAEA/5B,UAAQy6B,iBAAR,GAA4BV,cAA5B;;AAEA/5B,UAAQmN,SAAR,GAAoBA,SAApB;AAED,CApaA;AAqaD;;AAEA;;;;;;;AAOAnN,QAAQ06B,QAAR,GAAmB16B,QAAQ06B,QAAR,IAAoB,EAAvC;;IAEM/sB,c;AAEF,4BAAc;AAAA;;AACV,SAAKgtB,UAAL,GAAkB,EAAlB;AACA,SAAKC,SAAL,GAAiB,EAAjB;AACA,QAAIC,mBAAmB,IAAvB;AACA,QAAIC,kBAAkB,IAAtB;AACA,SAAKl3B,QAAL,GAAgB,EAAhB;AACA,SAAKA,QAAL,CAAcm3B,OAAd,GAAwB;AACtBC,gBAAS,GADa;AAEtBC,gBAAS,GAFa;AAGtBC,gBAAS,GAHa;AAItBC,gBAAS,GAJa;AAKtBC,gBAAS,IALa;AAMtBC,gBAAS,IANa;AAOtBC,gBAAS,IAPa;AAQtBC,gBAAS,IARa;AAStBC,gBAAS,QATa;AAUtBC,gBAAS,OAVa;AAWtBC,iBAAU,mBAXY;AAYtBC,iBAAU,oBAZY;AAatBC,iBAAU,IAbY;AActBC,iBAAU,MAdY;AAetBC,iBAAU,OAfY;AAgBtBC,iBAAU;AAhBY,KAAxB;;AAmBA,SAAKC,cAAL,CAAoB,SAApB;;AAEA,SAAKrsB,MAAL,GAAc,EAAd;;AAEAoB,WAAO0B,gBAAP,CAAwB,kBAAxB,EAA4C,UAAU9P,CAAV,EAAa;AACrD9C,cAAQC,GAAR,CAAY,yDAAZ,EACI6C,EAAEs5B,OAAF,CAAUC,KADd,EACqBv5B,EAAEs5B,OAAF,CAAU31B,EAD/B,EAEI3D,EAAEs5B,OAAF,CAAUE,OAAV,CAAkB51B,MAFtB,EAE8B5D,EAAEs5B,OAAF,CAAUG,IAAV,CAAe71B,MAF7C;;AAIA,UAAIu0B,gBAAgBuB,QAApB,EAA8B;AAC1BtrB,eAAOurB,aAAP,CAAqBxB,gBAAgBuB,QAArC;AACH;;AAEDvB,sBAAgBuB,QAAhB,GAA2BtrB,OAAOvR,WAAP,CAAmB,YAAY;;AAEtD,YAAIq6B,MAAM0C,UAAUC,WAAV,EAAV;;AAEA1B,wBAAgBjB,GAAhB,GAAsBA,GAAtB;;AAEA,aAAK,IAAIt4B,IAAI,CAAb,EAAgBA,IAAIs4B,IAAItzB,MAAxB,EAAgChF,GAAhC,EAAqC;;AAEjC,cAAIoO,SAASmrB,gBAAgBH,UAAhB,CAA2Bp5B,CAA3B,IAAgCu5B,gBAAgBH,UAAhB,CAA2Bp5B,CAA3B,CAAhC,GAAgE,EAA7E;;AAEAu5B,0BAAgB2B,OAAhB,CAAwB3B,gBAAgBjB,GAAhB,CAAoBt4B,CAApB,CAAxB,EAAgDoO,MAAhD;AACH;AACJ,OAZ0B,EAYxB,EAZwB,CAA3B;AAaH,KAtBD;AAuBH;;;;mCAEc3G,I,EACf;AACE,WAAI,IAAIzH,CAAR,IAAa,KAAKqC,QAAlB,EACA;AACE,YAAGrC,EAAEwI,WAAF,MAAmBf,KAAKe,WAAL,EAAtB,EACA;AACQ,eAAK2yB,gBAAL,GAAwB,KAAK94B,QAAL,CAAcrC,CAAd,CAAxB;AACP;AACF;AACF;;;sCAEiByH,I,EAAMpF,Q,EACxB;AACEoF,aAAOA,QAAQ,WAAf;AACA,WAAKpF,QAAL,CAAcoF,IAAd,IAAsBpF,QAAtB;AACD;;;+BAEU;;AAEP,aAAO24B,UAAUC,WAAV,EAAP;AAEH;;;qCAEgB;;AAEb,WAAK,IAAIj7B,IAAI,CAAb,EAAgBA,IAAI,KAAKq5B,SAAL,CAAer0B,MAAnC,EAA2ChF,GAA3C,EAAgD;;AAE5CwP,eAAOurB,aAAP,CAAqB,KAAK1B,SAAL,CAAer5B,CAAf,CAArB;AAEH;AACJ;;;wCAEmBo7B,c,EAAgB;;AAEhC5rB,aAAOurB,aAAP,CAAqB,KAAK1B,SAAL,CAAe+B,cAAf,CAArB;AAEH;;;gCAEW;AACR,aAAO,iBAAiBJ,SAAxB;AAEH;;;0BAEK76B,G,EAAKk7B,Q,EAAU/2B,Q,EAAU;AAC3B,aAAO;;AAEHnE,aAAKA,GAFF,EAEOk7B,UAAUA,QAFjB,EAE2B/2B,UAAUA;;AAFrC,OAAP;AAMH;;;kCAEayC,I,EAAM;;AAEhB,UAAIu0B,WAAW,IAAf;;AAEA,UAAIC,KAAK,EAAT;;AAEAA,SAAGC,UAAH,GAAgBz0B,KAAKy0B,UAAL,IAAmB,UAAUx7B,CAAV,EAAa0B,CAAb,EAAgB;;AAE/C;;AAEH,OAJD;;AAMA65B,SAAGE,WAAH,GAAiB10B,KAAK00B,WAAL,IAAoB,UAAUz7B,CAAV,EAAa0B,CAAb,EAAgB,CAEpD,CAFD;;AAIA65B,SAAGX,OAAH,GAAa,EAAb;;AAEAW,SAAGG,UAAH,GAAgB,UAAUC,EAAV,EAAcC,EAAd,EAAkB;;AAE9B,YAAIC,KAAKD,EAAT;;AAEA,eAAO,UAAU57B,CAAV,EAAa0B,CAAb,EAAgB;;AAEnBk6B,aAAG57B,CAAH,EAAM0B,CAAN;;AAEAi6B,aAAG37B,CAAH,EAAM0B,CAAN;AAEH,SAND;AAQH,OAZD;;AAeQ65B,SAAGO,UAAH,GAAgB,UAAS1zB,CAAT,EAAW;AAAE;AAC3B,aAAI,IAAIpI,IAAI,CAAZ,EAAeA,IAAI,CAAnB,EAAsBA,GAAtB,EACA;AACE,cAAGoI,EAAE2B,OAAF,CAAU,GAAV,KAAkB,CAArB,EACA;AACI3B,gBAAIA,EAAEK,OAAF,CAAU,GAAV,EAAe,GAAf,CAAJ;AACH;AACD,cAAGL,EAAE2B,OAAF,CAAU,GAAV,KAAkB,CAArB,EACA;AACI3B,gBAAIA,EAAEK,OAAF,CAAU,GAAV,EAAe,GAAf,CAAJ;AACH;AACF;;AAED,eAAOL,EAAEI,WAAF,EAAP;AACD,OAdD;;AAgBA+yB,SAAGlwB,EAAH,GAAQ,UAAUlL,GAAV,EAAemE,QAAf,EAAyB;;AAE7B,YAAIjC,WAAWi5B,SAASH,gBAAxB;;AAEAh7B,cAAM,KAAK27B,UAAL,CAAgB37B,GAAhB,CAAN;;AAGY,YAAI,KAAKA,GAAL,KAAaA,QAAQ,IAAzB,EAA+B;;AAE3B,cAAI47B,aAAa,OAAO,KAAK57B,GAAL,CAAP,IAAqB,UAArB,GAAkC,KAAKA,GAAL,CAAlC,GAA8C,UAAUH,CAAV,EAAa0B,CAAb,EAAgB,CAC9E,CADD;;AAGA,eAAKvB,GAAL,IAAY,KAAKu7B,UAAL,CAAgBp3B,QAAhB,EAA0By3B,UAA1B,CAAZ;AACH;;AAGb,aAAI,IAAI/7B,CAAR,IAAaqC,QAAb,EACA;AACI,cAAI25B,QAAQh8B,EAAEiL,KAAF,CAAQ,GAAR,CAAZ;;AAEA,cAAG,KAAK6wB,UAAL,CAAgB97B,CAAhB,KAAsBG,GAAtB,IAA6B,KAAK27B,UAAL,CAAgBz5B,SAASrC,CAAT,CAAhB,KAAgCG,GAAhE,EAAqE;AACrE;;AAEkB,kBAAIb,MAAJ;;AAEA,kBAAI;;AAEAA,yBAASwa,SAASkiB,MAAM,CAAN,CAAT,CAAT;;AAEA,oBAAID,aAAa,OAAO,KAAK,SAAL,EAAgBz8B,MAAhB,CAAP,IAAmC,UAAnC,GAAgD,KAAK,SAAL,EAAgBA,MAAhB,CAAhD,GAA0E,UAAUU,CAAV,EAAa0B,CAAb,EAAgB,CAC1G,CADD;;AAGA,qBAAK,SAAL,EAAgBpC,MAAhB,IAA0B,KAAKo8B,UAAL,CAAgBp3B,QAAhB,EAA0By3B,UAA1B,CAA1B;AAEH,eATD,CAUA,OAAO36B,CAAP,EAAU;AACN9C,wBAAQQ,KAAR,CAAc,qCAAqCqB,GAAnD;AAEH;AAClB;AACJ;AACJ,OAzCD;;AA2CRo7B,SAAG/zB,WAAH,GAAiB,EAACC,MAAM,eAAP,EAAjB;;AAEA,WAAK2xB,UAAL,CAAgBpzB,IAAhB,CAAqBu1B,EAArB;;AAEA98B,cAAQ06B,QAAR,GAAmB,KAAKC,UAAxB;;AAEA,aAAOmC,EAAP;AAEH;;;kCAEa;AACV,aAAO98B,QAAQ06B,QAAf;AAEH;;;4BAEOoC,E,EAAIU,Q,EAAU;;AAElB,WAAKC,eAAL,CAAqBX,EAArB,EAAyBU,QAAzB;;AAEA,WAAKE,YAAL,CAAkBZ,EAAlB,EAAsBU,QAAtB;AAEH;;;iCAEYV,E,EAAIntB,M,EAAQ;;AAErB,UAAI,CAACmtB,EAAD,IAAO,CAACA,GAAG,MAAH,CAAZ,EAAwB;;AAEpB,eAAO,KAAP;AAEH;;AAGD,WAAK,IAAIx1B,IAAI,CAAb,EAAgBA,IAAIw1B,GAAGV,IAAH,CAAQ71B,MAA5B,EAAoCe,KAAK,CAAzC,EAA4C;;AAExC,YAAIq2B,QAAQb,GAAGV,IAAH,CAAQ90B,CAAR,CAAZ;AAAA,YAAwBs2B,QAAQd,GAAGV,IAAH,CAAQ90B,IAAI,CAAZ,CAAhC;;AAEA,YAAI3C,KAAMmC,KAAKkwB,IAAL,CAAU1vB,IAAI,CAAd,IAAmB,CAA7B;AAAA,YAAiC/F,IAAIu7B,GAAGV,IAAH,CAAQ90B,CAAR,CAArC;AAAA,YAAiDrE,IAAI65B,GAAGV,IAAH,CAAQ90B,IAAI,CAAZ,CAArD;;AAEA,YAAI3C,MAAM,CAAN,IAAWgL,OAAOotB,UAAtB,EAAkC;AAC9BptB,iBAAOotB,UAAP,CAAkBx7B,CAAlB,EAAqB0B,CAArB;AAEH;;AAED,YAAI0B,MAAM,CAAN,IAAWgL,OAAOqtB,WAAtB,EAAmC;AAC/BrtB,iBAAOqtB,WAAP,CAAmBz7B,CAAnB,EAAsB0B,CAAtB;AAEH;;AAED,YAAI,KAAK0M,MAAL,IAAe,KAAKA,MAAL,CAAY,WAAWrI,CAAvB,CAAf,IAA4C,OAAO,KAAKqI,MAAL,CAAY,WAAWrI,CAAvB,EAA0BzB,QAAjC,IAA8C,UAA9F,EAA0G;AACtG,eAAK8J,MAAL,CAAY,WAAWrI,CAAvB,EAA0BzB,QAA1B;AAEH;AACJ;AAEJ;;;oCAGei3B,E,EAAIntB,M,EAAQ;;AAExB,UAAI,CAACmtB,EAAD,IAAO,CAACA,GAAG,SAAH,CAAZ,EAA2B;AACvB,eAAO,KAAP;AAEH;;AAED,WAAK,IAAIx1B,IAAI,CAAb,EAAgBA,IAAIw1B,GAAGX,OAAH,CAAW51B,MAA/B,EAAuCe,GAAvC,EAA4C;;AAExC,YAAI,CAACqI,OAAOwsB,OAAZ,EACI,MADJ,KAGK,IAAIxsB,OAAOwsB,OAAP,CAAe51B,MAAf,GAAwBe,CAAxB,IAA6B,OAAOqI,OAAOwsB,OAAP,CAAe70B,CAAf,CAAP,IAA6B,UAA9D,EAA0E;AAC3EqI,iBAAOwsB,OAAP,CAAe70B,CAAf,EAAkBw1B,GAAGX,OAAH,CAAW70B,CAAX,EAAcu2B,OAAhC;AACH,SAFI,MAGA,IAAIluB,OAAOwsB,OAAP,CAAe51B,MAAf,GAAwBe,CAAxB,IAA6B,QAAOqI,OAAOwsB,OAAP,CAAe70B,CAAf,CAAP,KAA6B,QAA1D,IAAsE,OAAOqI,OAAOwsB,OAAP,CAAe70B,CAAf,EAAkB0G,MAAzB,IAAoC,UAA9G,EAA0H;AAC3H2B,iBAAOwsB,OAAP,CAAe70B,CAAf,EAAkB0G,MAAlB,CAAyB2B,OAAOwsB,OAAP,CAAe70B,CAAf,EAAkBu2B,OAA3C;AAEH;AACD,YAAIC,cAAc,KAAKnuB,MAAL,IAAe,KAAKA,MAAL,CAAYrI,CAAZ,CAAjC;AAAA,YAAiDy2B,GAAjD;AAAA,YAAsDC,OAAO,YAAY12B,CAAzE;;AAEA,YAAIw2B,WAAJ,EAAiB;AACbC,gBAAM,KAAKpuB,MAAL,CAAYquB,IAAZ,KAAqB,CAACr3B,MAAM,KAAKgJ,MAAL,CAAYquB,IAAZ,EAAkBpB,QAAxB,CAAtB,GAA0D,KAAKlC,QAAL,CAAc,KAAK/qB,MAAL,CAAYquB,IAAZ,EAAkBpB,QAAhC,CAA1D,GAAsG,KAAKjtB,MAAL,CAAYquB,IAAZ,EAAkBpB,QAA9H;AACH;AACD;;AAEA,YAAIkB,eAAeC,GAAf,IAAsB,OAAO,KAAKpuB,MAAL,CAAYquB,IAAZ,EAAkBn4B,QAAzB,IAAsC,UAAhE,EAA4E;AACxE;AACA,eAAK8J,MAAL,CAAYrI,CAAZ,EAAezB,QAAf;AAEH;AAEJ;AACJ;;;uBAGEnE,G,EAAKkE,I,EAAMC,Q,EAAU;;AAEpB,UAAI9C,OAAOvC,SAASQ,SAAT,CAAmBU,OAAO,EAA1B,CAAX;AAAA,UAA0Cm4B,MAAMr5B,SAASQ,SAAT,CAAmB4E,QAAQ,EAA3B,CAAhD,CAA+E;;AAE/E,WAAI,IAAIrE,CAAR,IAAawB,IAAb,EACA;AACI,aAAI,IAAIE,CAAR,IAAa42B,GAAb,EACA;AACI,cAAIA,IAAI52B,CAAJ,KAAU,KAAK03B,UAAL,CAAgBp0B,MAA9B,EAAsC;;AAElC,iBAAKo0B,UAAL,CAAgBpzB,IAAhB,CAAqB,KAAK02B,aAAL,CAAmB,EAAnB,CAArB;AAEH;;AAED,eAAKtD,UAAL,CAAgB13B,CAAhB,EAAmB2J,EAAnB,CAAsB7J,KAAKxB,CAAL,CAAtB,EAA+BsE,QAA/B;AAEH;AACJ;AACJ;;;;;;AAGL;;;;;AAKA,IAAI,CAAC7F,QAAQ2N,cAAb,EAA6B;;AAEzB3N,UAAQ2N,cAAR,GAAyB,IAAIA,cAAJ,EAAzB;;AAEA;AAEH;AACD;AACA;;;;;;;;IAQMuwB,K;AAEF,iBAAYjrB,GAAZ,EAAiBiB,IAAjB,EAAuB;AAAA;;AAEnB,QAAI,QAAOjB,GAAP,yCAAOA,GAAP,MAAe,QAAnB,EAA6B;;AAEzB,WAAKkrB,KAAL,GAAa95B,SAASgnB,aAAT,CAAuB,OAAvB,CAAb;;AAEA,WAAK8S,KAAL,CAAWC,MAAX,GAAoBnrB,IAAIkrB,KAAJ,CAAUC,MAA9B;;AAEA,WAAKD,KAAL,CAAWlrB,GAAX,GAAiBA,IAAIA,GAArB;;AAEA,WAAKA,GAAL,GAAWA,IAAIA,GAAf;AACH,KATD,MAWK,IAAI,OAAOA,GAAP,IAAe,QAAnB,EAA6B;;AAE9B,WAAKkrB,KAAL,GAAa95B,SAASgnB,aAAT,CAAuB,OAAvB,CAAb;;AAEA,WAAK8S,KAAL,CAAWC,MAAX,GAAoB,CAApB;;AAEA,WAAKD,KAAL,CAAWlrB,GAAX,GAAiBA,GAAjB;;AAEA,WAAKA,GAAL,GAAWA,GAAX;AAEH;;AAED,QAAG,QAAOiB,IAAP,yCAAOA,IAAP,MAAc,QAAjB,EAA2B;AACvB,WAAK,IAAI3S,CAAT,IAAc2S,IAAd,EAAoB;AAChB,YAAI3S,MAAM,OAAV,EAAmB;AACf,eAAKA,CAAL,IAAU2S,KAAK3S,CAAL,CAAV;AAEH;AACJ;AACJ;;AAED,SAAKuH,MAAL,GAAc,KAAKA,MAAL,IAAe,YAAY,CACpC,CADL;;AAGA,QAAI,OAAO,KAAKA,MAAZ,IAAuB,UAA3B,EAAuC;;AAEnC,WAAKA,MAAL,CAAY,KAAKq1B,KAAjB;AAEH;AAEJ;;;;6BAEQt9B,M,EAAO;;AAEd,UAAIw9B,UAAU,EAAd;AACA,WAAI,IAAI98B,IAAI,CAAZ,EAAeA,IAAIV,MAAnB,EAA2BU,GAA3B,EACA;AACE88B,gBAAQ92B,IAAR,CAAa,KAAK0L,GAAL,IAAY,KAAKkrB,KAAL,CAAWlrB,GAApC;AACD;;AAED,aAAO,IAAIjT,QAAQs+B,SAAZ,CAAsBD,OAAtB,EAA+BE,MAA/B,CAAsC,KAAKJ,KAAL,CAAWC,MAAjD,CAAP;AACD;;;yBAEII,I,EACL;AACI,WAAKL,KAAL,CAAWK,IAAX,GAAkBA,QAAQ,IAA1B;;AAEA,aAAO,IAAP;AAEH;;;yBAEIA,K,EAAM;AACX;AACI,WAAKL,KAAL,CAAWK,IAAX,GAAkBA,SAAQ,IAA1B;;AAEA,aAAO,IAAP;AAEH;;;2BAGMC,G,EACP;AACI,WAAKN,KAAL,CAAWC,MAAX,GAAoBK,GAApB;;AAEA,aAAO,IAAP;AAEH;;;2BAGMA,G,EAAK;AACZ;;AAEI,WAAKN,KAAL,CAAWC,MAAX,GAAoBK,GAApB;;AAEA,aAAO,IAAP;AAEH;;;2BAEM;;AAEH,UAAGz+B,QAAQC,MAAR,IAAkBD,QAAQC,MAAR,CAAey+B,QAApC,EACA;AACE;AACD;;AAED,UAAI,QAAO,KAAKP,KAAZ,KAAsB,QAAtB,IAAkC,OAAO,KAAKA,KAAL,CAAWQ,IAAlB,IAA2B,UAAjE,EAA6E;;AAEzE,aAAKR,KAAL,CAAWQ,IAAX;AAEH;;AAED,aAAO,IAAP;AAEH;;;2BAEM;AAAE;AACP,UAAG3+B,QAAQC,MAAR,IAAkBD,QAAQC,MAAR,CAAey+B,QAApC,EACA;AACE;AACD;AACC,UAAI,QAAO,KAAKP,KAAZ,KAAsB,QAAtB,IAAkC,OAAO,KAAKA,KAAL,CAAWQ,IAAlB,IAA2B,UAAjE,EAA6E;;AAEzE,aAAKR,KAAL,CAAWQ,IAAX;AACH;AACD,aAAO,IAAP;AACH;;;;;;IAKCL,S;AAEF,qBAAYj9B,IAAZ,EACA;AAAA;;AACI,SAAKmM,GAAL,GAAW,CAAX;;AAEA,SAAKoxB,MAAL,GAAc,EAAd;;AAEA,QAAGv9B,gBAAgBH,KAAnB,EACA;AACI,WAAI,IAAIK,CAAR,IAAaF,IAAb,EACA;AACI,YAAGA,KAAKE,CAAL,EAAQ0R,GAAX,EACA;AACI,eAAK2rB,MAAL,CAAYr3B,IAAZ,CAAiB,IAAI22B,KAAJ,CAAU78B,KAAKE,CAAL,EAAQ0R,GAAlB,EAAuB5R,KAAKE,CAAL,CAAvB,CAAjB;AAEH,SAJD,MAKK,IAAG,OAAOF,KAAKE,CAAL,CAAP,IAAmB,QAAtB,EACL;AACI,eAAKq9B,MAAL,CAAYr3B,IAAZ,CAAiB,IAAI22B,KAAJ,CAAU78B,KAAKE,CAAL,CAAV,CAAjB;AAEH;AACJ;AACJ;AACJ;;;;wBAEG0R,G,EAAKjK,I,EACT;AACI,UAAG,QAAOiK,GAAP,yCAAOA,GAAP,MAAe,QAAf,IAA2BA,IAAIA,GAAlC,EACA;AACI,aAAK2rB,MAAL,CAAYr3B,IAAZ,CAAiB,IAAI22B,KAAJ,CAAUjrB,IAAIA,GAAd,EAAmBA,GAAnB,CAAjB;AAEH,OAJD,MAKK,IAAG,OAAOA,GAAP,IAAe,QAAlB,EACL;AACI,YAAIiB,OAAO,EAAX;;AAEA,YAAGlL,IAAH,EACA;AACIkL,eAAKlL,IAAL,GAAYA,IAAZ;AACH;;AAED,aAAK41B,MAAL,CAAYr3B,IAAZ,CAAiB,IAAI22B,KAAJ,CAAU78B,KAAKE,CAAL,CAAV,EAAmB2S,IAAnB,CAAjB;AAEH;AAEJ;;;2BAEMogB,C,EACP;AACI,WAAI,IAAI/yB,IAAI,CAAZ,EAAeA,IAAI,KAAKq9B,MAAL,CAAYr4B,MAA/B,EAAsChF,GAAtC,EACA;AACI,aAAKq9B,MAAL,CAAYr9B,CAAZ,EAAe68B,MAAf,CAAsB9J,CAAtB;AAEH;;AAED,aAAO,IAAP;AACH;;;2BAEMA,C,EACP;AACI,WAAI,IAAI/yB,IAAI,CAAZ,EAAeA,IAAI,KAAKq9B,MAAL,CAAYr4B,MAA/B,EAAsChF,GAAtC,EACA;AACI,aAAKq9B,MAAL,CAAYr9B,CAAZ,EAAe68B,MAAf,CAAsB9J,CAAtB;AAEH;;AAED,aAAO,IAAP;AACH;;;+BAID;AACE,UAAGt0B,QAAQC,MAAR,IAAkBD,QAAQC,MAAR,CAAey+B,QAApC,EACA;AACE;AACD;;AAEC,WAAKE,MAAL,CAAY,KAAKpxB,GAAL,GAAW,KAAKoxB,MAAL,CAAYr4B,MAAnC,EAA2Co4B,IAA3C;;AAEA,WAAKnxB,GAAL,IAAY,CAAZ;AAEH;;;2BAGD;;AAEE,UAAGxN,QAAQC,MAAR,IAAkBD,QAAQC,MAAR,CAAey+B,QAApC,EACA;AACE;AACD;;AAEC,WAAKE,MAAL,CAAY,KAAKpxB,GAAL,GAAW,KAAKoxB,MAAL,CAAYr4B,MAAnC,EAA2Co4B,IAA3C;;AAEA,WAAKnxB,GAAL,IAAY,CAAZ;AAGH;;;+BAEU;AACX;AACE,UAAGxN,QAAQC,MAAR,IAAkBD,QAAQC,MAAR,CAAey+B,QAApC,EACA;AACE;AACD;AACC,WAAKE,MAAL,CAAY,KAAKpxB,GAAL,GAAW,KAAKoxB,MAAL,CAAYr4B,MAAnC,EAA2Co4B,IAA3C;;AAEA,WAAKnxB,GAAL,IAAY,CAAZ;AAEH;;;2BAEM;AACP;AACE,UAAGxN,QAAQC,MAAR,IAAkBD,QAAQC,MAAR,CAAey+B,QAApC,EACA;AACE;AACD;;AAEC,WAAKE,MAAL,CAAY,KAAKpxB,GAAL,GAAW,KAAKoxB,MAAL,CAAYr4B,MAAnC,EAA2Co4B,IAA3C;;AAEA,WAAKnxB,GAAL,IAAY,CAAZ;AAGH;;;;;;AAILxN,QAAQk+B,KAAR,GAAgBA,KAAhB;;AAEAl+B,QAAQs+B,SAAR,GAAoBA,SAApB;;IAKMO,K,GAEJ,iBAAa;AAAA;AAGZ,C;;AAIH7+B,QAAQ6+B,KAAR,GAAgBA,KAAhB;AACA;;IACMC,E;AAEJ,cAAYl7B,QAAZ,EAAqB;AAAA;;AACnB,SAAI,IAAIrC,CAAR,IAAaqC,QAAb;AACA,WAAKrC,CAAL,IAAUqC,SAASrC,CAAT,CAAV;AADA;AAED;AACC;;;;;;;;6BAMS,CAER;;;6BAEQw9B,G,EAAK;;AAEZA,YAAMA,IAAI/S,IAAJ,CAAS,IAAT,CAAN;;AAEA,UAAIhe,SAAS,KAAKA,MAAL,CAAYge,IAAZ,CAAiB,IAAjB,CAAb;AACA,UAAIrhB,SAAS,IAAb;;AAEA,WAAKqD,MAAL,GAAc,UAASrD,MAAT,EAAiB;AAC7BqD,eAAOrD,MAAP;AACAo0B,YAAIp0B,MAAJ;AACD,OAHD;AAID;;;;;;AACJ;;AAED3K,QAAQ8+B,EAAR,GAAaA,EAAb;AACA9+B,QAAQg/B,EAAR,GAAaF,EAAb;AACA,CAAC,CAAC,YAAW;AACXj/B,UAAQC,GAAR,CAAY,6BAAZ;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAHW,MA+BLqV,SA/BK;AAiCT,yBAAsB;AAAA,UAAVlC,GAAU,uEAAJ,EAAI;;AAAA;;AAEpB,UAAI3K,OAAO,QAAO2K,GAAP,yCAAOA,GAAP,MAAe,QAAf,GAA0BA,GAA1B,GAAgC,EAA3C;;AAEA;;AAEA;;;;;AAKA,WAAKgsB,SAAL,GAAiB,KAAKA,SAAL,IAAkB,IAAIj/B,QAAQ+U,MAAZ,CAAmBzM,KAAK22B,SAAL,IAAkB,IAAIj/B,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAArC,CAAnC;AACA,WAAKD,IAAL,GAAY,KAAKA,IAAL,IAAa,IAAI9U,QAAQ+U,MAAZ,CAAmBzM,KAAKwM,IAAL,IAAa,IAAI9U,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAAhC,CAAzB;;AAEA,WAAK5R,IAAL,GAAY,WAAZ;;AAEA,UAAI,OAAO8P,GAAP,IAAc,QAAd,IAA0BA,eAAe+a,iBAA7C,EAAgE;AAC9D,aAAK/a,GAAL,GAAWA,GAAX;AACA,aAAKisB,KAAL,GAAa,IAAIl/B,QAAQyzB,SAAZ,CAAsBxgB,GAAtB,CAAb;AACA,aAAKksB,gBAAL;AACD,OAJD,MAIO,IAAI72B,gBAAgBtI,QAAQyzB,SAA5B,EAAuC;AAC5C;;AAEA,aAAKyL,KAAL,GAAa52B,IAAb;AACD,OAJM,MAIA,IAAIA,gBAAgB82B,gBAApB,EAAsC;AAC3C;;AAEA,aAAKF,KAAL,GAAa,IAAIl/B,QAAQyzB,SAAZ,CAAsBnrB,IAAtB,CAAb;AACD,OAJM,MAIA,IAAIA,gBAAgBtI,QAAQmV,SAA5B,EAAuC;;AAE5C,aAAK+pB,KAAL,GAAa52B,KAAK42B,KAAlB;AAED,OAJM,MAIA,IAAI,QAAO52B,IAAP,yCAAOA,IAAP,MAAgB,QAAhB,IAA4BA,KAAK2K,GAArC,EAA0C;AAC/C,aAAKA,GAAL,GAAW3K,KAAK2K,GAAhB;AACA,aAAKisB,KAAL,GAAa,IAAIl/B,QAAQyzB,SAAZ,CAAsBnrB,KAAK2K,GAA3B,CAAb;AACD;;AAED,WAAKosB,OAAL,GAAe,CAAf;;AAEA,WAAKC,OAAL,GAAeh3B,KAAKg3B,OAAL,IAAgB,IAA/B;;AAIA,UAAIh3B,KAAKi3B,WAAL,IAAoBj3B,KAAKi3B,WAAL,CAAiBj/B,GAArC,IAA4CgI,KAAKi3B,WAAL,CAAiBh/B,GAAjE,EAAsE;;AAEpE;;;;;AAKA,aAAKg/B,WAAL,GAAmB,IAAIv/B,QAAQizB,iBAAZ,CAA8B3qB,KAAKi3B,WAAL,CAAiBj/B,GAA/C,EAAoDgI,KAAKi3B,WAAL,CAAiBh/B,GAArE,EAA0E+H,KAAKi3B,WAAL,CAAiBrM,SAA3F,CAAnB;AAED,OATD,MASO;;AAEL,aAAKqM,WAAL,GAAmB,IAAIv/B,QAAQizB,iBAAZ,CAA8B,IAAIjzB,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAA9B,EAA2D,IAAI/U,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAA3D,EAAwF,IAAI/U,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAxF,CAAnB;AAED;;AAED,WAAKiE,KAAL,GAAa,GAAb;;AAGA,WAAKwmB,MAAL,GAAc,IAAIx/B,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAd;;AAEA,WAAK2C,QAAL,GAAgB,IAAI1X,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAAhB;;AAEA,WAAK2iB,QAAL,GAAgB,IAAI13B,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAhB;;AAEA,WAAK0qB,WAAL,GAAmB,KAAK/1B,MAAL,CAAYpB,IAAZ,EAAkB,aAAlB,EAAiC,IAAItI,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAjC,CAAnB;;AAEA,WAAK2qB,aAAL;;AAEA,WAAKC,KAAL,GAAa,KAAKj2B,MAAL,CAAYpB,IAAZ,EAAkB,OAAlB,EAA2B,KAA3B,CAAb;;AAEA,WAAKkF,GAAL,GAAW,CAAX;;AAEA;;;;;AAKA,WAAKoyB,cAAL,GAAsB,KAAKC,MAAL,CAAY,CAAZ,KAAkB,KAAxC;;AAEA,WAAKC,KAAL,GAAa,CAAb;;AAEA,WAAKrX,QAAL,GAAgBngB,KAAKmgB,QAAL,IAAiB,IAAjC;;AAEA,WAAKsX,WAAL,GAAmBz3B,KAAKy3B,WAAL,IAAoB,KAAvC;;AAEA,WAAKC,cAAL,GAAsB13B,KAAK03B,cAAL,IAAuB,KAA7C;;AAEA,WAAK90B,OAAL,GAAe5C,KAAK4C,OAAL,IAAgB,EAA/B;;AAEA,WAAKC,YAAL,GAAoB7C,KAAK6C,YAAL,IAAqB,EAAzC;;AAGA,WAAK80B,KAAL,CAAW,KAAKjnB,KAAhB;;AAEA;AAED;;AApIQ;AAAA;AAAA,6BA8IFzX,CA9IE,EA8IC0B,CA9ID,EA8IIwU,CA9IJ,EA8IO;AACd,aAAK+nB,MAAL,GAAc,IAAIx/B,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAAd;;AAEA,aAAKooB,MAAL,CAAYz6B,OAAZ,CAAoB,UAAS86B,EAAT,EAAa;AAC/BA,aAAGV,MAAH,GAAY,IAAIx/B,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAAZ;AACD,SAFD;AAGA,YAAI,KAAKmoB,cAAT,EAAyB;AACvB,eAAKA,cAAL,CAAoBJ,MAApB,GAA6B,IAAIx/B,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAA7B;AACD;AACD,eAAO,IAAP;AACD;AAxJQ;AAAA;AAAA,+BA0JAlW,CA1JA,EA0JG0B,CA1JH,EA0JMwU,CA1JN,EA0JS;AAChB,aAAKC,QAAL,GAAgB,IAAI1X,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAAhB;;AAEA,aAAKooB,MAAL,CAAYz6B,OAAZ,CAAoB,UAAS86B,EAAT,EAAa;;AAE/BA,aAAGxoB,QAAH,GAAc,IAAI1X,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAAd;AAED,SAJD;;AAMA,eAAO,IAAP;AACD;AApKQ;AAAA;AAAA,2BAsKJlW,CAtKI,EAsKD0B,CAtKC,EAsKE;;AAET,aAAK6R,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,CAAZ;AACA,aAAK48B,MAAL,CAAYz6B,OAAZ,CAAoB,UAASsQ,CAAT,EAAY;;AAE9BA,YAAEiW,IAAF,CAAOpqB,CAAP,EAAU0B,CAAV;AAED,SAJD;AAKA,eAAO,IAAP;AACD;AA/KQ;AAAA;AAAA,2BAiLJtD,CAjLI,EAiLD;AACN,aAAKwgC,IAAL,GAAYxgC,CAAZ;AACA,eAAO,IAAP;AACD;AApLQ;AAAA;AAAA,iCAsLEA,CAtLF,EAsLK;AACZ,aAAKygC,UAAL,GAAkBzgC,CAAlB;AACA,eAAO,IAAP;AACD;AAzLQ;AAAA;AAAA,+BA2LA4B,CA3LA,EA2LG0B,CA3LH,EA2LMwU,CA3LN,EA2LS;;AAEhB,aAAKigB,QAAL,GAAgB,IAAI13B,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAAhB;;AAEA,aAAKooB,MAAL,CAAYz6B,OAAZ,CAAoB,UAASi7B,MAAT,EAAiB;AACnCA,iBAAOjI,QAAP,CAAgB72B,CAAhB,EAAmB0B,CAAnB,EAAsBwU,CAAtB;AACD,SAFD;;AAIA,eAAO,IAAP;AACD;AApMQ;AAAA;AAAA,0BAsMLxE,GAtMK,EAsMc;AAAA,YAAdwc,OAAc,uEAAJ,EAAI;;;AAErB,YAAI,OAAOxc,GAAP,IAAc,QAAlB,EAA4B;;AAE1BpT,kBAAQC,GAAR,CAAY,mCAAmCmT,GAA/C;AACA,eAAKA,GAAL,GAAWA,GAAX;AACA,eAAKisB,KAAL,GAAa,IAAIl/B,QAAQyzB,SAAZ,CAAsBxgB,GAAtB,CAAb;AAED,SAND,MAMO,IAAIA,eAAewgB,SAAnB,EAA8B;AACnC;;AAEA,eAAKyL,KAAL,GAAajsB,GAAb;AACD,SAJM,MAIA,IAAIA,eAAemsB,gBAAnB,EAAqC;AAC1C;;AAEA,eAAKF,KAAL,GAAa,IAAIl/B,QAAQyzB,SAAZ,CAAsBxgB,GAAtB,CAAb;AACD;;AAED,YAAI,CAACwc,QAAQ8P,WAAb,EACE,KAAKJ,gBAAL;;AAEF,eAAO,IAAP;AAED;AA7NQ;AAAA;AAAA,4BA+NHvzB,CA/NG,EA+NA;;AAEP,aAAKoN,KAAL,GAAapN,CAAb;;AAEA,YAAI,KAAKszB,KAAL,IAAc,KAAKA,KAAL,CAAW9S,UAAzB,IAAuC,KAAK8S,KAAL,CAAW9S,UAAX,CAAsB9R,KAAtB,GAA8B,CAAzE,EAA4E;AAC1E,eAAKxF,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmB,KAAKmqB,KAAL,CAAW9S,UAAX,CAAsB9R,KAAtB,GAA8B1O,CAAjD,EAAoD,KAAKszB,KAAL,CAAW9S,UAAX,CAAsB/R,MAAtB,GAA+BzO,CAAnF,EAAsFqJ,KAAtF,EAAZ;AACA,eAAK0W,IAAL,CAAU,KAAK7W,IAAf;AACD;;AAED,YAAI,KAAK+qB,MAAL,YAAuB3+B,KAA3B,EACE,KAAK2+B,MAAL,CAAYz6B,OAAZ,CAAoB,UAASsQ,CAAT,EAAY;;AAE9BA,YAAEuqB,KAAF,CAAQr0B,CAAR;AAED,SAJD;;AAMF,eAAO,IAAP;AACD;AAhPQ;AAAA;AAAA,2BAkPJrK,CAlPI,EAkPD0B,CAlPC,EAkPEwU,CAlPF,EAkPK;;AAEZ,aAAK3C,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAAZ;;AAEA,aAAKooB,MAAL,CAAYz6B,OAAZ,CAAoB,UAASsQ,CAAT,EAAY;AAC9BA,YAAEZ,IAAF,GAAS,IAAI9U,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAAT;AACD,SAFD;;AAIA,eAAO,IAAP;AACD;AA3PQ;AAAA;AAAA,4BA6PHxE,GA7PG,EA6PE;;AAET,YAAI,OAAOA,GAAP,IAAe,QAAnB,EAA6B;;AAE3B;AACA,eAAKA,GAAL,GAAWA,GAAX;AACA,eAAKisB,KAAL,GAAa,IAAIl/B,QAAQyzB,SAAZ,CAAsBxgB,GAAtB,CAAb;AAED,SAND,MAMO,IAAIA,eAAejT,QAAQyzB,SAA3B,EAAsC;AAC3C;;AAEA,eAAKyL,KAAL,GAAajsB,GAAb;AACD,SAJM,MAIA,IAAIA,eAAemsB,gBAAnB,EAAqC;AAC1Cv/B,kBAAQC,GAAR,CAAY,uDAAZ;;AAEA,eAAKo/B,KAAL,GAAa,IAAIl/B,QAAQyzB,SAAZ,CAAsBxgB,GAAtB,CAAb;AACD;;AAED,aAAKksB,gBAAL;;AAGA,eAAO,IAAP;AAED;;AAGD;;;;;;AAvRS;AAAA;AAAA,yCA6RU;;AAEjB,YAAImB,SAAS,IAAb;;AAEAA,eAAOC,SAAP,GAAmBD,OAAOC,SAAP,IAAoB,YAAW,CAAE,CAApD;;AAEA,aAAKrB,KAAL,CAAW9S,UAAX,CAAsB8E,MAAtB,GAA+B,YAAW;;AAExC;;AAEA;AACAoP,iBAAOC,SAAP;;AAEA,cAAID,OAAOrB,SAAP,CAAiB19B,CAAjB,IAAsB,CAAtB,IAA2B,CAAC++B,OAAOE,QAAvC,EAAiD;AAC/CF,mBAAOG,SAAP,CAAiBH,OAAOpB,KAAP,CAAa9S,UAAb,CAAwB9R,KAAzC,EAAgDgmB,OAAOpB,KAAP,CAAa9S,UAAb,CAAwB/R,MAAxE,EACCqmB,WADD,CACa,IAAI1gC,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CADb,EACuC,IAAI/U,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CADvC;;AAGF,cAAIurB,OAAOxrB,IAAP,CAAYvT,CAAZ,IAAiB,CAAjB,IAAuB,CAAC++B,OAAOE,QAAnC,EAA6C;AAC3CF,mBAAO3U,IAAP,CAAY2U,OAAOrB,SAAP,CAAiB7H,IAAjB,CAAsB,IAAIp3B,QAAQ+U,MAAZ,CAAmBurB,OAAOtnB,KAA1B,EAAiCsnB,OAAOtnB,KAAxC,CAAtB,CAAZ;;AAEF,cAAG,CAACsnB,OAAOE,QAAX,EACAF,OAAOZ,aAAP;AAED,SAjBD;;AAmBA1/B,gBAAQF,GAAR,CAAY,wCAAZ;;AAEA,eAAO,IAAP;AAED;;AAED;;;;;AAMA;;;;;;;;AAlUS;AAAA;AAAA,6BA0UFyJ,IA1UE,EA0UI;;AAEX,YAAI+2B,SAAS,IAAb;AACA/2B,eAAOA,QAAQ,YAAW,CAAE,CAA5B;;AAEA,aAAKg3B,SAAL,GAAiBh3B,IAAjB;;AAEA,aAAK21B,KAAL,CAAW9S,UAAX,CAAsB8E,MAAtB,GAA+B,YAAW;;AAExC3nB,eAAKyiB,IAAL,CAAUsU,MAAV,EAAkB/2B,IAAlB;AAED,SAJD;AAMD;;AAED;;;;;;;;AAzVS;AAAA;AAAA,4BAiWHA,IAjWG,EAiWG;;AAEV,YAAI,KAAK2B,OAAL,CAAaI,OAAb,CAAqB/B,IAArB,KAA8B,CAAC,CAAnC,EAAsC;AACpC,eAAK2B,OAAL,CAAa3D,IAAb,CAAkBgC,KAAKyiB,IAAL,CAAU,IAAV,CAAlB;AACD;AACF;;AAGD;;;;;;;;AAzWS;AAAA;AAAA,iCAiXEziB,IAjXF,EAiXQ;;AAEf,YAAI,KAAK4B,YAAL,CAAkBG,OAAlB,CAA0B/B,IAA1B,KAAmC,CAAC,CAAxC,EAA2C;AACzC,eAAK4B,YAAL,CAAkB5D,IAAlB,CAAuBgC,KAAKyiB,IAAL,CAAU,IAAV,CAAvB;AACD;AACF;;AAGD;;;;;;;;AAzXS;AAAA;AAAA,mCAiYIziB,IAjYJ,EAiYU;AACjB,aAAK4B,YAAL,GAAoB,EAApB;AACA,YAAI,KAAKA,YAAL,CAAkBG,OAAlB,CAA0B/B,IAA1B,KAAmC,CAAC,CAAxC,EAA2C;AACzC,eAAK4B,YAAL,CAAkB5D,IAAlB,CAAuBgC,KAAKyiB,IAAL,CAAU,IAAV,CAAvB;AACD;AACF;AAtYQ;AAAA;AAAA,oCAwYK;AACZ;AACA,aAAK,IAAIzqB,IAAI,CAAb,EAAgBA,IAAI,KAAK2J,OAAL,CAAa3E,MAAjC,EAAyChF,GAAzC,EAA8C;AAC5C,eAAK2J,OAAL,CAAa3J,CAAb,EAAgB,IAAhB;AACD;AACF;AA7YQ;AAAA;AAAA,yCA+YU;AACjB;AACA,aAAK,IAAIA,IAAI,CAAb,EAAgBA,IAAI,KAAK4J,YAAL,CAAkB5E,MAAtC,EAA8ChF,GAA9C,EAAmD;AACjD,eAAK4J,YAAL,CAAkB5J,CAAlB,EAAqB,IAArB;AACD;AACF;AApZQ;AAAA;AAAA,8BAuZD+yB,CAvZC,EAuZE;AACT,aAAKgL,OAAL,GAAehL,CAAf;AACA,eAAO,IAAP;AACD;AA1ZQ;AAAA;AAAA,gCA6ZC7H,CA7ZD,EA6ZIC,CA7ZJ,EA6ZO;AACd,aAAKuS,SAAL,GAAiB,IAAIj/B,QAAQ+U,MAAZ,CAAmB0X,CAAnB,EAAsBC,CAAtB,CAAjB;AACA,aAAK8T,QAAL,GAAgB,IAAhB;AACA,aAAKd,aAAL;AACA,eAAO,IAAP;AACD;AAlaQ;AAAA;AAAA,6BAoaF;AACL,aAAKiB,KAAL,GAAa,IAAb;AACA,eAAO,IAAP;AACD;AAvaQ;AAAA;AAAA,kCAyaE;AACT,aAAKA,KAAL,GAAa,KAAb;AACA,aAAKnzB,GAAL,GAAW,KAAK6xB,OAAhB;AACD;AA5aQ;AAAA;AAAA,uCA8aQ3M,EA9aR,EA8aYC,EA9aZ,EA8agBC,EA9ahB,EA8aoBC,EA9apB,EA8awB+N,MA9axB,EA8agCC,MA9ahC,EA8awC;AAC/C,YAAIC,QAAJ;;AAEA,YAAI,OAAOF,MAAP,IAAiB,QAAjB,IAA6B,OAAOC,MAAP,IAAiB,QAAlD,EACEC,WAAW,IAAI9gC,QAAQ+U,MAAZ,CAAmB6rB,MAAnB,EAA2BC,MAA3B,CAAX;;AAEF,aAAKtB,WAAL,GAAmB,IAAIv/B,QAAQizB,iBAAZ,CACjB,IAAIjzB,QAAQ+U,MAAZ,CAAmB2d,EAAnB,EAAuBC,EAAvB,CADiB,EACW,IAAI3yB,QAAQ+U,MAAZ,CAAmB6d,EAAnB,EAAuBC,EAAvB,CADX,EACuCiO,QADvC,CAAnB;AAEA,aAAKN,QAAL,GAAgB,IAAhB;AACA,aAAKd,aAAL;AACA,eAAO,IAAP;AACD;AAzbQ;AAAA;AAAA,kCA2bGn+B,CA3bH,EA2bM0B,CA3bN,EA2bS;AAChB,aAAKw8B,WAAL,GAAmB,IAAIz/B,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,CAAnB;AACA,eAAO,IAAP;AACD;AA9bQ;AAAA;AAAA,+BAgcA;AACP,YAAI,CAAC,KAAK88B,WAAV,EAAuB;AACrB,eAAKA,WAAL,GAAmB,IAAnB;AACD;AACD,eAAO,IAAP;AACD;AArcQ;AAAA;AAAA,+BAucAnV,MAvcA,EAucQ;AACf,aAAKnC,QAAL,GAAgBmC,MAAhB;AACA,eAAO,IAAP;AACD;;AAGD;;;;;;;AA7cS;AAAA;AAAA,sCAodO;;AAEd,aAAKoV,cAAL,GAAsB,IAAtB;AACA,eAAO,IAAP;AACD;;AAED;;;;;;;;AA1dS;AAAA;AAAA,oCAkeK;AACZ,aAAKb,gBAAL;AACA,eAAO,IAAP;AACD;AAreQ;AAAA;AAAA,6BAueF72B,IAveE,EAueI5G,GAveJ,EAueSZ,QAveT,EAuemB;;AAE1B,YAAIwH,KAAK1G,cAAL,CAAoBF,GAApB,CAAJ,EAA8B;AAC5B,iBAAO4G,KAAK5G,GAAL,CAAP;AACD,SAFD,MAEO;AACL,iBAAOZ,QAAP;AACD;AACF;AA9eQ;AAAA;AAAA,6BAgfF;AACL,aAAK4+B,aAAL;AACA,eAAO,IAAP;AACD;AAnfQ;AAAA;AAAA,sCAsfO;AACd,aAAKG,MAAL,GAAc,EAAd;;AAEA,YAAI,CAAC,KAAK/qB,IAAV,EAAgB;AACd,eAAK6W,IAAL,CAAU,KAAKsT,SAAL,CAAe19B,CAAzB,EAA4B,KAAK09B,SAAL,CAAeh8B,CAA3C;AACD;;AAED,YAAI89B,SAAS,CAAb;AACA,YAAIC,WAAW,KAAf;;AAEA,aAAK,IAAI/9B,IAAI,KAAKs8B,WAAL,CAAiBj/B,GAAjB,CAAqB2C,CAAlC,EAAqCA,KAAK,KAAKs8B,WAAL,CAAiBh/B,GAAjB,CAAqB0C,CAA/D,EAAkEA,GAAlE,EAAuE;AACrE,eAAK,IAAI1B,OAAI,KAAKg+B,WAAL,CAAiBj/B,GAAjB,CAAqBiB,CAAlC,EAAqCA,QAAK,KAAKg+B,WAAL,CAAiBh/B,GAAjB,CAAqBgB,CAA/D,EAAkEA,MAAlE,EAAuE;;AAErE,gBAAI0/B,WAAW;AACb1/B,iBAAGA,OAAI,KAAK09B,SAAL,CAAe19B,CAAnB,GAAuB,KAAKk+B,WAAL,CAAiBl+B,CAD9B;AAEb0B,iBAAGA,IAAI,KAAKg8B,SAAL,CAAeh8B,CAAnB,GAAuB,KAAKw8B,WAAL,CAAiBx8B;AAF9B,aAAf;;AAKA,gBAAIyS,IAAI,IAAI1V,QAAQ+V,KAAZ,GAAoBmrB,KAApB,CAA0B,KAAKhC,KAA/B,EAAsCiC,QAAtC,CAA+CF,QAA/C,EAAyDR,SAAzD,CAAmE,KAAKxB,SAAxE,EAAmFmC,MAAnF,CAA0F,KAAK5B,MAA/F,EAAuG7T,IAAvG,CAA4G,KAAK7W,IAAL,IAAa,KAAKmqB,SAA9H,EAAyI3vB,QAAzI,CAAkJ,KAAKoI,QAAL,IAAiBupB,QAAnK,CAAR;AACAvrB,cAAE0iB,QAAF,CAAW,KAAKV,QAAhB;;AAEA,iBAAKmI,MAAL,CAAYt4B,IAAZ,CAAiBmO,CAAjB;;AAEA,gBAAInU,QAAK,KAAKg+B,WAAL,CAAiBrM,SAAjB,CAA2B3xB,CAAhC,IAAqC0B,KAAK,KAAKs8B,WAAL,CAAiBrM,SAAjB,CAA2BjwB,CAAzE,EAA4E;AAC1E+9B,yBAAW,IAAX;AACA;AACD;;AAEDD,sBAAU,CAAV;;AAEA,gBAAIC,QAAJ,EACE;AAEH;AAEF;;AAED,aAAKnB,MAAL,CAAY,CAAZ,IAAiB,KAAKD,cAAL,GAAsB,KAAKC,MAAL,CAAY,CAAZ,KAAkB,IAAI7/B,QAAQ+V,KAAZ,GAAoBmrB,KAApB,CAA0B,KAAKhC,KAA/B,EAAsCuB,SAAtC,CAAgD,KAAKxB,SAArD,EAAgEtT,IAAhE,CAAqE,KAAKsT,SAA1E,CAAzD;;AAEA,YAAI,KAAKc,WAAT,EAAsB;;AAEpB;;AAEA,cAAIsB,kBAAkB,KAAKxB,MAAL,CAAYyB,KAAZ,GAAoBC,OAApB,EAAtB;;AAEA,eAAK1B,MAAL,CAAY2B,GAAZ;;AAEA,eAAK3B,MAAL,GAAc,KAAKA,MAAL,CAAYv6B,MAAZ,CAAmB+7B,eAAnB,CAAd;AAED;AACD,YAAI,KAAKrB,cAAT,EAAyB;AACvB,eAAKH,MAAL,CAAY0B,OAAZ;AACD;AACF;AA3iBQ;AAAA;AAAA,8BA6iBDE,YA7iBC,EA6iBa;;AAEpB,YAAI71B,IAAIpL,SAASgB,yBAAT,CAAmCigC,YAAnC,EAAiD,MAAjD,EAAyD,wDAAzD,CAAR;;AAEA,eAAO71B,EAAElF,GAAF,CAAM,KAAKu4B,SAAX,CAAP;AAED;AAnjBQ;AAAA;AAAA,sCAqjBO;AACdz+B,iBAASC,IAAT,CAAc,iBAAd;;AAEA,YAAI,CAACD,SAASW,UAAT,CAAoB,CAAC,KAAK+9B,KAAN,EAAa,KAAKA,KAAL,CAAW9S,UAAxB,CAApB,CAAL,EACE,OAAO,EAAP;;AAEF,aAAKsV,YAAL,GAAoB,KAAKA,YAAL,IAAqB,IAAI1hC,QAAQ2hC,wBAAZ,CAAqC,KAAKzC,KAA1C,CAAzC;;AAEA,aAAK0C,QAAL,GAAgB,KAAKA,QAAL,IAAiB,KAAKC,gBAAL,EAAjC;;AAEA,eAAO,KAAKD,QAAZ;AACD;AAhkBQ;AAAA;AAAA,yCAmkBU;;AAEjB,YAAI1C,QAAQ,KAAKA,KAAL,CAAW9S,UAAvB;AAAA,YAEEH,MAAM,KAAKyV,YAAL,CAAkBzV,GAF1B;AAAA,YAIEoB,OAAO,EAJT;AAAA,YAMEyU,eAAe,KAAKlC,cAAL,CAAoBX,SAApB,CAA8Bv4B,GAA9B,CAAkC,EAAlC,EAAsCuO,KAAtC,EANjB;;AAQA,aAAK,IAAI1T,IAAI,CAAb,EAAgBA,KAAK29B,MAAM5kB,KAA3B,EAAkC/Y,KAAKugC,aAAavgC,CAApD,EAAuD;AACrD,eAAK,IAAI0B,IAAI,CAAb,EAAgBA,KAAKi8B,MAAM7kB,MAA3B,EAAmCpX,KAAK6+B,aAAa7+B,CAArD,EAAwD;AACtD;AACA,gBAAI8+B,QAAQ9V,IAAIU,YAAJ,CAAiBprB,CAAjB,EAAoB0B,CAApB,EAAuB,CAAvB,EAA0B,CAA1B,CAAZ;AACA;AACA,gBAAI8+B,MAAM7tB,IAAN,CAAW,CAAX,KAAiB,CAArB,EAAwB;;AAEtB,kBAAI8tB,SAAS,IAAIhiC,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,CAAb;AAAA,kBAEEg/B,aAAa;;AAEXvqB,0BAAUsqB,MAFC;;AAIXltB,sBAAMgtB;AAJK,eAFf;;AASAzU,mBAAK9lB,IAAL,CAAU06B,UAAV;AACD;AACF;AACF;;AAED,eAAO5U,IAAP;AACD;;AAGD;;;;;;;AAtmBS;AAAA;AAAA,2CA6mBY;;AAEnB7sB,iBAASC,IAAT,CAAc,sBAAd;AACA,YAAIyhC,MAAM,EAAV;AACA,YAAIC,QAAQ,KAAKvC,cAAjB;AACA,YAAIj1B,SAAS,IAAb;;AAEA,aAAKi3B,QAAL,GAAgB,KAAKQ,aAAL,EAAhB;;AAEA,aAAK,IAAI7gC,CAAT,IAAc,KAAKqgC,QAAnB,EAA6B;AAC3B,cAAIhiC,IAAI,KAAKgiC,QAAL,CAAcrgC,CAAd,CAAR;;AAEA,cAAIvB,QAAQuY,SAAR,CAAkBC,UAAlB,CAA6B2pB,MAAMlB,QAAnC,EAA6CkB,MAAMlD,SAAnD,EAA8Dr/B,EAAE8X,QAAhE,EAA0E9X,EAAEkV,IAA5E,CAAJ,EAAuF;AACrFotB,gBAAI36B,IAAJ,CAAS3H,CAAT;AACD;AACF;;AAED,eAAOsiC,GAAP;AAED;;AAED;;;;;;;;AAloBS;AAAA;AAAA,+BA0oBAv9B,EA1oBA,EA0oBI;AACX,aAAKi7B,cAAL,GAAsB,KAAKC,MAAL,CAAYl7B,EAAZ,CAAtB;AACD;;AAGD;;;;;;;;;;;;;;;;;AA/oBS;AAAA;AAAA,+BAiqBAo6B,GAjqBA,EAiqBK;;AAEZA,cAAMA,IAAI/S,IAAJ,CAAS,IAAT,CAAN;;AAEA,YAAIhe,SAAS,KAAKq0B,YAAL,CAAkBrW,IAAlB,CAAuB,IAAvB,CAAb;AACA,YAAIrhB,SAAS,IAAb;AACA,aAAK03B,YAAL,GAAoB,UAAS13B,MAAT,EAAiB;AACnCqD,iBAAOrD,MAAP;AACAo0B,cAAIp0B,MAAJ;AACD,SAHD;AAID;AA3qBQ;AAAA;AAAA,iCA6qBEo0B,GA7qBF,EA6qBO;;AAEdA,cAAMA,IAAI/S,IAAJ,CAAS,IAAT,CAAN;;AAEA,YAAIrhB,SAAS,IAAb;AACA,aAAK03B,YAAL,GAAoB,UAAS13B,MAAT,EAAiB;AACnCo0B,cAAIp0B,MAAJ;AACD,SAFD;AAGD;AArrBQ;AAAA;AAAA,qCAurBM;;AAEb,aAAKi1B,cAAL,GAAsB,KAAKC,MAAL,CAAY/4B,KAAKmO,KAAL,CAAW,KAAKzH,GAAhB,IAAuB,KAAKqyB,MAAL,CAAYt5B,MAA/C,CAAtB;AACD;AA1rBQ;AAAA;AAAA,8BA4rBD;;AAEN,aAAKm5B,aAAL;;AAEA,aAAKlyB,GAAL,GAAW,CAAX;AACD;;AAED;;;;;;;;AAnsBS;AAAA;AAAA,4BA2sBH;;AAEJ,YAAI,KAAK80B,WAAL,IAAoB,QAAxB,EAAkC;AAChC,iBAAO,CAAP;AACD;;AAED,aAAK5C,aAAL;;AAEA,aAAKlyB,GAAL,IAAY,CAAZ;;AAEA,aAAK60B,YAAL;AACD;;AAED;;;;;;;AAxtBS;AAAA;AAAA,gCA+tBC;;AAGR,YAAI,KAAKC,WAAL,IAAoB,QAAxB,EAAkC;AAChC,iBAAO,CAAP;AACD;;AAGD,YAAG,CAAC,KAAKC,OAAT,EACA;AACE,eAAK7C,aAAL;AACA,eAAK6C,OAAL,GAAe,IAAf;AACD;;AAID;AACA;;AAEJ;;AAEA;;AAEI,YAAI,KAAK/0B,GAAL,GAAW,KAAKqyB,MAAL,CAAYt5B,MAAvB,IAAiC,CAArC,EAAwC;;AAEtC,eAAKi8B,MAAL;AAED;AACF;;AAED;;;;;;;;AA7vBS;AAAA;AAAA,6BAqwBF/Z,QArwBE,EAqwBQ;;AAEf,aAAKga,WAAL;;AAEAha,mBAAWA,YAAY,KAAKA,QAAjB,IAA6B,KAAKoX,MAAL,CAAYt5B,MAAZ,GAAqB,EAA7D;;AAEA,YAAI,KAAK+7B,WAAL,IAAoB,QAAxB,EAAkC;AAChC,iBAAO,CAAP;AACD;;AAED;AACA,YAAI,KAAK90B,GAAL,IAAY,KAAKqyB,MAAL,CAAYt5B,MAAZ,GAAqB,CAAjC,IAAsC,KAAKiH,GAAL,GAAW,KAAK6xB,OAAhB,IAA2B,CAAC,KAAKsB,KAA3E,EAAkF;AAChF,eAAKnzB,GAAL,GAAW,KAAK6xB,OAAhB;AACD;;AAED,YAAI10B,SAAS,IAAb;;AAEA;AACA,aAAK+3B,KAAL,GAAa,IAAIvS,MAAMwS,KAAV,CAAgB,IAAhB,EACVC,MADU,CACHj4B,OAAOk4B,KAAP,IAAgB1S,MAAM2S,MAAN,CAAa5N,MAAb,CAAoB7L,IADjC,EAGV0Z,EAHU,CAGP;AACFv1B,eAAK,KAAK6xB,OAAL,IAAgB,KAAKQ,MAAL,CAAYt5B,MAAZ,GAAqB,CAArC;AADH,SAHO,EAKRkiB,QALQ,EAMV1a,QANU,CAMD,YAAW;AACnB;;AAEA;;AAEApD,iBAAO03B,YAAP;AAED,SAbU,EAcVj6B,UAdU,CAcC,YAAW;AACrB;;AAEE,cAAG,CAACuC,OAAOg2B,KAAX,EACFh2B,OAAO6C,GAAP,GAAa7C,OAAO00B,OAApB;;AAEA10B,iBAAOq4B,gBAAP;;AAEAr4B,iBAAOs4B,UAAP,GAAoB,IAApB;;AAEAt4B,iBAAO+0B,aAAP;AAED,SA1BU,CAAb;;AA6BA,YAAI,KAAKlyB,GAAL,IAAY,KAAK6xB,OAArB,EACE,KAAKqD,KAAL,CAAW/S,KAAX;AAGH;AAxzBQ;AAAA;AAAA,wBAsIGhd,KAtIH,EAsIU;AACjB,aAAKM,GAAL,GAAWN,KAAX;AACD,OAxIQ;AAAA,0BA0IK;AACZ,eAAO,KAAKM,GAAZ;AACD;AA5IQ;;AAAA;AAAA;;AAyzBV;;AAED;;AAEAkC,YAAU+tB,SAAV,CAAoBxC,WAApB,GAAkCvrB,UAAU+tB,SAAV,CAAoBC,gBAAtD;;AAEAnjC,UAAQmV,SAAR,GAAoBA,SAApB;;AAEAnV,UAAQmV,SAAR,CAAkBiuB,UAAlB,GAA+BpjC,QAAQmV,SAAR,CAAkB9G,GAAjD,CAj0BW,CAi0B2C;;AAEtDrO,UAAQmV,SAAR,CAAkBnH,MAAlB,GAA2BhO,QAAQmV,SAAR,CAAkBktB,YAA7C,CAn0BW,CAm0BgD;;AAE3DriC,UAAQmV,SAAR,CAAkBkuB,QAAlB,GAA6BrjC,QAAQmV,SAAR,CAAkB9G,GAA/C,CAr0BW,CAq0ByC;AAErD,CAv0BA;AAw0BD;IAAOi1B,I;AACL,kBAAc;AAAA;;AACZ,SAAKp7B,MAAL,GAAcwgB,SAAd;AACA,SAAKtO,MAAL,GAAcsO,SAAd;AACD;;;;6CACwB;AACvB;AACA,UAAI6a,gBAAgBvjC,QAAQu4B,UAAR,CAAmBnF,cAAnB,CAAkC,KAAKoQ,MAAL,CAAYjiC,CAA9C,EAAiD,KAAKiiC,MAAL,CAAYvgC,CAA7D,EAAgE,KAAKiF,MAAL,CAAYwvB,QAAZ,CAAqBn2B,CAArF,CAApB;AAAA,UACAkiC,eAAe,KAAKv7B,MAAL,CAAYwP,QAAZ,CAAqBjD,GAArB,CAAyB8uB,aAAzB,CADf;AAEA,WAAKnpB,MAAL,CAAY9K,QAAZ,CAAqBm0B,YAArB;AACA,WAAKC,YAAL,CAAkB,KAAKtpB,MAAL,CAAYsd,QAA9B;AACA,aAAO+L,YAAP;AACD;;;iCAEYliC,C,EAAG0B,C,EAAGwU,C,EAAG;AACpB,WAAK2C,MAAL,CAAYge,QAAZ,CAAqB72B,CAArB,EAAwB0B,CAAxB,EAA2BwU,CAA3B;AACA,aAAO,IAAP;AACD;;;2BAEMrV,C,EAAG;AACR,WAAK8F,MAAL,GAAc9F,CAAd;AACA,aAAO,IAAP;AACD;;;2BACMwY,C,EAAG;AACR,WAAKR,MAAL,GAAcQ,CAAd;AACA,aAAO,IAAP;AACD;;;;;;AAGH5a,QAAQsjC,IAAR,GAAeA,IAAf;;IAEMK,S,GACJ,mBAAYC,QAAZ,EAAsB;AAAA;;AACpB,MAAIC,SAAS,EAAb;AACAD,WAASx+B,OAAT,CAAiB,UAAS+6B,IAAT,EAAe;AAC9B0D,WAAOt8B,IAAP,CAAY;AACV44B,YAAMA,IADI;AAEVqD,cAAQ,IAAIxjC,QAAQ+U,MAAZ,EAFE;AAGV2iB,gBAAU,IAAI13B,QAAQ+U,MAAZ,EAHA;AAIVD,YAAM,IAAI9U,QAAQ+U,MAAZ;AAJI,KAAZ;AAMD,GAPD;AAQD,C;;AAGH/U,QAAQ2jC,SAAR,GAAoBA,SAApB;AACA,CAAC;;IAGKG,K;AAEJ,iBAAYxxB,GAAZ,EAAiBwC,IAAjB,EAAsB;AAAA;;AACpB,SAAKxF,QAAL,CAAcgD,MAAM,CAApB;AACA,SAAKqZ,IAAL,CAAU7W,OAAO,CAAjB;AACD;;;;6BAEQvT,C,EAAG0B,C,EACZ;AACE,WAAKyU,QAAL,GAAgB,IAAI1X,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,CAAhB;AACA,aAAO,IAAP;AACD;;;yBACI1B,C,EAAG0B,C,EACR;AACE,WAAK6R,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,CAAZ;AACA,aAAO,IAAP;AACD;;;;;;AAMHjD,QAAQ8jC,KAAR,GAAgBA,KAAhB;AACA,CAAC,CAAC,CAAC,YAAW;AACZjkC,UAAQC,GAAR,CAAY,yBAAZ;;AAEA;;;;;;;;;;;;;;AAHY,MAkBNiW,KAlBM;AAmBV,qBAAc;AAAA;;AACZ,UAAIpL,SAAS,IAAb;AACA,WAAKs2B,QAAL,GAAgB,IAAIjhC,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAAhB;AACA,WAAKyqB,MAAL,GAAc,IAAIx/B,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAAd;AACA,WAAK2iB,QAAL,GAAgB,IAAI13B,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAhB;AACD;;AAxBS;AAAA;AAAA,4BA0BJ9B,GA1BI,EA0BC;AACT,aAAKisB,KAAL,GAAa,IAAIl/B,QAAQyzB,SAAZ,CAAsBxgB,GAAtB,CAAb;AACA,eAAO,IAAP;AACD;AA7BS;AAAA;AAAA,6BA+BH7T,GA/BG,EA+BE;;AAEVA,cAAMA,OAAO,YAAW,CAAE,CAA1B;AACAA,cAAMA,IAAI4sB,IAAJ,CAAS,IAAT,CAAN;AACA,aAAKkT,KAAL,CAAW9S,UAAX,CAAsB8E,MAAtB,GAA+B,YAAW;AACxC9xB;AACD,SAFD;AAID;AAvCS;AAAA;AAAA,6BAyCHmC,CAzCG,EAyCA0B,CAzCA,EAyCGwU,CAzCH,EAyCM;AACd,aAAK+nB,MAAL,GAAc,IAAIx/B,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAAd;AACA,eAAO,IAAP;AACD;AA5CS;AAAA;AAAA,+BA8CDlW,CA9CC,EA8CE0B,CA9CF,EA8CKwU,CA9CL,EA8CQ;AAChB,aAAKigB,QAAL,GAAgB,IAAI13B,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAAhB;AACA,eAAO,IAAP;AACD;AAjDS;AAAA;AAAA,+BAmDDrV,CAnDC,EAmDE;AACV,aAAK6+B,QAAL,GAAgB,IAAIjhC,QAAQ+U,MAAZ,CAAmB3S,CAAnB,EAAsBA,CAAtB,EAAyBA,CAAzB,CAAhB;;AAEA,eAAO,IAAP;AACD;AAvDS;AAAA;AAAA,gCAyDAb,CAzDA,EAyDG0B,CAzDH,EAyDMwU,CAzDN,EAyDS;AACjB,aAAKwnB,SAAL,GAAiB,IAAIj/B,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAAjB;AACA,eAAO,IAAP;AACD;AA5DS;AAAA;AAAA,4BA8DJ7L,CA9DI,EA+DV;AACE,YAAG,KAAKszB,KAAL,IAAc,KAAKA,KAAL,CAAW9S,UAA5B,EACA;AACE,eAAKtX,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmBjO,KAAKmO,KAAL,CAAW,KAAKiqB,KAAL,CAAW9S,UAAX,CAAsB9R,KAAtB,GAA8B1O,CAAzC,CAAnB,EAAgE9E,KAAKmO,KAAL,CAAW,KAAKiqB,KAAL,CAAW9S,UAAX,CAAsB/R,MAAtB,GAA+BzO,CAA1C,CAAhE,CAAZ;AACD;AACF;AApES;AAAA;AAAA,uCAsEO;;AAEf,aAAK2gB,SAAL,GAAiB,KAAKA,SAAL,IAAkB,IAAIvsB,QAAQ2hC,wBAAZ,CAAqC,KAAKzC,KAA1C,CAAnC;;AAEA,aAAK,IAAI39B,CAAT,IAAc,KAAKgrB,SAAnB,EAA8B;AAC5B,cAAIhrB,KAAK,KAAL,IAAcA,KAAK,QAAvB,EACE,KAAKA,CAAL,IAAU,KAAKgrB,SAAL,CAAehrB,CAAf,CAAV;AACH;;AAED,eAAO,IAAP;AAED;AAjFS;AAAA;AAAA,+BAmFD;AACP,aAAKwiC,cAAL;AACA,eAAO,KAAKxX,SAAL,CAAevB,MAAf,CAAsBgZ,SAAtB,EAAP;AACD;AAtFS;AAAA;AAAA,4CAwF6B;AAAA,YAAnBC,QAAmB,uEAAR,CAAQ;AAAA,YAALhY,GAAK;;;AAErC,YAAIoB,OAAO,EAAX;;AAEApB,cAAMA,OAAO,KAAKA,GAAlB;;AAEA,YAAI3rB,MAAM,KAAK2gC,QAAf;AAAA,YACE1gC,MAAM,KAAK0gC,QAAL,CAAcxsB,GAAd,CAAkB,KAAKwqB,SAAvB,CADR;;AAIA,aAAK,IAAI19B,IAAIjB,IAAIiB,CAAjB,EAAoBA,KAAKhB,IAAIgB,CAA7B,EAAgCA,KAAK0iC,QAArC,EAA+C;AAC7C,eAAK,IAAIhhC,IAAI3C,IAAI2C,CAAjB,EAAoBA,KAAK1C,IAAI0C,CAA7B,EAAgCA,KAAKghC,QAArC,EAA+C;AAC7C;AACA,gBAAIlC,QAAQ9V,IAAIU,YAAJ,CAAiBprB,CAAjB,EAAoB0B,CAApB,EAAuB,CAAvB,EAA0B,CAA1B,CAAZ;AACA;AACA,gBAAI8+B,MAAM7tB,IAAN,CAAW,CAAX,KAAiB,CAArB,EAAwB;;AAEtB,kBAAI8tB,SAAS,IAAIhiC,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,CAAb;AAAA,kBAEEg/B,aAAa;;AAEXvqB,0BAAUsqB,MAFC;;AAIXzgC,mBAAEA,CAJS;AAKX0B,mBAAEA,CALS;;AAOX6R,sBAAM,IAAI9U,QAAQ+U,MAAZ,CAAmBkvB,QAAnB,EAA6BA,QAA7B,CAPK;;AASXlC,uBAAOA,KATI;;AAWXrK,0BAAS,KAAKA;;AAXH,eAFf;;AAiBArK,mBAAK9lB,IAAL,CAAU06B,UAAV;AACD;AACF;AACF;;AAED,eAAO5U,IAAP;AACD;AAhIS;AAAA;AAAA,+CAkIgC;AAAA,YAAnB4W,QAAmB,uEAAR,CAAQ;AAAA,YAALhY,GAAK;;;AAExC,YAAIoB,OAAO,EAAX;;AAEApB,cAAMA,OAAO,KAAKA,GAAlB;;AAEA,YAAI3rB,MAAM,KAAK2gC,QAAf;AAAA,YACE1gC,MAAM,KAAK0gC,QAAL,CAAcxsB,GAAd,CAAkB,KAAKwqB,SAAvB,CADR;;AAIA,aAAK,IAAI19B,IAAIjB,IAAIiB,CAAjB,EAAoBA,KAAKhB,IAAIgB,CAA7B,EAAgCA,KAAK0iC,QAArC,EAA+C;AAC7C,eAAK,IAAIhhC,IAAI3C,IAAI2C,CAAjB,EAAoBA,KAAK1C,IAAI0C,CAA7B,EAAgCA,KAAKghC,QAArC,EAA+C;AAC7C;AACA,gBAAIlC,QAAQ9V,IAAIU,YAAJ,CAAiBprB,CAAjB,EAAoB0B,CAApB,EAAuB,CAAvB,EAA0B,CAA1B,CAAZ;AACA;AACA,gBAAI8+B,MAAM7tB,IAAN,CAAW,CAAX,KAAiB,CAArB,EAAwB;;AAEtB,kBAAI8tB,SAAS,IAAIhiC,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,CAAb;AAAA,kBAEEg/B,aAAa;;AAEXvqB,0BAAUsqB,MAFC;;AAIXzgC,mBAAEA,CAJS;AAKX0B,mBAAEA,CALS;;AAOX6R,sBAAM,IAAI9U,QAAQ+U,MAAZ,CAAmBkvB,QAAnB,EAA6BA,QAA7B,CAPK;;AASXlC,uBAAOA,KATI;;AAWXrK,0BAAS,KAAKA;;AAXH,eAFf;;AAiBArK,mBAAK9lB,IAAL,CAAU06B,UAAV;AACD;AACF;AACF;;AAED,eAAO5U,IAAP;AACD;AA1KS;AAAA;AAAA,yCA4K0B;AAAA,YAAnB4W,QAAmB,uEAAR,CAAQ;AAAA,YAALhY,GAAK;;;AAElCA,cAAMA,OAAO,KAAKA,GAAlB;;AAEA,YAAIoB,OAAO,EAAX;;AAEA,YAAI/sB,MAAM,KAAK2gC,QAAf;AAAA,YACE1gC,MAAM,KAAK0gC,QAAL,CAAcxsB,GAAd,CAAkB,KAAKwqB,SAAvB,CADR;;AAGA,aAAK,IAAI19B,IAAIjB,IAAIiB,CAAjB,EAAoBA,KAAKhB,IAAIgB,CAA7B,EAAgCA,KAAK0iC,QAArC,EAA+C;AAC7C,eAAK,IAAIhhC,IAAI3C,IAAI2C,CAAjB,EAAoBA,KAAK1C,IAAI0C,CAA7B,EAAgCA,KAAKghC,QAArC,EAA+C;AAC7C;AACA,gBAAIlC,QAAQ9V,IAAIU,YAAJ,CAAiBprB,CAAjB,EAAoB0B,CAApB,EAAuB,CAAvB,EAA0B,CAA1B,CAAZ;AACA;;;AAGA,gBAAI++B,SAAS,IAAIhiC,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,CAAb;AAAA,gBAEEg/B,aAAa;;AAEXvqB,wBAAUsqB,MAFC;;AAIXzgC,iBAAEA,CAJS;AAKX0B,iBAAEA,CALS;;AAOX6R,oBAAM,IAAI9U,QAAQ+U,MAAZ,CAAmBkvB,QAAnB,EAA6BA,QAA7B,CAPK;;AASXlC,qBAAOA,KATI;;AAWXrK,wBAAS,KAAKA;;AAXH,aAFf;;AAiBArK,iBAAK9lB,IAAL,CAAU06B,UAAV;AACD;AACF;;AAED,eAAO5U,IAAP;AACD;;AAGD;;;;;;;;AArNU;AAAA;AAAA,qCA6NKvY,IA7NL,EA6NWmX,GA7NX,EA6NgB;;AAExB,aAAK8X,cAAL;;AAEA9X,cAAMA,OAAO,KAAKA,GAAlB;;AAEA,aAAK2V,QAAL,GAAgB,KAAKA,QAAL,IAAiB,KAAKsC,mBAAL,CAAyBpvB,IAAzB,EAA+BmX,GAA/B,CAAjC;;AAEA,eAAO,KAAK2V,QAAZ;AACD;AAtOS;AAAA;AAAA,wCAwOQ9sB,IAxOR,EAwOcmX,GAxOd,EAwOmB;AAC3B,aAAK8X,cAAL;AACA9X,cAAMA,OAAO,KAAKA,GAAlB;AACA,aAAKkY,WAAL,GAAmB,KAAKA,WAAL,IAAoB,KAAKC,sBAAL,CAA4BtvB,IAA5B,EAAkCmX,GAAlC,CAAvC;AACA,eAAO,KAAKkY,WAAZ;AACD;AA7OS;AAAA;AAAA,qCAgPKrvB,IAhPL,EAgPWuvB,QAhPX,EAgPqB;AAC7B,YAAG,KAAKnF,KAAL,CAAW9S,UAAX,YAAiC4B,iBAApC,EACA;AACE,eAAKhD,MAAL,GAAc,KAAKkU,KAAL,CAAW9S,UAAzB;AACAH,gBAAM,KAAKA,GAAL,GAAW,KAAKjB,MAAL,CAAYS,UAAZ,CAAuB,IAAvB,CAAjB;AACD,SAJD,MAKI;AACF,eAAKsY,cAAL;AACA9X,gBAAMA,OAAO,KAAKA,GAAlB;AACD;;AAED,aAAK1R,QAAL,GAAgB,KAAKA,QAAL,IAAiB,KAAK+pB,gBAAL,CAAsBxvB,IAAtB,EAA4B,KAAKyvB,OAAjC,CAAjC;AACA,eAAO,KAAKC,YAAZ;AACD;AA7PS;;AAAA;AAAA;;AAiQZxkC,UAAQ+V,KAAR,GAAgBA,KAAhB;AAED,CAnQC;AAoQF;IAAOI,M;;;AACL,oBAAc;AAAA;;AAAA;;AAEZ,WAAKlU,MAAL;AACA,WAAKgW,MAAL,GAAc,EAAd;AACA,WAAKP,QAAL,GAAgB,IAAI1X,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAAhB;AACA,WAAK2iB,QAAL,GAAgB,IAAI13B,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAAhB;AACA,WAAKD,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAAZ;AACA,WAAKmnB,KAAL,GAAa,CAAb;AACA,WAAKuI,SAAL,GAAiB,GAAjB;AACA,WAAK3E,KAAL,GAAa,CAAb;AACA,WAAK4E,WAAL,GAAmB,CAAnB;AACA,WAAKn7B,IAAL,GAAY,YAAW,CAAE,CAAzB;AAXY;AAYb;;;;iCAEYA,I,EAAM;AACjB,WAAKA,IAAL,GAAYA,IAAZ;AACA,aAAO,IAAP;AACD;;;2BAEM;AACL,WAAK2yB,KAAL,IAAc,CAAd;AACA,aAAO,KAAKjkB,MAAL,CAAY,KAAKikB,KAAL,GAAa,KAAKjkB,MAAL,CAAY1R,MAArC,CAAP;AACD;;;0BAEK3G,C,EAAG;AACP,WAAK0b,KAAL,GAAa1b,CAAb;AACA,aAAO,IAAP;AACD;;;iCAEYR,G,EAAmB;AAAA,UAAdulC,UAAc,uEAAH,EAAG;;AAC9B,WAAKA,UAAL,GAAkBA,UAAlB;AACA,WAAKC,aAAL,GAAqBxlC,IAAI4sB,IAAJ,CAAS,IAAT,CAArB;AACE,aAAO,IAAP;AACH;;;+BAEU6Y,U,EAAYvpB,K,EAAM;AACzB,WAAKupB,UAAL,GAAkBA,UAAlB;AACA,WAAKC,WAAL,GAAmBxpB,KAAnB;AACF,aAAO,IAAP;AACD;;;4BAEOgR,C,EAAE;AACR,WAAKyY,OAAL,GAAezY,CAAf;AACA,aAAO,IAAP;AACD;;;sCAEiB0Y,O,EAASC,O,EAAS3pB,K,EAAO4pB,Y,EAAa;AACtD,WAAKL,UAAL,GAAkBG,OAAlB;AACA,WAAKF,WAAL,GAAmBxpB,KAAnB;AACA,WAAK0pB,OAAL,GAAeA,OAAf;AACA,WAAKC,OAAL,GAAeA,OAAf;AACA,WAAKE,gBAAL,GAAwBD,aAAalZ,IAAb,CAAkB,IAAlB,CAAxB;AACA,WAAKoZ,SAAL,GAAiB,CAAjB;AACA,aAAO,IAAP;AACD;;;4BAEOC,U,EAA+C;AAAA,UAAnCC,qBAAmC,uEAAb,YAAU,CAAE,CAAC;;AACrD,UAAIC,MAAMF,WAAW3tB,QAArB;AAAA,UAA+B8tB,MAAMH,WAAWvwB,IAAhD;AACA,UAAI2wB,UAAU,KAAd;AAAA,UAAqBC,OAAO,IAA5B;AACA,WAAKztB,MAAL,CAAY7S,OAAZ,CAAoB,UAAShD,CAAT,EAAW;AAC7B,YAAGA,EAAEb,CAAF,IAAQgkC,IAAIhkC,CAAZ,IAAiBa,EAAEb,CAAF,IAAOgkC,IAAIhkC,CAAJ,GAAQikC,IAAIjkC,CAApC,IACHa,EAAEa,CAAF,IAAQsiC,IAAItiC,CADT,IACcb,EAAEa,CAAF,IAAOsiC,IAAItiC,CAAJ,GAAQuiC,IAAIviC,CADpC,EAEA;AACEwiC,oBAAU,IAAV;AACAH,gCAAsBljC,CAAtB,EAAyBsjC,KAAKztB,MAA9B;AACD;AACF,OAPD;AAQA,aAAOwtB,OAAP;AACD;;;2BAEM;AACL,WAAK,IAAIlkC,IAAI,CAAb,EAAgBA,KAAK,KAAKuT,IAAL,CAAUvT,CAA/B,EAAkCA,GAAlC,EAAuC;AACjC,YAAIokC,UAAU,KAAK7wB,IAAL,CAAUvT,CAAxB;AACA,YAAIqkC,WAAWrkC,IAAIokC,OAAnB;AACF;AACE,YAAI1iC,IAAK,KAAK6R,IAAL,CAAU7R,CAAV,GAAc,KAAKsG,IAAL,CAAUq8B,QAAV,EAAoB,GAApB,CAAvB;AAAA,YACAtzB,MAAM,IAAItS,QAAQ+U,MAAZ,CAAmB/U,QAAQu4B,UAAR,CAAmBnF,cAAnB,CAAkC7xB,CAAlC,EAAqC0B,CAArC,EAAwC,KAAKy0B,QAAL,CAAcn2B,CAAtD,CAAnB,CADN;AAEU,YAAIskC,SAAS,KAAKnuB,QAAL,CAAcnW,CAAd,GAAkB+Q,IAAI/Q,CAAnC;AAAA,YACRukC,SAAS,KAAKpuB,QAAL,CAAczU,CAAd,GAAkBqP,IAAIrP,CADvB;AAAA,YAEV8iC,aAAa,KAAK9tB,MAAL,CAAY,KAAKA,MAAL,CAAY1R,MAAZ,GAAqB,CAAjC,CAFH;AAGV,YAAG,CAACw/B,UAAJ,EACA;AACEA,uBAAa,IAAI/lC,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAAb;AACD;AACD,YAAIixB,aAAa,IAAIhmC,QAAQ+U,MAAZ,CAAmB8wB,MAAnB,EAA2BC,MAA3B,CAAjB;AACAE,mBAAWjuB,CAAX,GAAeiuB,WAAWC,YAAX,CAAwBF,UAAxB,EAAoCC,UAApC,CAAf;AACA,aAAK/tB,MAAL,CAAY1Q,IAAZ,CAAiBy+B,UAAjB;AACH;AACH,aAAO,IAAP;AACD;;;iCAEY1zB,G,EAAI;AACf,UAAIkxB,SAAS,KAAK0C,aAAL,IAAsB,IAAIlmC,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAAnC;AACA,aAAOzC,IAAImC,GAAJ,CAAQ+uB,MAAR,CAAP;AACD;;;8BAES3iC,M,EACV;AACE,WAAK4jC,SAAL,GAAiB5jC,MAAjB;AACA,aAAO,IAAP;AACD;;;0BAEK8pB,C,EACN;AACE,WAAKwb,KAAL,GAAaxb,CAAb;AACA,aAAO,IAAP;AACD;;;oCAEeyb,E,EAChB;AACE,WAAKC,eAAL,GAAuBD,EAAvB;AACA,aAAO,IAAP;AACD;;;yBAEIna,G,EAAKP,M,EAAQ;AAChBO,YAAMA,OAAOjsB,QAAQ4E,YAAR,CAAqB,CAArB,EAAwBqnB,GAArC;AACAP,eAASA,UAAU1rB,QAAQ4E,YAAR,CAAqB,CAArB,EAAwB8mB,MAA3C;;AAEA,WAAKO,GAAL,GAAWA,GAAX;AACA,UAAIhU,SAAS,KAAKA,MAAlB;AACAgU,UAAIqa,IAAJ;AACAra,UAAIsa,WAAJ,GAAkB,KAAKjrB,KAAvB;AACA2Q,UAAIwY,SAAJ,GAAgB,KAAKA,SAArB;AACAxY,UAAIua,SAAJ;AACA,WAAK1G,KAAL,IAAc,CAAd;AACA,UAAI2G,YAAY,KAAhB;;AAEA,UAAIxuB,kBAAkB/W,KAAtB,EAA6B;AAC3B,aAAK,IAAIK,IAAI,CAAb,EAAgBA,IAAI0W,OAAO1R,MAA3B,EAAmChF,GAAnC,EAAwC;AACtC,cAAIa,IAAI6V,OAAO1W,CAAP,CAAR;AACA,cAAGA,KAAK,CAAR,EACA;AACEklC,wBAAYxuB,OAAO1W,CAAP,CAAZ;AACA,gBAAG,KAAKqjC,aAAR,EACA;AACE,mBAAK8B,QAAL,GAAgB,KAAK9B,aAAL,CAAmB6B,SAAnB,EAA8BrkC,CAA9B,EAAiC,KAAKuiC,UAAtC,CAAhB;AACA1Y,kBAAIsa,WAAJ,GAAkB,KAAKG,QAAL,IAAiB,KAAKprB,KAAxC;AACD;AACF;AACD,cAAI5D,WAAWtV,EAAEsV,QAAF,IAActV,CAA7B;AACA,cAAIukC,WAAWjvB,SAASyf,GAAT,CAAazL,OAAOhU,QAApB,CAAf;AACA,cAAIivB,SAAS/kC,cAAT,CAAwB,GAAxB,KAAgC+kC,SAAS/kC,cAAT,CAAwB,GAAxB,CAApC,EAAkE;AAChEqqB,gBAAI2a,MAAJ,CAAWD,SAASplC,CAApB,EAAuBolC,SAAS1jC,CAAhC;AACD;AACF;AACF;;AAED,UAAI4jC,WAAW,KAAK/G,KAAL,IAAc,KAAKmF,OAAL,GAAe,KAAKD,OAAlC,CAAf;AAAA,UACA8B,UAAU,KAAK7B,OAAL,GAAe,KAAKD,OAD9B;AAEA,WAAKN,WAAL,GAAmB59B,KAAKkjB,KAAL,CAAW,KAAK8V,KAAL,IAAc,KAAKmF,OAAL,GAAe,KAAKD,OAAlC,CAAX,CAAnB;;AAEA,UAAG,KAAKH,UAAR,EACA;AACI5Y,YAAI4Y,UAAJ,GAAiB,KAAKA,UAAtB;AACH;AACD,UAAG,KAAKM,gBAAR,EACA;AACElZ,YAAI4Y,UAAJ,GAAiB,KAAKG,OAAL,GAAgB,KAAKG,gBAAL,CAAsB0B,WAAWC,OAAjC,EAA0C,GAA1C,KAAkD,KAAK7B,OAAL,GAAe,KAAKD,OAAtE,CAAjC;AACD;AACD,UAAG,KAAKF,WAAR,EACA;AACE7Y,YAAI6Y,WAAJ,GAAkB,KAAKA,WAAvB;AACD;AACD,UAAG,KAAKuB,eAAR,EACA;AACEpa,YAAI8a,wBAAJ,GAA+B,KAAKV,eAApC;AACD;AACD,UAAG,OAAO,KAAKtB,OAAZ,IAAuB,QAA1B,EACA;AACE9Y,YAAI+a,WAAJ,GAAkB,KAAKjC,OAAvB;AACD;;AAED9Y,UAAIgb,MAAJ;;AAEA,UAAG,KAAKC,SAAR,EACA;AACEjb,YAAIib,SAAJ,GAAgB,KAAKA,SAArB;AACAjb,YAAIkb,SAAJ;AACAlb,YAAImb,IAAJ;AACD;AACDnb,UAAIob,OAAJ;AACD;;;;EAtLmBvT,U;;AA0LtB9zB,QAAQmW,MAAR,GAAiBA,MAAjB;;AAEAnW,QAAQsnC,MAAR,GAAiBnxB,MAAjB;AACA;;IACMoxB,I,GAEF,cAAYC,QAAZ,EAAsB9vB,QAAtB,EACA;AAAA;;AACA,OAAK8vB,QAAL,GAAgBA,QAAhB;AACA,OAAK9vB,QAAL,GAAgBA,QAAhB;AACC,C;;AAIL1X,QAAQunC,IAAR,GAAeA,IAAf;AACA;IAAOvxB,Q;AAEL,sBAAsC;AAAA,QAA1ByZ,OAA0B,uEAAhB,EAAgB;AAAA,QAAZ/nB,UAAY;;AAAA;;AAEpC,QAAIsjB,SAAS3mB,SAASgnB,aAAT,CAAuB,QAAvB,CAAb;;AAEAoE,YAAQ3a,IAAR,GAAe2a,QAAQ3a,IAAR,IAAgB,IAAI9U,QAAQ+U,MAAZ,CAAmB,IAAnB,EAAyB,IAAzB,CAA/B;;AAEA,SAAK0a,OAAL,GAAeA,OAAf;;AAEA,SAAKgY,cAAL,GAAsB,KAAtB;;AAEAzc,WAAO1Q,KAAP,GAAemV,QAAQ3a,IAAR,CAAavT,CAA5B;AACAypB,WAAO3Q,MAAP,GAAgBoV,QAAQ3a,IAAR,CAAa7R,CAA7B;AACA+nB,WAAO7Y,KAAP,CAAaqa,OAAb,GAAuB,MAAvB;;AAEA,SAAK/D,QAAL,GAAgB,GAAhB;;AAEA;AACA,SAAKif,aAAL,GAAqB,IAAI1nC,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAArB;;AAEA,SAAK4yB,SAAL,GAAiB,KAAKD,aAAtB;;AAEA,QAAI,CAAC,KAAKtY,IAAV,EACE,KAAKwY,IAAL,CAAU,EAAV,EAAc,EAAd,EAAkB,QAAlB;;AAEF,SAAKC,aAAL;;AAEA,SAAKC,gBAAL,CAAsBrY,OAAtB;;AAEA,SAAKsY,OAAL,CAAatY,OAAb;;AAEA,QAAIA,QAAQhH,QAAZ,EACE,KAAKA,QAAL,GAAgBgH,QAAQhH,QAAxB;;AAEF,QAAIuf,gBAAgB,EAApB;AAAA,QACEC,gBAAgB,EADlB;AAAA,QAEEhc,MAAMjB,OAAOS,UAAP,CAAkB,IAAlB,CAFR;;AAIA,SAAKuc,aAAL,GAAqB,EAArB;;AAEA,SAAKtgC,UAAL,GAAkBA,UAAlB;AACA,SAAKukB,GAAL,GAAWA,GAAX;AACA,SAAKjB,MAAL,GAAcA,MAAd;;AAEA,SAAKtiB,OAAL,GAAe,EAAf;AACA,SAAKy9B,KAAL,GAAa,CAAb;AACA,SAAKxd,MAAL,GAAc,CAAd;AACA,SAAKuf,KAAL,GAAa,CAAb;AACA,SAAKxwB,QAAL,GAAgB,IAAI1X,QAAQ+U,MAAZ,CAAmB,GAAnB,EAAwB,GAAxB,CAAhB;AACD;;;;0BAEK4V,C,EAAG;AACP,WAAKwb,KAAL,GAAaxb,CAAb;AACA,aAAO,IAAP;AACD;;;gCAE6B;AAAA,UAApBwd,UAAoB,uEAAP,KAAO;;;AAE5B,WAAKC,WAAL,GAAmB,IAAnB;AACA,WAAKC,SAAL,GAAiBhkC,SAASgnB,aAAT,CAAuB,QAAvB,CAAjB;;AAEA,WAAKgd,SAAL,CAAe/tB,KAAf,GAAuB,GAAvB;AACA,WAAK+tB,SAAL,CAAehuB,MAAf,GAAwB,GAAxB;;AAGA,UAAIiuB,OAAJ;;AAEA,UAAIH,UAAJ,EAAgB;AACdG,kBAAUjkC,SAASgnB,aAAT,CAAuB,KAAvB,CAAV;AACAid,gBAAQn2B,KAAR,CAAcuF,QAAd,GAAyB,OAAzB;AACA4wB,gBAAQn2B,KAAR,CAAco2B,QAAd,GAAyB,QAAzB;AACAD,gBAAQn2B,KAAR,CAAcmI,KAAd,GAAsB,KAAtB;AACAguB,gBAAQn2B,KAAR,CAAckI,MAAd,GAAuB,KAAvB;AACA,aAAKiuB,OAAL,GAAeA,OAAf;AACD;;AAED,WAAKE,MAAL,GAAc,KAAKH,SAAL,CAAe5c,UAAf,CAA0B,IAA1B,CAAd;;AAEA,WAAKyT,KAAL,GAAa76B,SAASgnB,aAAT,CAAuB,KAAvB,CAAb;AACA,WAAK6T,KAAL,CAAWjsB,GAAX,GAAiB,KAAKwc,OAAL,CAAaxc,GAA9B;;AAEA,WAAKw1B,QAAL,GAAgB,EAAhB;;AAEA,WAAKC,UAAL,GAAkB,EAAlB;;AAEA,WAAK,IAAInnC,IAAI,CAAb,EAAgBA,KAAK,EAArB,EAAyBA,GAAzB,EAA8B;AAC5B,aAAKknC,QAAL,CAAclhC,IAAd,CAAmBT,KAAKmO,KAAL,CAAY1T,IAAI,EAAL,GAAW,GAAtB,IAA6B,GAAhD;AACD;;AAED,UAAI8yB,UAAU,IAAd;;AAEA,UAAIsU,KAAK,CAAT;AAAA,UACEC,KAAK,CADP;;AAKA,UAAIzO,UAAU,IAAIn6B,QAAQ0F,MAAZ,CAAmB,KAAKw5B,KAAL,CAAWjsB,GAA9B,CAAd;;AAEA,WAAK41B,aAAL,GAAqB,IAArB;;AAEA,UAAIC,IAAI9oC,QAAQ+U,MAAhB;;AAEA,WAAKg0B,SAAL,GAAiB5O,OAAjB;;AAEAA,cAAQrxB,MAAR,CAAe,YAAW;;AAExB6/B,aAAK,KAAK7zB,IAAL,CAAUvT,CAAf;AACAqnC,aAAK,KAAK9zB,IAAL,CAAU7R,CAAf;;AAEJ;;AAEA;;AAEIoxB,gBAAQgU,SAAR,CAAkBl2B,KAAlB,CAAwBmI,KAAxB,GAAgC,KAAKxF,IAAL,CAAUvT,CAAV,GAAc,EAAd,GAAmB,IAAnD;AACA8yB,gBAAQgU,SAAR,CAAkBl2B,KAAlB,CAAwBkI,MAAxB,GAAiC,KAAKvF,IAAL,CAAU7R,CAAV,GAAc,IAA/C;;AAEAoxB,gBAAQgU,SAAR,CAAkB/tB,KAAlB,GAA0B,KAAKxF,IAAL,CAAUvT,CAAV,GAAc,EAAxC;AACA8yB,gBAAQgU,SAAR,CAAkBhuB,MAAlB,GAA2B,KAAKvF,IAAL,CAAU7R,CAArC;;AAEA,YAAIoxB,QAAQiU,OAAZ,EACEjU,QAAQiU,OAAR,CAAgBn2B,KAAhB,CAAsBkI,MAAtB,GAAgC,KAAKvF,IAAL,CAAU7R,CAAV,GAAc,EAAf,GAAqB,IAApD;;AAEF,aAAK+lC,QAAL,GAAgB,KAAKl0B,IAArB;;AAEA,YAAIm0B,eAAe5U,QAAQ5E,OAAR,CAAgBnU,KAAnC;AAAA,YACE4tB,iBAAiB/oC,QAAQC,kBAAR,CAA2B6oC,aAAavpC,CAAxC,EAA2CupC,aAAatpC,CAAxD,CADnB;;AAGA,YAAIiqB,SAAS,IAAI5pB,QAAQ2pB,cAAZ,CAA2Buf,eAAe5oC,GAA1C,EAA+C4oC,eAAe3oC,GAA9D,EAAmE,QAAnE,EAA6EupB,aAA7E,EAAb;;AAEA,YAAIqf,aAAavf,OAAOA,MAAxB;AAAA,YACEwf,SAAS,EADX;;AAGA,YAAIvJ,SAAS,EAAb;;AAEA1F,gBAAQkP,cAAR,GAAyB,EAAzB;;AAEA,aAAK,IAAI1kC,KAAK,CAAd,EAAiBA,KAAK,EAAtB,EAA0BA,IAA1B,EAAgC;;AAE9B,cAAI2kC,aAAaxiC,KAAKkjB,KAAL,CAAYrlB,KAAKykC,MAAN,GAAgBD,WAAW5iC,MAAtC,CAAjB;;AAEA,eAAKgjC,qBAAL,CAA2BJ,WAAWG,aAAaH,WAAW5iC,MAAnC,CAA3B;AACA,eAAKijC,WAAL,CAAiBL,WAAWG,aAAaH,WAAW5iC,MAAnC,CAAjB;;AAEA;;AAEA;AACA,eAAK+I,QAAL,CAAc3K,KAAKgkC,EAAnB,EAAuB,CAAvB;AACA,eAAKxa,IAAL,CAAUkG,QAAQmU,MAAlB;AACD;;AAGD;AACAnU,gBAAQ0U,SAAR,CAAkB5a,IAAlB,GAAyB,UAASlC,GAAT,EAAcP,MAAd,EAAsB;;AAE7C,cAAIzd,SAAS,IAAb;;AAEA,eAAKw7B,KAAL,CAAWpV,QAAQ8R,KAAnB;;AAEA,eAAKuD,YAAL,CAAkB,CAAlB;;AAEA,cAAIvH,QAAQ,KAAZ;;AAEA,cAAIl0B,OAAO07B,MAAX,EAAmB;;AAEjB,gBAAI17B,OAAOuM,kBAAP,YAAqCvY,MAArC,IAA+CgM,OAAOuM,kBAAP,CAA0B5Y,cAA1B,CAAyC,gBAAzC,CAAnD,EAA+G;AAC7GugC,sBAAQl0B,OAAOuM,kBAAP,CAA0BolB,cAAlC;AACD;;AAED;AACAuC,kBAAM7yB,QAAN,CAAerB,OAAOyJ,QAAtB;;AAEA,gBAAIkyB,OAAOzH,MAAMzqB,QAAN,CAAenW,CAA1B;AAAA,gBACEsoC,OAAO1H,MAAMzqB,QAAN,CAAezU,CADxB;;AAGA,gBAAIb,IAAI6L,OAAOyJ,QAAf;;AAEA,gBAAInW,IAAIa,EAAEb,CAAV;AAAA,gBACE0B,IAAIb,EAAEa,CADR;AAAA,gBAEE6mC,eAAe77B,OAAO67B,YAAP,IAAuB,CAAC,GAAxB,IAA+B77B,OAAO67B,YAAP,IAAuB,GAAtD,GAA4D77B,OAAO67B,YAAnE,GAAkF,GAFnG;;AAIA,gBAAI77B,OAAO87B,QAAX,EAAqB;AACnBD,6BAAe,CAAf;AACD;;AAED;;AAEA,gBAAIE,aAAa/7B,OAAO6G,IAAP,IAAe7G,OAAOuM,kBAAP,CAA0B1F,IAA1D;AACA,gBAAIm1B,YAAYD,WAAWzoC,CAA3B;AACA,gBAAI2oC,aAAaF,WAAW/mC,CAA5B;;AAGA,gBAAIu8B,SAASvxB,OAAOuxB,MAAP,IAAiB,IAAIx/B,QAAQ+U,MAAZ,CAAmBk1B,YAAY,CAA/B,EAAkCC,aAAa,CAA/C,CAA9B;;AAEA;;AAEA,gBAAIxS,QAAJ;;AAEA,gBAAI,QAAOzpB,OAAOypB,QAAd,KAA2B,QAA/B,EAAyC;AACvCA,yBAAWzpB,OAAOypB,QAAP,CAAgBn2B,CAA3B;AAED,aAHD,MAGO;AACLm2B,yBAAWzpB,OAAOypB,QAAlB;AACD;;AAED,gBAAIyS,MAAM,KAAKxhB,MAAL,IAAe,KAAKyG,IAAL,GAAY,CAA3B,CAAV;;AAEA,gBAAI+a,MAAM,GAAN,IAAaxjC,MAAMwjC,GAAN,CAAjB,EACEA,MAAM,GAAN;;AAEF,gBAAI,EAAE,KAAKC,gBAAL,YAAiClpC,KAAnC,CAAJ,EACEmpC,MAAM,cAAN;;AAEF,gBAAInO,QAAQp1B,KAAKkjB,KAAL,CAAW,CAAC,KAAKogB,gBAAL,CAAsB7jC,MAAtB,GAA+B,CAAhC,IAAqC4jC,GAAhD,CAAZ;;AAEA,gBAAIxjC,MAAMu1B,KAAN,KAAgBA,QAAQ,KAAKkO,gBAAL,CAAsB7jC,MAAlD,EACE21B,QAAQ,CAAR;;AAGF,gBAAIoO,eAAe,KAAKF,gBAAL,CAAsBlO,KAAtB,CAAnB;;AAEA,gBAAIoO,wBAAwBtc,iBAA5B,EACEhuB,QAAQuqC,MAAR,CAAeC,gBAAf,CAAgCF,YAAhC,EAA8CnI,MAAMlB,QAApD,EAA8DkB,MAAMlD,SAApE,EAA+E,IAAIj/B,QAAQs4B,QAAZ,CAAqBxxB,KAAKmO,KAAL,CAAW20B,OAAQpK,OAAOj+B,CAA1B,CAArB,EAAoDuF,KAAKmO,KAAL,CAAW40B,OAAQrK,OAAOv8B,CAA1B,CAApD,CAA/E,EAAmK,IAAIjD,QAAQs4B,QAAZ,CAAqB2R,SAArB,EAAgCC,UAAhC,CAAnK,EAAgNxS,WAAW,GAA3N,EAAgOzL,GAAhO,EAAqOhe,OAAO0xB,KAA5O,EAAmP1xB,OAAOw8B,KAA1P,EAAiQjL,MAAjQ,EAAyQ,KAAKuF,OAA9Q,EAAuR,KAAvR;AAEH;AACF,SAxED;;AA0EA,YAAI,KAAKuD,OAAT,EAAkB;AAChBA,kBAAQn2B,KAAR,CAAcu4B,MAAd,GAAuB,IAAvB;AACApC,kBAAQn2B,KAAR,CAAcC,GAAd,GAAoB,KAApB;AACAk2B,kBAAQn2B,KAAR,CAAckH,IAAd,GAAqB,KAArB;AACAivB,kBAAQ5X,WAAR,CAAoB2D,QAAQgU,SAA5B;AACAhkC,mBAASC,IAAT,CAAcosB,WAAd,CAA0B4X,OAA1B;AACD;AAEF,OAlID;;AAsIA,aAAO,IAAP;AACD;;;oCAEe;AACd,UAAIqC,WAAW,EAAf;;AAEA,UAAI,EAAE,KAAKlb,OAAL,CAAamb,SAAb,IAA0B,KAAKnb,OAAL,CAAa4W,eAAvC,IAA0D,KAAK5W,OAAL,CAAaob,uBAAzE,CAAJ,EACE,KAAKC,SAAL,CAAe,aAAf;;AAEF,UAAI,CAAC,KAAKrb,OAAL,CAAazW,KAAlB,EACE,KAAKinB,KAAL,CAAW,GAAX,EAAgB,GAAhB,EAAqB,WAArB,EAAkC0K,QAAlC;;AAEF,UAAI,CAAC,KAAKlb,OAAL,CAAa/f,KAAlB,EACE,KAAKH,KAAL,CAAW,GAAX,EAAgB,GAAhB,EAAqB,QAArB,EAA+Bo7B,QAA/B;;AAEF,UAAI,EAAE,KAAKlb,OAAL,CAAasb,KAAb,IAAsB,KAAKtb,OAAL,CAAasV,OAArC,CAAJ,EACE,KAAKiG,KAAL,CAAW,GAAX,EAAgB,GAAhB,EAAqB,SAArB,EAAgCL,QAAhC;;AAEF,UAAI,CAAC,KAAKlb,OAAL,CAAanU,KAAlB,EACE,KAAK2vB,KAAL,CAAW,KAAX;AACH;;;qCAEgBxb,O,EAAS;;AAGxB,UAAI,OAAOA,QAAQ4D,KAAf,IAAwB,QAA5B,EACE5D,QAAQ4D,KAAR,GAAgB;AACd3zB,WAAG+vB,QAAQ4D;AADG,OAAhB;;AAIF,UAAI,OAAO5D,QAAQzW,KAAf,IAAwB,QAA5B,EACEyW,QAAQzW,KAAR,GAAgB;AACdtZ,WAAG+vB,QAAQzW;AADG,OAAhB;;AAIF,UAAI,OAAOyW,QAAQ/f,KAAf,IAAwB,QAA5B,EACE+f,QAAQ/f,KAAR,GAAgB;AACdhQ,WAAG+vB,QAAQ/f;AADG,OAAhB;;AAIF,UAAI,OAAO+f,QAAQsb,KAAf,IAAwB,QAA5B,EACEtb,QAAQsb,KAAR,GAAgB;AACdrrC,WAAG+vB,QAAQsb;AADG,OAAhB;;AAIF,UAAI,OAAOtb,QAAQnU,KAAf,IAAwB,QAA5B,EACEmU,QAAQnU,KAAR,GAAgB;AACd5b,WAAG+vB,QAAQnU;AADG,OAAhB;AAIH;;;4BAEOmU,O,EAAS;;AAGf,WAAKqb,SAAL,CAAerb,QAAQmb,SAAR,IAAqBnb,QAAQ4W,eAA7B,IAAgD5W,QAAQob,uBAAxD,IAAmF,aAAlG;;AAEA,UAAIpb,QAAQL,IAAZ,EACE,KAAKwY,IAAL,CAAUnY,QAAQL,IAAR,CAAa1vB,CAAvB,EAA0B+vB,QAAQL,IAAR,CAAazvB,CAAvC,EAA0C8vB,QAAQL,IAAR,CAAa5G,UAAvD,EAAmE,GAAnE;;AAGF,UAAI4G,OAAO,KAAKA,IAAL,CAAUtG,KAAV,GAAkBE,QAAlB,EAAX;;AAEA,UAAIyG,QAAQ4D,KAAZ,EACE,KAAK6X,KAAL,CAAWzb,QAAQ4D,KAAR,CAAc3zB,CAAzB,EAA4B+vB,QAAQ4D,KAAR,CAAc1zB,CAA1C,EAA6C8vB,QAAQ4D,KAAR,CAAc7K,UAA3D,EAAuE4G,IAAvE;;AAEF,UAAIK,QAAQzW,KAAZ,EACE,KAAKinB,KAAL,CAAWxQ,QAAQzW,KAAR,CAActZ,CAAzB,EAA4B+vB,QAAQzW,KAAR,CAAcrZ,CAA1C,EAA6C8vB,QAAQzW,KAAR,CAAcwP,UAA3D,EAAuE4G,IAAvE;;AAEF,UAAIK,QAAQ/f,KAAZ,EACE,KAAKH,KAAL,CAAWkgB,QAAQ/f,KAAR,CAAchQ,CAAzB,EAA4B+vB,QAAQ/f,KAAR,CAAc/P,CAA1C,EAA6C8vB,QAAQ/f,KAAR,CAAc8Y,UAA3D,EAAuE4G,IAAvE;;AAEF,UAAIK,QAAQsb,KAAZ,EACE,KAAKC,KAAL,CAAWvb,QAAQsb,KAAR,CAAcrrC,CAAzB,EAA4B+vB,QAAQsb,KAAR,CAAcprC,CAA1C,EAA6C8vB,QAAQsb,KAAR,CAAcviB,UAA3D,EAAuE4G,IAAvE;;AAEF,UAAIK,QAAQnU,KAAZ,EACE,KAAK2vB,KAAL,CAAWxb,QAAQnU,KAAR,CAAc5b,CAAzB,EAA4B+vB,QAAQnU,KAAR,CAAc3b,CAA1C,EAA6C8vB,QAAQnU,KAAR,CAAckN,UAA3D,EAAuE4G,IAAvE;AACH;;AAGD;;;;0BACMzc,K,EAAO;AACX,WAAKgtB,KAAL,GAAahtB,KAAb;;AAEA,UAAI,KAAKgtB,KAAT,EAAgB;AACd,YAAI,KAAKlQ,OAAL,CAAa/f,KAAb,CAAmBhQ,CAAnB,GAAuB,CAA3B,EAA8B;AAC5B,eAAK+vB,OAAL,CAAa/f,KAAb,CAAmBhQ,CAAnB,GAAuB,CAAC,KAAK+vB,OAAL,CAAa/f,KAAb,CAAmBhQ,CAA3C;AACD;AACD,YAAI,KAAK+vB,OAAL,CAAa/f,KAAb,CAAmB/P,CAAnB,GAAuB,CAA3B,EAA8B;AAC5B,eAAK8vB,OAAL,CAAa/f,KAAb,CAAmB/P,CAAnB,GAAuB,CAAC,KAAK8vB,OAAL,CAAa/f,KAAb,CAAmB/P,CAA3C;AACD;AACF,OAPD,MAOO;AACL,YAAI,KAAK8vB,OAAL,CAAa/f,KAAb,CAAmBhQ,CAAnB,GAAuB,CAA3B,EAA8B;AAC5B,eAAK+vB,OAAL,CAAa/f,KAAb,CAAmBhQ,CAAnB,GAAuB,CAAC,KAAK+vB,OAAL,CAAa/f,KAAb,CAAmBhQ,CAA3C;AACD;AACD,YAAI,KAAK+vB,OAAL,CAAa/f,KAAb,CAAmB/P,CAAnB,GAAuB,CAA3B,EAA8B;AAC5B,eAAK8vB,OAAL,CAAa/f,KAAb,CAAmB/P,CAAnB,GAAuB,CAAC,KAAK8vB,OAAL,CAAa/f,KAAb,CAAmB/P,CAA3C;AACD;AACF;AACD,aAAO,IAAP;AACD;;AAED;;;;wBACIsT,G,EAAK;;AAEP,WAAK+0B,aAAL,GAAqB,EAArB;AACA,WAAKvY,OAAL,CAAaxc,GAAb,GAAmBA,GAAnB;;AAGA,UAAIwc,UAAU,KAAKA,OAAnB;;AAEF;;AAEE,UAAI0b,OAAJ;;AAEA,UAAG1b,QAAQL,IAAR,YAAwBntB,MAA3B,EACA;AACGkpC,kBAAU1b,QAAQL,IAAR,CAAa1vB,CAAb,IAAkB,CAAC+vB,QAAQL,IAAR,CAAazvB,CAAhC,GAAoC8vB,QAAQL,IAAR,CAAa1vB,CAAjD,GAAqD+vB,QAAQL,IAAR,CAAa1vB,CAAb,GAAiB+vB,QAAQL,IAAR,CAAazvB,CAA9B,GAAkC8vB,QAAQL,IAAR,CAAa1vB,CAA/C,GAAmD+vB,QAAQL,IAAR,CAAazvB,CAA/H;AACF,OAHD,MAKK,IAAG,OAAO8vB,QAAQL,IAAf,IAAuB,QAA1B,EACL;AACE+b,kBAAU1b,QAAQL,IAAlB;AACD;;AAED,WAAKK,OAAL,CAAalvB,GAAb,GAAmB4qC,UAAU,EAA7B;;AAEE,UAAG,KAAK1b,OAAL,CAAalvB,GAAb,GAAmB,IAAtB,EACA;AACE,aAAKkvB,OAAL,CAAalvB,GAAb,GAAmB,IAAnB;AACD;;AAEH,WAAK,IAAIgB,IAAI,CAAb,EAAgBA,IAAI,KAAKkuB,OAAL,CAAalvB,GAAjC,EAAsCgB,GAAtC,EAA2C;AACzC,YAAI0M,SAAS,IAAIjO,QAAQ0F,MAAZ,CAAmB,KAAK+pB,OAAL,CAAaxc,GAAhC,EAAqCgtB,KAArC,CAA2C,KAAKxQ,OAAL,CAAazW,KAAb,CAAmBtZ,CAA9D,CAAb;;AAEA,YAAI0rC,WAAW,IAAf;;AAEA,YAAI7pC,KAAK,CAAT,EACE0M,OAAOnF,MAAP,CAAc,YAAW;AACvBsiC,mBAAS1D,aAAT,GAAyB,KAAK5yB,IAA9B;AACD,SAFD;;AAIF7G,eAAOwhB,OAAP,GAAiB,KAAKA,OAAtB;AACA,aAAKuY,aAAL,CAAmBzgC,IAAnB,CAAwB0G,MAAxB;AACD;;AAGD,WAAK+5B,aAAL,CAAmBqD,MAAnB,GAA4B,YAAW;;AAErC,YAAIC,YAAY,CAAhB;AAAA,YACEC,kBAAkB,CADpB;;AAGA,aAAK,IAAIhqC,IAAI,CAAb,EAAgBA,IAAI,KAAKgF,MAAzB,EAAiChF,GAAjC,EAAsC;AACpC,cAAI,QAAO,KAAKA,CAAL,CAAP,KAAkB,QAAlB,IAA8B,KAAKA,CAAL,EAAQonB,MAAR,IAAkB2iB,SAApD,EAA+D;AAC7DA,wBAAY,KAAK/pC,CAAL,EAAQonB,MAApB;AACA4iB,8BAAkBhqC,CAAlB;AACD;AACF;AACD,eAAO,KAAKgqC,eAAL,CAAP;AACD,OAZD;;AAcA,WAAKvD,aAAL,CAAmBwD,WAAnB,GAAiC,YAAW;AAC1C,YAAItD,QAAQ,CAAZ;AACA,aAAK,IAAI3mC,IAAI,CAAb,EAAgBA,IAAI,KAAKgF,MAAzB,EAAiChF,GAAjC,EAAsC;AACpC,cAAI,KAAKA,CAAL,EAAQonB,MAAR,IAAkB,CAAtB,EAAyB;AACvBuf;AACD;AACF;;AAEH;AACE,eAAOA,KAAP;AACD,OAVD;;AAaA,aAAO,IAAP;AACD;;AAED;;;;0BACMuD,K,EAAO;AACX,WAAKhc,OAAL,CAAagc,KAAb,GAAqBA,KAArB;AACA,aAAO,IAAP;AACD;;;iCAGYlqC,C,EAAG;;AAEd,UAAI6pC,WAAW,IAAf;;AAEA,WAAK1iC,OAAL,CAAatD,OAAb,CAAqB,UAAS6I,MAAT,EAAiB;AACpC,YAAI,CAACA,OAAOy9B,iBAAR,IAA6Bz9B,OAAO0xB,KAAP,IAAgByL,SAASzL,KAA1D,EACE1xB,OAAOyJ,QAAP,CAAgBnW,CAAhB,IAAqBA,CAArB,CADF,KAEK;AACH0M,iBAAOy9B,iBAAP,GAA2B,IAA3B;AACD;AACF,OAND;;AAQA,aAAO,IAAP;AACD;;AAED;;;;8BACU9rC,C,EAAG;AACX,WAAK6vB,OAAL,CAAasX,wBAAb,GAAwCnnC,CAAxC;AACA,aAAO,IAAP;AACD;;AAED;;;;yBACKF,C,EAAGC,C,EAAG6oB,U,EAA4B;AAAA,UAAhBC,QAAgB,uEAAL,GAAK;;AACrC,WAAK2G,IAAL,GAAY,IAAIpvB,QAAQuoB,SAAZ,CAAsB7oB,CAAtB,EAAyBC,CAAzB,EAA4B6oB,UAA5B,EAAwCC,QAAxC,CAAZ;AACA,aAAO,IAAP;AACD;;;0BAEK/oB,C,EAAGC,C,EAAG6oB,U,EAAY4G,I,EAAM;AAC5B,UAAG,CAAC1vB,CAAJ,EACA;AACE,aAAK+vB,OAAL,CAAanU,KAAb,GAAqB,KAArB;AACA,eAAO,KAAP;AACD;AACD,WAAKmU,OAAL,CAAanU,KAAb,GAAqB,IAAItb,QAAQ2pB,cAAZ,CAA2BjqB,CAA3B,EAA8BC,CAA9B,EAAiC6oB,UAAjC,EAA6C4G,IAA7C,EAAmDtF,aAAnD,EAArB;AACD;;AAED;;;;0BACMpqB,C,EAAGC,C,EAAG6oB,U,EAAY4G,I,EAAM;AAC5B,WAAKK,OAAL,CAAazW,KAAb,GAAqB,IAAIhZ,QAAQuoB,SAAZ,CAAsB7oB,CAAtB,EAAyBC,CAAzB,EAA4B6oB,UAA5B,EAAwC4G,IAAxC,CAArB;AACA,aAAO,IAAP;AACD;;AAED;;;;0BACM1vB,C,EAAGC,C,EAAG6oB,U,EAAY4G,I,EAAM;AAC5B,WAAKK,OAAL,CAAa4D,KAAb,GAAqB,IAAIrzB,QAAQuoB,SAAZ,CAAsB7oB,CAAtB,EAAyBC,CAAzB,EAA4B6oB,UAA5B,EAAwC4G,IAAxC,CAArB;AACA,aAAO,IAAP;AACD;;AAED;;;;0BACM1vB,C,EAAGC,C,EAAG6oB,U,EAAY4G,I,EAAM;AAC5B,WAAKK,OAAL,CAAasb,KAAb,GAAqB,IAAI/qC,QAAQuoB,SAAZ,CAAsB7oB,CAAtB,EAAyBC,CAAzB,EAA4B6oB,UAA5B,EAAwC4G,IAAxC,CAArB;AACA,aAAO,IAAP;AACD;;AAED;;;;0BACM1vB,C,EAAGC,C,EAAG6oB,U,EAAY4G,I,EAAM;AAC5B,WAAKK,OAAL,CAAa/f,KAAb,GAAqB,IAAI1P,QAAQuoB,SAAZ,CAAsB7oB,CAAtB,EAAyBC,CAAzB,EAA4B6oB,UAA5B,EAAwC4G,IAAxC,CAArB;AACA,aAAO,IAAP;AACD;;;iCAEYrX,C,EAAG;AACd,WAAK4zB,cAAL,GAAsB5zB,CAAtB;AACA,aAAO,IAAP;AACD;;;iCAGYmwB,K,EAAO;;AAElB,UAAIzY,UAAU,KAAKA,OAAnB;;AAEA,UAAImc,YAAY,EAAhB;;AAEA,UAAInc,QAAQoc,KAAR,YAAyB7rC,QAAQkW,MAArC,EACE01B,YAAY,CAAC,QAAD,EAAW,WAAX,EAAwBtgC,OAAxB,CAAgCmkB,QAAQqc,SAAxC,KAAsD,CAAtD,GAA0Drc,QAAQoc,KAAR,CAAcE,4BAAd,CAA2C7D,KAA3C,CAA1D,GAA8GzY,QAAQoc,KAAR,CAAcG,eAAd,CAA8B9D,KAA9B,CAA1H;AACF,WAAK,IAAI3mC,IAAI,CAAb,EAAgBA,IAAI2mC,KAApB,EAA2B3mC,GAA3B,EAAgC;;AAE9B,aAAK2mC,KAAL,IAAc,CAAd;AACA,YAAIj6B,MAAJ;;AAEA,YAAItJ,KAAKpD,IAAI,KAAKymC,aAAL,CAAmBwD,WAAnB,EAAb;;AAEA,YAAG7mC,KAAK,KAAKqjC,aAAL,CAAmBzhC,MAA3B,EACA0H,SAAS,KAAK+5B,aAAL,CAAmBrjC,EAAnB,CAAT,CADA,KAEI;AACFsJ,mBAAS,KAAK+5B,aAAL,CAAmBqD,MAAnB,EAAT;AACD;AACH;AACA;AACE,YAAI,KAAKnD,KAAL,IAAc,KAAKF,aAAL,CAAmBzhC,MAArC,EAA6C;AAC3C;AACD;AACD,aAAK0lC,UAAL,GAAkBh+B,MAAlB;AACF;AACA;AACA;AACEA,eAAO0a,MAAP,GAAgB,CAAhB;AACA1a,eAAOyB,KAAP,GAAe,IAAI1P,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAAf;;AAGA;;AAEA9G,eAAOy7B,YAAP,CAAoB,CAApB;;AAEA,YAAI,KAAKX,SAAL,IAAkB,KAAKtZ,OAAL,CAAanU,KAA/B,IAAwC,KAAKmU,OAAL,CAAanU,KAAb,CAAmBuO,WAAnB,EAA5C,EAA8E;AAC5E5b,iBAAOm8B,gBAAP,GAA0B,KAAKrB,SAAL,CAAeqB,gBAAzC;AACAn8B,iBAAOkgB,IAAP,GAAc,KAAK4a,SAAL,CAAe5a,IAA7B;AACD;;AAED,YAAI,KAAKzmB,UAAL,CAAgBwkC,GAAhB,CAAoBj+B,MAApB,CAAJ,EACE,KAAKvG,UAAL,CAAgB2nB,MAAhB,CAAuBphB,MAAvB;;AAEF,YAAI,KAAKvF,OAAL,CAAa4C,OAAb,CAAqB2C,MAArB,KAAgC,CAApC,EACE,KAAKvF,OAAL,CAAawmB,MAAb,CAAoB,KAAKxmB,OAAL,CAAa4C,OAAb,CAAqB2C,MAArB,CAApB,EAAkD,CAAlD;;AAEF,YAAIA,OAAOlF,WAAP,CAAmBC,IAAnB,KAA4B,QAAhC,EAA0C;AACxCnJ,kBAAQQ,KAAR,CAAc,cAAd;AACD;;AAED4N,eAAOy9B,iBAAP,GAA2B,KAA3B;AACAz9B,eAAO0xB,KAAP,GAAe,KAAKA,KAApB;;AAEA,YAAIyL,WAAW,IAAf;;AAEAn9B,eAAOk+B,aAAP,GAAuB,UAAS9Y,KAAT,EAAgB3jB,KAAhB,EAAuB;AAC5C,eAAKA,KAAL,GAAa1P,QAAQg1B,IAAR,CAAaF,gBAAb,CAA8BzB,KAA9B,EAAqC3jB,KAArC,CAAb;AACA,eAAKgI,QAAL,GAAgB,KAAKA,QAAL,CAAcjD,GAAd,CAAkB,KAAK/E,KAAvB,CAAhB;AACD,SAHD;;AAKAzB,eAAOyB,KAAP,GAAe,IAAI1P,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAAf;;AAEA9G,eAAOm+B,UAAP,GAAoB,EAApB;;AAEAn+B,eAAOm+B,UAAP,CAAkBhd,IAAlB,GAAyB,KAAKA,IAAL,CAAUtG,KAAV,EAAzB;;AAEA7a,eAAOmhB,IAAP,GAAcnhB,OAAOm+B,UAAP,CAAkBhd,IAAlB,CAAuBpG,QAAvB,EAAd;;AAEA,YAAIriB,MAAMsH,OAAOmhB,IAAb,KAAsBnhB,OAAOmhB,IAAP,IAAe,CAAzC,EACEvvB,QAAQQ,KAAR,CAAc,sCAAd;;AAEF4N,eAAOm+B,UAAP,CAAkB/Y,KAAlB,GAA0B5D,QAAQ4D,KAAR,CAAczK,QAAd,CAAuB3a,OAAOmhB,IAA9B,EAAoCtG,KAApC,EAA1B;;AAEA,YAAI2G,QAAQnU,KAAR,IAAiBmU,QAAQnU,KAAR,CAAcuO,WAAd,EAArB,EACA5b,OAAOm+B,UAAP,CAAkB9wB,KAAlB,GAA0BmU,QAAQnU,KAAR,CAAcsN,QAAd,CAAuB3a,OAAOmhB,IAA9B,EAAoCtG,KAApC,EAA1B;;AAEA7a,eAAOm+B,UAAP,CAAkBrB,KAAlB,GAA0Btb,QAAQsb,KAAR,CAAcniB,QAAd,CAAuB3a,OAAOmhB,IAA9B,EAAoCtG,KAApC,EAA1B;;AAEA7a,eAAOm+B,UAAP,CAAkB18B,KAAlB,GAA0B+f,QAAQ/f,KAAR,CAAckZ,QAAd,CAAuB3a,OAAOmhB,IAA9B,EAAoCtG,KAApC,EAA1B;;AAEA7a,eAAOm+B,UAAP,CAAkBpzB,KAAlB,GAA0ByW,QAAQzW,KAAR,CAAc4P,QAAd,CAAuB3a,OAAOmhB,IAA9B,EAAoCtG,KAApC,EAA1B;;AAEA7a,eAAO82B,OAAP,GAAiB92B,OAAOm+B,UAAP,CAAkBrB,KAAlB,CAAwB/hB,QAAxB,EAAjB;;AAEA,YAAI,KAAKyG,OAAL,CAAanU,KAAb,IAAsB,CAAC,KAAKytB,SAA5B,IAAyC,KAAKtZ,OAAL,CAAanU,KAAb,CAAmBuO,WAAnB,EAA7C,EAA+E;AAC7E5b,iBAAOqN,KAAP,GAAerN,OAAOm+B,UAAP,CAAkB9wB,KAAlB,CAAwB0N,QAAxB,EAAf;AACD;;AAGD/a,eAAO+K,KAAP,GAAe/K,OAAOm+B,UAAP,CAAkBpzB,KAAlB,CAAwBgQ,QAAxB,EAAf;;AAEA,YAAI,CAAC,KAAK+f,SAAN,IAAmB,KAAKtZ,OAAL,CAAanU,KAAhC,IAAyC,KAAKmU,OAAL,CAAanU,KAAb,CAAmBuO,WAAnB,EAA7C,EACE5b,OAAOu7B,WAAP,CAAmBv7B,OAAOqN,KAA1B;;AAGFrN,eAAO84B,wBAAP,GAAkCtX,QAAQsX,wBAAR,IAAoC,SAAtE;;AAGA,YAAIsF,YAAYvlC,KAAK+U,GAAL,CAAS4T,QAAQ4D,KAAR,CAAc3zB,CAAd,GAAkB+vB,QAAQ4D,KAAR,CAAc1zB,CAAzC,CAAhB;;AAEA,YAAGsO,OAAOrM,cAAP,CAAsB,GAAtB,CAAH,EACA;AACCqM,iBAAOq+B,SAAP,GAAmBr+B,OAAO8J,CAA1B;AACA,SAHD,MAII;AACF9J,iBAAOq+B,SAAP,GAAmBr+B,OAAOm+B,UAAP,CAAkB/Y,KAAlB,CAAwBrK,QAAxB,EAAnB;AACD;;AAGD/a,eAAOgyB,KAAP,CAAahyB,OAAO+K,KAApB;;AAEA,YAAI4yB,UAAUrlC,MAAV,IAAoB,CAAxB,EAA2B;AACzB,cAAIhF,IAAIqqC,UAAUrlC,MAAlB,EAA0B;AACxB0H,mBAAOqB,QAAP,CAAgB,KAAKoI,QAAL,CAAcjD,GAAd,CAAkBm3B,UAAUrqC,CAAV,CAAlB,CAAhB;;AAEA,gBAAGqqC,UAAUrqC,CAAV,KAAgBqqC,UAAUrqC,CAAV,EAAaK,cAAb,CAA4B,GAA5B,CAAhB,IAAoD,CAAC+E,MAAMilC,UAAUrqC,CAAV,EAAawW,CAAnB,CAArD,IACF6zB,UAAUrqC,CAAV,EAAawW,CAAb,IAAkB,CAAC,GADjB,IACwB6zB,UAAUrqC,CAAV,EAAawW,CAAb,IAAkB,GAD7C,EAEA;AACE9J,qBAAO8J,CAAP,GAAW6zB,UAAUrqC,CAAV,EAAawW,CAAxB;AACD;AACF,WARD,MAQO;AACL9J,mBAAOqB,QAAP,CAAgB,KAAKoI,QAArB;AACD;AAEF,SAbD,MAaO;AACLzJ,iBAAOqB,QAAP,CAAgB,KAAKi9B,iBAAL,IAA0B,KAAK70B,QAA/C;AACD;;AAED,YAAIhQ,aAAa,KAAKA,UAAtB;;AAGA,YAAI,KAAKikC,cAAT,EAAyB;AACvB19B,iBAAOmqB,QAAP,CAAgB,KAAKuT,cAArB;AACD;;AAED19B,eAAOD,MAAP,GAAgB,YAAW;;AAEzB,eAAK2a,MAAL,IAAe,CAAf;;AAEA,eAAKyG,IAAL,IAAa,CAAb;;AAEA,cAAI,KAAKA,IAAL,IAAa,CAAjB,EAAoB;AAClB;AACAgc,qBAAS1iC,OAAT,CAAiBwmB,MAAjB,CAAwBkc,SAAS1iC,OAAT,CAAiB4C,OAAjB,CAAyB,IAAzB,CAAxB,EAAwD,CAAxD;AACA5D,uBAAW2nB,MAAX,CAAkB,IAAlB;AACD;;AAED,eAAKrW,KAAL,GAAa,KAAKozB,UAAL,CAAgBpzB,KAAhB,CAAsBgQ,QAAtB,EAAb;;AAEA,eAAKiX,KAAL,CAAW,KAAKjnB,KAAhB;;AAEA,cAAI,CAACoyB,SAASvC,aAAV,IAA2BuC,SAAS3b,OAAT,CAAiBnU,KAA5C,IAAqD8vB,SAAS3b,OAAT,CAAiBnU,KAAjB,CAAuBuO,WAAvB,EAAzD,EAA+F;AAC7F,iBAAKvO,KAAL,GAAa,KAAK8wB,UAAL,CAAgB9wB,KAAhB,CAAsB0N,QAAtB,EAAb;AACA,iBAAKwgB,WAAL,CAAiB,KAAKluB,KAAtB;AACD;;AAED,eAAKkxB,OAAL,CAAa,KAAKJ,UAAL,CAAgBrB,KAAhB,CAAsB/hB,QAAtB,EAAb;;AAEA,eAAKyjB,QAAL,GAAgB,KAAKL,UAAL,CAAgB18B,KAAhB,CAAsBsZ,QAAtB,EAAhB;;AAEA,eAAKmjB,aAAL,CAAmB,KAAKp0B,CAAL,GAAS,KAAKA,CAAL,GAAS,GAAlB,GAAwB,KAAKu0B,SAAL,GAAiB,GAA5D,EAAiE,KAAKG,QAAtE;;AAEA,cAAIrB,SAAS3D,cAAb,EAA6B;AAC3B,iBAAK/vB,QAAL,GAAgB,KAAKA,QAAL,CAAcjD,GAAd,CAAkB22B,SAAS3D,cAA3B,CAAhB;AACD;AACD,cAAI2D,SAASmB,iBAAb,EAAgC;AAC9B,iBAAK70B,QAAL,GAAgB0zB,SAASmB,iBAAzB;AACD;AACF,SAjCD;;AAmCA,aAAK7jC,OAAL,CAAanB,IAAb,CAAkB0G,MAAlB;AACA,aAAKvG,UAAL,CAAgB+M,GAAhB,CAAoBxG,MAApB;AACD;AACF;;;kCAEa;AACZ,WAAK0a,MAAL,GAAc,CAAd;AACA,aAAO,IAAP;AACD;;;yCAGoBjZ,K,EAAO;;AAE1B,WAAK+3B,cAAL,GAAsB/3B,KAAtB;AACA,aAAO,IAAP;AACD;;;4CAGuBgI,Q,EAAU;;AAEhC,WAAK60B,iBAAL,GAAyB70B,QAAzB;AACA,aAAO,IAAP;AACD;;;2CAEsBg1B,Q,EAAUC,Y,EAAc;AAC7C,WAAKC,KAAL,GAAaA,KAAb;AACA,aAAO,IAAP;AACD;;;0BAGK/rC,M,EAAQ;;AAEZ,WAAK8nB,MAAL,IAAe,CAAf;;AAEA,WAAKkkB,YAAL,CAAkBhsC,MAAlB;;AAEA;;AAEA,UAAIisC,KAAK,IAAT;;AAEA,aAAO,IAAP;AAED;;;;;;AAGH9sC,QAAQgW,QAAR,GAAmBA,QAAnB;;IAEM+2B,M;;;AAEJ,oBAAc;AAAA;;AAAA,4GACHC,SADG;AAGb;;;EALkBh3B,Q;;AAQrBhW,QAAQ+sC,MAAR,GAAiBA,MAAjB;AACA;IAAO92B,e;AACL,6BAAc;AAAA;;AACZ,SAAKyB,QAAL,GAAgB,IAAI1X,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAAhB;AACA,SAAK2iB,QAAL,GAAgB,IAAI13B,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAAhB;AACA,SAAKD,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAAZ;AACA,SAAK2xB,QAAL,GAAgBhe,SAAhB;AACA,SAAKihB,MAAL,GAAc,IAAd;AACA,SAAKsD,SAAL,GAAiB,KAAjB;AACD;;;;6BACQvtC,C,EAAGC,C,EAAG;AACb,WAAKutC,cAAL,GAAsBxtC,CAAtB;AACA,WAAKytC,cAAL,GAAsBxtC,CAAtB;AACA,aAAO,IAAP;AACD;;;8BACSib,C,EAAG;AACX,WAAKwyB,SAAL,GAAiBxyB,CAAjB;AACA,aAAO,IAAP;AACD;;;yBACIqR,G,EAAKP,M,EAAQ;;AAEhB,UAAG,CAAC,KAAKuhB,SAAN,IAAmB,KAAKtD,MAA3B,EACA;AACE,aAAK1d,GAAL,GAAWA,GAAX;AACA,YAAIya,WAAW,KAAKza,GAAL,CAASohB,oBAAT,CAA8B,CAA9B,EAAiC,CAAjC,EAAoC,KAAKv4B,IAAL,CAAUvT,CAA9C,EAAiD,CAAjD,CAAf;AACAmlC,iBAAS4G,YAAT,CAAsB,CAAtB,EAAyB,KAAKJ,cAAL,IAAuB,OAAhD;AACAxG,iBAAS4G,YAAT,CAAsB,CAAtB,EAAyB,KAAKH,cAAL,IAAuB,OAAhD;AACA,aAAKzG,QAAL,GAAgBA,QAAhB;;AAEAza,YAAIsa,WAAJ,GAAkB,KAAKG,QAAL,IAAiB,OAAnC;AACAza,YAAIwY,SAAJ,GAAgB,KAAK2I,SAAL,IAAkB,GAAlC;;AAEAnhB,YAAIua,SAAJ;AACAva,YAAIshB,UAAJ,CAAe,KAAK71B,QAAL,CAAcnW,CAA7B,EAAgC,KAAKmW,QAAL,CAAczU,CAA9C,EAAiD,KAAK6R,IAAL,CAAUvT,CAA3D,EAA8D,KAAKuT,IAAL,CAAU7R,CAAxE;AACD;AAEF;;;;;;AAGHjD,QAAQiW,eAAR,GAA0BA,eAA1B;AACA,C,CAAC;;;;;;;;;;;;;;;;IAiBKvQ,M;AACJ,oBAA6B;AAAA,QAAjBuN,GAAiB,uEAAX,EAAW;AAAA,QAAP+F,KAAO;;AAAA;;AAC3B,QAAI1Q,OAAO,QAAO2K,GAAP,yCAAOA,GAAP,MAAc,QAAd,GAAyBA,GAAzB,GAA+B,EAA1C;;AAEA,SAAKu6B,mBAAL,CAAyBllC,IAAzB;AACA,SAAKmlC,UAAL,GAAkB,EAAlB;AACA,SAAKtH,KAAL,GAAa,CAAb;AACA,SAAKhjC,IAAL,GAAY,QAAZ;;AAEA;AACA,SAAK2R,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAAZ;AACA,SAAK40B,MAAL,GAAc,IAAd,CAV2B,CAUP;AACpB,SAAKhhB,MAAL,GAAc,CAAd;;AAEA,SAAK3P,KAAL,GAAaA,SAAS,GAAtB;;AAEA;AACA,SAAK00B,gBAAL,CAAsBz6B,GAAtB;;AAEA;AACA,SAAK06B,UAAL,CAAgBrlC,IAAhB;;AAEA,QAAI,CAAC,KAAKkS,kBAAV,EACE,KAAKozB,WAAL;AACH;;;;qCAEgB36B,G,EAAK;AACpB,UAAIA,eAAe+a,iBAAnB,EAAsC;AACpC,aAAK/a,GAAL,GAAWA,GAAX;AACA,aAAKuH,kBAAL,GAA0B,IAAIxa,QAAQmV,SAAZ,CAAsBlC,GAAtB,CAA1B;AACA,aAAKisB,KAAL,GAAa,KAAK1kB,kBAAL,CAAwB0kB,KAArC;AACA,aAAKuO,UAAL,GAAkB,EAAlB;AACA,aAAKA,UAAL,CAAgBlmC,IAAhB,CAAqB,KAAKiT,kBAA1B;AACA,aAAKozB,WAAL;AACD,OAPD,MAOO,IAAI,OAAO36B,GAAP,IAAc,QAAlB,EAA4B;AACjC,aAAKA,GAAL,GAAWA,GAAX;;AAEA,YAAI46B,UAAU,KAAK56B,GAAL,CAASzG,KAAT,CAAe,GAAf,EAAoBg1B,GAApB,EAAd;AACA;AACA,YAAGqM,OAAH,EACA;AACE,eAAK7kC,IAAL,GAAY,KAAKA,IAAL,IAAa6kC,QAAQrhC,KAAR,CAAc,GAAd,EAAmB,CAAnB,CAAzB;AACD;;AAED,aAAKgO,kBAAL,GAA0B,IAAIxa,QAAQmV,SAAZ,CAAsBlC,GAAtB,CAA1B;AACA,aAAKisB,KAAL,GAAa,KAAK1kB,kBAAL,CAAwB0kB,KAArC;AACA,aAAKuO,UAAL,GAAkB,EAAlB;AACA,aAAKA,UAAL,CAAgBlmC,IAAhB,CAAqB,KAAKiT,kBAA1B;AACA,aAAKozB,WAAL;AACD;AACF;;;wCAEmBtlC,I,EAAM;AACxB,UAAIA,gBAAgBtI,QAAQmV,SAA5B,EAAuC;AACvC;AACEtV,kBAAQ6vB,GAAR,CAAY,4BAAZ,EAA0CpnB,IAA1C;AACAA,iBAAO;AACLkS,gCAAoBlS,IADf;AAEL42B,mBAAO52B,KAAK42B,KAFP;AAGLpqB,kBAAM,IAAI9U,QAAQ+U,MAAZ,CAAmBzM,KAAK22B,SAAxB;AAHD,WAAP;AAKD;AACF;;;0BAEKtU,C,EAAG;AACP,WAAKwb,KAAL,GAAaxb,CAAb;AACA,aAAO,IAAP;AACD;;;yBAEIppB,C,EAAG0B,C,EAAGwU,C,EAAG;AACZ,WAAK3C,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAAZ;AACA,UAAI,KAAK+C,kBAAL,IAA2B,KAAKA,kBAAL,CAAwBqlB,MAAxB,YAA0C3+B,KAAzE,EAAgF;AAC9E,aAAKsZ,kBAAL,CAAwBmR,IAAxB,CAA6BqW,MAA7B;AACD;AACD,aAAO,KAAKltB,IAAZ;AACD;;;sCAEiBg5B,G,EAAK;AACrB,WAAKh5B,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmB+4B,IAAIxzB,KAAJ,GAAY,KAAKtB,KAApC,EAA2C80B,IAAIzzB,MAAJ,GAAa,KAAKrB,KAA7D,EAAoE/D,KAApE,EAAZ;AACD;;;0CAEqBqG,K,EAAO;AAC3B,WAAK8uB,gBAAL,GAAwB,KAAKA,gBAAL,IAAyB,EAAjD;;AAEA,UAAIpf,SAAS3mB,SAASgnB,aAAT,CAAuB,QAAvB,CAAb;AACA,UAAIyiB,MAAM,KAAK5O,KAAL,CAAW9S,UAArB;;AAEApB,aAAO1Q,KAAP,GAAewzB,IAAIxzB,KAAnB;AACA0Q,aAAO3Q,MAAP,GAAgByzB,IAAIzzB,MAApB;;AAEA,UAAI4R,MAAMjB,OAAOS,UAAP,CAAkB,IAAlB,CAAV;AACAQ,UAAIgC,SAAJ,CAAc6f,GAAd,EAAmB,CAAnB,EAAsB,CAAtB,EAAyBA,IAAIxzB,KAA7B,EAAoCwzB,IAAIzzB,MAAxC;AACA4R,UAAIib,SAAJ,GAAgB5rB,KAAhB;AACA2Q,UAAI+a,WAAJ,GAAkB,IAAlB;AACA/a,UAAI8a,wBAAJ,GAA+B,aAA/B;AACA9a,UAAI8hB,QAAJ,CAAa,CAAb,EAAgB,CAAhB,EAAmBD,IAAIxzB,KAAvB,EAA8BwzB,IAAIzzB,MAAlC;AACA4R,UAAI8a,wBAAJ,GAA+B,aAA/B;;AAEA,WAAKqD,gBAAL,CAAsB7iC,IAAtB,CAA2ByjB,MAA3B;;AAEA,aAAO,IAAP;AACD;;;oCAEehQ,C,EAAG;AACjB,WAAK+rB,wBAAL,GAAgC/rB,CAAhC;AACA,aAAO,IAAP;AACD;;;gCAEWM,K,EAAsB;AAAA,UAAfypB,OAAe,uEAAP,KAAO;;AAChC,WAAKiJ,YAAL;AACA,WAAKC,YAAL,GAAoB,KAAKA,YAAL,IAAqB5pC,SAASgnB,aAAT,CAAuB,QAAvB,CAAzC;;AAEA,UAAIyiB,MAAM,KAAK5O,KAAL,CAAW9S,UAArB;AACA,WAAK6hB,YAAL,CAAkB3zB,KAAlB,GAA0BwzB,IAAIxzB,KAA9B;AACA,WAAK2zB,YAAL,CAAkB5zB,MAAlB,GAA2ByzB,IAAIzzB,MAA/B;;AAEA,WAAK6zB,SAAL,GAAiB,KAAKA,SAAL,IAAkB,KAAKD,YAAL,CAAkBxiB,UAAlB,CAA6B,IAA7B,CAAnC;AACA,WAAKyiB,SAAL,CAAejgB,SAAf,CAAyB6f,GAAzB,EAA8B,CAA9B,EAAiC,CAAjC,EAAoCA,IAAIxzB,KAAJ,GAAY,KAAKtB,KAArD,EAA4D80B,IAAIzzB,MAAJ,GAAa,KAAKrB,KAA9E;;AAEA,WAAKk1B,SAAL,CAAehH,SAAf,GAA2B5rB,KAA3B;AACA,WAAK4yB,SAAL,CAAelH,WAAf,GAA6BjC,OAA7B;AACA,WAAKmJ,SAAL,CAAenH,wBAAf,GAA0C,aAA1C;AACA,WAAKmH,SAAL,CAAeH,QAAf,CAAwB,CAAxB,EAA2B,CAA3B,EAA8BD,IAAIxzB,KAAlC,EAAyCwzB,IAAIzzB,MAA7C;AACA,WAAK6zB,SAAL,CAAenH,wBAAf,GAA0C,aAA1C;AACA,WAAK7yB,IAAL,GAAY,KAAKg6B,SAAL,CAAevhB,YAAf,CAA4B,CAA5B,EAA+B,CAA/B,EAAkC,KAAKshB,YAAL,CAAkB3zB,KAApD,EAA2D,KAAK2zB,YAAL,CAAkB5zB,MAA7E,CAAZ;AACA,aAAO,IAAP;AACD;;;mCAEc;AACb,WAAK2zB,YAAL;AACA,WAAKC,YAAL,GAAoB,KAAKA,YAAL,IAAqB5pC,SAASgnB,aAAT,CAAuB,QAAvB,CAAzC;AACA,UAAIyiB,MAAM,KAAK5O,KAAL,CAAW9S,UAArB;AACA,WAAK6hB,YAAL,CAAkB3zB,KAAlB,GAA0BwzB,IAAIxzB,KAA9B;AACA,WAAK2zB,YAAL,CAAkB5zB,MAAlB,GAA2ByzB,IAAIzzB,MAA/B;AACA,WAAK6zB,SAAL,GAAiB,KAAKA,SAAL,IAAkB,KAAKD,YAAL,CAAkBxiB,UAAlB,CAA6B,IAA7B,CAAnC;AACA,WAAKyiB,SAAL,CAAejgB,SAAf,CAAyB6f,GAAzB,EAA8B,CAA9B,EAAiC,CAAjC,EAAoCA,IAAIxzB,KAAxC,EAA+CwzB,IAAIzzB,MAAnD;AACA,WAAK6kB,KAAL,CAAW9S,UAAX,GAAwB,KAAK6hB,YAA7B;AACA,aAAO,IAAP;AACD;;;sCAEiB;;AAEhB,UAAG,CAAC,KAAKE,MAAT,EACA;AACE,aAAKH,YAAL;AACD;;AAED,WAAKC,YAAL,GAAoB,KAAKA,YAAL,IAAqB5pC,SAASgnB,aAAT,CAAuB,QAAvB,CAAzC;AACA,WAAK+e,gBAAL,GAAwB,KAAKA,gBAAL,IAAyB,EAAjD;;AAEA,UAAI0D,MAAM,KAAK5O,KAAL,CAAW9S,UAArB;;AAEA,WAAK0hB,GAAL,GAAWA,GAAX;AACA,WAAKG,YAAL,CAAkB3zB,KAAlB,GAA0BwzB,IAAIxzB,KAA9B;AACA,WAAK2zB,YAAL,CAAkB5zB,MAAlB,GAA2ByzB,IAAIzzB,MAA/B;AACA,WAAK6zB,SAAL,GAAiB,KAAKA,SAAL,IAAkB,KAAKD,YAAL,CAAkBxiB,UAAlB,CAA6B,IAA7B,CAAnC;AACA,WAAKyiB,SAAL,CAAejgB,SAAf,CAAyB6f,GAAzB,EAA8B,CAA9B,EAAiC,CAAjC,EAAoCA,IAAIxzB,KAAxC,EAA+CwzB,IAAIzzB,MAAnD;;AAEA,WAAKnG,IAAL,GAAY,KAAKg6B,SAAL,CAAevhB,YAAf,CAA4B,CAA5B,EAA+B,CAA/B,EAAkC,KAAKshB,YAAL,CAAkB3zB,KAApD,EAA2D,KAAK2zB,YAAL,CAAkB5zB,MAA7E,CAAZ;AACA,WAAK+vB,gBAAL,CAAsB7iC,IAAtB,CAA2B,KAAK0mC,YAAhC;;AAEA,WAAKE,MAAL,GAAc,IAAd;AACA,WAAKC,YAAL,GAAoB,EAApB;AACD;;;wCAEkB;AACjB,WAAKA,YAAL,GAAoB,EAApB;AACA,aAAO,IAAP;AACD;;;mCAEcC,G,EAAKxoC,Q,EAAU;;AAE5B,WAAKukC,gBAAL,GAAwB,KAAKA,gBAAL,IAAyB,EAAjD;AACA,WAAKgE,YAAL,GAAoB,KAAKA,YAAL,IAAqB,EAAzC;AACA,WAAKE,iBAAL,GAA0B,CAA1B;;AAEA,UAAGD,IAAIvO,KAAJ,IAAa,CAAhB,EACA;AACF;AACI,aAAKyO,eAAL;AACD;;AAED,UAAIr6B,OAAO,KAAKg6B,SAAL,CAAevhB,YAAf,CAA4B,CAA5B,EAA+B,CAA/B,EAAkC,KAAKshB,YAAL,CAAkB3zB,KAApD,EAA2D,KAAK2zB,YAAL,CAAkB5zB,MAA7E,CAAX;AACAg0B,UAAIG,IAAJ,CAASt6B,IAAT;AACA,WAAKk6B,YAAL,CAAkB7mC,IAAlB,CAAuB2M,IAAvB;AACJ;AACG;;;6CAEuB;AACtB,WAAKk6B,YAAL,GAAoB,KAAKA,YAAL,CAAkB9oC,MAAlB,CAAyB,KAAK8oC,YAAL,CAAkB9M,KAAlB,GAA0BC,OAA1B,EAAzB,CAApB;AACA;AACD;;;kCAEarC,K,EAAOr5B,Q,EAAU;AAC7B,WAAKyoC,iBAAL,GAA0B,CAA1B;AACA,WAAKL,YAAL,CAAkB3zB,KAAlB,GAA0B,KAAKxF,IAAL,CAAUvT,CAApC;AACA,WAAK0sC,YAAL,CAAkB5zB,MAAlB,GAA2B,KAAKvF,IAAL,CAAU7R,CAArC;AACA,WAAKirC,SAAL,CAAejgB,SAAf,CAAyBiR,KAAzB,EAAgC,CAAhC,EAAmC,CAAnC,EAAsC,KAAKpqB,IAAL,CAAUvT,CAAhD,EAAmD,KAAKuT,IAAL,CAAU7R,CAA7D;AACA,UAAIiR,OAAO,KAAKg6B,SAAL,CAAevhB,YAAf,CAA4B,CAA5B,EAA+B,CAA/B,EAAkC,KAAKshB,YAAL,CAAkB3zB,KAApD,EAA2D,KAAK2zB,YAAL,CAAkB5zB,MAA7E,CAAX;AACAxa,cAAQY,IAAR,CAAa,QAAb,EAAuByT,IAAvB;AACA,WAAKk6B,YAAL,CAAkB7mC,IAAlB,CAAuB2M,IAAvB;AACArU,cAAQC,GAAR,CAAY,mBAAZ;AACD;;;mCAEc;AACb,UAAI,KAAKmuC,YAAL,IAAqB,KAAKC,SAA9B,EACE,KAAKA,SAAL,CAAe7d,SAAf,CAAyB,CAAzB,EAA4B,CAA5B,EAA+B,KAAK4d,YAAL,CAAkB3zB,KAAjD,EAAwD,KAAK2zB,YAAL,CAAkB5zB,MAA1E;AACF,aAAO,IAAP;AACD;;AAED;;;;;;;;;;2BAQO3E,C,EAAG;;AAER,UAAI,KAAKzC,GAAL,YAAoB+a,iBAAxB,EAA2C;AACzC,YAAItY,IAAIA,KAAK,YAAW,CAAE,CAA1B;AACAA,UAAEsW,IAAF,CAAO,IAAP,EAAaziB,IAAb,CAAkB,KAAlB;AACD;;AAED,UAAI,KAAK21B,KAAL,IAAc,KAAKA,KAAL,CAAW9S,UAA7B,EAAyC;AACvC,YAAI0hB,MAAM,KAAK5O,KAAL,CAAW9S,UAArB;AAAA,YACE0E,OAAOgd,IAAI5c,MADb;AAEAxb,YAAIA,KAAK,YAAW,CAAE,CAAtB;AACAA,UAAEsW,IAAF,CAAO,IAAP;AACA,aAAKuU,SAAL,GAAiB7qB,CAAjB;AACA,YAAIykB,UAAU,IAAd;AACA2T,YAAI5c,MAAJ,GAAa,YAAW;;AAEtBiJ,kBAAQsU,UAAR,IAAsB,CAAtB;;AAEA3d,eAAK9E,IAAL,CAAUmO,OAAV,EAAmB5wB,IAAnB,CAAwB,KAAxB,EAA+B4wB,OAA/B;AACA;AACAA,kBAAQoG,SAAR,CAAkB,KAAlB,EAAyBpG,OAAzB;AACD,SAPD;;AASA2T,YAAI5hB,OAAJ,GAAc,UAASwiB,GAAT,EAAc;AAC1BvU,kBAAQoG,SAAR,CAAkB,IAAlB,EAAwBpG,OAAxB;AACD,SAFD;AAGD,OAnBD,MAoBK,IAAG,KAAKwU,KAAL,IAAc,KAAKA,KAAL,CAAW9O,MAAX,YAA6B3+B,KAA9C,EACL;AACQ,aAAKq/B,SAAL,GAAiB7qB,CAAjB;AACAA,UAAEsW,IAAF,CAAO,IAAP,EAAaziB,IAAb;AACP;;AAED,aAAO,IAAP;AACD;;;4BAEO+iB,C,EAAG;;AAET,WAAKyY,OAAL,GAAezY,CAAf;AACA,aAAO,IAAP;AACD;;AAGD;;;;;;iCAIsB;AAAA,UAAXhkB,IAAW,uEAAJ,EAAI;;;AAEpB,WAAKsmC,QAAL,CAActmC,IAAd,EAAoB,IAApB,EAFoB,CAEO;;AAE3B,eAASumC,cAAT,CAAwBxtC,IAAxB,EAA8B;AAC5B,eAAOA,KAAKigC,KAAL,CAAW,CAAX,CAAP;AACD;;AAED,UAAIh5B,KAAK42B,KAAL,YAAsBl/B,QAAQyzB,SAA9B,IAA2C,CAAC,KAAKyL,KAArD,EAA4D;AAC1D,aAAKA,KAAL,GAAa52B,KAAK42B,KAAlB;AACD;;AAED,UAAG,OAAO52B,KAAKU,IAAZ,IAAoB,QAAvB,EACA,KAAKA,IAAL,GAAYV,KAAKU,IAAjB;;AAEA;AACA,WAAKomB,IAAL,GAAY9mB,KAAK8mB,IAAL,IAAa,OAAO,EAAhC;;AAEA,WAAK0f,WAAL,GAAmBxmC,KAAKwmC,WAAL,IAAoB,cAAvC;;AAEA,WAAK/J,OAAL,GAAez8B,KAAKy8B,OAAL,IAAgB,GAA/B;;AAEA,WAAKzpB,KAAL,GAAahT,KAAKgT,KAAL,IAAc,SAA3B;;AAGA;;;;;AAKA,WAAKhV,EAAL,GAAU,KAAKM,SAAL,EAAV;;AAGA;;;;;AAKA,UAAImoC,YAAY,CAAC,YAAD,EAAe,OAAf,EAAwB,QAAxB,EAAkC,SAAlC,EAA6C,QAA7C,EAAuD,QAAvD,CAAhB;;AAEA,UAAI1a,UAAU,IAAd;;AAEA0a,gBAAU3pC,OAAV,CAAkB,UAAS4pC,EAAT,EAAa;;AAE7B3a,gBAAQ2a,EAAR,IAAcH,eAAe7uC,QAAQ0J,MAAR,CAAepB,IAAf,EAAqB0mC,EAArB,EAAyB,EAAzB,CAAf,CAAd;AAED,OAJD;;AAOA;;;;;AAKA,WAAKC,OAAL,GAAejvC,QAAQ0J,MAAR,CAAepB,IAAf,EAAqB,SAArB,EAAgC,EAAhC,CAAf;AACA,WAAK4mC,SAAL,GAAiBlvC,QAAQ0J,MAAR,CAAepB,IAAf,EAAqB,WAArB,EAAkC,EAAlC,CAAjB;AACA,WAAK6mC,KAAL,GAAanvC,QAAQ0J,MAAR,CAAepB,IAAf,EAAqB,OAArB,EAA8B,EAA9B,CAAb;AACA,WAAK8mC,QAAL,GAAgBpvC,QAAQ0J,MAAR,CAAepB,IAAf,EAAqB,UAArB,EAAiC,EAAjC,CAAhB;AACA,WAAKmC,KAAL,GAAazK,QAAQ0J,MAAR,CAAepB,IAAf,EAAqB,OAArB,EAA8B,KAA9B,CAAb;AACA,WAAKwhC,YAAL,GAAoBxhC,KAAKwhC,YAAL,IAAqB,GAAzC;AACA,WAAKC,QAAL,GAAgBzhC,KAAKyhC,QAAL,IAAiB,KAAjC;;AAEA,UAAI,KAAKA,QAAT,EAAmB;AACjB,aAAKD,YAAL,GAAoB,CAApB;AACD;;AAGD;;;;;AAKA,WAAKp6B,KAAL,GAAa,IAAI1P,QAAQ+U,MAAZ,CAAmB/U,QAAQ0J,MAAR,CAAepB,IAAf,EAAqB,OAArB,EAA8B,IAAItI,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAA9B,CAAnB,CAAb;;AAEA;;;;;AAKA,WAAKD,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmB/U,QAAQ0J,MAAR,CAAepB,IAAf,EAAqB,MAArB,EAA6B,IAAItI,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAA7B,CAAnB,CAAZ;;AAGA;;;;;AAKA,WAAK2C,QAAL,GAAgB,IAAI1X,QAAQ+U,MAAZ,CAAmB/U,QAAQ0J,MAAR,CAAepB,IAAf,EAAqB,UAArB,EAAiC,IAAItI,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAjC,CAAnB,CAAhB;AACA,WAAKs6B,YAAL,GAAoB,IAAIrvC,QAAQ+U,MAAZ,CAAmB/U,QAAQ0J,MAAR,CAAepB,IAAf,EAAqB,cAArB,EAAqC,IAAItI,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAArC,CAAnB,CAApB;AACA,WAAKu6B,gBAAL,GAAwBtvC,QAAQ0J,MAAR,CAAepB,IAAf,EAAqB,kBAArB,EAAyC,IAAItI,QAAQgzB,YAAZ,CAAyB,IAAIhzB,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAzB,EAAsD,IAAI/U,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAtD,CAAzC,CAAxB;;AAGA,WAAKw6B,QAAL,GAAgB,KAAhB;;AAEA;;;;;;;AAOA,WAAK7X,QAAL,GAAgB,IAAI13B,QAAQ+U,MAAZ,CAAmB/U,QAAQ0J,MAAR,CAAepB,IAAf,EAAqB,UAArB,EAAiC,IAAItI,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAjC,CAAnB,CAAhB;;AAGA;;;;;AAKA,WAAKiE,KAAL,GAAa1Q,KAAK0Q,KAAL,IAAc,GAA3B;AACA,WAAKw2B,YAAL,GAAoBxvC,QAAQ0J,MAAR,CAAepB,IAAf,EAAqB,cAArB,EAAqC,IAAItI,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAArC,CAApB;AACA,WAAK06B,SAAL,GAAiB,IAAIzvC,QAAQ+U,MAAZ,CAAmB/U,QAAQ0J,MAAR,CAAepB,IAAf,EAAqB,WAArB,EAAkC,IAAItI,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAAlC,CAAnB,CAAjB;AACA,WAAK26B,SAAL,GAAiB,IAAI1vC,QAAQ+U,MAAZ,CAAmB/U,QAAQ0J,MAAR,CAAepB,IAAf,EAAqB,WAArB,EAAkC,IAAItI,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAAlC,CAAnB,CAAjB;AACA,WAAKzH,OAAL,GAAetN,QAAQ0J,MAAR,CAAepB,IAAf,EAAqB,SAArB,EAAgC,IAAItI,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAhC,CAAf;;AAGA,UAAIpK,SAAS,IAAb;;AAEA;;;AAGA3K,cAAQwI,IAAR,CAAa,KAAK2mC,KAAlB,EAAyB,UAASxqC,EAAT,EAAaU,IAAb,EAAmB;AAC1CsF,eAAOwkC,KAAP,CAAaxqC,EAAb,IAAmB,IAAI3E,QAAQqV,IAAZ,CAAiBhQ,IAAjB,CAAnB;AACD,OAFD;;AAIArF,cAAQwI,IAAR,CAAa,KAAKo2B,MAAlB,EAA0B,UAASj6B,EAAT,EAAaU,IAAb,EAAmB;AAC3CsF,eAAOi0B,MAAP,CAAcj6B,EAAd,IAAoB,IAAI3E,QAAQk+B,KAAZ,CAAkB74B,IAAlB,CAApB;AACD,OAFD;;AAIArF,cAAQwI,IAAR,CAAa,KAAKymC,OAAlB,EAA2B,UAAStqC,EAAT,EAAaU,IAAb,EAAmB;AAC5CsF,eAAOskC,OAAP,CAAetqC,EAAf,IAAqB,IAAI3E,QAAQ2vC,WAAZ,CAAwBtqC,IAAxB,CAArB;AACD,OAFD;;AAIArF,cAAQwI,IAAR,CAAa,KAAKilC,UAAlB,EAA8B,UAAS9oC,EAAT,EAAaU,IAAb,EAAmB;AAC/CsF,eAAO8iC,UAAP,CAAkB9oC,EAAlB,IAAwB,IAAI3E,QAAQmV,SAAZ,CAAsB9P,IAAtB,CAAxB;AACD,OAFD;;AAIArF,cAAQwI,IAAR,CAAa,KAAK0mC,SAAlB,EAA6B,UAASvqC,EAAT,EAAaU,IAAb,EAAmB;AAC9CsF,eAAOukC,SAAP,CAAiBvqC,EAAjB,IAAuB,IAAI3E,QAAQ4vC,QAAZ,CAAqBvqC,IAArB,CAAvB;AACD,OAFD;;AAIA;;AAEArF,cAAQwI,IAAR,CAAa,KAAK4mC,QAAlB,EAA4B,UAASzqC,EAAT,EAAaU,IAAb,EAAmB;AAC7CsF,eAAOtD,cAAP,CAAsBhC,IAAtB;AACD,OAFD;;AAIA,UAAI,CAAC,KAAKmV,kBAAN,IAA4BlS,KAAKkS,kBAArC,EAAyD;;AAEvD;AACA,aAAKA,kBAAL,GAA0B,IAAIxa,QAAQmV,SAAZ,CAAsB7M,KAAKkS,kBAA3B,CAA1B;;AAEA,aAAKizB,UAAL,GAAkB,EAAlB;AACA,YAAI,KAAKA,UAAL,CAAgBniC,OAAhB,CAAwB,KAAKkP,kBAA7B,KAAoD,CAAC,CAAzD,EACE,KAAKizB,UAAL,CAAgBlmC,IAAhB,CAAqB,KAAKiT,kBAA1B;AACH;AACF;;;mCAEc;AACb,aAAO,KAAK60B,YAAZ;AACD;;;2BAEM9tC,C,EAAG0B,C,EAAG;AACX,WAAKu8B,MAAL,GAAc,IAAIx/B,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,CAAd;AACA,UAAIgL,SAAS,IAAb;AACA,WAAKw/B,UAAL,CAAgBroC,OAAhB,CAAwB,UAASk7B,MAAT,EAAiB;AACvCA,eAAOc,MAAP,CAAcnzB,OAAOuxB,MAArB;AACD,OAFD;AAGD;;AAGD;;;;;;;;;;0BAQMvxB,M,EAAQ;AACZpO,cAAQC,GAAR,CAAY,wBAAZ;AACA,UAAI+vC,QAAQ,IAAI7vC,QAAQ0F,MAAZ,CAAmBuI,OAAOgF,GAA1B,CAAZ;AACA48B,YAAMC,KAAN,CAAY,IAAI9vC,QAAQmV,SAAZ,CAAsBlH,OAAO0gC,KAA7B,CAAZ;AACAkB,YAAMlC,UAAN,CAAiB1/B,MAAjB;AACA,aAAO4hC,KAAP;AACD;;;yBAEI5jB,G,EAAKP,M,EAAQ;;AAEhB,UAAIzd,MAAJ;;AAEA,UAAI,KAAKlF,WAAL,CAAiBC,IAAjB,IAAyB,aAA7B,EAA4C;AAC1CiF,iBAAS,KAAK8hC,eAAd;AACD,OAFD,MAEO;AACL9hC,iBAAS,IAAT;AACD;;AAEDyd,eAASA,UAAU,KAAnB;;AAEA,UAAI,CAACA,MAAD,IAAW1rB,QAAQ4E,YAAR,CAAqB,CAArB,CAAX,IAAsC5E,QAAQ4E,YAAR,CAAqB,CAArB,EAAwB8mB,MAAlE,EACEA,SAAS1rB,QAAQ4E,YAAR,CAAqB,CAArB,EAAwB8mB,MAAjC,CADF,KAGK,IAAI,CAACA,MAAL,EAAa;AAChBA,iBAAS;AACPhU,oBAAU,IAAI1X,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB;AADH,SAAT;AAGD;;AAED,UAAI9G,OAAOg/B,SAAX,EACE;;AAEF,UAAIh/B,OAAO07B,MAAP,KAAkB,KAAKqG,aAAL,IAAsB/hC,OAAOgiC,QAAP,CAAgBjwC,QAAQoE,KAAxB,EAA+BpE,QAAQwE,MAAvC,CAAxC,CAAJ,EAA6F;AAC3F,aAAK0rC,kBAAL,CAAwBjkB,GAAxB,EAA6BP,MAA7B;AACD;AACF;;;kCAEa7lB,Q,EAAU;AACtB,WAAKmI,MAAL,GAAc,YAAW;AACvBnI,iBAASmmB,IAAT,CAAc,IAAd,EAAoBziB,IAApB;AACD,OAFD;AAGD;;;gCAEWhG,M,EAAQsC,Q,EAAU;AAC5B,WAAKkI,QAAL,CAAc,YAAW;AACvB,YAAI2L,aAAa1Z,QAAQuY,SAAR,CAAkBkB,kBAAlB,CAAqC,CAAC,IAAD,CAArC,EAA6ClW,MAA7C,CAAjB;AACAmW,mBAAWtU,OAAX,CAAmB,UAASxF,CAAT,EAAY;AAC7BiG,mBAASjG,EAAE2D,MAAX,EAAmB3D,EAAEia,QAArB;AACD,SAFD;AAGD,OALD;AAMD;;;oCAEetW,M,EAAQsC,Q,EAAU;AAChC,WAAKkI,QAAL,CAAc,YAAW;AACvBlI,iBAAS7F,QAAQuY,SAAR,CAAkBkB,kBAAlB,CAAqC,CAAC,IAAD,CAArC,EAA6ClW,MAA7C,CAAT;AACD,OAFD;AAGD;;;uCAEkB0oB,G,EAAKP,M,EAAQ;;AAE9B,UAAIzd,MAAJ;;AAEA,UAAI,KAAKlF,WAAL,CAAiBC,IAAjB,IAAyB,aAA7B,EAA4C;AAC1CiF,iBAAS,KAAK8hC,eAAd;AACD,OAFD,MAEO;AACL9hC,iBAAS,IAAT;AACD;;AAED,UAAIk0B,QAAQ,KAAZ;AAAA,UACEgO,YAAY,EADd;;AAGA,UAAI,KAAKlC,YAAT,EAAuB;AACrB,aAAKn5B,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmB,KAAKk5B,YAAL,CAAkB3zB,KAAlB,GAA0B,KAAKtB,KAAlD,EAAyD,KAAKi1B,YAAL,CAAkB5zB,MAAlB,GAA2B,KAAKrB,KAAzF,CAAZ,EACA,KAAKwmB,MAAL,GAAc,KAAK1qB,IAAL,CAAUpO,GAAV,CAAc,GAAd,CADd;;AAGA7G,gBAAQC,GAAR,CAAY,uBAAZ;;AAEF,eAAQE,QAAQuqC,MAAR,CAAeC,gBAAf,CAAgC,KAAKyD,YAArC,EAAmD,IAAIjuC,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAAnD,EAA6E,KAAKD,IAAlF,EAAwF,IAAI9U,QAAQs4B,QAAZ,CAAqBxxB,KAAKmO,KAAL,CAAW,KAAKyC,QAAL,CAAcnW,CAAd,GAAmB,KAAKi+B,MAAL,CAAYj+B,CAA1C,CAArB,EAAoEuF,KAAKmO,KAAL,CAAW,KAAKyC,QAAL,CAAczU,CAAd,GAAmB,KAAKu8B,MAAL,CAAYv8B,CAA1C,CAApE,CAAxF,EAA4M,KAAK6R,IAAjN,EAAuN,KAAK4iB,QAAL,CAAcn2B,CAArO,EAAwO0qB,GAAxO,EAA6O,KAAK0T,KAAlP,EAAyP,KAAK8K,KAA9P,EAAqQ,KAAKjL,MAA1Q,EAAkR,KAAKuF,OAAvR,EAAgS,KAAKgC,wBAAL,IAAiC,KAAjU,CAAR;AACC;;AAED,UAAI94B,OAAO07B,MAAX,EAAmB;;AAEjB,YAAI17B,OAAOuM,kBAAP,YAAqCtZ,KAArC,IAA8C+M,OAAOuM,kBAAP,CAA0BjU,MAA1B,IAAoC,CAAtF,EAAyF;AACvF0H,iBAAOuM,kBAAP,CAA0BpV,OAA1B,CAAkC,UAASupC,KAAT,EAAgB;AAChDwB,sBAAU5oC,IAAV,CAAeonC,MAAM/O,cAArB;AACD,WAFD;AAGD;;AAED,YAAI3xB,OAAOuM,kBAAP,YAAqCvY,MAArC,IAA+CgM,OAAOuM,kBAAP,CAA0B5Y,cAA1B,CAAyC,gBAAzC,CAAnD,EAA+G;AAC7GugC,kBAAQl0B,OAAOuM,kBAAP,CAA0BolB,cAAlC;AACD;;AAED,YAAIx9B,IAAI6L,OAAOyJ,QAAf;;AAEA,YAAI04B,aAAa1kB,OAAOhU,QAAP,IAAmB;AAClCnW,aAAG,CAD+B;AAElC0B,aAAG,CAF+B;AAGlCwU,aAAG;AAH+B,SAApC;;AAMA,YAAI,CAACxJ,OAAOrM,cAAP,CAAsB,cAAtB,CAAL,EAA4C;AAC1CqM,iBAAO67B,YAAP,GAAsB,GAAtB;AACD;;AAED,YAAIvoC,IAAIa,EAAEb,CAAV;AAAA,YACE0B,IAAIb,EAAEa,CADR;AAAA,YAEE6mC,eAAe77B,OAAO67B,YAAP,IAAuB,CAAC,GAAxB,IAA+B77B,OAAO67B,YAAP,IAAuB,GAAtD,GAA4D77B,OAAO67B,YAAnE,GAAkF,GAFnG;;AAIA,YAAI77B,OAAO87B,QAAX,EAAqB;AACnBD,yBAAe,CAAf;AACD;;AAGD;;AAEA,YAAIE,aAAa/7B,OAAO6G,IAAP,IAAe7G,OAAOuM,kBAAP,CAA0B1F,IAA1D;;AAEA,YAAIm1B,YAAYD,WAAWzoC,CAA3B;AACA,YAAI2oC,aAAaF,WAAW/mC,CAA5B;;AAGA,YAAIu8B,SAASvxB,OAAOuxB,MAAP,IAAiB,IAAIx/B,QAAQ+U,MAAZ,CAAmBk1B,YAAY,CAA/B,EAAkCC,aAAa,CAA/C,CAA9B;;AAEA;;AAEA,YAAIxS,QAAJ;;AAEA,YAAI,QAAOzpB,OAAOypB,QAAd,KAA2B,QAA/B,EAAyC;AACvCA,qBAAWzpB,OAAOypB,QAAP,CAAgBn2B,CAA3B;AAED,SAHD,MAGO;AACLm2B,qBAAWzpB,OAAOypB,QAAlB;AACD;;AAGD,YAAI,KAAKwH,KAAL,IAAc,KAAKA,KAAL,CAAW9S,UAAX,YAAiC4B,iBAAnD,EAAsE;AACpE,cAAIzsB,IAAI,KAAKmW,QAAL,CAAcnW,CAAtB;AAAA,cACE0B,IAAI,KAAKyU,QAAL,CAAczU,CADpB;;AAGA1B,eAAK6uC,WAAW7uC,CAAX,GAAeuoC,YAAf,IAA+B,CAApC;AACA7mC,eAAKmtC,WAAWntC,CAAX,GAAe6mC,YAAf,IAA+B,CAApC;AACA;AACA,iBAAO9pC,QAAQuqC,MAAR,CAAeC,gBAAf,CAAgC,KAAKtL,KAAL,CAAW9S,UAA3C,EAAuD,IAAIpsB,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAAvD,EAAiF,KAAKD,IAAtF,EAA4F,IAAI9U,QAAQs4B,QAAZ,CAAqBxxB,KAAKmO,KAAL,CAAW1T,IAAKi+B,OAAOj+B,CAAvB,CAArB,EAAiDuF,KAAKmO,KAAL,CAAWhS,IAAKu8B,OAAOv8B,CAAvB,CAAjD,CAA5F,EAA0K,IAAIjD,QAAQs4B,QAAZ,CAAqB2R,SAArB,EAAgCC,UAAhC,CAA1K,EAAuNxS,WAAW,GAAlO,EAAuOzL,GAAvO,EAA4Ohe,OAAO0xB,KAAnP,EAA0P1xB,OAAOw8B,KAAjQ,EAAwQjL,MAAxQ,EAAgR,KAAKuF,OAArR,EAA8R,KAAKgC,wBAAL,IAAiC,KAA/T,CAAP;AACD;;AAGD,YAAI,EAAE94B,OAAOuM,kBAAP,IAA6BvM,OAAOuM,kBAAP,CAA0BolB,cAAzD,CAAJ,EAA8E;AAC5E;AACD;;AAED,YAAIuC,QAAQl0B,OAAOuM,kBAAP,CAA0BolB,cAAtC;;AAEA,YAAIuC,SAASA,MAAMjD,KAAf,IAAwBiD,MAAMjD,KAAN,CAAYhrB,IAAxC,EAA8C;;AAE5C+X,cAAIokB,YAAJ,CAAiBlO,MAAMjD,KAAN,CAAYhrB,IAA7B,EAAmC3S,CAAnC,EAAsC0B,CAAtC,EAAyC,CAAzC,EAA4C,CAA5C,EAA+CgL,OAAO6G,IAAP,CAAYvT,CAA3D,EAA8D0M,OAAO6G,IAAP,CAAY7R,CAA1E;AAED,SAJD,MAIO;;AAEL,cAAIktC,UAAU5pC,MAAV,IAAoB,CAAxB,EAA2B;;AAEzB4pC,sBAAU/qC,OAAV,CAAkB,UAAS+8B,KAAT,EAAgB;;AAEhC,kBAAI8H,YAAY9H,MAAMrtB,IAAN,CAAWvT,CAA3B;AACA,kBAAI2oC,aAAa/H,MAAMrtB,IAAN,CAAW7R,CAA5B;;AAEA,kBAAI2mC,OAAOzH,MAAMzqB,QAAN,CAAenW,CAA1B;AAAA,kBACEsoC,OAAO1H,MAAMzqB,QAAN,CAAezU,CADxB;;AAGA1B,mBAAK0M,OAAOyJ,QAAP,CAAgBnW,CAArB;AACA0B,mBAAKgL,OAAOyJ,QAAP,CAAgBzU,CAArB;;AAEA1B,mBAAK6uC,WAAW7uC,CAAX,GAAeuoC,YAAf,IAA+B,CAApC;AACA7mC,mBAAKmtC,WAAWntC,CAAX,GAAe6mC,YAAf,IAA+B,CAApC;;AAEA77B,qBAAOohC,YAAP,GAAsB,IAAIrvC,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,CAAtB;;AAEA,kBAAIk/B,MAAMzK,QAAN,IAAkB,OAAOyK,MAAMzK,QAAN,CAAen2B,CAAtB,IAA2B,QAAjD,EAA2D;AACzDm2B,2BAAWyK,MAAMzK,QAAN,CAAen2B,CAA1B;AACD;;AAED,kBAAI4gC,MAAM3C,MAAV,EAAkB;AAChBA,yBAAS2C,MAAM3C,MAAf;AACA;AACD;;AAGD,kBAAI2C,SAASA,MAAMjD,KAAnB,EACEl/B,QAAQuqC,MAAR,CAAeC,gBAAf,CAAgCv8B,OAAOggC,YAAP,GAAsBhgC,OAAOggC,YAA7B,GAA4C9L,MAAMjD,KAAN,CAAY9S,UAAxF,EAAoG+V,MAAMlB,QAA1G,EAAoHkB,MAAMlD,SAA1H,EAAqI,IAAIj/B,QAAQs4B,QAAZ,CAAqBxxB,KAAKmO,KAAL,CAAW20B,OAAQpK,OAAOj+B,CAA1B,CAArB,EAAoDuF,KAAKmO,KAAL,CAAW40B,OAAQrK,OAAOv8B,CAA1B,CAApD,CAArI,EAAyN,IAAIjD,QAAQs4B,QAAZ,CAAqB2R,SAArB,EAAgCC,UAAhC,CAAzN,EAAsQxS,WAAW,GAAjR,EAAsRzL,GAAtR,EAA2Rhe,OAAO0xB,KAAlS,EAAyS1xB,OAAOw8B,KAAhT,EAAuTjL,MAAvT,EAA+T,KAAKuF,OAApU,EAA6U,KAAKgC,wBAAL,IAAiC,KAA9W;AAEH,aA7BD;AA+BD,WAjCD,MAiCO;AACL,gBAAIuJ,KAAKnO,MAAMzqB,QAAN,CAAenW,CAAxB;AAAA,gBACEgvC,KAAKpO,MAAMzqB,QAAN,CAAezU,CADtB;AAAA,gBAEEqP,MAAM,IAAItS,QAAQ+U,MAAZ,CAAmBxT,IAAI+uC,EAAvB,EAA2BrtC,IAAIstC,EAA/B,CAFR;;AAIAj+B,gBAAI/Q,CAAJ,IAAS6uC,WAAW7uC,CAAX,GAAeuoC,YAAf,IAA+B,CAAxC;AACAx3B,gBAAIrP,CAAJ,IAASmtC,WAAWntC,CAAX,GAAe6mC,YAAf,IAA+B,CAAxC;AACA77B,mBAAOohC,YAAP,GAAsB/8B,GAAtB;AACA,gBAAI6vB,MAAMjD,KAAN,CAAY9S,UAAZ,YAAkCgT,gBAAlC,IAAsD+C,MAAMjD,KAAN,CAAY9S,UAAZ,YAAkC4B,iBAA5F,EAA+G;AAC7GhuB,sBAAQuqC,MAAR,CAAeC,gBAAf,CAAgC,KAAKyD,YAAL,GAAoB,KAAKA,YAAzB,GAAwC9L,MAAMjD,KAAN,CAAY9S,UAApF,EAAgG+V,MAAMlB,QAAtG,EAAgHkB,MAAMlD,SAAtH,EAAiI,IAAIj/B,QAAQs4B,QAAZ,CAAqBxxB,KAAKmO,KAAL,CAAW3C,IAAI/Q,CAAJ,GAASi+B,OAAOj+B,CAA3B,CAArB,EAAqDuF,KAAKmO,KAAL,CAAW3C,IAAIrP,CAAJ,GAASu8B,OAAOv8B,CAA3B,CAArD,CAAjI,EAAuN,IAAIjD,QAAQs4B,QAAZ,CAAqB2R,SAArB,EAAgCC,UAAhC,CAAvN,EAAoQxS,WAAW,GAA/Q,EAAoRzL,GAApR,EAAyRhe,OAAO0xB,KAAhS,EAAuS1xB,OAAOw8B,KAA9S,EAAqTjL,MAArT,EAA6T,KAAKuF,OAAlU,EAA2U,KAAKgC,wBAAL,IAAiC,KAA5W;AACD;AAEF;AAEF;AACF;AAEF;;AAED;;;;;;;;;;wBASIxjC,M,EAAQ;;AAEV,UAAIA,kBAAkBvD,QAAQmV,SAA9B,EAAyC;AACvC,aAAKs4B,UAAL,CAAgBh5B,GAAhB,CAAoBlR,MAApB;AACD;;AAED,aAAO,IAAP;AACD;;;0BAUKorC,K,EAAO;AACX,UAAIA,KAAJ,EACE,KAAKn0B,kBAAL,GAA0Bm0B,KAA1B;AACF,aAAO,IAAP;AACD;;;8BAGSA,K,EAAO;AACf,UAAIA,KAAJ,EACE,KAAKn0B,kBAAL,GAA0Bm0B,KAA1B;AACF,aAAO,IAAP;AACD;;;+BAGoC;AAAA,UAA5Bz6B,IAA4B,uEAArB,EAAqB;AAAA,UAAjBs8B,OAAiB,uEAAP,KAAO;;AACnC,WAAK,IAAIjvC,CAAT,IAAc2S,IAAd,EAAoB;AAClB,YAAIs8B,WAAW,OAAOt8B,KAAK3S,CAAL,CAAP,KAAoB,UAAnC,EACE,KAAKA,CAAL,IAAU2S,KAAK3S,CAAL,CAAV;AACH;;AAED,UAAG2S,KAAKlG,MAAR,EACA;AACE,aAAKA,MAAL,GAAckG,KAAKlG,MAAnB;AACD;AACD,aAAO,IAAP;AACD;;;oCAEeiF,G,EAAK;AACnB,aAAO,IAAI,KAAKlK,WAAT,CAAqBkK,GAArB,CAAP;AACD;;AAED;;;;;;;;;;0BAQMw9B,U,EAA4B;AAAA,UAAhBxR,SAAgB,uEAAJ,EAAI;;;AAEhC,WAAKjmB,KAAL,GAAay3B,UAAb;;AAEA,UAAI,KAAK9B,KAAL,IAAc,KAAKA,KAAL,CAAW1P,SAAzB,IAAsC,KAAK0P,KAAL,CAAW1P,SAAX,CAAqByR,aAArB,EAA1C,EAAgF;AAC9EzR,oBAAY,KAAK0P,KAAL,CAAW1P,SAAvB;AACD;;AAED,UAAI0R,SAAS1R,UAAU19B,CAAV,IAAe,KAAK29B,KAAL,CAAW9S,UAAX,CAAsB9R,KAAlD;AAAA,UACEs2B,SAAS3R,UAAUh8B,CAAV,IAAe,KAAKi8B,KAAL,CAAW9S,UAAX,CAAsB/R,MADhD;;AAGA,UAAIvF,OAAO,IAAI9U,QAAQ+U,MAAZ,CAAmB47B,SAASF,UAA5B,EAAwCG,SAASH,UAAjD,CAAX;;AAGA,UAAI,CAAC,KAAK37B,IAAN,IAAcnO,MAAM,KAAKmO,IAAL,CAAUvT,CAAhB,CAAd,IAAoCoF,MAAM,KAAKmO,IAAL,CAAU7R,CAAhB,CAAxC,EACE,KAAK6R,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAAZ;;AAIF,UAAI87B,UAAU/7B,KAAKqiB,GAAL,CAAS,KAAKriB,IAAd,EAAoBg8B,IAApB,EAAd;;AAEA,WAAKp5B,QAAL,CAAcnW,CAAd,IAAmBsvC,QAAQtvC,CAA3B;AACA,WAAKmW,QAAL,CAAczU,CAAd,IAAmB4tC,QAAQ5tC,CAA3B;AACA,WAAK6R,IAAL,GAAYA,IAAZ;;AAEA,aAAO,IAAP;AACD;;AAED;;;;;;;;;;iCASalJ,C,EAAG;AACd,WAAKk+B,YAAL,GAAoBl+B,CAApB;AACA,aAAO,IAAP;AACD;;;2BAEM3K,G,EAAK;AACZ;AACEA,UAAIiH,MAAJ,GAAa,IAAb;AACA,UAAIjH,IAAIuhC,MAAR,EAAgB;AACdvhC,YAAIuhC,MAAJ;AACD;AACF;;AAED;;;;;;;;;;yBAQKlO,C,EAAG;AACN,WAAKlF,IAAL,GAAYkF,CAAZ;AACA,aAAO,IAAP;AACD;;AAED;;;;;;;;;;;2BASO,CAGN;;AAED;;;;;;;;;mCAOeyK,G,EAAK;AAClB,UAAIgS,WAAWhS,IAAI/S,IAAJ,CAAS,IAAT,CAAf;AACA,UAAI,KAAKojB,QAAL,CAAc9jC,OAAd,CAAsBylC,QAAtB,IAAkC,CAAtC,EAAyC;AACvC,aAAK3B,QAAL,CAAc7nC,IAAd,CAAmBwpC,QAAnB;AACD;AACF;;AAED;;;;AAIA;;;;;;;;;6BAOS;AACP,aAAO,KAAKzqC,EAAZ;AACD;;AAED;;;;;;kCAIcwO,I,EAAMk8B,S,EAAW;;AAE7B,WAAKC,SAAL,GAAiB,IAAIjxC,QAAQ+U,MAAZ,CAAmBD,QAAQ,KAAKA,IAAhC,CAAjB;;AAEA,WAAKmqB,SAAL,GAAiB,IAAIj/B,QAAQ+U,MAAZ,CAAmBi8B,aAAa,KAAKl8B,IAArC,CAAjB;;AAEA,aAAO,IAAP;AAED;;AAED;;;;AAIA;;;;;;;;;gCAOY;;AAEV,aAAO9U,QAAQ4G,SAAR,EAAP;AAED;;AAED;;;;;;;;;;;iCASasqC,E,EAAIC,E,EAAI;;AAEnB,UAAIr8B,OAAO,IAAI9U,QAAQ+U,MAAZ,CAAmB,KAAKD,IAAxB,CAAX;AACA,UAAIs8B,MAAMt8B,KAAK7R,CAAL,GAAS6R,KAAKvT,CAAxB;AACA,UAAI8vC,MAAMv8B,KAAKvT,CAAL,GAASuT,KAAK7R,CAAxB;;AAEA,UAAI6R,KAAKvT,CAAL,GAAS2vC,EAAb,EAAiB;AACfp8B,aAAKvT,CAAL,GAAS2vC,EAAT;AACAp8B,aAAK7R,CAAL,GAAS6R,KAAKvT,CAAL,GAAS6vC,GAAlB;AACD;;AAED,UAAIt8B,KAAK7R,CAAL,GAASkuC,EAAb,EAAiB;AACfr8B,aAAK7R,CAAL,GAASkuC,EAAT;AACAr8B,aAAKvT,CAAL,GAASuT,KAAK7R,CAAL,GAASouC,GAAlB;AACD;;AAED,aAAOv8B,IAAP;AACD;;AAED;;;;;;;;kCAMc;AACZ,UAAI,CAAC,KAAKpF,KAAV,EAAiB;AACf,aAAKA,KAAL,GAAa,IAAI1P,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAb;AACD;AACF;;AAGD;;;;;;;;kCAMc;;AAEZ,UAAI,CAAC,KAAKmqB,KAAN,IAAe,CAAC,KAAKA,KAAL,CAAW9S,UAA/B,EAA2C;AACzC,eAAO,IAAP;AACD;;AAED,UAAIzhB,SAAS,IAAb;AAAA,UACEmmB,OAAO,KAAKoO,KAAL,CAAW9S,UAAX,CAAsB8E,MAAtB,IAAgC,YAAW,CAAE,CADtD;;AAGA,UAAI,KAAKpc,IAAL,IAAa,KAAKA,IAAL,CAAUvT,CAAV,KAAgB,CAA7B,IAAkC,KAAKuT,IAAL,CAAU7R,CAAV,KAAgB,CAAtD,EACE;;AAEF,UAAIquC,OAAO,IAAX;;AAEA,UAAI,KAAKpS,KAAL,CAAW9S,UAAX,YAAiC4B,iBAArC,EAAwD;AACtD,YAAIsjB,KAAKx8B,IAAL,IAAaw8B,KAAKx8B,IAAL,CAAUvT,CAAV,KAAgB,CAA7B,IAAkC+vC,KAAKx8B,IAAL,CAAU7R,CAAV,KAAgB,CAAtD,EAAyD,CAExD,CAFD,MAEO;AACL0H,iBAAOmK,IAAP,GAAc,IAAI9U,QAAQ+U,MAAZ,CAAmBpK,OAAOu0B,KAAP,CAAa9S,UAAb,CAAwB9R,KAA3C,EAAkD3P,OAAOu0B,KAAP,CAAa9S,UAAb,CAAwB/R,MAA1E,CAAd;AACA1P,iBAAO6P,kBAAP,GAA4B,IAAIxa,QAAQmV,SAAZ,CAAsB,KAAK+pB,KAAL,CAAW9S,UAAjC,EAA6CqU,SAA7C,CAAuD91B,OAAOmK,IAA9D,CAA5B;AACAnK,iBAAO8iC,UAAP,GAAoB,EAApB;AACA9iC,iBAAO8iC,UAAP,CAAkBlmC,IAAlB,CAAuBoD,OAAO6P,kBAA9B;AACA7P,iBAAOs1B,KAAP,CAAat1B,OAAOqO,KAAP,IAAgB,GAA7B;AACD;;AAED,eAAO,IAAP;AAED;;AAED,WAAKkmB,KAAL,CAAW9S,UAAX,CAAsB8E,MAAtB,GAA+B,YAAW;;AAExCJ,aAAK,KAAL,EAAYnmB,MAAZ;;AAEA,YAAI2mC,KAAKx8B,IAAL,IAAaw8B,KAAKx8B,IAAL,CAAUvT,CAAV,KAAgB,CAA7B,IAAkC+vC,KAAKx8B,IAAL,CAAU7R,CAAV,KAAgB,CAAtD,EAAyD,CAExD,CAFD,MAEO;AACL0H,iBAAOmK,IAAP,GAAc,IAAI9U,QAAQ+U,MAAZ,CAAmBpK,OAAOu0B,KAAP,CAAa9S,UAAb,CAAwB9R,KAA3C,EAAkD3P,OAAOu0B,KAAP,CAAa9S,UAAb,CAAwB/R,MAA1E,CAAd;AACA1P,iBAAO6P,kBAAP,GAA4B,IAAIxa,QAAQmV,SAAZ,CAAsBxK,OAAOu0B,KAA7B,EAAoCuB,SAApC,CAA8C91B,OAAOmK,IAArD,CAA5B;AACAnK,iBAAO8iC,UAAP,GAAoB,EAApB;AACA9iC,iBAAO8iC,UAAP,CAAkBlmC,IAAlB,CAAuBoD,OAAO6P,kBAA9B;AACA7P,iBAAOs1B,KAAP,CAAat1B,OAAOqO,KAAP,IAAgB,GAA7B;AACD;AAEF,OAdD;;AAgBAhZ,cAAQF,GAAR,CAAY,4BAAZ;;AAEA,aAAO,IAAP;AAED;;AAGD;;;;;;;;6BAMS6S,K,EAAO;AACd,WAAKyc,IAAL,GAAYzc,KAAZ;AACD;;AAED;;;;;;;;yBAMKA,K,EAAO;AACZ;AACE,WAAKyc,IAAL,GAAYzc,KAAZ;AACD;;AAED;;;;;;;;2BAMOxM,E,EAAI;AACTA,WAAKA,MAAMnG,QAAQ4E,YAAR,CAAqB,CAArB,CAAX;AACA,aAAO,KAAKhD,cAAL,CAAoB,MAApB,KAA+B,KAAKwtB,IAAL,IAAa,CAAnD;AACD;;AAED;;;;;;;;wBAMIjpB,E,EAAI;AACN,WAAKipB,IAAL,GAAY,CAAZ;AACA,aAAO,IAAP;AACD;;AAED;;;;;;;;;;;6BASS3C,C,EAAGC,C,EAAGvmB,E,EAAI;;AAEjBsmB,UAAIA,KAAKzsB,QAAQoE,KAAjB;AACAsoB,UAAIA,KAAK1sB,QAAQwE,MAAjB;AACA2B,WAAKA,MAAMnG,QAAQ4E,YAAR,CAAqB,CAArB,CAAX;;AAEA,UAAI8mB,SAASvlB,MAAMA,GAAGulB,MAAT,GAAkBvlB,GAAGulB,MAArB,GAA8B1rB,WAAWA,QAAQ0rB,MAAnB,GAA4B1rB,QAAQ0rB,MAApC,GAA6C;AACpFhU,kBAAU,IAAI1X,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB;AAD0E,OAAxF;AAAA,UAGE+0B,eAAe,KAAKC,QAAL,GAAgB,CAAhB,GAAoB,KAAKD,YAH1C;;AAKA,UAAI77B,SAAS,IAAb;AAAA,UACE7L,IAAI6L,OAAOyJ,QADb;AAAA,UAEE04B,aAAa1kB,OAAOhU,QAAP,IAAmB;AAC9BnW,WAAG,CAD2B;AAE9B0B,WAAG,CAF2B;AAG9BwU,WAAG;AAH2B,OAFlC;;AAQA,UAAI,CAACxJ,OAAOrM,cAAP,CAAsB,cAAtB,CAAL,EAA4C;AAC1CqM,eAAO67B,YAAP,GAAsB,GAAtB;AACD;;AAED,UAAIvoC,IAAIa,EAAEb,CAAV;AAAA,UACE0B,IAAIb,EAAEa,CADR;AAAA,UAEE6mC,eAAe77B,OAAO67B,YAAP,IAAuB,CAAC,GAAxB,IAA+B77B,OAAO67B,YAAP,IAAuB,GAAtD,GAA4D77B,OAAO67B,YAAnE,GAAkF,GAFnG;;AAIA,UAAI77B,OAAO87B,QAAX,EAAqB;AACnBD,uBAAe,CAAf;AACD;;AAEDvoC,WAAK6uC,WAAW7uC,CAAX,GAAeuoC,YAAf,IAA+B,CAApC;AACA7mC,WAAKmtC,WAAWntC,CAAX,GAAe6mC,YAAf,IAA+B,CAApC;;AAEA,aAAOvoC,IAAI0M,OAAO6G,IAAP,CAAYvT,CAAhB,GAAoB,CAAC,IAAD,GAAQkrB,CAA5B,IAAiClrB,IAAIkrB,IAAI,IAAzC,IACLxpB,IAAIgL,OAAO6G,IAAP,CAAY7R,CAAhB,GAAoB,IAAI,IAAJ,GAAWypB,CAD1B,IAC+BzpB,IAAIypB,IAAI,IAD9C;AAED;;AAED;;;;AAIA;;;;;AAKA;;;;;;;;2BAMOze,M,EAAQ,CAAE;;;oCAGD;AACd,WAAKyJ,QAAL,CAAcnW,CAAd,IAAmB,KAAKmO,KAAL,CAAWnO,CAA9B;AACA,WAAKmW,QAAL,CAAczU,CAAd,IAAmB,KAAKyM,KAAL,CAAWzM,CAA9B;AACD;;AAED;;;;;;AAOA;;;;;;;;;;;;;;;;;;;6BAkBS87B,G,EAAK;;AAEZA,YAAMA,IAAI/S,IAAJ,CAAS,IAAT,CAAN;;AAEA,UAAIhe,SAAS,KAAKA,MAAL,CAAYge,IAAZ,CAAiB,IAAjB,CAAb;;AAEA,UAAIrhB,SAAS,IAAb;;AAEA,WAAKqD,MAAL,GAAc,UAASrD,MAAT,EAAiB;;AAE7BqD,eAAOrD,MAAP;;AAEAo0B,YAAIp0B,MAAJ;AAED,OAND;AAOD;;AAED;;;;;AAKA;;;;;;;;;qCAOiB4mC,U,EAAY7hC,K,EAAO8hC,Q,EAAUhO,M,EAAQ;;AAEpD9zB,cAAQA,SAAS,CAAjB;;AAEA,UAAI+hC,qBAAqB,CAAC,QAAD,EAAW,WAAX,EAAwB,OAAxB,CAAzB;AACAD,iBAAWA,YAAY,QAAvB;AACA,UAAIE,OAAOH,UAAX;;AAEA,UAAIA,WAAWG,IAAf,EAAqB;AACnBA,eAAOH,WAAWG,IAAlB;AACD;;AAED,WAAKC,WAAL,GAAmB,KAAKA,WAAL,IAAoB,CAAvC;;AAEA,UAAIhnC,SAAS,IAAb;AAAA,UACEinC,WAAWjnC,OAAOgnC,WAAP,IAAsB,CAACD,KAAKz5B,MAAL,CAAY1R,MAAZ,GAAqB,CAAtB,IAA2B,CAAjD,KAAuD,CAACmrC,KAAKz5B,MAAL,CAAY1R,MAAZ,GAAqB,CAAtB,IAA2B,CAAlF,CADb;;AAGA,UAAIoE,OAAOgnC,WAAP,IAAuB,CAACD,KAAKz5B,MAAL,CAAY1R,MAAZ,GAAqB,CAAtB,IAA2B,CAAtD,EAA0D;AACxDqrC,mBAAW,MAAMA,QAAjB;AACD;;AAED,UAAIC,WAAW7xC,QAAQgnB,MAAR,CAAesB,KAAf,CAAqBkpB,QAArB,EAA+BI,QAA/B,IAA2CliC,KAA3C,GAAmD,GAAlE;;AAEA,UAAI8hC,YAAY,QAAhB,EAA0B;AACxBK,mBAAWniC,KAAX;AACD;;AAEDmiC,iBAAW/qC,KAAKkwB,IAAL,CAAU6a,QAAV,CAAX;;AAEA,UAAIA,WAAW,CAAf,EAAkB;AAChBA,mBAAW,CAAX;AACD;;AAEDlnC,aAAO+M,QAAP,GAAkB,IAAI1X,QAAQ+U,MAAZ,CAAmB28B,KAAKz5B,MAAL,CAAYtN,OAAOgnC,WAAnB,CAAnB,CAAlB;;AAEA;;AAEAhnC,aAAOgnC,WAAP,IAAsBE,QAAtB;;AAEA,UAAIlnC,OAAOgnC,WAAP,IAAsBD,KAAKz5B,MAAL,CAAY1R,MAAtC,EAA8C;AAC5CmrC,aAAKz5B,MAAL,GAAcy5B,KAAKz5B,MAAL,CAAYspB,OAAZ,EAAd;AACA52B,eAAOgnC,WAAP,GAAqB,CAArB;AACD;;AAED,UAAInO,kBAAkBxjC,QAAQ+U,MAA9B,EAAsC;AACpC,aAAK2C,QAAL,GAAgB,KAAKA,QAAL,CAAcjD,GAAd,CAAkB+uB,MAAlB,CAAhB;AACD;AACF;;AAGD;;;;;AAKA;;;;;;;;;qCAOiB+N,U,EAAY7hC,K,EAAO8hC,Q,EAAUhO,M,EAAQ;;AAEpD9zB,cAAQA,SAAS,CAAjB;;AAEA,UAAI+hC,qBAAqB,CAAC,QAAD,EAAW,WAAX,EAAwB,OAAxB,CAAzB;;AAEAD,iBAAWA,YAAY,QAAvB;;AAEA,UAAIE,OAAOH,UAAX;;AAEA,UAAIA,WAAWG,IAAf,EAAqB;AACnBA,eAAOH,WAAWG,IAAlB;AACD;;AAED,WAAKC,WAAL,GAAmB,KAAKA,WAAL,IAAoB,CAAvC;;AAEA,UAAIhnC,SAAS,IAAb;AAAA,UAEEinC,WAAWjnC,OAAOgnC,WAAP,IAAsB,CAACD,KAAKz5B,MAAL,CAAY1R,MAAZ,GAAqB,CAAtB,IAA2B,CAAjD,KAAuD,CAACmrC,KAAKz5B,MAAL,CAAY1R,MAAZ,GAAqB,CAAtB,IAA2B,CAAlF,CAFb;;AAIA,UAAIoE,OAAOgnC,WAAP,IAAuB,CAACD,KAAKz5B,MAAL,CAAY1R,MAAZ,GAAqB,CAAtB,IAA2B,CAAtD,EAA0D;AACxDqrC,mBAAW,MAAMA,QAAjB;AAED;;AAED,UAAIC,WAAW7xC,QAAQgnB,MAAR,CAAesB,KAAf,CAAqBkpB,QAArB,EAA+BI,QAA/B,IAA2CliC,KAA3C,GAAmD,GAAlE;;AAEA,UAAI8hC,YAAY,QAAhB,EAA0B;AACxBK,mBAAWniC,KAAX;AACD;;AAEDmiC,iBAAW/qC,KAAKkwB,IAAL,CAAU6a,QAAV,CAAX;;AAEA,UAAIA,WAAW,CAAf,EAAkB;AAChBA,mBAAW,CAAX;AACD;;AAEDlnC,aAAO+M,QAAP,GAAkB,IAAI1X,QAAQ+U,MAAZ,CAAmB28B,KAAKz5B,MAAL,CAAYtN,OAAOgnC,WAAnB,CAAnB,CAAlB;;AAEA;;AAEAhnC,aAAOgnC,WAAP,IAAsBE,QAAtB;;AAEA,UAAIlnC,OAAOgnC,WAAP,IAAsBD,KAAKz5B,MAAL,CAAY1R,MAAtC,EAA8C;AAC5CoE,eAAOgnC,WAAP,GAAqB,CAArB;AACD;;AAED,UAAInO,kBAAkBxjC,QAAQ+U,MAA9B,EAAsC;AACpC,aAAK2C,QAAL,GAAgB,KAAKA,QAAL,CAAcjD,GAAd,CAAkB+uB,MAAlB,CAAhB;AACD;AACF;;AAED;;;;;;;AAQA;;;;;;;;;;;;;;0BAYM/T,O,EAAStpB,E,EAAI;AACjB;AACAA,WAAKA,MAAMnG,QAAQ4E,YAAR,CAAqB,CAArB,CAAX;AACA,WAAKktC,QAAL,GAAgB,OAAhB;;AAEA,UAAIC,YAAYtiB,QAAQuiB,MAAR,IAAkBviB,QAAQsiB,SAA1B,IAAuCtiB,QAAQkf,KAA/C,IAAwD,IAAI3uC,QAAQmV,SAAZ,EAAxE;AACA,UAAIzF,QAAQ+f,QAAQ/f,KAAR,IAAiB+f,QAAQwiB,QAAzB,IAAqC,CAAjD;;AAGA,UAAIn9B,OAAO2a,QAAQ3a,IAAR,IAAgB,IAAI9U,QAAQ+U,MAAZ,CAAmB,EAAnB,EAAuB,EAAvB,EAA2B,CAA3B,CAA3B;AACA,UAAI2C,WAAW,IAAI1X,QAAQ+U,MAAZ,CAAmB0a,QAAQ/X,QAA3B,KAAwC,IAAI1X,QAAQ+U,MAAZ,CAAmB,KAAK2C,QAAxB,CAAvD;;AAGA,UAAIw6B,aAAaziB,QAAQyiB,UAAR,IAAsBziB,QAAQiI,QAA9B,IAA0C,CAA3D;AACA,UAAIwQ,QAAQzY,QAAQyY,KAAR,IAAiB,CAA7B;AACA,UAAIiK,WAAW1iB,QAAQ0iB,QAAR,IAAoB,CAAnC,CAfiB,CAeqB;;AAEtC,UAAI/iB,OAAOK,QAAQL,IAAR,IAAgB,GAA3B;AACA,UAAI+f,QAAQ,EAAZ;AACA,WAAK,IAAI5tC,IAAI,CAAb,EAAgBA,IAAI2mC,KAApB,EAA2B3mC,GAA3B,EAAgC;;AAE9B,YAAI6wC,eAAe,IAAnB;AACA,YAAIpyC,QAAQkwB,QAAZ,EAAsB;AACpB,cAAImiB,KAAK36B,SAASnW,CAAlB;AAAA,cACE+wC,KAAK56B,SAASzU,CADhB;AAAA,cAEEsvC,KAAKz9B,KAAKvT,CAFZ;AAAA,cAGEixC,KAAK19B,KAAK7R,CAHZ;;AAKA,cAAIwvC,OAAO,IAAIzyC,QAAQ0F,MAAZ,GAAqBkpC,QAArB,CAA8B;AACvCjF,oBAAQ,IAD+B;AAEvCjyB,sBAAU,IAAI1X,QAAQ+U,MAAZ,CAAmB2C,QAAnB,CAF6B;AAGvC5C,kBAAM,IAAI9U,QAAQ+U,MAAZ,CAAmBD,IAAnB,CAHiC;AAIvCpF,mBAAOA,KAJgC;AAKvCwvB,mBAAO6S,UAAU7S,KALsB;AAMvCxH,sBAAU,IAAI13B,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAN6B;AAOvC4qB,mBAAO,KAPgC;AAQvCvQ,kBAAMK,QAAQL,IARyB;AASvC2a,sBAAU;AAT6B,WAA9B,CAAX;;AAaA0I,eAAKt9B,SAAL,CAAe48B,SAAf;;AAEAG,uBAAa,IAAIlyC,QAAQ+U,MAAZ,CAAmBm9B,UAAnB,EAA+B,CAA/B,EAAkC,CAAlC,CAAb;AACAO,eAAK/6B,QAAL,CAAcnW,CAAd,GAAkB8wC,EAAlB,EAAsBI,KAAK/6B,QAAL,CAAczU,CAAd,GAAkBqvC,EAAxC;;AAEA;;AAEA,cAAI5rC,MAAMyrC,WAAWjK,KAArB;AACA,cAAIwK,UAAUhsC,MAAMnF,CAAN,GAAUmF,MAAM,CAAhB,GAAoByrC,WAAW,CAA7C;;AAEAM,eAAK/a,QAAL,CAAcn2B,CAAd,GAAkB2wC,WAAW3wC,CAAX,GAAemxC,OAAjC;AACA;;AAEAD,eAAK/iC,KAAL,GAAa,IAAI1P,QAAQ+U,MAAZ,CAAmBjO,KAAKqR,GAAL,CAAUs6B,KAAK/a,QAAL,CAAcn2B,CAAf,GAAoB,IAApB,GAA2B,GAApC,IAA2CmO,KAA9D,EAAqE5I,KAAKsR,GAAL,CAAUq6B,KAAK/a,QAAL,CAAcn2B,CAAf,GAAoB,IAApB,GAA2B,GAApC,IAA2CmO,KAAhH,CAAb;AACAy/B,gBAAM5nC,IAAN,CAAWkrC,IAAX;;AAEAA,eAAK1kC,QAAL,CAAc,UAASlF,GAAT,EAAc;AAC1B;AACD,WAFD;AAGA1C,aAAGsO,GAAH,CAAOg+B,IAAP;AACD;AACF;AACD,aAAOtD,KAAP;AACD;;AAED;;;;;;;;;;;;;;;8BAaU1f,O,EAAStpB,E,EAAI;;AAErBA,WAAKA,MAAMnG,QAAQ4E,YAAR,CAAqB,CAArB,CAAX;;AAEA,UAAImtC,YAAYtiB,QAAQsiB,SAAR,IAAqB,IAAI/xC,QAAQmV,SAAZ,EAArC;AACA,UAAIuC,WAAW+X,QAAQ/X,QAAR,IAAoB,IAAI1X,QAAQ+U,MAAZ,CAAmB,KAAK2C,QAAxB,CAAnC;AACA,UAAI8rB,SAAS/T,QAAQ+T,MAAR,IAAkB,IAAIxjC,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAA/B;AACA,UAAID,OAAO,IAAI9U,QAAQ+U,MAAZ,CAAmB0a,QAAQ3a,IAAR,IAAgB,KAAKA,IAAxC,CAAX;;AAEA,UAAI9U,QAAQkwB,QAAZ,EAAsB;;AAEpB,YAAIyiB,YAAYxsC,GAAGsO,GAAH,CAAO,IAAIzU,QAAQ0F,MAAZ,GAAqBkpC,QAArB,CAA8B;AACnDjF,kBAAQ,IAD2C;AAEnDjyB,oBAAUA,QAFyC;AAGnD5C,gBAAMA,IAH6C;AAInD0uB,kBAAQA,MAJ2C;AAKnDtE,iBAAO6S,UAAU7S,KALkC;AAMnDxH,oBAAU,IAAI13B,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CANyC;AAOnD4qB,iBAAO,KAP4C;AAQnDmK,wBAAc,KAAKA,YARgC;AASnDC,oBAAU,KAAKA;AAToC,SAA9B,CAAP,CAAhB;;AAYA4I,kBAAUx9B,SAAV,CAAoB48B,SAApB;;AAEA,eAAOY,SAAP;AAED,OAlBD,MAkBO;AACL9yC,gBAAQQ,KAAR,CAAc,+BAAd;AACD;AACF;;AAGD;;;;;;;;;4BAOQ0xC,S,EAAW;AACjB,UAAI/xC,QAAQkwB,QAAZ,EAAsB;AACpB,YAAI6hB,SAAJ,EAAe;AACb,eAAK58B,SAAL,CAAe48B,SAAf;AACD;;AAED,YAAI,KAAK3D,YAAL,YAA6BltC,KAA7B,IAAsC,KAAKktC,YAAL,CAAkB7nC,MAAxD,IAAkE,KAAK6nC,YAAL,CAAkB7nC,MAAlB,IAA4B,CAAlG,EAAqG;AACnG,eAAK+nC,iBAAL,IAA0B,CAA1B;;AAEAzuC,kBAAQC,GAAR,CAAY,qBAAZ;;AAEA,cAAIoU,OAAO,KAAKk6B,YAAL,CAAkB,KAAKE,iBAAL,GAAyB,KAAKF,YAAL,CAAkB7nC,MAA7D,CAAX;AACF;AACE,eAAK2nC,SAAL,CAAemC,YAAf,CAA4Bn8B,IAA5B,EAAkC,CAAlC,EAAqC,CAArC;AACArU,kBAAQC,GAAR,CAAY,eAAZ;AACD,SATD,MASO,IAAI,KAAKmuC,YAAT,EAAuB;AAC5B,eAAKK,iBAAL,IAA0B,CAA1B;AACA;AACD,SAHM,MAGA,IAAI,KAAK9zB,kBAAT,EAA6B;AAClC,eAAKA,kBAAL,CAAwBnM,GAAxB;AACD;AACF;AACF;;AAED;;;;;;;;;;;wCAQoB0wB,G,EAAK;AACvB,WAAKvkB,kBAAL,CAAwBpS,UAAxB,CAAmC22B,GAAnC;AACD;;;6BAEQpsB,K,EAAO;AACd,UAAIA,KAAJ,EACE,KAAK48B,QAAL,GAAgB58B,KAAhB;AACF,aAAO,KAAK48B,QAAZ;AACD;;AAGD;;;;;;;;;;;6BAQS;AACP,aAAO,IAAIvvC,QAAQ+U,MAAZ,CAAmB,KAAK2C,QAAL,CAAcnW,CAAd,GAAkB,KAAKuT,IAAL,CAAUvT,CAAV,GAAc,CAAnD,EAAsD,KAAKmW,QAAL,CAAczU,CAAd,GAAkB,KAAK6R,IAAL,CAAU7R,CAAV,GAAc,CAAtF,EAAyF,CAAzF,CAAP;AACD;;AAGD;;;;AAKA;;;;;;kCAIcoC,I,EAAMQ,Q,EAAU;AAC5B,UAAI+sC,aAAavtC,KAAK/E,GAAL,GAAW+E,KAAK/E,GAAL,CAAS2C,CAApB,GAAwB6D,KAAK+U,GAAL,CAASxW,KAAKqS,QAAL,CAAczU,CAAd,GAAkB,KAAKyU,QAAL,CAAczU,CAAhC,GAAoC,KAAK6R,IAAL,CAAU7R,CAAvD,CAAzC;AACA,UAAI4vC,aAAaxtC,KAAK/E,GAAL,GAAW+E,KAAK/E,GAAL,CAASiB,CAApB,GAAwBuF,KAAK+U,GAAL,CAASxW,KAAKqS,QAAL,CAAcnW,CAAd,GAAkB,KAAKmW,QAAL,CAAcnW,CAAhC,GAAoC,KAAKuT,IAAL,CAAUvT,CAAvD,CAAzC;AACA,UAAIuxC,aAAaztC,KAAK9E,GAAL,GAAW8E,KAAK9E,GAAL,CAAS0C,CAApB,GAAwB6D,KAAK+U,GAAL,CAASxW,KAAKqS,QAAL,CAAczU,CAAd,GAAkBoC,KAAKyP,IAAL,CAAU7R,CAA5B,GAAgC,KAAKyU,QAAL,CAAczU,CAAvD,CAAzC;AACA,UAAI8vC,aAAa1tC,KAAK9E,GAAL,GAAW8E,KAAK9E,GAAL,CAASgB,CAApB,GAAwBuF,KAAK+U,GAAL,CAASxW,KAAKqS,QAAL,CAAcnW,CAAd,GAAkB8D,KAAKyP,IAAL,CAAUvT,CAA5B,GAAgC,KAAKmW,QAAL,CAAczU,CAAvD,CAAzC;;AAEA,UAAI+vC,SAAS;AACX5gC,aAAKwgC,UADM;AAEXv5B,cAAMw5B,UAFK;AAGXt5B,gBAAQu5B,UAHG;AAIXx5B,eAAOy5B;AAJI,OAAb;;AAOA,UAAIE,SAAS,EAAb;AAAA,UACE3yC,MAAM,QADR;;AAGA,WAAK,IAAIiB,CAAT,IAAcyxC,MAAd,EAAsB;AACpB,YAAIA,OAAOzxC,CAAP,IAAYjB,GAAhB,EAAqB;AACnBA,gBAAM0yC,OAAOzxC,CAAP,CAAN;AACA0xC,mBAAS1xC,CAAT,CAFmB,CAEP;AACb;AACF;;AAEDsE,eAASotC,MAAT;AACD;;AAED;;;;;AAKA;;;;;;;;;;;;;8BAWU5tC,I,EAAMiI,O,EAAS;AACvB,UAAI,CAACA,OAAL,EAAc;AACZA,kBAAU,CAAV;AACD;;AAED,UAAIqqB,KAAK,KAAKjgB,QAAd;AAAA,UACEkgB,KAAKvyB,KAAKqS,QADZ;AAEA,UAAIyB,WAAWrS,KAAKmO,KAAL,CAAW3H,UAAU,KAAKwH,IAAL,CAAUvT,CAA/B,CAAf;AAAA,UAEE6X,WAAWtS,KAAKmO,KAAL,CAAW3H,UAAU,KAAKwH,IAAL,CAAU7R,CAA/B,CAFb;AAAA,UAGEoW,OAAOue,GAAGr2B,CAAH,GAAO4X,QAHhB;AAAA,UAIEG,QAAQse,GAAGr2B,CAAH,GAAO,KAAKuT,IAAL,CAAUvT,CAAjB,GAAqB4X,QAJ/B;;AAMA,aAAOG,QAAQqe,GAAGp2B,CAAX,IAAgB8X,OAAOse,GAAGp2B,CAAH,GAAO8D,KAAKyP,IAAL,CAAUvT,CAA/C;AACD;;AAED;;;;;AAKA;;;;;;;;;;;;8BAUU8D,I,EAAMiI,O,EAAS;AACvB,UAAI,CAACA,OAAL,EAAc;AACZA,kBAAU,CAAV;AACD;;AAED,UAAIqqB,KAAK,KAAKjgB,QAAd;AAAA,UACEkgB,KAAKvyB,KAAKqS,QADZ;;AAGA,UAAIyB,WAAWrS,KAAKmO,KAAL,CAAW3H,UAAU,KAAKwH,IAAL,CAAUvT,CAA/B,CAAf;AAAA,UACE6X,WAAWtS,KAAKmO,KAAL,CAAW3H,UAAU,KAAKwH,IAAL,CAAU7R,CAA/B,CADb;AAAA,UAGEmP,MAAMwlB,GAAG30B,CAAH,GAAOmW,QAHf;AAAA,UAIEG,SAASqe,GAAG30B,CAAH,GAAO,KAAK6R,IAAL,CAAU7R,CAAjB,GAAqBmW,QAJhC;;AAMA,aAAOG,SAASoe,GAAG10B,CAAZ,IAAiBmP,MAAMulB,GAAG10B,CAAH,GAAOoC,KAAKyP,IAAL,CAAUvT,CAA/C;AAED;;AAGD;;;;;AAMA;;;;;;;;;mCAOe8D,I,EAAM;;AAEnB,UAAI6tC,QAAQ,KAAZ;AACA,UAAIC,KAAK,GAAT;;AAEA,aAAO,CAACD,KAAD,IAAUC,KAAK,CAAtB,EAAyB;AACvBA;;AAEA,YAAIC,QAAQ,KAAKp+B,MAAL,GAAcmiB,GAAd,CAAkB9xB,KAAK2P,MAAL,EAAlB,EAAiCzT,CAA7C;AACA,YAAI8xC,QAAQvsC,KAAK+U,GAAL,CAAS,KAAK/G,IAAL,CAAUvT,CAAV,GAAc,CAAd,GAAkB8D,KAAKyP,IAAL,CAAUvT,CAAV,GAAc,CAAhC,GAAoCuF,KAAKmO,KAAL,CAAW,KAAKH,IAAL,CAAUvT,CAAV,GAAc,KAAK+L,OAAL,CAAa/L,CAAtC,CAA7C,CAAZ;;AAEA,YAAIuF,KAAK+U,GAAL,CAASu3B,KAAT,IAAkBC,KAAtB,EAA6B;AAC3B,eAAK37B,QAAL,CAAcnW,CAAd,IAAmB6xC,QAAQ,CAAR,GAAY,CAAC,CAAb,GAAiB,CAApC;AACD,SAFD,MAEO;AACL,eAAK1jC,KAAL,CAAWnO,CAAX,GAAe,CAAf;AACA2xC,kBAAQ,IAAR;AACD;AACF;AACF;;AAID;;;;;;;;;;;gCASYh/B,I,EAAM;AAChBA,WAAKgrB,KAAL,GAAa,IAAIzL,SAAJ,CAAcvf,KAAKjB,GAAL,IAAYiB,KAAKgrB,KAAL,CAAWjsB,GAArC,CAAb;AACA,aAAO,IAAIjT,QAAQ0F,MAAZ,CAAmBwO,IAAnB,CAAP;AACD;;;gCAEWoH,K,EAAOmR,C,EAAGC,C,EAAG;AACvB,UAAI1B,SAAS3mB,SAASgnB,aAAT,CAAuB,QAAvB,CAAb;AACAL,aAAO1Q,KAAP,GAAemS,CAAf;AACAzB,aAAO3Q,MAAP,GAAgBqS,CAAhB;AACA,UAAIT,MAAMjB,OAAOS,UAAP,CAAkB,IAAlB,CAAV;AACA,WAAKT,MAAL,GAAcA,MAAd;AACAiB,UAAIib,SAAJ,GAAgB5rB,KAAhB;AACA2Q,UAAI8hB,QAAJ,CAAa,CAAb,EAAgB,CAAhB,EAAmBthB,CAAnB,EAAsBC,CAAtB;AACA,WAAKwS,KAAL,GAAa,IAAIl/B,QAAQyzB,SAAZ,CAAsBzI,MAAtB,CAAb;AACA,WAAKiB,GAAL,GAAWA,GAAX;AACA,WAAKnX,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmB0X,CAAnB,EAAsBC,CAAtB,CAAZ;AACA,aAAO,IAAP;AACD;;;kCAEa4mB,M,EAAQC,M,EAAQC,S,EAAWC,U,EAAY;;AAEnD,UAAIzoB,SAAS3mB,SAASgnB,aAAT,CAAuB,QAAvB,CAAb;;AAEA,UAAI/Q,QAAQk5B,YAAYF,MAAZ,GAAqBE,SAAjC;AAAA,UACEn5B,SAASo5B,aAAaF,MAAb,GAAsBE,UADjC;;AAGAzoB,aAAO1Q,KAAP,GAAeA,KAAf;AACA0Q,aAAO3Q,MAAP,GAAgBA,MAAhB;;AAEA,WAAKvF,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmB0X,CAAnB,EAAsBC,CAAtB,CAAZ;;AAEA,UAAIT,MAAMjB,OAAOS,UAAP,CAAkB,IAAlB,CAAV;;AAEA,WAAKT,MAAL,GAAcA,MAAd;AACA,WAAK0oB,YAAL,GAAoB,IAAI1zC,QAAQyzB,SAAZ,CAAsB,KAAKyL,KAAL,CAAW9S,UAAX,CAAsBnZ,GAA5C,CAApB;;AAEA,UAAIohB,UAAU,IAAd;;AAEA,WAAKqf,YAAL,CAAkBtnB,UAAlB,CAA6B8E,MAA7B,GAAsC,YAAW;;AAE/C,aAAK,IAAI3vB,IAAI,CAAb,EAAgBA,IAAI+xC,MAApB,EAA4B/xC,GAA5B,EAAiC;AAC/B,eAAK,IAAI0B,IAAI,CAAb,EAAgBA,IAAIswC,MAApB,EAA4BtwC,GAA5B,EAAiC;AAC/BgpB,gBAAIgC,SAAJ,CAAc,IAAd,EAAoB1sB,IAAI8yB,QAAQvf,IAAR,CAAavT,CAArC,EAAwC0B,IAAIoxB,QAAQvf,IAAR,CAAa7R,CAAzD,EAA4DuwC,SAA5D,EAAuEC,UAAvE;AACD;AACF;AACF,OAPD;;AAUA,WAAKvU,KAAL,GAAa,IAAIl/B,QAAQyzB,SAAZ,CAAsBzI,MAAtB,CAAb;AACA,WAAKiB,GAAL,GAAWA,GAAX;AACA,aAAO,IAAP;AACD;;AAGD;;;;;;;;;;6BAQS0nB,S,EAAW;AAClB,UAAI,OAAOA,SAAP,IAAoB,QAAxB,EAAkC;AAChC,YAAIhpC,SAAS,IAAb;AACAyJ,UAAEw/B,OAAF,CAAUD,SAAV,EAAqB,UAASz/B,IAAT,EAAe;AAClCvJ,mBAAS,IAAI3K,QAAQ0F,MAAZ,CAAmBwO,IAAnB,CAAT;AACD,SAFD;AAGD;AACF;;AAED;;;;;;;mCAKe;AACb,aAAOlJ,KAAKQ,KAAKqoC,OAAL,CAAa,IAAb,CAAL,CAAP;AACD;;;wBAt9Be;AACd,aAAO,KAAKr5B,kBAAZ;AACD;;;wBAEW;AACV,aAAO,KAAKA,kBAAZ;AACD;;;;;;AAk9BF;;AAEDxa,QAAQ0F,MAAR,GAAiBA,MAAjB;AACA,C,CAAC;;;IAGKouC,a;AAEN,2BAAa;AAAA;;AACX,SAAKC,OAAL,GAAe/zC,QAAQg0C,YAAvB;AACD;;;;yBAEI/lC,M,EAAO;;AAEV,WAAKgmC,YAAL,GAAoBhmC,OAAOlF,WAAP,CAAmBC,IAAnB,CAAwBsC,OAAxB,CAAgC,WAAhC,KAAgD,CAAhD,GAAoD2C,MAApD,GAA6DA,OAAOw/B,UAAP,CAAkB,CAAlB,CAAjF;;AAEA,WAAKsG,OAAL,CAAa3uC,OAAb,CAAqB,UAASkrC,EAAT,EAAY,CAIhC,CAJD;AAMD;;;;;;IAMK4D,gB;AAEN,8BAAa;AAAA;AAEZ;;;;2BAEK,CAEL;;;;;;AAGD;;IACM99B,I;AAEJ,gBAAYzD,KAAZ,EAAkB;AAAA;;AAEhB,SAAKyD,IAAL,CAAUzD,KAAV;;AAEA,SAAKwhC,QAAL,CAAc,EAAd;AACA,SAAKC,UAAL,CAAgB,OAAhB;;AAEA,SAAK94B,KAAL,GAAa,OAAb;;AAEA,SAAKwpB,WAAL,GAAmB,OAAnB;AACA,SAAKD,UAAL,GAAkB,CAAlB;;AAEA,SAAKntB,QAAL,GAAgB,IAAI1X,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAAhB;AAED;;;;yBAEI6F,C,EAAE;;AAEL,WAAKy5B,IAAL,GAAYz5B,CAAZ;AACA,WAAKjI,KAAL,GAAaiI,CAAb;AACA,aAAO,IAAP;AACD;;;2BAEMU,K,EAAOg5B,I,EAAK;AACf,WAAKxP,WAAL,GAAmBxpB,KAAnB;AACA,WAAKupB,UAAL,GAAkByP,IAAlB;AACA,aAAO,IAAP;AACH;;;yBAEIC,K,EAAOC,O,EAAQ;AAClB,WAAKL,QAAL,CAAcI,KAAd;AACA,WAAKH,UAAL,CAAgBI,OAAhB;AACA,aAAO,IAAP;AACD;;;0BAEK50C,C,EACN;AACE,WAAK0b,KAAL,GAAa1b,CAAb;AACA,aAAO,IAAP;AACD;;;6BAEQ+S,K,EAAM;AACb,UAAG,OAAOA,KAAP,KAAiB,QAApB,EACAA,QAAQA,QAAQ,EAAhB;;AAEAA,cAAQA,MAAM3I,OAAN,CAAc,IAAd,EAAoB,EAApB,IAA0B,IAAlC;;AAEA,WAAKyqC,QAAL,GAAgB9hC,KAAhB;AACA,aAAO,IAAP;AACD;;;+BACUA,K,EACX;AACE,WAAK+hC,UAAL,GAAkB/hC,KAAlB;AACA,aAAO,IAAP;AACD;;;iCAGcL,G,EAAI;AACf,UAAIkxB,SAAS,KAAK0C,aAAL,IAAsB,IAAIlmC,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAAnC;AACA,aAAOzC,IAAImC,GAAJ,CAAQ+uB,MAAR,CAAP;AACD;;;yBAEEvX,G,EAAKP,M,EAAO;;AAEf7rB,cAAQC,GAAR,CAAY,wBAAZ;;AAEA,UAAIyB,IAAI,KAAKmW,QAAL,CAAcnW,CAAd,GAAkBmqB,OAAOhU,QAAP,CAAgBnW,CAA1C;AAAA,UACC0B,IAAI,KAAKyU,QAAL,CAAczU,CAAd,GAAkByoB,OAAOhU,QAAP,CAAgBzU,CADvC;;AAGC,UAAGgpB,IAAIqa,IAAP,EACA;AACDra,YAAIqa,IAAJ;AACC;;AAEDra,UAAIib,SAAJ,GAAgB,KAAK5rB,KAArB;;AAEA2Q,UAAI0oB,IAAJ,GAAW,KAAKF,QAAL,GAAgB,GAAhB,GAAsB,KAAKC,UAAtC;;AAEA,UAAI5/B,OAAOmX,IAAI2oB,WAAJ,CAAgB,KAAKP,IAArB,CAAX;;AAGApoB,UAAI6Y,WAAJ,GAAkB,KAAKA,WAAvB;;AAEA7Y,UAAI4Y,UAAJ,GAAiB,KAAKA,UAAtB;;AAEA;;AAEA,WAAK/vB,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmBD,KAAKwF,KAAxB,EAA+B2R,IAAI2oB,WAAJ,CAAgB,GAAhB,EAAqBt6B,KAApD,CAAZ;;AAEA,UAAIhI,MAAM,IAAItS,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,CAAV;AAAA,UACA4xC,UAAU,KAAKC,YAAL,CAAkBxiC,GAAlB,CADV;;AAGA2Z,UAAI8oB,QAAJ,CAAa,KAAKV,IAAlB,EAAwBQ,QAAQtzC,CAAhC,EAAmCszC,QAAQ5xC,CAA3C;;AAEAgpB,UAAIob,OAAJ;AAED;;;;;;AAIHrnC,QAAQoW,IAAR,GAAeA,IAAf;AACA,C,CAAC;;;;;;;;;;;;;;AAcD,CAAC,YAAY;AACTvW,UAAQC,GAAR,CAAY,yBAAZ;;AADS,MAGHk1C,YAHG;AAIL,4BAAuB;AAAA,UAAX1sC,IAAW,uEAAJ,EAAI;;AAAA;;AACnB,WAAKU,IAAL,GAAYV,KAAKU,IAAL,IAAa,EAAzB;;AAEA,WAAK8lC,WAAL,GAAmBxmC,KAAKwmC,WAAL,IAAoB,EAAvC;;AAEA,WAAKmG,QAAL,GAAgB3sC,KAAK2sC,QAAL,IAAiB,EAAjC;;AAEA,WAAKC,cAAL,GAAsB5sC,KAAK4sC,cAAL,IAAuB,EAA7C;;AAEA,WAAKC,WAAL,GAAmB7sC,KAAK6sC,WAAL,IAAoB,EAAvC;;AAEA,WAAK50C,GAAL,GAAW+H,KAAK/H,GAAL,IAAY,IAAIP,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAvB;AACA,WAAKqgC,KAAL,GAAa9sC,KAAK8sC,KAAL,IAAc,IAAIp1C,QAAQ+U,MAAZ,CAAmB,GAAnB,EAAwB,GAAxB,EAA6B,GAA7B,CAA3B;;AAGA,WAAK,IAAIxT,CAAT,IAAc,KAAK2zC,cAAnB,EAAmC;AAC/B,YAAI,CAAC,KAAKA,cAAL,CAAoB3zC,CAApB,CAAD,YAAmCvB,QAAQ0F,MAA/C,EAAuD;AACnD,eAAKwvC,cAAL,CAAoB3zC,CAApB,IAAyBvB,QAAQuK,OAAR,CAAgB,KAAK2qC,cAAL,CAAoB3zC,CAApB,EAAuB+E,EAAvC,CAAzB;AACH;AAEJ;;AAGD,WAAK,IAAI/E,CAAT,IAAc,KAAK4zC,WAAnB,EAAgC;AAC5B,YAAI,CAAC,KAAKA,WAAL,CAAiB5zC,CAAjB,CAAD,YAAgCvB,QAAQ0F,MAA5C,EAAoD;AAChD,eAAKyvC,WAAL,CAAiB5zC,CAAjB,IAAsBvB,QAAQuK,OAAR,CAAgB,KAAK4qC,WAAL,CAAiB5zC,CAAjB,EAAoB+E,EAApC,CAAtB;AACH;AAEJ;;AAGD,WAAK,IAAI/E,CAAT,IAAc,KAAK0zC,QAAnB,EAA6B;AACzB,YAAI,CAAC,KAAKA,QAAL,CAAc1zC,CAAd,CAAD,YAA6BvB,QAAQ0F,MAAzC,EAAiD;AAC7C,eAAKuvC,QAAL,CAAc1zC,CAAd,IAAmBvB,QAAQuK,OAAR,CAAgB,KAAK0qC,QAAL,CAAc1zC,CAAd,EAAiB+E,EAAjC,CAAnB;AACH;AAEJ;AAEJ;;AA1CI;AAAA;AAAA,6BA4CEgC,IA5CF,EA4CQ5G,GA5CR,EA4CaZ,QA5Cb,EA4CuB;;AAExB,YAAIwH,KAAK1G,cAAL,CAAoBF,GAApB,CAAJ,EAA8B;AAC1B,iBAAO4G,KAAK5G,GAAL,CAAP;AACH,SAFD,MAGK;AACD,iBAAOZ,QAAP;AAEH;AACJ;;AAGD;;;;;AAxDK;AAAA;AAAA,+BA6DI;;AAEL,YAAIm0C,WAAW,KAAKA,QAApB;;AAEA,YAAIC,iBAAiB,KAAKA,cAA1B;;AAEA,YAAIC,cAAc,KAAKA,WAAvB;;AAEA,YAAIC,QAAQ,KAAKA,KAAL,IAAc,EAA1B;;AAEA,YAAI70C,MAAM,KAAKA,GAAL,IAAY,EAAtB;;AAEAP,gBAAQwI,IAAR,CAAaysC,QAAb,EAAuB,UAAUtwC,EAAV,EAAc0wC,KAAd,EAAqB;;AAExC,cAAG,CAACA,MAAMC,OAAP,IAAkB,CAACD,MAAME,MAA5B,EACAF,MAAMG,MAAN,CAAaJ,KAAb,EAAoB70C,GAApB;;AAEA80C,gBAAMI,OAAN,GAAgB,IAAhB;;AAGA,cAAIJ,MAAM39B,QAAN,CAAezU,CAAf,IAAoBoyC,MAAMK,UAA9B,EAA0C;AACtCL,kBAAM39B,QAAN,CAAezU,CAAf,GAAmBoyC,MAAMK,UAAzB;AACH;;AAEDL,gBAAMK,UAAN,GAAmB,OAAnB,CAZwC,CAYZ;;AAE5B11C,kBAAQwI,IAAR,CAAa2sC,WAAb,EAA0B,UAAUtnC,EAAV,EAAc8nC,KAAd,EAAqB;;AAE3CN,kBAAMO,gBAAN,CAAuBD,KAAvB;AAEH,WAJD;AAMH,SApBD;AAqBH;AA9FI;;AAAA;AAAA;;AA+FR;;AAED,MAAIE,QAAQb,YAAZ;;AAEAh1C,UAAQ61C,KAAR,GAAgBA,KAAhB;;AAEA71C,UAAQ81C,MAAR,GAAiBD,KAAjB;;AAEA71C,UAAQg1C,YAAR,GAAuBA,YAAvB;AAEH,CAzGD;AA0GA;AACAn1C,QAAQC,GAAR,CAAY,uCAAZ;;IAEMi2C,O;AACJ,qBAAa;AAAA;AAEZ;AACD;;;;;yBACKxyC,M,EAA2B;AAAA,UAAnB6xC,KAAmB,uEAAb,GAAa;AAAA,UAAR70C,GAAQ,uEAAJ,GAAI;;AAC9B,UAAIc,OAAOkC,kBAAkBrC,KAAlB,GAA0BqC,MAA1B,GAAmC,CAACA,MAAD,CAA9C;AACAlC,WAAK+D,OAAL,CAAa,UAASC,IAAT,EAAc;AACvB,YAAGA,KAAKqK,KAAL,CAAWzM,CAAX,GAAe1C,GAAlB,EACA;AACE8E,eAAKowC,OAAL,GAAe,IAAf;AACApwC,eAAKqK,KAAL,CAAWzM,CAAX,IAAgBmyC,KAAhB;AACD,SAJD,MAMA;AACI/vC,eAAKqK,KAAL,CAAWzM,CAAX,GAAe1C,GAAf;AACH;AAEJ,OAXD;AAYD;;;;;;AAGHP,QAAQ+1C,OAAR,GAAkBA,OAAlB;AACA;;IAEM1+B,U;;;AACJ,wBAAa;AAAA;;AAAA,mHACL21B,SADK;AAEZ;;;;2BACMzrC,C,EAAG0B,C,EAAE;AACV,WAAK1D,MAAL,GAAc,IAAIS,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,CAAd;AACA,aAAO,IAAP;AACD;;;gCACW0P,K,EAAM;AAChB,WAAKqjC,WAAL,GAAmBrjC,KAAnB;AACA,aAAO,IAAP;AACD;;;yBACIsZ,G,EAAKP,M,EAAQ;;AAEhB,UAAIzd,MAAJ;;AAEA,UAAI,KAAKlF,WAAL,CAAiBC,IAAjB,IAAyB,aAA7B,EAA4C;AAC1CiF,iBAAS,KAAK8hC,eAAd;AACD,OAFD,MAEO;AACL9hC,iBAAS,IAAT;AACD;;AAEDyd,eAASA,UAAU,KAAnB;;AAEA,UAAI,CAACA,MAAD,IAAW1rB,QAAQ4E,YAAR,CAAqB,CAArB,CAAX,IAAsC5E,QAAQ4E,YAAR,CAAqB,CAArB,EAAwB8mB,MAAlE,EACEA,SAAS1rB,QAAQ4E,YAAR,CAAqB,CAArB,EAAwB8mB,MAAjC,CADF,KAGK,IAAI,CAACA,MAAL,EAAa;AAChBA,iBAAS;AACPhU,oBAAU,IAAI1X,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB;AADH,SAAT;AAGD;;AAED,UAAI9G,OAAOg/B,SAAX,EACE;;AAEF,UAAIh/B,OAAO07B,MAAP,KAAkB,KAAKqG,aAAL,IAAsB/hC,OAAOgiC,QAAP,CAAgBjwC,QAAQoE,KAAxB,EAA+BpE,QAAQwE,MAAvC,CAAxC,CAAJ,EAA6F;AAC3F,aAAK0rC,kBAAL,CAAwBjkB,GAAxB,EAA6BP,MAA7B;AACD;AACF;;;uCAGoBO,G,EAAKP,M,EAAQ;;AAE9B,UAAIzd,MAAJ;;AAEA,UAAI,KAAKlF,WAAL,CAAiBC,IAAjB,IAAyB,aAA7B,EAA4C;AAC1CiF,iBAAS,KAAK8hC,eAAd;AACD,OAFD,MAEO;AACL9hC,iBAAS,IAAT;AACD;;AAED,UAAIk0B,QAAQ,KAAZ;AAAA,UACEgO,YAAY,EADd;;AAIA,UAAIliC,OAAO07B,MAAX,EAAmB;;AAEjB,YAAI17B,OAAOuM,kBAAP,YAAqCtZ,KAArC,IAA8C+M,OAAOuM,kBAAP,CAA0BjU,MAA1B,IAAoC,CAAtF,EAAyF;AACvF0H,iBAAOuM,kBAAP,CAA0BpV,OAA1B,CAAkC,UAASupC,KAAT,EAAgB;AAChDwB,sBAAU5oC,IAAV,CAAeonC,MAAM/O,cAArB;AACD,WAFD;AAGD;;AAED,YAAI3xB,OAAOuM,kBAAP,YAAqCvY,MAArC,IAA+CgM,OAAOuM,kBAAP,CAA0B5Y,cAA1B,CAAyC,gBAAzC,CAAnD,EAA+G;AAC7GugC,kBAAQl0B,OAAOuM,kBAAP,CAA0BolB,cAAlC;AACD;;AAED,YAAIx9B,IAAI6L,OAAOyJ,QAAf;;AAEA,YAAI04B,aAAa1kB,OAAOhU,QAAP,IAAmB;AAClCnW,aAAG,CAD+B;AAElC0B,aAAG,CAF+B;AAGlCwU,aAAG;AAH+B,SAApC;;AAMA,YAAI,CAACxJ,OAAOrM,cAAP,CAAsB,cAAtB,CAAL,EAA4C;AAC1CqM,iBAAO67B,YAAP,GAAsB,GAAtB;AACD;;AAED,YAAIvoC,IAAIa,EAAEb,CAAV;AAAA,YACE0B,IAAIb,EAAEa,CADR;AAAA,YAEE6mC,eAAe77B,OAAO67B,YAAP,IAAuB,CAAC,GAAxB,IAA+B77B,OAAO67B,YAAP,IAAuB,GAAtD,GAA4D77B,OAAO67B,YAAnE,GAAkF,GAFnG;;AAIA,YAAI77B,OAAO87B,QAAX,EAAqB;AACnBD,yBAAe,CAAf;AACD;;AAGD;;AAEA,YAAIE,aAAa/7B,OAAO6G,IAAP,IAAe7G,OAAOuM,kBAAP,CAA0B1F,IAA1D;;AAEA,YAAIm1B,YAAYD,WAAWzoC,CAA3B;AACA,YAAI2oC,aAAaF,WAAW/mC,CAA5B;;AAGA,YAAIu8B,SAASvxB,OAAOuxB,MAAP,IAAiB,IAAIx/B,QAAQ+U,MAAZ,CAAmBk1B,YAAY,CAA/B,EAAkCC,aAAa,CAA/C,CAA9B;;AAEA;;AAEA,YAAIxS,QAAJ;;AAEA,YAAI,QAAOzpB,OAAOypB,QAAd,KAA2B,QAA/B,EAAyC;AACvCA,qBAAWzpB,OAAOypB,QAAP,CAAgBn2B,CAA3B;AAED,SAHD,MAGO;AACLm2B,qBAAWzpB,OAAOypB,QAAlB;AACD;;AAGD,YAAI,KAAKwH,KAAL,IAAc,KAAKA,KAAL,CAAW9S,UAAX,YAAiC4B,iBAAnD,EAAsE;AACpE,cAAIzsB,IAAI,KAAKmW,QAAL,CAAcnW,CAAtB;AAAA,cACE0B,IAAI,KAAKyU,QAAL,CAAczU,CADpB;;AAGA1B,eAAK6uC,WAAW7uC,CAAX,GAAeuoC,YAAf,IAA+B,CAApC;AACA7mC,eAAKmtC,WAAWntC,CAAX,GAAe6mC,YAAf,IAA+B,CAApC;AACA;AACA,iBAAO9pC,QAAQuqC,MAAR,CAAeC,gBAAf,CAAgC,KAAKtL,KAAL,CAAW9S,UAA3C,EAAuD,IAAIpsB,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAAvD,EAAiF,KAAKD,IAAtF,EAA4F,IAAI9U,QAAQs4B,QAAZ,CAAqBxxB,KAAKmO,KAAL,CAAW1T,IAAKi+B,OAAOj+B,CAAvB,CAArB,EAAiDuF,KAAKmO,KAAL,CAAWhS,IAAKu8B,OAAOv8B,CAAvB,CAAjD,CAA5F,EAA0K,IAAIjD,QAAQs4B,QAAZ,CAAqB2R,SAArB,EAAgCC,UAAhC,CAA1K,EAAuNxS,WAAW,GAAlO,EAAuOzL,GAAvO,EAA4Ohe,OAAO0xB,KAAnP,EAA0P1xB,OAAOw8B,KAAjQ,EAAwQjL,MAAxQ,EAAgR,KAAKuF,OAArR,EAA8R,KAAKgC,wBAAL,IAAiC,KAA/T,CAAP;AACD;;AAGD,YAAI,EAAE94B,OAAOuM,kBAAP,IAA6BvM,OAAOuM,kBAAP,CAA0BolB,cAAzD,CAAJ,EAA8E;AAC5E;AACD;;AAED,YAAIuC,QAAQl0B,OAAOuM,kBAAP,CAA0BolB,cAAtC;;AAEA,YAAIuC,SAASA,MAAMjD,KAAf,IAAwBiD,MAAMjD,KAAN,CAAYhrB,IAAxC,EAA8C;;AAE5C+X,cAAIokB,YAAJ,CAAiBlO,MAAMjD,KAAN,CAAYhrB,IAA7B,EAAmC3S,CAAnC,EAAsC0B,CAAtC,EAAyC,CAAzC,EAA4C,CAA5C,EAA+CgL,OAAO6G,IAAP,CAAYvT,CAA3D,EAA8D0M,OAAO6G,IAAP,CAAY7R,CAA1E;AAED,SAJD,MAIO;;AAEL,cAAIktC,UAAU5pC,MAAV,IAAoB,CAAxB,EAA2B;;AAEzB4pC,sBAAU/qC,OAAV,CAAkB,UAAS+8B,KAAT,EAAgB;;AAEhC,kBAAI8H,YAAY9H,MAAMrtB,IAAN,CAAWvT,CAA3B;AACA,kBAAI2oC,aAAa/H,MAAMrtB,IAAN,CAAW7R,CAA5B;;AAEA,kBAAI2mC,OAAOzH,MAAMzqB,QAAN,CAAenW,CAA1B;AAAA,kBACEsoC,OAAO1H,MAAMzqB,QAAN,CAAezU,CADxB;;AAGA1B,mBAAK0M,OAAOyJ,QAAP,CAAgBnW,CAArB;AACA0B,mBAAKgL,OAAOyJ,QAAP,CAAgBzU,CAArB;;AAEA1B,mBAAK6uC,WAAW7uC,CAAX,GAAeuoC,YAAf,IAA+B,CAApC;AACA7mC,mBAAKmtC,WAAWntC,CAAX,GAAe6mC,YAAf,IAA+B,CAApC;;AAEA77B,qBAAOohC,YAAP,GAAsB,IAAIrvC,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,CAAtB;;AAEA,kBAAIk/B,MAAMzK,QAAN,IAAkB,OAAOyK,MAAMzK,QAAN,CAAen2B,CAAtB,IAA2B,QAAjD,EAA2D;AACzDm2B,2BAAWyK,MAAMzK,QAAN,CAAen2B,CAA1B;AACD;;AAED,kBAAI4gC,MAAM3C,MAAV,EAAkB;AAChBA,yBAAS2C,MAAM3C,MAAf;AACA;AACD;;AAGD,kBAAI2C,SAASA,MAAMjD,KAAnB,EACEl/B,QAAQuqC,MAAR,CAAeC,gBAAf,CAAgCv8B,OAAOggC,YAAP,GAAsBhgC,OAAOggC,YAA7B,GAA4C9L,MAAMjD,KAAN,CAAY9S,UAAxF,EAAoG+V,MAAMlB,QAA1G,EAAoHkB,MAAMlD,SAA1H,EAAqI,IAAIj/B,QAAQs4B,QAAZ,CAAqBxxB,KAAKmO,KAAL,CAAW20B,OAAQpK,OAAOj+B,CAA1B,CAArB,EAAoDuF,KAAKmO,KAAL,CAAW40B,OAAQrK,OAAOv8B,CAA1B,CAApD,CAArI,EAAyN,IAAIjD,QAAQs4B,QAAZ,CAAqB2R,SAArB,EAAgCC,UAAhC,CAAzN,EAAsQxS,WAAW,GAAjR,EAAsRzL,GAAtR,EAA2Rhe,OAAO0xB,KAAlS,EAAyS1xB,OAAOw8B,KAAhT,EAAuTjL,MAAvT,EAA+T,KAAKuF,OAApU,EAA6U,KAAKgC,wBAAL,IAAiC,KAA9W;AAEH,aA7BD;AA+BD,WAjCD,MAiCO;AACL,gBAAIuJ,KAAKnO,MAAMzqB,QAAN,CAAenW,CAAxB;AAAA,gBACEgvC,KAAKpO,MAAMzqB,QAAN,CAAezU,CADtB;AAAA,gBAEEqP,MAAM,IAAItS,QAAQ+U,MAAZ,CAAmBxT,IAAI+uC,EAAvB,EAA2BrtC,IAAIstC,EAA/B,CAFR;;AAIAj+B,gBAAI/Q,CAAJ,IAAS6uC,WAAW7uC,CAAX,GAAeuoC,YAAf,IAA+B,CAAxC;AACAx3B,gBAAIrP,CAAJ,IAASmtC,WAAWntC,CAAX,GAAe6mC,YAAf,IAA+B,CAAxC;AACA77B,mBAAOohC,YAAP,GAAsB/8B,GAAtB;AACA,gBAAI6vB,MAAMjD,KAAN,CAAY9S,UAAZ,YAAkCgT,gBAAlC,IAAsD+C,MAAMjD,KAAN,CAAY9S,UAAZ,YAAkC4B,iBAA5F,EAA+G;AAC7GhuB,sBAAQuqC,MAAR,CAAeC,gBAAf,CAAgC,KAAKyD,YAAL,GAAoB,KAAKA,YAAzB,GAAwC9L,MAAMjD,KAAN,CAAY9S,UAApF,EAAgG+V,MAAMlB,QAAtG,EAAgHkB,MAAMlD,SAAtH,EAAiI,IAAIj/B,QAAQs4B,QAAZ,CAAqBxxB,KAAKmO,KAAL,CAAW3C,IAAI/Q,CAAJ,GAASi+B,OAAOj+B,CAA3B,CAArB,EAAqDuF,KAAKmO,KAAL,CAAW3C,IAAIrP,CAAJ,GAASu8B,OAAOv8B,CAA3B,CAArD,CAAjI,EAAuN,IAAIjD,QAAQs4B,QAAZ,CAAqB2R,SAArB,EAAgCC,UAAhC,CAAvN,EAAoQxS,WAAW,GAA/Q,EAAoRzL,GAApR,EAAyRhe,OAAO0xB,KAAhS,EAAuS1xB,OAAOw8B,KAA9S,EAAqTjL,MAArT,EAA6T,KAAKuF,OAAlU,EAA2U,KAAKgC,wBAAL,IAAiC,KAA5W;AACD;AAEF;AAEF;AACF;AAEF;;;;EAxLoBrhC,M;;AA8LzB1F,QAAQqX,UAAR,GAAqBA,UAArB;AACA,C,CAAC;;;;;;;;;;;;;;;IAeK4+B,U;;;AACJ,wBAAmC;AAAA,QAAvBhjC,GAAuB,uEAAjB,EAAiB;AAAA,QAAb+F,KAAa,uEAAL,GAAK;;AAAA;;AAAA,0HAC3B/F,GAD2B,EACtB+F,KADsB;;AAEjC,YAAKk9B,KAAL,GAAa,EAAb;AAFiC;AAGlC;;;;4BACOC,Q,EAAU;AAChB,UAAIhW,OAAO,IAAImD,IAAJ,CAAS,IAAT,EAAe,KAAKxuB,IAApB,CAAX;AACAqhC,eAASnqB,IAAT,CAAcmU,IAAd,EAAoB52B,IAApB;AACA,WAAK2sC,KAAL,CAAW3uC,IAAX,CAAgB44B,IAAhB;AACD;;;kCACY;;AAEX,WAAK+V,KAAL,CAAW,CAAX,EAAcE,iBAAd,CAAgC,KAAK1+B,QAArC;;AAEA,UAAI2+B,UAAU,KAAKH,KAAL,CAAW,CAAX,EAAcI,UAAd,EAAd;;AAEA,UAAIt+B,QAAQ,CAAZ;;AAEA,WAAI,IAAIzW,IAAI,CAAZ,EAAeA,IAAI,KAAK20C,KAAL,CAAW3vC,MAA9B,EAAsChF,KAAI,CAA1C,EACA;;AAEE,YAAG,KAAK20C,KAAL,CAAW30C,CAAX,KAAiB,KAAK20C,KAAL,CAAW30C,IAAI,CAAf,CAApB,EACA;AACE,cAAIg1C,KAAK,KAAKL,KAAL,CAAW30C,CAAX,CAAT;AAAA,cAAwBi1C,KAAK,KAAKN,KAAL,CAAW30C,IAAI,CAAf,CAA7B;AACA80C,oBAAUE,GAAGD,UAAH,EAAV;AACAE,aAAGJ,iBAAH,CAAqBC,OAArB;AACAG,aAAGF,UAAH,CAAcC,EAAd;AACD;AACF;AAEF;;;uCACkBtqB,G,EAAKP,M,EAAQ;;AAG9B,UAAIzd,SAAS,IAAb;AACA,UAAIkiC,YAAY,EAAhB;AACA,UAAIliC,OAAO07B,MAAX,EAAmB;;AAEjB,YAAI17B,OAAOuM,kBAAP,YAAqCtZ,KAArC,IAA8C+M,OAAOuM,kBAAP,CAA0BjU,MAA1B,IAAoC,CAAtF,EAAyF;AACvF0H,iBAAOuM,kBAAP,CAA0BpV,OAA1B,CAAkC,UAASupC,KAAT,EAAgB;;AAEhDA,kBAAM/O,cAAN,CAAqB13B,MAArB,GAA8BymC,KAA9B;AACAwB,sBAAU5oC,IAAV,CAAeonC,MAAM/O,cAArB;AAED,WALD;AAMD;;AAED,YAAIJ,SAASvxB,OAAOuxB,MAAP,IAAiB,IAAIx/B,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAA9B;AACA,YAAI2iB,WAAWzpB,OAAOypB,QAAP,CAAgBn2B,CAA/B;;AAEA4uC,kBAAU5O,OAAV,GAAoBn8B,OAApB,CAA4B,UAAS+8B,KAAT,EAAe;;AAEzC,cAAI8H,YAAY9H,MAAMrtB,IAAN,CAAWvT,CAA3B;AACA,cAAI2oC,aAAa/H,MAAMrtB,IAAN,CAAW7R,CAA5B;;AAEA,cAAI1B,IAAI4gC,MAAMzqB,QAAN,CAAenW,CAAvB;AAAA,cACE0B,IAAIk/B,MAAMzqB,QAAN,CAAezU,CADrB;;AAGA,cAAIk/B,MAAMzK,QAAN,IAAkB,OAAOyK,MAAMzK,QAAN,CAAen2B,CAAtB,IAA2B,QAAjD,EAA2D;AACzDm2B,uBAAWyK,MAAMzK,QAAN,CAAen2B,CAA1B;AACD;;AAED,cAAI4gC,MAAM3C,MAAV,EAAkB;AAChBA,qBAAS2C,MAAM3C,MAAf;AACA;AACD;;AAED,cAAIiX,eAAe,IAAIz2C,QAAQ+U,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,CAAnB;;AAEA,cAAGotB,MAAMj6B,MAAN,IAAgBi6B,MAAMj6B,MAAN,CAAau3B,WAAb,YAAoCz/B,QAAQ+U,MAA/D,EACA;AACE;AACA0hC,2BAAetU,MAAMj6B,MAAN,CAAau3B,WAA5B;AACD;;AAED,cAAI0C,SAASA,MAAMjD,KAAnB,EACEl/B,QAAQuqC,MAAR,CAAeC,gBAAf,CAAgCrI,MAAMjD,KAAN,CAAY9S,UAA5C,EAAwD,IAAIpsB,QAAQ+U,MAAZ,CAAmBotB,MAAMlB,QAAzB,EAAmCxsB,GAAnC,CAAuCgiC,YAAvC,CAAxD,EAA8GtU,MAAMlD,SAApH,EAA+H,IAAIj/B,QAAQs4B,QAAZ,CAAqBxxB,KAAKmO,KAAL,CAAW1T,IAAKi+B,OAAOj+B,CAAvB,CAArB,EAAiDuF,KAAKmO,KAAL,CAAWhS,IAAKu8B,OAAOv8B,CAAvB,CAAjD,CAA/H,EAA6M,IAAIjD,QAAQs4B,QAAZ,CAAqB2R,SAArB,EAAgCC,UAAhC,CAA7M,EAA0PxS,WAAW,GAArQ,EAA0QzL,GAA1Q,EAA+Qhe,OAAO0xB,KAAtR,EAA6R1xB,OAAOw8B,KAApS,EAA2SjL,MAA3S;AACH,SA3BD;AA6BD;AAEF;;;;EAjFsB95B,M;;AAkFxB;;AAED1F,QAAQi2C,UAAR,GAAqBA,UAArB;AACA,C,CAAC;;;;IAIKngC,W;AACJ,uBAAY4d,QAAZ,EAAuC;AAAA,QAAjBgjB,IAAiB,uEAAV,QAAU;;AAAA;;AACrC,SAAKhuC,OAAL,GAAe,EAAf;AACA,SAAKiuC,cAAL,GAAsB,EAAtB;AACA,SAAKD,IAAL,GAAYA,IAAZ;AACA,SAAKxa,KAAL,GAAa,CAAC,CAAd;AACA,SAAKgM,KAAL,GAAa,CAAb;AACA,SAAK6H,eAAL,GAAuB,EAAvB;AACA,SAAKzpC,EAAL,GAAUtG,QAAQ4G,SAAR,EAAV;AACA8sB,eAAWA,YAAY,YAAU,CAAE,CAAnC;AACAA,aAAS1H,IAAT,CAAc,IAAd;AACD;;;;8BAES/Y,G,EAAK+F,K,EAAOnT,Q,EAAU;AAC9B,WAAK6C,OAAL,CAAanB,IAAb,CAAkB,IAAIvH,QAAQ0F,MAAZ,CAAmBuN,GAAnB,EAAwB+F,KAAxB,CAAlB;AACA,UAAGnT,QAAH,EAAaA,SAASmmB,IAAT,CAAc,IAAd,EAAoBziB,IAApB;AACd;;;qCACgB0J,G,EAAK+F,K,EAAOnT,Q,EAAU;AACrChG,cAAQY,IAAR;AAEA,WAAKk2C,cAAL,CAAoBpvC,IAApB,CAAyB,IAAIvH,QAAQ0F,MAAZ,CAAmBuN,GAAnB,EAAwB+F,KAAxB,CAAzB;AACA,UAAGnT,QAAH,EAAaA,SAASmmB,IAAT,CAAc,IAAd,EAAoBziB,IAApB;AACd;;;gCAEU;AACT,WAAKb,OAAL,GAAe,EAAf;AACA,WAAKiuC,cAAL,GAAsB,EAAtB;AACD;;;2BAEK;AACJ,WAAKza,KAAL,IAAc,CAAd;AACA,cAAO,KAAKwa,IAAL,CAAU3sC,WAAV,EAAP;AAEI,aAAK,QAAL;AACA,cAAImyB,QAAQp1B,KAAKkjB,KAAL,CAAWljB,KAAKC,MAAL,KAAgB,KAAK2B,OAAL,CAAanC,MAAxC,CAAZ;AACA,eAAKwpC,eAAL,GAAuB,KAAKrnC,OAAL,CAAawzB,KAAb,CAAvB;AACA,iBAAO,KAAK6T,eAAZ;AACA;;AAEA,aAAK,aAAL;AACA,eAAKA,eAAL,GAAuB,KAAKrnC,OAAL,CAAa,KAAKwzB,KAAL,GAAa,KAAKxzB,OAAL,CAAanC,MAAvC,CAAvB;AACA,iBAAO,KAAKwpC,eAAZ;AACA;AAXJ;AAaD;;;0BAEK6G,W,EACN;AACE,UAAIC,eAAe,IAAI72C,QAAQ8V,WAAZ,EAAnB;AACA+gC,mBAAavwC,EAAb,GAAkBswC,YAAYtwC,EAA9B;AACA,UAAIwwC,MAAM,CAAV;;AAEAF,kBAAYluC,OAAZ,CAAoBtD,OAApB,CAA4B,UAAS6I,MAAT,EAAgB;AACxC4oC,qBAAaE,SAAb,CAAuB9oC,OAAOgF,GAA9B,EAAmChF,OAAO6G,IAA1C;AACAgiC,eAAO,CAAP;AACH,OAHD;;AAKAF,kBAAYD,cAAZ,CAA2BvxC,OAA3B,CAAmC,UAAS6I,MAAT,EAAgB;AAC/C4oC,qBAAaG,gBAAb,CAA8B/oC,OAAOgF,GAArC,EAA0ChF,OAAO6G,IAAjD;AACAgiC,eAAO,CAAP;AACH,OAHD;AAIA,aAAOD,YAAP;AACD;;;6BAEQD,W,EACT;AACE,UAAIC,eAAe,IAAI72C,QAAQ8V,WAAZ,EAAnB;;AAEA+gC,mBAAavwC,EAAb,GAAkBswC,YAAYtwC,EAA9B;;AAEA,UAAIwwC,MAAM,CAAV;;AAEAF,kBAAYluC,OAAZ,CAAoBtD,OAApB,CAA4B,UAAS6I,MAAT,EAAgB;;AAExC4oC,qBAAaE,SAAb,CAAuB9oC,OAAOgF,GAA9B,EAAmChF,OAAO6G,IAA1C;;AAEAgiC,eAAO,CAAP;AACH,OALD;;AAOAF,kBAAYD,cAAZ,CAA2BvxC,OAA3B,CAAmC,UAAS6I,MAAT,EAAgB;;AAE/C4oC,qBAAaG,gBAAb,CAA8B/oC,OAAOgF,GAArC,EAA0ChF,OAAO6G,IAAjD;;AAEAgiC,eAAO,CAAP;AACH,OALD;;AAOA,aAAOD,YAAP;AACD;;;;;;AACF;;AAED72C,QAAQ8V,WAAR,GAAsBA,WAAtB;AACA;;IAGMmhC,a;AAEJ,yBAAYvjB,QAAZ,EAAqB;AAAA;;AAEnB,SAAKhrB,OAAL,GAAe,EAAf;;AAEA,SAAKwuC,WAAL,GAAmB,CAAnB;;AAEA,SAAKjP,aAAL,GAAqB,EAArB;;AAGA,SAAKA,aAAL,CAAmBoD,MAAnB,GAA4B,YAAU;;AAEpC,UAAIC,YAAY,CAAhB;AAAA,UAAmBC,kBAAkB,CAArC;;AAEA,WAAI,IAAIhqC,IAAI,CAAZ,EAAeA,IAAI,KAAKgF,MAAxB,EAAgChF,GAAhC,EACA;AACE,YAAG,QAAO,KAAKA,CAAL,CAAP,KAAkB,QAAlB,IAA8B,KAAKA,CAAL,EAAQonB,MAAR,IAAkB2iB,SAAnD,EACA;AACEA,sBAAY,KAAK/pC,CAAL,EAAQonB,MAApB;AACA4iB,4BAAkBhqC,CAAlB;AACD;AACF;AACD,aAAO,KAAKgqC,eAAL,CAAP;AACD,KAbD;;AAeA,SAAKtD,aAAL,CAAmBuD,WAAnB,GAAiC,YAAU;AACzC,UAAItD,QAAQ,CAAZ;AACA,WAAI,IAAI3mC,IAAI,CAAZ,EAAeA,IAAI,KAAKgF,MAAxB,EAAgChF,GAAhC,EACA;AACE,YAAG,KAAKA,CAAL,EAAQonB,MAAR,GAAiB,CAApB,EACA;AACEuf;AACD;AACF;AACD,aAAOA,KAAP;AACD,KAVD;;AAcA,SAAKx/B,OAAL,CAAa2iC,MAAb,GAAsB,YAAU;;AAE9B,UAAIC,YAAY,CAAhB;AAAA,UAAmBC,kBAAkB,CAArC;;AAEA,WAAI,IAAIhqC,IAAI,CAAZ,EAAeA,IAAI,KAAKgF,MAAxB,EAAgChF,GAAhC,EACA;AACE,YAAG,QAAO,KAAKA,CAAL,CAAP,KAAkB,QAAlB,IAA8B,KAAKA,CAAL,EAAQonB,MAAR,IAAkB2iB,SAAnD,EACA;AACEA,sBAAY,KAAK/pC,CAAL,EAAQonB,MAApB;AACA4iB,4BAAkBhqC,CAAlB;AACD;AACF;AACD,aAAO,KAAKgqC,eAAL,CAAP;AACD,KAbD;;AAeA,SAAK7iC,OAAL,CAAa8iC,WAAb,GAA2B,YAAU;AACnC,UAAItD,QAAQ,CAAZ;AACA,WAAI,IAAI3mC,IAAI,CAAZ,EAAeA,IAAI,KAAKgF,MAAxB,EAAgChF,GAAhC,EACA;AACE,YAAG,KAAKA,CAAL,EAAQonB,MAAR,IAAkB,CAArB,EACA;AACEuf;AACD;AACF;AACDroC,cAAQC,GAAR,CAAY,wBAAwBooC,KAApC;AACA,aAAOA,KAAP;AACD,KAXD;;AAaA,QAAG,OAAOxU,QAAP,IAAmB,UAAtB,EACAA,SAAS1H,IAAT,CAAc,IAAd,EAAoBziB,IAApB;AAED;;;;8BAESmM,C,EAAE;AACR,WAAKyhC,SAAL,GAAiBzhC,CAAjB;AACA,aAAO,IAAP;AACH;;;+BAEUzH,M,EAAO;;AAEhB,UAAGA,MAAH,EACA,KAAKmpC,WAAL,GAAmBnpC,MAAnB;;AAEA,aAAO,KAAKmpC,WAAZ;AACD;;;qCAEqD;AAAA,UAAvClP,KAAuC,uEAAjC,CAAiC;AAAA,UAA9BmP,aAA8B;AAAA,UAAfC,cAAe;;;AAEpD,WAAI,IAAI/1C,IAAI,CAAZ,EAAeA,IAAI2mC,KAAnB,EAA0B3mC,GAA1B,EACA;AACE,YAAIqK,IAAI,IAAI5L,QAAQ0F,MAAZ,GAAqBkpC,QAArB,CAA8ByI,aAA9B,CAAR;AACA,aAAK3uC,OAAL,CAAanB,IAAb,CAAkBqE,CAAlB;AACD;;AAED,WAAK2rC,YAAL,GAAoBD,cAApB;;AAEA,aAAO,IAAP;AACD;;;iDAE6D;AAAA,UAAjCpP,KAAiC,uEAA3B,CAA2B;AAAA,UAAxBsP,cAAwB;AAAA,UAARC,OAAQ;;;AAE1D,UAAG,CAACD,cAAD,YAA2Bt2C,KAA9B,EACAs2C,iBAAiB,CAACA,cAAD,CAAjB;;AAEA,WAAI,IAAIj2C,IAAI,CAAZ,EAAeA,IAAI2mC,KAAnB,EAA0B3mC,GAA1B,EACA;AACE,YAAIqK,IAAI,IAAI5L,QAAQ0F,MAAZ,GAAqBkpC,QAArB,CAA8B4I,eAAej2C,IAAIi2C,eAAejxC,MAAlC,CAA9B,CAAR;AACAqF,UAAE9C,MAAF,CAAS2uC,WAAW,YAAU,CAAE,CAAhC;AACA,aAAK/uC,OAAL,CAAanB,IAAb,CAAkBqE,CAAlB;AACD;;AAED,aAAO,IAAP;AACD;;;4BAGH;AAAA,UADM/K,MACN,uEADa,CACb;AAAA,UADgB6G,UAChB;;AACE,UAAIgwC,cAAc,IAAlB;;AAEA,WAAI,IAAIn2C,IAAI,CAAZ,EAAeA,IAAIV,MAAnB,EAA2BU,GAA3B,EACA;AACE;AACA,YAAIo2C,cAAc,KAAKjvC,OAAL,CAAa8iC,WAAb,EAAlB;;AAEA,YAAI5/B,IAAI,IAAI5L,QAAQ0F,MAAZ,GAAqBojB,KAArB,CAA2B,KAAKpgB,OAAL,CAAa,CAAb,CAA3B,CAAR;;AAEA,YAAG,KAAK6uC,YAAR,EACA;AACE,eAAKA,YAAL,CAAkBvrB,IAAlB,CAAuBpgB,CAAvB,EAA0BrC,IAA1B;AACD;;AAED,aAAK0+B,aAAL,CAAmB1gC,IAAnB,CAAwBqE,CAAxB;;AAEAlE,mBAAW+M,GAAX,CAAe7I,CAAf;AACA,aAAKsrC,WAAL,IAAoB,CAApB;;AAEA,YAAG,KAAKU,MAAR,EACA,KAAKA,MAAL,CAAYhsC,CAAZ;AAED;;AAEO,aAAO;;AAELisC,8BAAqB,8BAASnoC,KAAT,EAAe;;AAEhCo9B,aAAGrF,cAAH,GAAoB/3B,KAApB;AACA,iBAAO,IAAP;AACH,SANI;;AASLooC,gCAAuB,gCAASpL,QAAT,EAAmBC,YAAnB,EAAgC;AACnDG,aAAGF,KAAH,GAAWA,KAAX;AACA,iBAAO,IAAP;AACH;;AAZI,OAAP;AAgBT;;;6BAEQ5+B,M,EAAO;AACd,WAAK+pC,QAAL,GAAgB/pC,MAAhB;AACA,aAAO,IAAP;AACD;;;2BAEMnI,Q,EAAS;;AAEd,WAAK+xC,MAAL,GAAc/xC,QAAd;AACA,aAAO,IAAP;AACD;;;yBAEI6B,U,EAAW;AACZ,WAAKswC,KAAL,CAAW,CAAX,EAActwC,UAAd;AACH;;;;;;AAIH1H,QAAQi3C,aAAR,GAAwBA,aAAxB;AACA,C,CAAC;;;;IAIKgB,U;;;AACJ,wBAAmC;AAAA,QAAvBhlC,GAAuB,uEAAjB,EAAiB;AAAA,QAAb+F,KAAa,uEAAL,GAAK;;AAAA;;AAAA,0HAC3B/F,GAD2B,EACtB+F,KADsB;;AAEjC,YAAKgvB,aAAL,GAAqB,EAArB;AACA,YAAK2O,cAAL,GAAsB,EAAtB;AACA,YAAK9K,KAAL,GAAa,EAAb;AAJiC;AAKlC;AACD;;;;;2BACO;AACL,aAAO,CAAP;AACD;;;8BACS54B,G,EAAK+F,K,EAAOnT,Q,EAAU;AAC9B,WAAKmiC,aAAL,CAAmBzgC,IAAnB,CAAwB,IAAIvH,QAAQ0F,MAAZ,CAAmBuN,GAAnB,EAAwB+F,KAAxB,CAAxB;AACA,UAAGnT,QAAH,EAAaA,SAASmmB,IAAT,CAAc,IAAd,EAAoBziB,IAApB;AACd;;;qCACgB0J,G,EAAK+F,K,EAAOnT,Q,EAAU;AACrChG,cAAQY,IAAR;AAEA,WAAKk2C,cAAL,CAAoBpvC,IAApB,CAAyB,IAAIvH,QAAQ0F,MAAZ,CAAmBuN,GAAnB,EAAwB+F,KAAxB,CAAzB;AACA,UAAGnT,QAAH,EAAaA,SAASmmB,IAAT,CAAc,IAAd,EAAoBziB,IAApB;AACd;;;kCACamtC,I,EAAM;AAClB,WAAKwB,cAAL,GAAsBxB,QAAQ,KAAKyB,aAAb,IAA8B,QAApD;AACA,aAAO,KAAKD,cAAZ;AACD;;;+BACUE,a,EAAe;AACxB,UAAGA,aAAH,EAAkBA,cAAcpsB,IAAd,CAAmB,IAAnB,EAAyBziB,IAAzB;AAClB,aAAO,KAAKsiC,KAAZ;AACD;;;wCACmB;AAClB,UAAI7e,OAAO,IAAIhtB,QAAQyyB,SAAZ,CAAsB/H,QAAtB,EAAgCA,QAAhC,EAA0C,CAACA,QAA3C,EAAqD,CAACA,QAAtD,CAAX;AACA,WAAKmhB,KAAL,CAAWzmC,OAAX,CAAmB,UAASmuB,KAAT,EAAgB;AACjC,YAAIA,MAAMhyB,CAAN,GAAUyrB,KAAK1sB,GAAL,CAASiB,CAAvB,EAA0B;AACxByrB,eAAK1sB,GAAL,CAASiB,CAAT,GAAagyB,MAAMhyB,CAAnB;AACD;AACD,YAAIgyB,MAAMtwB,CAAN,GAAU+pB,KAAK1sB,GAAL,CAAS2C,CAAvB,EAA0B;AACxB+pB,eAAK1sB,GAAL,CAAS2C,CAAT,GAAaswB,MAAMtwB,CAAnB;AACD;AACD,YAAIswB,MAAMhyB,CAAN,GAAUyrB,KAAKzsB,GAAL,CAASgB,CAAvB,EAA0B;AACxByrB,eAAKzsB,GAAL,CAASgB,CAAT,GAAagyB,MAAMhyB,CAAnB;AACD;AACD,YAAIgyB,MAAMtwB,CAAN,GAAU+pB,KAAKzsB,GAAL,CAAS0C,CAAvB,EAA0B;AACxB+pB,eAAKzsB,GAAL,CAAS0C,CAAT,GAAaswB,MAAMtwB,CAAnB;AACD;AACF,OAbD;AAcA,aAAO+pB,IAAP;AACD;;;2BAEM;;AAEL,UAAIqrB,SAAS,KAAKC,iBAAL,EAAb;;AAEA;;AAEA,UAAIC,UAAU,IAAIv4C,QAAQ+U,MAAZ,EAAd;AAAA,UACE9G,SAAS,KAAK+5B,aAAL,CAAmB,CAAnB,CADX;AAAA,UAEEwQ,cAAc,IAAIx4C,QAAQ+U,MAAZ,CAAmB9G,OAAO6G,IAA1B,CAFhB;AAAA,UAGE2jC,eAAe,CAHjB;;AAKA,WAAKC,eAAL,GAAuB,IAAI14C,QAAQ+xB,eAAZ,CAA4B1tB,SAASgnB,aAAT,CAAuB,QAAvB,CAA5B,EAA8DgtB,OAAO/3C,GAAP,CAAWiB,CAAzE,EAA4E82C,OAAO/3C,GAAP,CAAW2C,CAAvF,CAAvB;;AAEA,UAAIgpB,MAAM,KAAKysB,eAAL,CAAqBzsB,GAA/B;;AAEA;AACA,WAAK,IAAI1qB,IAAI82C,OAAO/3C,GAAP,CAAWiB,CAAxB,EAA2BA,IAAI82C,OAAO93C,GAAP,CAAWgB,CAA1C,EAA6CA,KAAKi3C,YAAYj3C,CAA9D,EAAiE;AAC/D,aAAK,IAAI0B,IAAIo1C,OAAO/3C,GAAP,CAAW2C,CAAxB,EAA2BA,IAAIo1C,OAAO93C,GAAP,CAAW0C,CAA1C,EAA6CA,KAAKu1C,YAAYv1C,CAA9D,EAAiE;AAC/D,cAAI01C,aAAa,IAAI34C,QAAQ0F,MAAZ,GAAqBkpC,QAArB,CAA8B,KAAK5G,aAAL,CAAmByQ,YAAnB,CAA9B,CAAjB;AACA,eAAK/vC,OAAL,CAAanB,IAAb,CAAkBoxC,UAAlB;AACAH,wBAAc,IAAIx4C,QAAQ+U,MAAZ,CAAmB4jC,WAAW7jC,IAA9B,CAAd;AACA2jC,0BAAgB,CAAhB;AACAE,qBAAW7vC,MAAX,CAAkB,YAAW;AAC3B,iBAAKqlB,IAAL,CAAUlC,GAAV;AACD,WAFD;AAGD;AACF;;AAED,aAAO,KAAKysB,eAAZ;AAED;;;;EA9EsBhzC,M;;AAgFxB;;AAED1F,QAAQi4C,UAAR,GAAqBA,UAArB;AACA,C,CAAC;;;;;;;IAOKpiC,W;AACJ,yBAAmC;AAAA,QAAvB5C,GAAuB,uEAAjB,EAAiB;AAAA,QAAb+F,KAAa,uEAAL,GAAK;;AAAA;;AACjC,SAAKtQ,OAAL,GAAe,EAAf;AACA,SAAKkwC,UAAL,GAAkB,IAAI54C,QAAQ0F,MAAZ,CAAmBuN,GAAnB,EAAwB+F,KAAxB,CAAlB;AACD;;;;iCAEY6/B,E,EAAIC,E,EAAG;AAClB,WAAKC,YAAL,GAAoB,IAAI/4C,QAAQ+U,MAAZ,CAAmB8jC,EAAnB,EAAuBC,EAAvB,CAApB;AACA,aAAO,IAAP;AACD;;;wBAEG7qC,M,EAAO;AACT,WAAKvF,OAAL,CAAanB,IAAb,CAAkB0G,MAAlB;AACA,aAAO,IAAP;AACD;;;;;;AACF;;AAEDjO,QAAQ6V,WAAR,GAAsBA,WAAtB;AACA;IAAOmjC,a,GACL,uBAAYt3C,GAAZ,EAAiB;AAAA;;AACf,OAAKA,GAAL,GAAWA,OAAO,OAAlB;AACA,OAAKu3C,MAAL,GAAcC,OAAOx3C,GAAP,CAAd;AACD,C;;AAGH1B,QAAQg5C,aAAR,GAAwBA,aAAxB;;AAEAh5C,QAAQm5C,gBAAR,GAA2Bn5C,QAAQm5C,gBAAR,IAA4B,EAAvD;;AAEAn5C,QAAQo5C,aAAR,GAAwB,UAASrwC,WAAT,EAAsBT,IAAtB,EAA4B;;AAElD;;AAEA,MAAI+wC,iBAAiB,EAArB;;AAGA,OAAK,IAAIp2C,CAAT,IAAcjD,QAAQ4V,gBAAtB,EAAwC;;AAEtC,QAAI5V,QAAQiD,CAAR,KAAc,OAAOjD,QAAQiD,CAAR,CAAP,IAAqB,UAAvC,EAAmD;;AAEjD,UAAI8F,cAAc/I,QAAQiD,CAAR,CAAlB;;AAEAo2C,qBAAep2C,CAAf,IAAoB,EAApB;;AAEA;;AAEAo2C,qBAAep2C,CAAf,EAAkBq2C,cAAlB,GAAmCD,eAAep2C,CAAf,EAAkBq2C,cAAlB,IAAoC,EAAvE;;AAEA,WAAK,IAAI7hC,CAAT,IAAczX,QAAQ4V,gBAAR,CAAyB3S,CAAzB,CAAd,EAA2C;;AAEzCo2C,uBAAep2C,CAAf,EAAkBq2C,cAAlB,CAAiC/xC,IAAjC,CAAsC,IAAIvH,QAAQg5C,aAAZ,CAA0Bh5C,QAAQ4V,gBAAR,CAAyB3S,CAAzB,EAA4BwU,CAA5B,CAA1B,CAAtC;;AAEA4hC,uBAAep2C,CAAf,EAAkBq2C,cAAlB,CAAiCC,MAAjC,GAA0C,UAAS73C,GAAT,EAAc;;AAEtD,eAAK,IAAIH,IAAI,CAAb,EAAgBA,IAAI,KAAKgF,MAAzB,EAAiChF,GAAjC,EAAsC;AACpC,gBAAI,OAAO,KAAKA,CAAL,EAAQG,GAAf,KAAuB,QAA3B,EACE;;AAEF,gBAAI,KAAKH,CAAL,EAAQG,GAAR,CAAY4J,OAAZ,CAAoB,GAApB,KAA4B,CAAC,CAAjC,EACEzL,QAAQQ,KAAR,CAAc,6BAAd;;AAEF;;AAEA,gBAAI,KAAKkB,CAAL,EAAQG,GAAR,CAAY8K,KAAZ,CAAkB,GAAlB,EAAuB,CAAvB,KAA6B9K,GAAjC,EACE,OAAO,IAAP;AACH;;AAED,iBAAO,KAAP;AACD,SAhBD;;AAkBA23C,uBAAep2C,CAAf,EAAkBq2C,cAAlB,CAAiCE,SAAjC,GAA6C,UAASP,MAAT,EAAiB;AAC5D,eAAK,IAAI13C,CAAT,IAAc,IAAd,EAAoB;AAClB,gBAAI,KAAKA,CAAL,EAAQ03C,MAAR,IAAkBA,MAAtB,EACE,OAAO,IAAP;AACH;;AAED,iBAAO,KAAP;AACD,SAPD;;AASA;AACD;AACF,KA3CD,MA2CO;AACLp5C,cAAQQ,KAAR,CAAc,iDAAiDkB,CAAjD,GAAqD,sCAAnE;AACD;AACF;;AAGD1B,UAAQY,IAAR,CAAa,WAAb,EAA0B44C,cAA1B;;AAGA,OAAK,IAAI93C,CAAT,IAAcvB,QAAQm5C,gBAAtB,EAAwC;;AAEtC;;AAEA,QAAIM,QAAQj5C,SAAS6B,aAAT,CAAuBrC,QAAQm5C,gBAAR,CAAyB53C,CAAzB,CAAvB,CAAZ;;AAEA,SAAK,IAAI0B,IAAI,CAAb,EAAgBA,IAAIw2C,MAAMlzC,MAA1B,EAAkCtD,GAAlC,EAAuC;AACrCpD,cAAQC,GAAR,CAAYyB,IAAI,GAAJ,GAAUk4C,MAAMx2C,CAAN,CAAtB;AACA,WAAK,IAAIwU,CAAT,IAAc4hC,cAAd;AACE,YAAIA,eAAe5hC,CAAf,KAAqB4hC,eAAe5hC,CAAf,EAAkB6hC,cAAlB,CAAiCC,MAAjC,CAAwCE,MAAMx2C,CAAN,CAAxC,CAAzB,EAA4E;AAC1EjD,kBAAQm5C,gBAAR,CAAyB53C,CAAzB,EAA4Bk4C,MAAMx2C,CAAN,CAA5B,EAAsCjD,QAAQyX,CAAR,EAAWyrB,SAAjD,EAA4D56B,IAA5D;AACD;AAHH;AAID;AACF;AAEF,CA5ED;;IA+EMoxC,W;;;;;;;4BAEIz4C,G,EAAI;AACVA,UAAIgqC,KAAJ,GAAY,UAASrrC,CAAT,EACZ;AACE,aAAK0b,KAAL,GAAa1b,CAAb;AACA,eAAO,IAAP;AACD,OAJD;AAKD;;;qCAEgB+5C,S,EAAWC,S,EAAU;AACpC,WAAKD,SAAL,GAAiBA,SAAjB;AACA,WAAKC,SAAL,GAAiBA,SAAjB;AACA,aAAO,IAAP;AACD;;;yBAEI34C,G,EAAI;AACPA,UAAImV,IAAJ,GAAW,UAASzD,KAAT,EACX;AACE,aAAK0hC,IAAL,GAAY1hC,KAAZ;AACA,eAAO,IAAP;AACD,OAJD;AAKD;;;2BAEM1R,G,EAAI;AACTA,UAAIurC,OAAJ,GAAc,UAASlgB,CAAT,EAAW;AACvB,aAAKyY,OAAL,GAAezY,CAAf;AACA,eAAO,IAAP;AACD,OAHD;AAID;;;;;;AACF;;IAGKutB,a;;;;;;;yBAEC54C,G,EAAI;;AAEPA,UAAI64C,IAAJ,GAAW,UAASC,CAAT,EAAY;AACrB,aAAK/wC,IAAL,GAAY+wC,CAAZ;AACA,eAAO,IAAP;AACD,OAHD;;AAKA94C,UAAI+4C,WAAJ,GAAkB,UAASnxB,CAAT,EAAW;AAC3B,aAAKimB,WAAL,GAAmBjmB,CAAnB;AACA,eAAO,IAAP;AACD,OAHD;;AAKA5nB,UAAIg5C,OAAJ,GAAc,UAASr6C,CAAT,EAAY;AACxB,aAAK4rB,OAAL,GAAe5rB,CAAf;AACA,eAAO,IAAP;AACD,OAHD;;AAKAqB,UAAI2F,SAAJ,GAAgB,YAAU;AACxB,eAAO5G,QAAQ4G,SAAR,EAAP;AACD,OAFD;AAGD;;;;;;AAMH;;;;;;;IAKMszC,e;AACJ,6BAAc;AAAA;;AAEZ,SAAKlxC,IAAL,GAAY,mBAAZ;AAED;;;;gCAEW/H,G,EAAK;AACfA,UAAIk5C,kBAAJ,GAAyB,YAAW,CAAE,CAAtC;AACAl5C,UAAIm5C,SAAJ,GAAgB9xC,KAAK8xC,SAAL,IAAkB,UAASC,YAAT,EAAuBx0C,QAAvB,EAAiC;AACjE,YAAI,OAAOw0C,YAAP,IAAwB,UAA5B,EAAwC;AACtCx0C,qBAAWw0C,YAAX;AACD;AACD,aAAKF,kBAAL,GAA0Bt0C,YAAY,YAAW,CAAE,CAAnD;AACD,OALD;AAMD;;;4BAEO5E,G,EAAK;;AAEXA,UAAI0qB,IAAJ,GAAW,UAASpqB,CAAT,EAAY0B,CAAZ,EAAewU,CAAf,EAAkB;;AAE3B,YAAI,QAAOlW,CAAP,yCAAOA,CAAP,MAAa,QAAjB,EACE,KAAKuT,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmBxT,CAAnB,CAAZ,CADF,KAGK,IAAI,CAACoF,MAAMpF,CAAN,CAAD,IAAa,CAACoF,MAAM1D,CAAN,CAAlB,EAA4B;AAC/B,eAAK6R,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAAZ,CADG,KAGA;AACH,eAAK3C,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsBA,CAAtB,EAAyBA,CAAzB,CAAZ;;AAEF,eAAO,IAAP;AACD,OAZD;;AAcAN,UAAI6rB,GAAJ,GAAU,UAASvrB,CAAT,EAAY0B,CAAZ,EAAewU,CAAf,EAAkB;;AAE1B,YAAI,QAAOlW,CAAP,yCAAOA,CAAP,MAAa,QAAjB,EACE,KAAKmW,QAAL,GAAgB,IAAI1X,QAAQ+U,MAAZ,CAAmBxT,CAAnB,CAAhB,CADF,KAGK,IAAI,CAACoF,MAAMpF,CAAN,CAAD,IAAa,CAACoF,MAAM1D,CAAN,CAAlB,EAA4B;AAC/B,eAAKyU,QAAL,GAAgB,IAAI1X,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAAhB,CADG,KAGA;AACH,eAAKC,QAAL,GAAgB,IAAI1X,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsBA,CAAtB,EAAyBA,CAAzB,CAAhB;;AAEF,eAAO,IAAP;AACD,OAZD;;AAcAN,UAAIq5C,GAAJ,GAAU,UAAS/4C,CAAT,EAAY0B,CAAZ,EAAewU,CAAf,EAAkB;;AAE1B,YAAI,QAAOlW,CAAP,yCAAOA,CAAP,MAAa,QAAjB,EACE,KAAKm2B,QAAL,GAAgB,IAAI13B,QAAQ+U,MAAZ,CAAmBxT,CAAnB,CAAhB,CADF,KAGK,IAAI,CAACoF,MAAMpF,CAAN,CAAD,IAAa,CAACoF,MAAM1D,CAAN,CAAlB,EAA4B;AAC/B,eAAKy0B,QAAL,GAAgB,IAAI13B,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAAhB,CADG,KAGA;AACH,eAAKigB,QAAL,GAAgB,IAAI13B,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsBA,CAAtB,EAAyBA,CAAzB,CAAhB;;AAEF,eAAO,IAAP;AACD,OAZD;;AAcAN,UAAIqO,QAAJ,GAAerO,IAAI6rB,GAAnB;;AAEA7rB,UAAIs5C,MAAJ,GAAat5C,IAAIq5C,GAAjB;;AAEAr5C,UAAIm3B,QAAJ,GAAen3B,IAAIq5C,GAAnB;AAED;;;qCAEgBr5C,G,EAAI;;AAGfA,UAAI0qB,IAAJ,GAAW,UAASpqB,CAAT,EAAY0B,CAAZ,EAAewU,CAAf,EAAkB;;AAE3B,YAAI,QAAOlW,CAAP,yCAAOA,CAAP,MAAa,QAAjB,EACE,KAAKuT,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmBxT,CAAnB,CAAZ,CADF,KAGK,IAAI,CAACoF,MAAMpF,CAAN,CAAD,IAAa,CAACoF,MAAM1D,CAAN,CAAlB,EAA4B;AAC/B,eAAK6R,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAAZ,CADG,KAGA;AACH,eAAK3C,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsBA,CAAtB,EAAyBA,CAAzB,CAAZ;;AAEF,eAAO,IAAP;AACD,OAZD;;AAcAN,UAAI6rB,GAAJ,GAAU,UAASvrB,CAAT,EAAY0B,CAAZ,EAAewU,CAAf,EAAkB;;AAE1B,YAAI+iC,MAAM,CAAV;AACA,YAAG,KAAKzB,YAAL,IAAsB,KAAKA,YAAL,CAAkBx3C,CAA3C,EACAi5C,MAAM,KAAKzB,YAAL,CAAkBx3C,CAAxB;;AAEA,YAAI,QAAOA,CAAP,yCAAOA,CAAP,MAAa,QAAjB,EACE,KAAKmW,QAAL,GAAgB,IAAI1X,QAAQ+U,MAAZ,CAAmBylC,MAAMj5C,CAAzB,CAAhB,CADF,KAGK,IAAI,CAACoF,MAAMpF,CAAN,CAAD,IAAa,CAACoF,MAAM1D,CAAN,CAAlB,EAA4B;AAC/B,eAAKyU,QAAL,GAAgB,IAAI1X,QAAQ+U,MAAZ,CAAmBylC,MAAMj5C,CAAzB,EAA4B0B,CAA5B,EAA+BwU,CAA/B,CAAhB,CADG,KAGA;AACH,eAAKC,QAAL,GAAgB,IAAI1X,QAAQ+U,MAAZ,CAAmBylC,MAAMj5C,CAAzB,EAA4BA,CAA5B,EAA+BA,CAA/B,CAAhB;;AAEF,eAAO,IAAP;AACD,OAhBD;;AAkBAN,UAAIq5C,GAAJ,GAAU,UAAS/4C,CAAT,EAAY0B,CAAZ,EAAewU,CAAf,EAAkB;;AAE1B,YAAI46B,KAAK,CAAT;AACA,YAAG,KAAKoI,YAAL,IAAsB,KAAKA,YAAL,CAAkBl5C,CAA3C,EACA8wC,KAAK,KAAKoI,YAAL,CAAkBl5C,CAAvB;;AAEA,YAAI,QAAOA,CAAP,yCAAOA,CAAP,MAAa,QAAjB,EACE,KAAKm2B,QAAL,GAAgB,IAAI13B,QAAQ+U,MAAZ,CAAmBs9B,KAAK9wC,CAAxB,CAAhB,CADF,KAGK,IAAI,CAACoF,MAAMpF,CAAN,CAAD,IAAa,CAACoF,MAAM1D,CAAN,CAAlB,EAA4B;AAC/B,eAAKy0B,QAAL,GAAgB,IAAI13B,QAAQ+U,MAAZ,CAAmBs9B,KAAK9wC,CAAxB,EAA2B0B,CAA3B,EAA8BwU,CAA9B,CAAhB,CADG,KAGA;AACH,eAAKigB,QAAL,GAAgB,IAAI13B,QAAQ+U,MAAZ,CAAmBs9B,KAAK9wC,CAAxB,EAA2BA,CAA3B,EAA8BA,CAA9B,CAAhB;;AAEF,eAAO,IAAP;AACD,OAhBD;;AAkBAN,UAAIqO,QAAJ,GAAerO,IAAI6rB,GAAnB;;AAEA7rB,UAAIs5C,MAAJ,GAAat5C,IAAIq5C,GAAjB;;AAEAr5C,UAAIm3B,QAAJ,GAAen3B,IAAIq5C,GAAnB;AAEL;;;4BAEOr5C,G,EAAK;;AAEXA,UAAI6rB,GAAJ,GAAU,UAASvrB,CAAT,EAAY0B,CAAZ,EAAewU,CAAf,EAAkB;;AAE1B,YAAI,QAAOlW,CAAP,yCAAOA,CAAP,MAAa,QAAjB,EACE,KAAKmW,QAAL,GAAgB,IAAI1X,QAAQ+U,MAAZ,CAAmBxT,CAAnB,CAAhB,CADF,KAGK,IAAI,CAACoF,MAAMpF,CAAN,CAAD,IAAa,CAACoF,MAAM1D,CAAN,CAAlB,EAA4B;AAC/B,eAAKyU,QAAL,GAAgB,IAAI1X,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAAhB,CADG,KAGA;AACH,eAAKC,QAAL,GAAgB,IAAI1X,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsBA,CAAtB,EAAyBA,CAAzB,CAAhB;;AAEF,eAAO,IAAP;AACD,OAZD;;AAcAN,UAAIqO,QAAJ,GAAerO,IAAI6rB,GAAnB;AAED;;;6BAEQ7rB,G,EAAK;;AAEZA,UAAI0qB,IAAJ,GAAW,UAASpqB,CAAT,EAAY0B,CAAZ,EAAewU,CAAf,EAAkB;;AAE3B,YAAI,QAAOlW,CAAP,yCAAOA,CAAP,MAAa,QAAjB,EACE,KAAKuT,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmBxT,CAAnB,CAAZ,CADF,KAGK,IAAI,CAACoF,MAAMpF,CAAN,CAAD,IAAa,CAACoF,MAAM1D,CAAN,CAAlB,EAA4B;AAC/B,eAAK6R,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAAZ,CADG,KAGA;AACH,eAAK3C,IAAL,GAAY,IAAI9U,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsBA,CAAtB,EAAyBA,CAAzB,CAAZ;;AAEF,eAAO,IAAP;AACD,OAZD;;AAcAN,UAAIqO,QAAJ,GAAerO,IAAI6rB,GAAnB;AAED;;;4BAEO7rB,G,EAAK;AACXA,UAAIq5C,GAAJ,GAAU,UAAS/4C,CAAT,EAAY0B,CAAZ,EAAewU,CAAf,EAAkB;;AAE1B,YAAI,QAAOlW,CAAP,yCAAOA,CAAP,MAAa,QAAjB,EACE,KAAKm2B,QAAL,GAAgB,IAAI13B,QAAQ+U,MAAZ,CAAmBxT,CAAnB,CAAhB,CADF,KAGK,IAAI,CAACoF,MAAMpF,CAAN,CAAD,IAAa,CAACoF,MAAM1D,CAAN,CAAlB,EAA4B;AAC/B,eAAKy0B,QAAL,GAAgB,IAAI13B,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAAhB,CADG,KAGA;AACH,eAAKigB,QAAL,GAAgB,IAAI13B,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsBA,CAAtB,EAAyBA,CAAzB,CAAhB;;AAEF,YAAI,OAAO,KAAKm5C,SAAZ,IAAyB,UAA7B,EAAyC;AACvC,eAAKA,SAAL;AACD;;AAED,eAAO,IAAP;AACD,OAhBD;;AAkBAz5C,UAAIs5C,MAAJ,GAAat5C,IAAIq5C,GAAjB;;AAEAr5C,UAAIm3B,QAAJ,GAAen3B,IAAIq5C,GAAnB;AAED;;;4BAEOr5C,G,EAAK;AACXA,UAAI6xB,GAAJ,GAAU,UAASvxB,CAAT,EAAY0B,CAAZ,EAAewU,CAAf,EAAkB;;AAE1B,YAAI,QAAOlW,CAAP,yCAAOA,CAAP,MAAa,QAAjB,EACE,KAAKjB,GAAL,GAAW,IAAIN,QAAQ+U,MAAZ,CAAmBxT,CAAnB,CAAX,CADF,KAGK,IAAI,CAACoF,MAAMpF,CAAN,CAAD,IAAa,CAACoF,MAAM1D,CAAN,CAAlB,EAA4B;AAC/B,eAAK3C,GAAL,GAAW,IAAIN,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAAX,CADG,KAGA;AACH,eAAKnX,GAAL,GAAW,IAAIN,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsBA,CAAtB,EAAyBA,CAAzB,CAAX;;AAEF,eAAO,IAAP;AACD,OAZD;;AAcAN,UAAI05C,OAAJ,GAAc15C,IAAI6xB,GAAlB;AAED;;;4BAEO7xB,G,EAAK;AACXA,UAAI8xB,GAAJ,GAAU,UAASxxB,CAAT,EAAY0B,CAAZ,EAAewU,CAAf,EAAkB;;AAE1B,YAAI,QAAOlW,CAAP,yCAAOA,CAAP,MAAa,QAAjB,EACE,KAAKhB,GAAL,GAAW,IAAIP,QAAQ+U,MAAZ,CAAmBxT,CAAnB,CAAX,CADF,KAGK,IAAI,CAACoF,MAAMpF,CAAN,CAAD,IAAa,CAACoF,MAAM1D,CAAN,CAAlB,EAA4B;AAC/B,eAAK1C,GAAL,GAAW,IAAIP,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsB0B,CAAtB,EAAyBwU,CAAzB,CAAX,CADG,KAGA;AACH,eAAKlX,GAAL,GAAW,IAAIP,QAAQ+U,MAAZ,CAAmBxT,CAAnB,EAAsBA,CAAtB,EAAyBA,CAAzB,CAAX;;AAEF,eAAO,IAAP;AACD,OAZD;;AAcAN,UAAI25C,OAAJ,GAAc35C,IAAI8xB,GAAlB;AAED;;;8BAES9xB,G,EAAK;AACb,WAAK45C,OAAL,CAAa55C,GAAb;;AAEA,WAAK65C,OAAL,CAAa75C,GAAb;AACD;;;qCAEgBA,G,EAAK;AACpB;AACAA,UAAIy5C,SAAJ,GAAgB,UAAShjB,QAAT,EAAmBhgB,QAAnB,EAA6B;;AAE3C,aAAKggB,QAAL,GAAgB,IAAI13B,QAAQ+U,MAAZ,CAAmB2iB,YAAY,KAAKA,QAApC,CAAhB;;AAEA,aAAKhgB,QAAL,GAAgB,IAAI1X,QAAQ+U,MAAZ,CAAmB2C,YAAY,KAAKA,QAApC,CAAhB;;AAEA;;AAEA,aAAK,IAAInW,IAAI,CAAb,EAAgBA,IAAI,KAAK0W,MAAL,CAAY1R,MAAhC,EAAwChF,GAAxC,EAA6C;;AAE3C,cAAIa,IAAI,KAAK6V,MAAL,CAAY1W,CAAZ,CAAR;;AAEA,cAAIw5C,KAAK/6C,QAAQg1B,IAAR,CAAaP,cAAb,CAA4B,CAA5B,EAA+B,CAA/B,EAAkCryB,EAAEb,CAApC,EAAuCa,EAAEa,CAAzC,EAA4C,KAAKy0B,QAAL,CAAcn2B,CAA1D,CAAT;;AAEA,eAAK0W,MAAL,CAAY1W,CAAZ,IAAiB,KAAKmW,QAAL,CAAcjD,GAAd,CAAkBsmC,EAAlB,CAAjB;AAED;AACD,eAAO,IAAP;AACD,OAlBD;AAoBD;;;wCAEmB95C,G,EAAK;AACvB;AACAA,UAAI+5C,KAAJ,GAAY,YAAW;;AAErB,YAAIC,SAASn0C,KAAKkjB,KAAL,CAAW,KAAK/R,MAAL,CAAY1R,MAAZ,GAAqB,CAAhC,CAAb,CAFqB,CAE4B;;AAEjD,YAAIhF,CAAJ,EAAO0B,CAAP;;AAEA,aAAK1B,IAAI,KAAK0W,MAAL,CAAY1R,MAAZ,GAAqB,CAAzB,EAA4BtD,IAAI,CAArC,EAAwC1B,IAAI05C,MAAJ,EAAYh4C,IAAIg4C,MAAxD,EAAgE15C,KAAK0B,GAArE,EAA0E;;AAExE,cAAI00B,KAAK,KAAK1f,MAAL,CAAY1W,CAAZ,CAAT;AAAA,cACEq2B,KAAK,KAAK3f,MAAL,CAAYhV,CAAZ,CADP;;AAFwE,qBAKzD,CAAC20B,GAAGr2B,CAAJ,EAAOo2B,GAAGp2B,CAAV,CALyD;AAKvEo2B,aAAGp2B,CALoE;AAKjEq2B,aAAGr2B,CAL8D;AAOzE;;AAED,eAAO,IAAP;AACD,OAhBD;;AAmBA;AACAN,UAAIi6C,KAAJ,GAAY,YAAW;;AAErB,YAAID,SAASn0C,KAAKkjB,KAAL,CAAW,KAAK/R,MAAL,CAAY1R,MAAZ,GAAqB,CAAhC,CAAb,CAFqB,CAE4B;;AAEjD,YAAIhF,CAAJ,EAAO0B,CAAP;;AAEA,aAAK1B,IAAI,KAAK0W,MAAL,CAAY1R,MAAZ,GAAqB,CAAzB,EAA4BtD,IAAI,CAArC,EAAwC1B,IAAI05C,MAAJ,EAAYh4C,IAAIg4C,MAAxD,EAAgE15C,KAAK0B,GAArE,EAA0E;;AAExE,cAAI00B,KAAK,KAAK1f,MAAL,CAAY1W,CAAZ,CAAT;AAAA,cACEq2B,KAAK,KAAK3f,MAAL,CAAYhV,CAAZ,CADP;;AAFwE,sBAKzD,CAAC20B,GAAG30B,CAAJ,EAAO00B,GAAG10B,CAAV,CALyD;AAKvE00B,aAAG10B,CALoE;AAKjE20B,aAAG30B,CAL8D;AAOzE;;AAED,eAAO,IAAP;AACD,OAhBD;AAkBD;;;+BAEUhC,G,EAAKqH,I,EAAM;AACpBrH,UAAI+H,IAAJ,GAAWhJ,QAAQ0J,MAAR,CAAepB,IAAf,EAAqB,MAArB,EAA6B,cAA7B,CAAX;;AAEArH,UAAI6tC,WAAJ,GAAkB9uC,QAAQ0J,MAAR,CAAepB,IAAf,EAAqB,aAArB,EAAoC,KAApC,CAAlB;;AAEArH,UAAIwJ,KAAJ,GAAYzK,QAAQ0J,MAAR,CAAepB,IAAf,EAAqB,OAArB,EAA8B,KAA9B,CAAZ;AACD;;;8BAESrH,G,EAAK;;AAEbA,UAAIk6C,YAAJ,GAAmBl6C,IAAIk6C,YAAJ,IAAoB,YAAvC;;AAEAl6C,UAAIm6C,aAAJ,GAAoB,UAASx7C,CAAT,EAAY;;AAE9BA,YAAIA,KAAK,aAAT;;AAEA,YAAIy7C,MAAMz7C,EAAE4M,KAAF,CAAQ,GAAR,CAAV;;AAEA;;AAEA,YAAI8uC,KAAKD,IAAI,CAAJ,EAAOtxC,WAAP,EAAT;AAAA,YACEwxC,KAAKF,IAAI,CAAJ,EAAOtxC,WAAP,EADP;;AAGA,YAAI84B,QAAQ1S,MAAM2S,MAAN,CAAa5N,MAAb,CAAoB7L,IAAhC;;AAEApoB,YAAIk6C,YAAJ,GAAmB,aAAnB;;AAEAn7C,gBAAQwI,IAAR,CAAa2nB,MAAM2S,MAAnB,EAA2B,UAASn+B,EAAT,EAAai+B,MAAb,EAAqB;;AAE9C5iC,kBAAQwI,IAAR,CAAa2nB,MAAM2S,MAAN,CAAan+B,EAAb,CAAb,EAA+B,UAASkJ,EAAT,EAAa2tC,QAAb,EAAuB;;AAEpD,gBAAI72C,MAAM22C,EAAN,IAAYztC,MAAM0tC,EAAtB,EAA0B;;AAExB;;AAEA1Y,sBAAQ1S,MAAM2S,MAAN,CAAan+B,EAAb,EAAiBkJ,EAAjB,CAAR;;AAEA5M,kBAAIk6C,YAAJ,GAAmBx2C,KAAK,GAAL,GAAWkJ,EAA9B;AAED;AAEF,WAZD;AAcD,SAhBD;;AAkBA5M,YAAI4hC,KAAJ,GAAYA,KAAZ;;AAEA,eAAOA,KAAP;AAED,OArCD;;AAuCA5hC,UAAIw6C,aAAJ,GAAoB,YAAW;;AAE7B,YAAI77C,IAAI,EAAR;;AAEAI,gBAAQwI,IAAR,CAAa2nB,MAAM2S,MAAnB,EAA2B,UAASn+B,EAAT,EAAai+B,MAAb,EAAqB;;AAE9C5iC,kBAAQwI,IAAR,CAAao6B,MAAb,EAAqB,UAAS/0B,EAAT,EAAa2tC,QAAb,EAAuB;;AAE1C,gBAAI,CAAC,IAAD,EAAO,KAAP,EAAc,OAAd,EAAuB,MAAvB,EAA+BlwC,OAA/B,CAAuCuC,GAAG9D,WAAH,EAAvC,KAA4D,CAAhE,EAAmE;;AAEjEnK,gBAAE2H,IAAF,CAAO5C,KAAK,GAAL,GAAWkJ,EAAlB;AAED;AAEF,WARD;AAUD,SAZD;;AAcA,eAAOjO,CAAP;AAED,OApBD;AAqBD;;;;;;AAEF;;AAEDI,QAAQm5C,gBAAR,CAAyBO,WAAzB,GAAuC,IAAIA,WAAJ,EAAvC;;AAEA15C,QAAQm5C,gBAAR,CAAyBe,eAAzB,GAA2C,IAAIA,eAAJ,EAA3C;;AAEAl6C,QAAQm5C,gBAAR,CAAyBU,aAAzB,GAAyC,IAAIA,aAAJ,EAAzC;AACA,C,CAAC;;;;;;;;;AASD,CAAC,YAAW;;AAEVh6C,UAAQC,GAAR,CAAY,+BAAZ;;AAFU,MAIJ47C,aAJI;AAMR,6BAAc;AAAA;;AACZ,WAAKC,YAAL,GAAoB,KAApB;AACA;AACA,WAAKxtB,IAAL,GAAY,KAAKytB,WAAjB;AACD;;AAVO;AAAA;AAAA,kCAYI;AACV,eAAO57C,QAAQkE,QAAR,IAAoB,KAA3B;AACD;AAdO;AAAA;AAAA,0BAgBJyzB,EAhBI,EAgBAC,EAhBA,EAgBkB;AAAA,YAAdnI,OAAc,uEAAJ,EAAI;;;AAExB,YAAI,KAAKosB,SAAL,EAAJ,EACE;;AAGF,YAAI5vB,MAAMjsB,QAAQ4E,YAAR,CAAqB,CAArB,EAAwBqnB,GAAlC;;AAEAA,YAAIsa,WAAJ,GAAkB9W,QAAQ8W,WAAR,IAAuB,MAAzC;;AAEAta,YAAIua,SAAJ;AACAva,YAAI6vB,GAAJ,CAAQnkB,GAAGp2B,CAAX,EAAco2B,GAAG10B,CAAjB,EAAoB20B,GAAGr2B,CAAvB,EAA0Bq2B,GAAG30B,CAA7B,EAAgC6D,KAAK+Q,EAAL,GAAU,CAA1C,EAA6C,IAA7C;AACAoU,YAAIgb,MAAJ;AAED;AA9BO;AAAA;AAAA,uCAgCS/H,KAhCT,EAgCgB+B,QAhChB,EAgC0BhC,SAhC1B,EAgCqCvnB,QAhCrC,EAgC+C5C,IAhC/C,EAgCqD4iB,QAhCrD,EAgC+DqkB,aAhC/D,EAgC8Epc,KAhC9E,EAgCqF8K,KAhCrF,EAgC4FjL,MAhC5F,EAgCoGwH,WAhCpG,EAgCiHX,eAhCjH,EAgCkI;;AAExI,YAAI,KAAKwV,SAAL,EAAJ,EACE;;AAGF,YAAIvL,KAAKrP,SAAS1/B,CAAlB;AAAA,YACEgvC,KAAKtP,SAASh+B,CADhB;AAAA,YAEE0lC,KAAK1J,UAAU19B,CAFjB;AAAA,YAGEqnC,KAAK3J,UAAUh8B,CAHjB;AAAA,YAIE1B,IAAImW,SAASnW,CAJf;AAAA,YAKE0B,IAAIyU,SAASzU,CALf;AAAA,YAMEqX,QAAQxF,KAAKvT,CANf;AAAA,YAOE8Y,SAASvF,KAAK7R,CAPhB;;AAUA;AACA84C,sBAAczV,IAAd;;AAEA;AACA,YAAI0V,MAAMtkB,QAAV;AACAskB,cAAMA,MAAM,GAAZ;AACA,YAAIC,MAAMD,MAAMl1C,KAAK+Q,EAAX,GAAgB,GAA1B;AACA;AACAkkC,sBAAcG,SAAd,CAAwB36C,CAAxB,EAA2B0B,CAA3B;AACA84C,sBAAcI,MAAd,CAAqBF,GAArB;AACA;;AAEAF,sBAAcG,SAAd,CAAwB,CAAxB,EAA2BH,cAAczhC,KAAzC;;AAEA,YAAIqlB,KAAJ,EAAW;AACToc,wBAAc/iC,KAAd,CAAoB,CAAC,CAArB,EAAwB,CAAxB;AACD,SAFD,MAEO,CAEN;;AAED,YAAIyxB,KAAJ,EAAW;AACTsR,wBAAc/iC,KAAd,CAAoB,CAApB,EAAuB,CAAC,CAAxB;AACD,SAFD,MAEO,CAEN;;AAEDwmB,iBAASA,UAAU,IAAIx/B,QAAQ+U,MAAZ,CAAmBuF,QAAQ,CAA3B,EAA8BD,SAAS,CAAvC,CAAnB;;AAEA0hC,sBAAc/U,WAAd,GAA4BA,eAAe,GAA3C;;AAEA,YAAGX,eAAH,EACA;AACE0V,wBAAchV,wBAAd,GAAyCV,eAAzC;AACD;;AAED;AACA0V,sBAAc9tB,SAAd,CAAwBiR,KAAxB,EAA+BoR,EAA/B,EAAmCC,EAAnC,EAAuC5H,EAAvC,EAA2CC,EAA3C,EAA+CpJ,OAAOj+B,CAAP,GAAY,CAAC,CAA5D,EAAgEi+B,OAAOv8B,CAAP,GAAY,CAAC,CAA7E,EAAiFqX,KAAjF,EAAwFD,MAAxF;AACA;AACA0hC,sBAAc/U,WAAd,GAA4B,GAA5B;AACA+U,sBAAc1U,OAAd;AAED;AAzFO;AAAA;AAAA,gCA2FE9lC,CA3FF,EA2FK0B,CA3FL,EA2FQwpB,CA3FR,EA2FWC,CA3FX,EA2FcxY,IA3Fd,EA2FoB+X,GA3FpB,EA2FyB;;AAE/B,YAAI,KAAK4vB,SAAL,EAAJ,EACE;;AAEF5vB,YAAIokB,YAAJ,CAAiBn8B,IAAjB,EAAuB3S,CAAvB,EAA0B0B,CAA1B,EAA6B,CAA7B,EAAgC,CAAhC,EAAmCwpB,CAAnC,EAAsCC,CAAtC;AAED;AAlGO;;AAAA;AAAA;;AAsGV1sB,UAAQuqC,MAAR,GAAiB,IAAImR,aAAJ,EAAjB;;AAEA17C,UAAQ07C,aAAR,GAAwBA,aAAxB;;AAxGU,MA0GJ/Z,wBA1GI,GA2GR,kCAAYya,WAAZ,EAAyB;AAAA;;AAEvB,SAAKC,SAAL,GAAiBD,YAAYhwB,UAAZ,IAA0BgwB,WAA3C;;AAEA,SAAKE,UAAL,GAAkBj4C,SAASgnB,aAAT,CAAuB,QAAvB,CAAlB;;AAEA,SAAKkZ,OAAL,GAAe,KAAK+X,UAAL,CAAgB7wB,UAAhB,CAA2B,IAA3B,CAAf;;AAEA,SAAK6wB,UAAL,CAAgBhiC,KAAhB,GAAwB,KAAK+hC,SAAL,CAAe/hC,KAAvC;;AAEA,SAAKgiC,UAAL,CAAgBjiC,MAAhB,GAAyB,KAAKgiC,SAAL,CAAehiC,MAAxC;;AAEA,SAAKiiC,UAAL,CAAgBnqC,KAAhB,CAAsBu4B,MAAtB,GAA+B,MAA/B;;AAEA,SAAKnG,OAAL,CAAatW,SAAb,CAAuB,KAAKouB,SAA5B,EAAuC,CAAvC,EAA0C,CAA1C;;AAEA,WAAO;AACLrxB,cAAQ,KAAKsxB,UADR;AAELrwB,WAAK,KAAKsY;AAFL,KAAP;AAKD,GAhIO;;AAkIT;;AAEDvkC,UAAQ2hC,wBAAR,GAAmCA,wBAAnC;AAED,CAtID;AAuIA,CAAC,IAAI,OAAOn2B,KAAKqoC,OAAZ,KAAwB,UAA5B,EAAwC;AACrCroC,OAAKqoC,OAAL,GAAe,SAASA,OAAT,CAAiBtwC,MAAjB,EAAyB;AACpC;;AAEA,QAAI6C,UAAU,EAAd;AAAA,QAAoB;AAChBm2C,YAAQ,EADZ,CAHoC,CAIhB;;AAEpB,WAAQ,SAASC,KAAT,CAAe7pC,KAAf,EAAsB8pC,IAAtB,EAA4B;;AAGhC,UAAIn1C,CAAJ,EAAgB;AACZ0B,UADJ,EACgB;AACZ0zC,QAFJ,CAHgC,CAKhB;;AAEhB,qBAAe/pC,KAAf,yCAAeA,KAAf;AACA,aAAK,QAAL;;AAEI,cAAI,CAACA,KAAL,EAAY;AACR,mBAAO,IAAP;AACH;;AAGD,eAAKrL,IAAI,CAAT,EAAYA,IAAIlB,QAAQG,MAAxB,EAAgCe,KAAK,CAArC,EAAwC;AACpC,gBAAIlB,QAAQkB,CAAR,MAAeqL,KAAnB,EAA0B;AACtB,qBAAO,EAACgqC,MAAMJ,MAAMj1C,CAAN,CAAP,EAAP;AACH;AACJ;;AAEjB;;AAEgBlB,kBAAQmB,IAAR,CAAaoL,KAAb;AACA4pC,gBAAMh1C,IAAN,CAAWk1C,IAAX;;AAEhB;;AAEgB,cAAIx6C,OAAOihC,SAAP,CAAiBl8B,QAAjB,CAA0B+nB,KAA1B,CAAgCpc,KAAhC,MAA2C,gBAA/C,EAAiE;AAC7D+pC,iBAAK,EAAL;AACA,iBAAKp1C,IAAI,CAAT,EAAYA,IAAIqL,MAAMpM,MAAtB,EAA8Be,KAAK,CAAnC,EAAsC;AAClCo1C,iBAAGp1C,CAAH,IAAQk1C,MAAM7pC,MAAMrL,CAAN,CAAN,EAAgBm1C,OAAO,GAAP,GAAan1C,CAAb,GAAiB,GAAjC,CAAR;AACH;AACJ,WALD,MAKO;;AAEvB;;AAEoBo1C,iBAAK,EAAL;AACA,iBAAK1zC,IAAL,IAAa2J,KAAb,EAAoB;AAChB,kBAAI1Q,OAAOihC,SAAP,CAAiBthC,cAAjB,CAAgC2H,IAAhC,CAAqCoJ,KAArC,EAA4C3J,IAA5C,CAAJ,EAAuD;AACnD0zC,mBAAG1zC,IAAH,IAAWwzC,MAAM7pC,MAAM3J,IAAN,CAAN,EACPyzC,OAAO,GAAP,GAAajxC,KAAKC,SAAL,CAAezC,IAAf,CAAb,GAAoC,GAD7B,CAAX;AAEH;AACJ;AACJ;AACD,iBAAO0zC,EAAP;AACJ,aAAK,QAAL;AACA,aAAK,QAAL;AACA,aAAK,SAAL;AACI,iBAAO/pC,KAAP;AA1CJ;AA4CH,KAnDO,CAmDNpP,MAnDM,EAmDE,GAnDF,CAAR;AAoDH,GA1DD;AA2DH;;AAED,IAAI,OAAOiI,KAAKoxC,UAAZ,KAA2B,UAA/B,EAA2C;AACvCpxC,OAAKoxC,UAAL,GAAkB,SAASA,UAAT,CAAoBxoC,CAApB,EAAuB;AACrC;;AAEA,QAAIykC,KACA,sFADJ;;AAGC,cAASgE,GAAT,CAAalqC,KAAb,EAAoB;;AAEjB,UAAIrL,CAAJ,EAAOjC,IAAP,EAAa2D,IAAb,EAAmByzC,IAAnB;;AAEA,UAAI9pC,SAAS,QAAOA,KAAP,yCAAOA,KAAP,OAAiB,QAA9B,EAAwC;AACpC,YAAI1Q,OAAOihC,SAAP,CAAiBl8B,QAAjB,CAA0B+nB,KAA1B,CAAgCpc,KAAhC,MAA2C,gBAA/C,EAAiE;AAC7D,eAAKrL,IAAI,CAAT,EAAYA,IAAIqL,MAAMpM,MAAtB,EAA8Be,KAAK,CAAnC,EAAsC;AAClCjC,mBAAOsN,MAAMrL,CAAN,CAAP;AACA,gBAAIjC,QAAQ,QAAOA,IAAP,yCAAOA,IAAP,OAAgB,QAA5B,EAAsC;AAClCo3C,qBAAOp3C,KAAKs3C,IAAZ;AACA,kBAAI,OAAOF,IAAP,KAAgB,QAAhB,IAA4B5D,GAAGzpC,IAAH,CAAQqtC,IAAR,CAAhC,EAA+C;AAC3C9pC,sBAAMrL,CAAN,IAAWw1C,KAAKL,IAAL,CAAX;AACH,eAFD,MAEO;AACHI,oBAAIx3C,IAAJ;AACH;AACJ;AACJ;AACJ,SAZD,MAYO;AACH,eAAK2D,IAAL,IAAa2J,KAAb,EAAoB;AAChB,gBAAI,QAAOA,MAAM3J,IAAN,CAAP,MAAuB,QAA3B,EAAqC;AACjC3D,qBAAOsN,MAAM3J,IAAN,CAAP;AACA,kBAAI3D,IAAJ,EAAU;AACNo3C,uBAAOp3C,KAAKs3C,IAAZ;AACA,oBAAI,OAAOF,IAAP,KAAgB,QAAhB,IAA4B5D,GAAGzpC,IAAH,CAAQqtC,IAAR,CAAhC,EAA+C;AAC3C9pC,wBAAM3J,IAAN,IAAc8zC,KAAKL,IAAL,CAAd;AACH,iBAFD,MAEO;AACHI,sBAAIx3C,IAAJ;AACH;AACJ;AACJ;AACJ;AACJ;AACJ;AACJ,KAjCA,EAiCC+O,CAjCD,CAAD;AAkCA,WAAOA,CAAP;AACH,GAzCD;AA0CH;;AAED,IAAI2oC,iBAAiBvxC,KAAKC,SAA1B;;AAEAD,KAAKC,SAAL,GAAiB,UAASlI,MAAT,EAAiB5C,IAAjB,EAAuBq8C,IAAvB,EACjB;AACE,MAAIC,eAAezxC,KAAKqoC,OAAL,CAAatwC,MAAb,CAAnB;AACA,SAAOw5C,eAAeE,YAAf,EAA6Bt8C,IAA7B,EAAmCq8C,IAAnC,CAAP;AACD,CAJD;;AAMA,IAAIE,aAAa1xC,KAAK2I,KAAtB;;AAEA3I,KAAK2I,KAAL,GAAa,UAAS5Q,MAAT,EAAiB5C,IAAjB,EAAuBq8C,IAAvB,EAA4B;AACvC,MAAIG,eAAe3xC,KAAKoxC,UAAL,CAAgBr5C,MAAhB,CAAnB;AACA,SAAO25C,WAAWC,YAAX,CAAP;AACD,CAHD;AAIA,C,CAAC;;;;AAKD;;;;;;AAMA,IAAI5sB,QAAQ,SAARA,KAAQ,GAAY;;AAEvB,MAAImmB,OAAO,CAAX;;AAEA,MAAI0G,YAAY/4C,SAASgnB,aAAT,CAAwB,KAAxB,CAAhB;AACA+xB,YAAUjrC,KAAV,CAAgBkrC,OAAhB,GAA0B,sEAA1B;AACAD,YAAU3qC,gBAAV,CAA4B,OAA5B,EAAqC,UAAWrB,KAAX,EAAmB;;AAEvDA,UAAMyB,cAAN;AACA2d,cAAW,EAAGkmB,IAAH,GAAU0G,UAAU9qB,QAAV,CAAmB/rB,MAAxC;AAEA,GALD,EAKG,KALH;;AAOA;;AAEA,WAAS+2C,QAAT,CAAmBC,KAAnB,EAA2B;;AAE1BH,cAAU1sB,WAAV,CAAuB6sB,MAAM9sB,GAA7B;AACA,WAAO8sB,KAAP;AAEA;;AAED,WAAS/sB,SAAT,CAAoBlqB,EAApB,EAAyB;;AAExB,SAAM,IAAIgB,IAAI,CAAd,EAAiBA,IAAI81C,UAAU9qB,QAAV,CAAmB/rB,MAAxC,EAAgDe,GAAhD,EAAuD;;AAEtD81C,gBAAU9qB,QAAV,CAAoBhrB,CAApB,EAAwB6K,KAAxB,CAA8Bqa,OAA9B,GAAwCllB,MAAMhB,EAAN,GAAW,OAAX,GAAqB,MAA7D;AAEA;;AAEDowC,WAAOpwC,EAAP;AAEA;;AAED;;AAEA,MAAIk3C,YAAY,CAAEC,eAAeC,IAAjB,EAAwBC,GAAxB,EAAhB;AAAA,MAA+CC,WAAWJ,SAA1D;AAAA,MAAqE3d,SAAS,CAA9E;;AAEA,MAAIge,WAAWP,SAAU,IAAI/sB,MAAMutB,KAAV,CAAiB,KAAjB,EAAwB,MAAxB,EAAgC,MAAhC,CAAV,CAAf;AACA,MAAIC,UAAUT,SAAU,IAAI/sB,MAAMutB,KAAV,CAAiB,IAAjB,EAAuB,MAAvB,EAA+B,MAA/B,CAAV,CAAd;;AAEA,MAAKE,KAAKP,WAAL,IAAoBO,KAAKP,WAAL,CAAiBQ,MAA1C,EAAmD;;AAElD,QAAIC,WAAWZ,SAAU,IAAI/sB,MAAMutB,KAAV,CAAiB,IAAjB,EAAuB,MAAvB,EAA+B,MAA/B,CAAV,CAAf;AAEA;;AAEDttB,YAAW,CAAX;;AAEA,SAAO;;AAEN2tB,cAAU,EAFJ;;AAIN1tB,SAAK2sB,SAJC;;AAMNE,cAAUA,QANJ;AAON9sB,eAAWA,SAPL;;AASNT,WAAO,iBAAY;;AAElBytB,kBAAY,CAAEC,eAAeC,IAAjB,EAAwBC,GAAxB,EAAZ;AAEA,KAbK;;AAeNrtB,SAAK,eAAY;;AAEhBuP;;AAEA,UAAIrQ,OAAO,CAAEiuB,eAAeC,IAAjB,EAAwBC,GAAxB,EAAX;;AAEAI,cAAQ/vC,MAAR,CAAgBwhB,OAAOguB,SAAvB,EAAkC,GAAlC;;AAEA,UAAKhuB,QAAQouB,WAAW,IAAxB,EAA+B;;AAE9BC,iBAAS7vC,MAAT,CAAmB6xB,SAAS,IAAX,IAAsBrQ,OAAOouB,QAA7B,CAAjB,EAA0D,GAA1D;;AAEAA,mBAAWpuB,IAAX;AACAqQ,iBAAS,CAAT;;AAEA,YAAKqe,QAAL,EAAgB;;AAEf,cAAID,SAASR,YAAYQ,MAAzB;AACAC,mBAASlwC,MAAT,CAAiBiwC,OAAOG,cAAP,GAAwB,OAAzC,EAAkDH,OAAOI,eAAP,GAAyB,OAA3E;AAEA;AAED;;AAED,aAAO7uB,IAAP;AAEA,KAzCK;;AA2CNxhB,YAAQ,kBAAY;;AAEnBwvC,kBAAY,KAAKltB,GAAL,EAAZ;AAEA,KA/CK;;AAiDN;;AAEAlE,gBAAYgxB,SAnDN;AAoDNkB,aAAS9tB;;AApDH,GAAP;AAwDA,CAzGD;;AA2GAD,MAAMutB,KAAN,GAAc,UAAW90C,IAAX,EAAiBu1C,EAAjB,EAAqBC,EAArB,EAA0B;;AAEvC,MAAIl+C,MAAMoqB,QAAV;AAAA,MAAoBnqB,MAAM,CAA1B;AAAA,MAA6B0U,QAAQnO,KAAKmO,KAA1C;AACA,MAAIwpC,KAAKxpC,MAAOlE,OAAO2tC,gBAAP,IAA2B,CAAlC,CAAT;;AAEA,MAAIt6C,QAAQ,KAAKq6C,EAAjB;AAAA,MAAqBj6C,SAAS,KAAKi6C,EAAnC;AAAA,MACEE,SAAS,IAAIF,EADf;AAAA,MACmBG,SAAS,IAAIH,EADhC;AAAA,MAEEI,UAAU,IAAIJ,EAFhB;AAAA,MAEoBK,UAAU,KAAKL,EAFnC;AAAA,MAGEM,cAAc,KAAKN,EAHrB;AAAA,MAGyBO,eAAe,KAAKP,EAH7C;;AAKA,MAAIzzB,SAAS3mB,SAASgnB,aAAT,CAAwB,QAAxB,CAAb;AACAL,SAAO1Q,KAAP,GAAelW,KAAf;AACA4mB,SAAO3Q,MAAP,GAAgB7V,MAAhB;AACAwmB,SAAO7Y,KAAP,CAAakrC,OAAb,GAAuB,wBAAvB;;AAEA,MAAI7xB,UAAUR,OAAOS,UAAP,CAAmB,IAAnB,CAAd;AACAD,UAAQmpB,IAAR,GAAe,UAAY,IAAI8J,EAAhB,GAAuB,+BAAtC;AACAjzB,UAAQyzB,YAAR,GAAuB,KAAvB;;AAEAzzB,UAAQ0b,SAAR,GAAoBsX,EAApB;AACAhzB,UAAQuiB,QAAR,CAAkB,CAAlB,EAAqB,CAArB,EAAwB3pC,KAAxB,EAA+BI,MAA/B;;AAEAgnB,UAAQ0b,SAAR,GAAoBqX,EAApB;AACA/yB,UAAQupB,QAAR,CAAkB/rC,IAAlB,EAAwB21C,MAAxB,EAAgCC,MAAhC;AACApzB,UAAQuiB,QAAR,CAAkB8Q,OAAlB,EAA2BC,OAA3B,EAAoCC,WAApC,EAAiDC,YAAjD;;AAEAxzB,UAAQ0b,SAAR,GAAoBsX,EAApB;AACAhzB,UAAQwb,WAAR,GAAsB,GAAtB;AACAxb,UAAQuiB,QAAR,CAAkB8Q,OAAlB,EAA2BC,OAA3B,EAAoCC,WAApC,EAAiDC,YAAjD;;AAEA,SAAO;;AAENvuB,SAAKzF,MAFC;;AAINhd,YAAQ,gBAAW2E,KAAX,EAAkBusC,QAAlB,EAA6B;;AAEpC5+C,YAAMwG,KAAKxG,GAAL,CAAUA,GAAV,EAAeqS,KAAf,CAAN;AACApS,YAAMuG,KAAKvG,GAAL,CAAUA,GAAV,EAAeoS,KAAf,CAAN;;AAEA6Y,cAAQ0b,SAAR,GAAoBsX,EAApB;AACAhzB,cAAQwb,WAAR,GAAsB,CAAtB;AACAxb,cAAQuiB,QAAR,CAAkB,CAAlB,EAAqB,CAArB,EAAwB3pC,KAAxB,EAA+B06C,OAA/B;AACAtzB,cAAQ0b,SAAR,GAAoBqX,EAApB;AACA/yB,cAAQupB,QAAR,CAAkB9/B,MAAOtC,KAAP,IAAiB,GAAjB,GAAuB3J,IAAvB,GAA8B,IAA9B,GAAqCiM,MAAO3U,GAAP,CAArC,GAAoD,GAApD,GAA0D2U,MAAO1U,GAAP,CAA1D,GAAyE,GAA3F,EAAgGo+C,MAAhG,EAAwGC,MAAxG;;AAEApzB,cAAQyC,SAAR,CAAmBjD,MAAnB,EAA2B6zB,UAAUJ,EAArC,EAAyCK,OAAzC,EAAkDC,cAAcN,EAAhE,EAAoEO,YAApE,EAAkFH,OAAlF,EAA2FC,OAA3F,EAAoGC,cAAcN,EAAlH,EAAsHO,YAAtH;;AAEAxzB,cAAQuiB,QAAR,CAAkB8Q,UAAUE,WAAV,GAAwBN,EAA1C,EAA8CK,OAA9C,EAAuDL,EAAvD,EAA2DO,YAA3D;;AAEAxzB,cAAQ0b,SAAR,GAAoBsX,EAApB;AACAhzB,cAAQwb,WAAR,GAAsB,GAAtB;AACAxb,cAAQuiB,QAAR,CAAkB8Q,UAAUE,WAAV,GAAwBN,EAA1C,EAA8CK,OAA9C,EAAuDL,EAAvD,EAA2DxpC,MAAO,CAAE,IAAMtC,QAAQusC,QAAhB,IAA+BF,YAAtC,CAA3D;AAEA;;AAvBK,GAAP;AA2BA,CAzDD;AA0DA,C,CAAC;;;;;;;;;AAUD;;;;;;AAMA,IAAI7uB,QAAQA,SAAU,YAAY;;AAEjC,MAAIgvB,UAAU,EAAd;;AAEA,SAAO;;AAENC,YAAQ,kBAAY;;AAEnB,aAAOD,OAAP;AAEA,KANK;;AAQNE,eAAW,qBAAY;;AAEtBF,gBAAU,EAAV;AAEA,KAZK;;AAcN1qC,SAAK,aAAUiuB,KAAV,EAAiB;;AAErByc,cAAQ53C,IAAR,CAAam7B,KAAb;AAEA,KAlBK;;AAoBNrT,YAAQ,gBAAUqT,KAAV,EAAiB;;AAExB,UAAIp7B,IAAI63C,QAAQ7zC,OAAR,CAAgBo3B,KAAhB,CAAR;;AAEA,UAAIp7B,MAAM,CAAC,CAAX,EAAc;AACb63C,gBAAQjwB,MAAR,CAAe5nB,CAAf,EAAkB,CAAlB;AACA;AAED,KA5BK;;AA8BN0G,YAAQ,gBAAUwhB,IAAV,EAAgB8vB,QAAhB,EAA0B;;AAEjC,UAAIH,QAAQ54C,MAAR,KAAmB,CAAvB,EAA0B;AACzB,eAAO,KAAP;AACA;;AAED,UAAIe,IAAI,CAAR;;AAEAkoB,aAAOA,SAAS9G,SAAT,GAAqB8G,IAArB,GAA4BW,MAAMwtB,GAAN,EAAnC;;AAEA,aAAOr2C,IAAI63C,QAAQ54C,MAAnB,EAA2B;;AAE1B,YAAI44C,QAAQ73C,CAAR,EAAW0G,MAAX,CAAkBwhB,IAAlB,KAA2B8vB,QAA/B,EAAyC;AACxCh4C;AACA,SAFD,MAEO;AACN63C,kBAAQjwB,MAAR,CAAe5nB,CAAf,EAAkB,CAAlB;AACA;AAED;;AAED,aAAO,IAAP;AAEA;AApDK,GAAP;AAuDA,CA3DoB,EAArB;;AA6DA;;AAEA6oB,MAAMwtB,GAAN,GAAYD,KAAKC,GAAjB;;AAEAxtB,MAAMwS,KAAN,GAAc,UAAUp/B,MAAV,EAAkB;;AAE/B,MAAIg8C,UAAUh8C,MAAd;AACA,MAAIi8C,eAAe,EAAnB;AACA,MAAIC,aAAa,EAAjB;AACA,MAAIC,qBAAqB,EAAzB;AACA,MAAIC,YAAY,IAAhB;AACA,MAAIC,UAAU,CAAd;AACA,MAAIC,gBAAJ;AACA,MAAIC,QAAQ,KAAZ;AACA,MAAIC,aAAa,KAAjB;AACA,MAAIC,YAAY,KAAhB;AACA,MAAIC,aAAa,CAAjB;AACA,MAAIC,aAAa,IAAjB;AACA,MAAIC,kBAAkBhwB,MAAM2S,MAAN,CAAa5N,MAAb,CAAoB7L,IAA1C;AACA,MAAI+2B,yBAAyBjwB,MAAMkwB,aAAN,CAAoBnrB,MAAjD;AACA,MAAIorB,iBAAiB,EAArB;AACA,MAAIC,mBAAmB,IAAvB;AACA,MAAIC,wBAAwB,KAA5B;AACA,MAAIC,oBAAoB,IAAxB;AACA,MAAIC,sBAAsB,IAA1B;AACA,MAAIC,kBAAkB,IAAtB;;AAEA;AACA,OAAK,IAAIC,KAAT,IAAkBr9C,MAAlB,EAA0B;AACzBi8C,iBAAaoB,KAAb,IAAsBryC,WAAWhL,OAAOq9C,KAAP,CAAX,EAA0B,EAA1B,CAAtB;AACA;;AAED,OAAK7d,EAAL,GAAU,UAAU8d,UAAV,EAAsBp4B,QAAtB,EAAgC;;AAEzC,QAAIA,aAAaC,SAAjB,EAA4B;AAC3Bi3B,kBAAYl3B,QAAZ;AACA;;AAEDg3B,iBAAaoB,UAAb;;AAEA,WAAO,IAAP;AAEA,GAVD;;AAYA,OAAKlxB,KAAL,GAAa,UAAUH,IAAV,EAAgB;;AAE5BW,UAAM1b,GAAN,CAAU,IAAV;;AAEAsrC,iBAAa,IAAb;;AAEAS,4BAAwB,KAAxB;;AAEAN,iBAAa1wB,SAAS9G,SAAT,GAAqB8G,IAArB,GAA4BW,MAAMwtB,GAAN,EAAzC;AACAuC,kBAAcD,UAAd;;AAEA,SAAK,IAAIx+C,QAAT,IAAqBg+C,UAArB,EAAiC;;AAEhC;AACA,UAAIA,WAAWh+C,QAAX,aAAgCP,KAApC,EAA2C;;AAE1C,YAAIu+C,WAAWh+C,QAAX,EAAqB8E,MAArB,KAAgC,CAApC,EAAuC;AACtC;AACA;;AAED;AACAk5C,mBAAWh+C,QAAX,IAAuB,CAAC89C,QAAQ99C,QAAR,CAAD,EAAoB6D,MAApB,CAA2Bm6C,WAAWh+C,QAAX,CAA3B,CAAvB;AAEA;;AAED;AACA;AACA,UAAI89C,QAAQ99C,QAAR,MAAsBinB,SAA1B,EAAqC;AACpC;AACA;;AAED82B,mBAAa/9C,QAAb,IAAyB89C,QAAQ99C,QAAR,CAAzB;;AAEA,UAAK+9C,aAAa/9C,QAAb,aAAkCP,KAAnC,KAA8C,KAAlD,EAAyD;AACxDs+C,qBAAa/9C,QAAb,KAA0B,GAA1B,CADwD,CACzB;AAC/B;;AAEDi+C,yBAAmBj+C,QAAnB,IAA+B+9C,aAAa/9C,QAAb,KAA0B,CAAzD;AAEA;;AAED,WAAO,IAAP;AAEA,GA3CD;;AA6CA,OAAKq/C,IAAL,GAAY,YAAY;;AAEvB,QAAI,CAACf,UAAL,EAAiB;AAChB,aAAO,IAAP;AACA;;AAED5vB,UAAMd,MAAN,CAAa,IAAb;AACA0wB,iBAAa,KAAb;;AAEA,QAAIY,oBAAoB,IAAxB,EAA8B;AAC7BA,sBAAgBp3C,IAAhB,CAAqBg2C,OAArB,EAA8BA,OAA9B;AACA;;AAED,SAAKwB,iBAAL;AACA,WAAO,IAAP;AAEA,GAhBD;;AAkBA,OAAKzwB,GAAL,GAAW,YAAY;;AAEtB,SAAKtiB,MAAL,CAAYkyC,aAAaP,SAAzB;AACA,WAAO,IAAP;AAEA,GALD;;AAOA,OAAKoB,iBAAL,GAAyB,YAAY;;AAEpC,SAAK,IAAIz5C,IAAI,CAAR,EAAW05C,mBAAmBV,eAAe/5C,MAAlD,EAA0De,IAAI05C,gBAA9D,EAAgF15C,GAAhF,EAAqF;AACpFg5C,qBAAeh5C,CAAf,EAAkBw5C,IAAlB;AACA;AAED,GAND;;AAQA,OAAK3hD,KAAL,GAAa,UAAU8hD,MAAV,EAAkB;;AAE9BhB,iBAAagB,MAAb;AACA,WAAO,IAAP;AAEA,GALD;;AAOA,OAAK1hD,MAAL,GAAc,UAAU2hD,KAAV,EAAiB;;AAE9BtB,cAAUsB,KAAV;AACA,WAAO,IAAP;AAEA,GALD;;AAOA,OAAKC,WAAL,GAAmB,UAAUF,MAAV,EAAkB;;AAEpCpB,uBAAmBoB,MAAnB;AACA,WAAO,IAAP;AAEA,GALD;;AAOA,OAAKG,IAAL,GAAY,UAAUA,IAAV,EAAgB;;AAE3BtB,YAAQsB,IAAR;AACA,WAAO,IAAP;AAEA,GALD;;AAQA,OAAKxe,MAAL,GAAc,UAAUA,MAAV,EAAkB;;AAE/Bud,sBAAkBvd,MAAlB;AACA,WAAO,IAAP;AAEA,GALD;;AAOA,OAAKye,aAAL,GAAqB,UAAUA,aAAV,EAAyB;;AAE7CjB,6BAAyBiB,aAAzB;AACA,WAAO,IAAP;AAEA,GALD;;AAOA,OAAKC,KAAL,GAAa,YAAY;;AAExBhB,qBAAiBtT,SAAjB;AACA,WAAO,IAAP;AAEA,GALD;;AAOA,OAAKuU,OAAL,GAAe,UAAU17C,QAAV,EAAoB;;AAElC06C,uBAAmB16C,QAAnB;AACA,WAAO,IAAP;AAEA,GALD;;AAOA,OAAKkI,QAAL,GAAgB,UAAUlI,QAAV,EAAoB;;AAEnC46C,wBAAoB56C,QAApB;AACA,WAAO,IAAP;AAEA,GALD;;AAOA,OAAKuC,UAAL,GAAkB,UAAUvC,QAAV,EAAoB;;AAErC66C,0BAAsB76C,QAAtB;AACA,WAAO,IAAP;AAEA,GALD;;AAOA,OAAK27C,MAAL,GAAc,UAAU37C,QAAV,EAAoB;;AAEjC86C,sBAAkB96C,QAAlB;AACA,WAAO,IAAP;AAEA,GALD;;AAOA,OAAKmI,MAAL,GAAc,UAAUwhB,IAAV,EAAgB;;AAE7B,QAAI/tB,QAAJ;AACA,QAAIggD,OAAJ;AACA,QAAI9uC,KAAJ;;AAEA,QAAI6c,OAAO0wB,UAAX,EAAuB;AACtB,aAAO,IAAP;AACA;;AAED,QAAIM,0BAA0B,KAA9B,EAAqC;;AAEpC,UAAID,qBAAqB,IAAzB,EAA+B;AAC9BA,yBAAiBh3C,IAAjB,CAAsBg2C,OAAtB,EAA+BA,OAA/B;AACA;;AAEDiB,8BAAwB,IAAxB;AACA;;AAEDiB,cAAU,CAACjyB,OAAO0wB,UAAR,IAAsBP,SAAhC;AACA8B,cAAUA,UAAU,CAAV,GAAc,CAAd,GAAkBA,OAA5B;;AAEA9uC,YAAQwtC,gBAAgBsB,OAAhB,CAAR;;AAEA,SAAKhgD,QAAL,IAAiBg+C,UAAjB,EAA6B;;AAE5B;AACA,UAAID,aAAa/9C,QAAb,MAA2BinB,SAA/B,EAA0C;AACzC;AACA;;AAED,UAAIiH,QAAQ6vB,aAAa/9C,QAAb,KAA0B,CAAtC;AACA,UAAI6uB,MAAMmvB,WAAWh+C,QAAX,CAAV;;AAEA,UAAI6uB,eAAepvB,KAAnB,EAA0B;;AAEzBq+C,gBAAQ99C,QAAR,IAAoB2+C,uBAAuB9vB,GAAvB,EAA4B3d,KAA5B,CAApB;AAEA,OAJD,MAIO;;AAEN;AACA,YAAI,OAAQ2d,GAAR,KAAiB,QAArB,EAA+B;;AAE9B,cAAIA,IAAIoxB,MAAJ,CAAW,CAAX,MAAkB,GAAlB,IAAyBpxB,IAAIoxB,MAAJ,CAAW,CAAX,MAAkB,GAA/C,EAAoD;AACnDpxB,kBAAMX,QAAQphB,WAAW+hB,GAAX,EAAgB,EAAhB,CAAd;AACA,WAFD,MAEO;AACNA,kBAAM/hB,WAAW+hB,GAAX,EAAgB,EAAhB,CAAN;AACA;AACD;;AAED;AACA,YAAI,OAAQA,GAAR,KAAiB,QAArB,EAA+B;AAC9BivB,kBAAQ99C,QAAR,IAAoBkuB,QAAQ,CAACW,MAAMX,KAAP,IAAgBhd,KAA5C;AACA;AAED;AAED;;AAED,QAAI8tC,sBAAsB,IAA1B,EAAgC;AAC/BA,wBAAkBl3C,IAAlB,CAAuBg2C,OAAvB,EAAgC5sC,KAAhC;AACA;;AAED,QAAI8uC,YAAY,CAAhB,EAAmB;;AAElB,UAAI7B,UAAU,CAAd,EAAiB;;AAEhB,YAAI+B,SAAS/B,OAAT,CAAJ,EAAuB;AACtBA;AACA;;AAED;AACA,aAAKn+C,QAAL,IAAiBi+C,kBAAjB,EAAqC;;AAEpC,cAAI,OAAQD,WAAWh+C,QAAX,CAAR,KAAkC,QAAtC,EAAgD;AAC/Ci+C,+BAAmBj+C,QAAnB,IAA+Bi+C,mBAAmBj+C,QAAnB,IAA+B8M,WAAWkxC,WAAWh+C,QAAX,CAAX,EAAiC,EAAjC,CAA9D;AACA;;AAED,cAAIq+C,KAAJ,EAAW;AACV,gBAAI8B,MAAMlC,mBAAmBj+C,QAAnB,CAAV;;AAEAi+C,+BAAmBj+C,QAAnB,IAA+Bg+C,WAAWh+C,QAAX,CAA/B;AACAg+C,uBAAWh+C,QAAX,IAAuBmgD,GAAvB;AACA;;AAEDpC,uBAAa/9C,QAAb,IAAyBi+C,mBAAmBj+C,QAAnB,CAAzB;AAEA;;AAED,YAAIq+C,KAAJ,EAAW;AACVE,sBAAY,CAACA,SAAb;AACA;;AAED,YAAIH,qBAAqBn3B,SAAzB,EAAoC;AACnCw3B,uBAAa1wB,OAAOqwB,gBAApB;AACA,SAFD,MAEO;AACNK,uBAAa1wB,OAAOywB,UAApB;AACA;;AAED,eAAO,IAAP;AAEA,OApCD,MAoCO;;AAEN,YAAIS,wBAAwB,IAA5B,EAAkC;;AAEjCA,8BAAoBn3C,IAApB,CAAyBg2C,OAAzB,EAAkCA,OAAlC;AACA;;AAED,aAAK,IAAIj4C,IAAI,CAAR,EAAW05C,mBAAmBV,eAAe/5C,MAAlD,EAA0De,IAAI05C,gBAA9D,EAAgF15C,GAAhF,EAAqF;AACpF;AACA;AACAg5C,yBAAeh5C,CAAf,EAAkBqoB,KAAlB,CAAwBuwB,aAAaP,SAArC;AACA;;AAED,eAAO,KAAP;AAEA;AAED;;AAED,WAAO,IAAP;AAEA,GA1HD;AA4HA,CAhUD;;AAmUAxvB,MAAM2S,MAAN,GAAe;;AAEd5N,UAAQ;;AAEP7L,UAAM,cAAU1f,CAAV,EAAa;;AAElB,aAAOA,CAAP;AAEA;;AANM,GAFM;;AAYdwrB,aAAW;;AAEV7L,QAAI,YAAU3f,CAAV,EAAa;;AAEhB,aAAOA,IAAIA,CAAX;AAEA,KANS;;AAQVyrB,SAAK,aAAUzrB,CAAV,EAAa;;AAEjB,aAAOA,KAAK,IAAIA,CAAT,CAAP;AAEA,KAZS;;AAcV2e,WAAO,eAAU3e,CAAV,EAAa;;AAEnB,UAAI,CAACA,KAAK,CAAN,IAAW,CAAf,EAAkB;AACjB,eAAO,MAAMA,CAAN,GAAUA,CAAjB;AACA;;AAED,aAAO,CAAE,GAAF,IAAS,EAAEA,CAAF,IAAOA,IAAI,CAAX,IAAgB,CAAzB,CAAP;AAEA;;AAtBS,GAZG;;AAsCd2rB,SAAO;;AAENhM,QAAI,YAAU3f,CAAV,EAAa;;AAEhB,aAAOA,IAAIA,CAAJ,GAAQA,CAAf;AAEA,KANK;;AAQNyrB,SAAK,aAAUzrB,CAAV,EAAa;;AAEjB,aAAO,EAAEA,CAAF,GAAMA,CAAN,GAAUA,CAAV,GAAc,CAArB;AAEA,KAZK;;AAcN2e,WAAO,eAAU3e,CAAV,EAAa;;AAEnB,UAAI,CAACA,KAAK,CAAN,IAAW,CAAf,EAAkB;AACjB,eAAO,MAAMA,CAAN,GAAUA,CAAV,GAAcA,CAArB;AACA;;AAED,aAAO,OAAO,CAACA,KAAK,CAAN,IAAWA,CAAX,GAAeA,CAAf,GAAmB,CAA1B,CAAP;AAEA;;AAtBK,GAtCO;;AAgEd4rB,WAAS;;AAERjM,QAAI,YAAU3f,CAAV,EAAa;;AAEhB,aAAOA,IAAIA,CAAJ,GAAQA,CAAR,GAAYA,CAAnB;AAEA,KANO;;AAQRyrB,SAAK,aAAUzrB,CAAV,EAAa;;AAEjB,aAAO,IAAK,EAAEA,CAAF,GAAMA,CAAN,GAAUA,CAAV,GAAcA,CAA1B;AAEA,KAZO;;AAcR2e,WAAO,eAAU3e,CAAV,EAAa;;AAEnB,UAAI,CAACA,KAAK,CAAN,IAAW,CAAf,EAAkB;AACjB,eAAO,MAAMA,CAAN,GAAUA,CAAV,GAAcA,CAAd,GAAkBA,CAAzB;AACA;;AAED,aAAO,CAAE,GAAF,IAAS,CAACA,KAAK,CAAN,IAAWA,CAAX,GAAeA,CAAf,GAAmBA,CAAnB,GAAuB,CAAhC,CAAP;AAEA;;AAtBO,GAhEK;;AA0Fd6rB,WAAS;;AAERlM,QAAI,YAAU3f,CAAV,EAAa;;AAEhB,aAAOA,IAAIA,CAAJ,GAAQA,CAAR,GAAYA,CAAZ,GAAgBA,CAAvB;AAEA,KANO;;AAQRyrB,SAAK,aAAUzrB,CAAV,EAAa;;AAEjB,aAAO,EAAEA,CAAF,GAAMA,CAAN,GAAUA,CAAV,GAAcA,CAAd,GAAkBA,CAAlB,GAAsB,CAA7B;AAEA,KAZO;;AAcR2e,WAAO,eAAU3e,CAAV,EAAa;;AAEnB,UAAI,CAACA,KAAK,CAAN,IAAW,CAAf,EAAkB;AACjB,eAAO,MAAMA,CAAN,GAAUA,CAAV,GAAcA,CAAd,GAAkBA,CAAlB,GAAsBA,CAA7B;AACA;;AAED,aAAO,OAAO,CAACA,KAAK,CAAN,IAAWA,CAAX,GAAeA,CAAf,GAAmBA,CAAnB,GAAuBA,CAAvB,GAA2B,CAAlC,CAAP;AAEA;;AAtBO,GA1FK;;AAoHdk4C,cAAY;;AAEXv4B,QAAI,YAAU3f,CAAV,EAAa;;AAEhB,aAAO,IAAI7C,KAAKqR,GAAL,CAASxO,IAAI7C,KAAK+Q,EAAT,GAAc,CAAvB,CAAX;AAEA,KANU;;AAQXud,SAAK,aAAUzrB,CAAV,EAAa;;AAEjB,aAAO7C,KAAKsR,GAAL,CAASzO,IAAI7C,KAAK+Q,EAAT,GAAc,CAAvB,CAAP;AAEA,KAZU;;AAcXyQ,WAAO,eAAU3e,CAAV,EAAa;;AAEnB,aAAO,OAAO,IAAI7C,KAAKqR,GAAL,CAASrR,KAAK+Q,EAAL,GAAUlO,CAAnB,CAAX,CAAP;AAEA;;AAlBU,GApHE;;AA0IdgsB,eAAa;;AAEZrM,QAAI,YAAU3f,CAAV,EAAa;;AAEhB,aAAOA,MAAM,CAAN,GAAU,CAAV,GAAc7C,KAAK0U,GAAL,CAAS,IAAT,EAAe7R,IAAI,CAAnB,CAArB;AAEA,KANW;;AAQZyrB,SAAK,aAAUzrB,CAAV,EAAa;;AAEjB,aAAOA,MAAM,CAAN,GAAU,CAAV,GAAc,IAAI7C,KAAK0U,GAAL,CAAS,CAAT,EAAY,CAAE,EAAF,GAAO7R,CAAnB,CAAzB;AAEA,KAZW;;AAcZ2e,WAAO,eAAU3e,CAAV,EAAa;;AAEnB,UAAIA,MAAM,CAAV,EAAa;AACZ,eAAO,CAAP;AACA;;AAED,UAAIA,MAAM,CAAV,EAAa;AACZ,eAAO,CAAP;AACA;;AAED,UAAI,CAACA,KAAK,CAAN,IAAW,CAAf,EAAkB;AACjB,eAAO,MAAM7C,KAAK0U,GAAL,CAAS,IAAT,EAAe7R,IAAI,CAAnB,CAAb;AACA;;AAED,aAAO,OAAO,CAAE7C,KAAK0U,GAAL,CAAS,CAAT,EAAY,CAAE,EAAF,IAAQ7R,IAAI,CAAZ,CAAZ,CAAF,GAAgC,CAAvC,CAAP;AAEA;;AA9BW,GA1IC;;AA4Kdm4C,YAAU;;AAETx4B,QAAI,YAAU3f,CAAV,EAAa;;AAEhB,aAAO,IAAI7C,KAAKwR,IAAL,CAAU,IAAI3O,IAAIA,CAAlB,CAAX;AAEA,KANQ;;AAQTyrB,SAAK,aAAUzrB,CAAV,EAAa;;AAEjB,aAAO7C,KAAKwR,IAAL,CAAU,IAAK,EAAE3O,CAAF,GAAMA,CAArB,CAAP;AAEA,KAZQ;;AAcT2e,WAAO,eAAU3e,CAAV,EAAa;;AAEnB,UAAI,CAACA,KAAK,CAAN,IAAW,CAAf,EAAkB;AACjB,eAAO,CAAE,GAAF,IAAS7C,KAAKwR,IAAL,CAAU,IAAI3O,IAAIA,CAAlB,IAAuB,CAAhC,CAAP;AACA;;AAED,aAAO,OAAO7C,KAAKwR,IAAL,CAAU,IAAI,CAAC3O,KAAK,CAAN,IAAWA,CAAzB,IAA8B,CAArC,CAAP;AAEA;;AAtBQ,GA5KI;;AAsMdo4C,WAAS;;AAERz4B,QAAI,YAAU3f,CAAV,EAAa;;AAEhB,UAAIA,MAAM,CAAV,EAAa;AACZ,eAAO,CAAP;AACA;;AAED,UAAIA,MAAM,CAAV,EAAa;AACZ,eAAO,CAAP;AACA;;AAED,aAAO,CAAC7C,KAAK0U,GAAL,CAAS,CAAT,EAAY,MAAM7R,IAAI,CAAV,CAAZ,CAAD,GAA6B7C,KAAKsR,GAAL,CAAS,CAACzO,IAAI,GAAL,IAAY,CAAZ,GAAgB7C,KAAK+Q,EAA9B,CAApC;AAEA,KAdO;;AAgBRud,SAAK,aAAUzrB,CAAV,EAAa;;AAEjB,UAAIA,MAAM,CAAV,EAAa;AACZ,eAAO,CAAP;AACA;;AAED,UAAIA,MAAM,CAAV,EAAa;AACZ,eAAO,CAAP;AACA;;AAED,aAAO7C,KAAK0U,GAAL,CAAS,CAAT,EAAY,CAAC,EAAD,GAAM7R,CAAlB,IAAuB7C,KAAKsR,GAAL,CAAS,CAACzO,IAAI,GAAL,IAAY,CAAZ,GAAgB7C,KAAK+Q,EAA9B,CAAvB,GAA2D,CAAlE;AAEA,KA5BO;;AA8BRyQ,WAAO,eAAU3e,CAAV,EAAa;;AAEnB,UAAIA,MAAM,CAAV,EAAa;AACZ,eAAO,CAAP;AACA;;AAED,UAAIA,MAAM,CAAV,EAAa;AACZ,eAAO,CAAP;AACA;;AAEDA,WAAK,CAAL;;AAEA,UAAIA,IAAI,CAAR,EAAW;AACV,eAAO,CAAC,GAAD,GAAO7C,KAAK0U,GAAL,CAAS,CAAT,EAAY,MAAM7R,IAAI,CAAV,CAAZ,CAAP,GAAmC7C,KAAKsR,GAAL,CAAS,CAACzO,IAAI,GAAL,IAAY,CAAZ,GAAgB7C,KAAK+Q,EAA9B,CAA1C;AACA;;AAED,aAAO,MAAM/Q,KAAK0U,GAAL,CAAS,CAAT,EAAY,CAAC,EAAD,IAAO7R,IAAI,CAAX,CAAZ,CAAN,GAAmC7C,KAAKsR,GAAL,CAAS,CAACzO,IAAI,GAAL,IAAY,CAAZ,GAAgB7C,KAAK+Q,EAA9B,CAAnC,GAAuE,CAA9E;AAEA;;AAhDO,GAtMK;;AA0PdmqC,QAAM;;AAEL14B,QAAI,YAAU3f,CAAV,EAAa;;AAEhB,UAAIiC,IAAI,OAAR;;AAEA,aAAOjC,IAAIA,CAAJ,IAAS,CAACiC,IAAI,CAAL,IAAUjC,CAAV,GAAciC,CAAvB,CAAP;AAEA,KARI;;AAULwpB,SAAK,aAAUzrB,CAAV,EAAa;;AAEjB,UAAIiC,IAAI,OAAR;;AAEA,aAAO,EAAEjC,CAAF,GAAMA,CAAN,IAAW,CAACiC,IAAI,CAAL,IAAUjC,CAAV,GAAciC,CAAzB,IAA8B,CAArC;AAEA,KAhBI;;AAkBL0c,WAAO,eAAU3e,CAAV,EAAa;;AAEnB,UAAIiC,IAAI,UAAU,KAAlB;;AAEA,UAAI,CAACjC,KAAK,CAAN,IAAW,CAAf,EAAkB;AACjB,eAAO,OAAOA,IAAIA,CAAJ,IAAS,CAACiC,IAAI,CAAL,IAAUjC,CAAV,GAAciC,CAAvB,CAAP,CAAP;AACA;;AAED,aAAO,OAAO,CAACjC,KAAK,CAAN,IAAWA,CAAX,IAAgB,CAACiC,IAAI,CAAL,IAAUjC,CAAV,GAAciC,CAA9B,IAAmC,CAA1C,CAAP;AAEA;;AA5BI,GA1PQ;;AA0Rdq2C,UAAQ;;AAEP34B,QAAI,YAAU3f,CAAV,EAAa;;AAEhB,aAAO,IAAIwmB,MAAM2S,MAAN,CAAamf,MAAb,CAAoB7sB,GAApB,CAAwB,IAAIzrB,CAA5B,CAAX;AAEA,KANM;;AAQPyrB,SAAK,aAAUzrB,CAAV,EAAa;;AAEjB,UAAIA,IAAK,IAAI,IAAb,EAAoB;AACnB,eAAO,SAASA,CAAT,GAAaA,CAApB;AACA,OAFD,MAEO,IAAIA,IAAK,IAAI,IAAb,EAAoB;AAC1B,eAAO,UAAUA,KAAM,MAAM,IAAtB,IAA+BA,CAA/B,GAAmC,IAA1C;AACA,OAFM,MAEA,IAAIA,IAAK,MAAM,IAAf,EAAsB;AAC5B,eAAO,UAAUA,KAAM,OAAO,IAAvB,IAAgCA,CAAhC,GAAoC,MAA3C;AACA,OAFM,MAEA;AACN,eAAO,UAAUA,KAAM,QAAQ,IAAxB,IAAiCA,CAAjC,GAAqC,QAA5C;AACA;AAED,KApBM;;AAsBP2e,WAAO,eAAU3e,CAAV,EAAa;;AAEnB,UAAIA,IAAI,GAAR,EAAa;AACZ,eAAOwmB,MAAM2S,MAAN,CAAamf,MAAb,CAAoB34B,EAApB,CAAuB3f,IAAI,CAA3B,IAAgC,GAAvC;AACA;;AAED,aAAOwmB,MAAM2S,MAAN,CAAamf,MAAb,CAAoB7sB,GAApB,CAAwBzrB,IAAI,CAAJ,GAAQ,CAAhC,IAAqC,GAArC,GAA2C,GAAlD;AAEA;;AA9BM;;AA1RM,CAAf;;AA8TAwmB,MAAMkwB,aAAN,GAAsB;;AAErBnrB,UAAQ,gBAAUZ,CAAV,EAAa3qB,CAAb,EAAgB;;AAEvB,QAAIxC,IAAImtB,EAAE/tB,MAAF,GAAW,CAAnB;AACA,QAAImP,IAAIvO,IAAIwC,CAAZ;AACA,QAAIrC,IAAIR,KAAKkjB,KAAL,CAAWtU,CAAX,CAAR;AACA,QAAIwsC,KAAK/xB,MAAMkwB,aAAN,CAAoB8B,KAApB,CAA0BjtB,MAAnC;;AAEA,QAAIvrB,IAAI,CAAR,EAAW;AACV,aAAOu4C,GAAG5tB,EAAE,CAAF,CAAH,EAASA,EAAE,CAAF,CAAT,EAAe5e,CAAf,CAAP;AACA;;AAED,QAAI/L,IAAI,CAAR,EAAW;AACV,aAAOu4C,GAAG5tB,EAAEntB,CAAF,CAAH,EAASmtB,EAAEntB,IAAI,CAAN,CAAT,EAAmBA,IAAIuO,CAAvB,CAAP;AACA;;AAED,WAAOwsC,GAAG5tB,EAAEhtB,CAAF,CAAH,EAASgtB,EAAEhtB,IAAI,CAAJ,GAAQH,CAAR,GAAYA,CAAZ,GAAgBG,IAAI,CAAtB,CAAT,EAAmCoO,IAAIpO,CAAvC,CAAP;AAEA,GAnBoB;;AAqBrB86C,UAAQ,gBAAU9tB,CAAV,EAAa3qB,CAAb,EAAgB;;AAEvB,QAAIhK,IAAI,CAAR;AACA,QAAIo6C,IAAIzlB,EAAE/tB,MAAF,GAAW,CAAnB;AACA,QAAI87C,KAAKv7C,KAAK0U,GAAd;AACA,QAAI8mC,KAAKnyB,MAAMkwB,aAAN,CAAoB8B,KAApB,CAA0BI,SAAnC;;AAEA,SAAK,IAAIj7C,IAAI,CAAb,EAAgBA,KAAKyyC,CAArB,EAAwBzyC,GAAxB,EAA6B;AAC5B3H,WAAK0iD,GAAG,IAAI14C,CAAP,EAAUowC,IAAIzyC,CAAd,IAAmB+6C,GAAG14C,CAAH,EAAMrC,CAAN,CAAnB,GAA8BgtB,EAAEhtB,CAAF,CAA9B,GAAqCg7C,GAAGvI,CAAH,EAAMzyC,CAAN,CAA1C;AACA;;AAED,WAAO3H,CAAP;AAEA,GAlCoB;;AAoCrB6iD,cAAY,oBAAUluB,CAAV,EAAa3qB,CAAb,EAAgB;;AAE3B,QAAIxC,IAAImtB,EAAE/tB,MAAF,GAAW,CAAnB;AACA,QAAImP,IAAIvO,IAAIwC,CAAZ;AACA,QAAIrC,IAAIR,KAAKkjB,KAAL,CAAWtU,CAAX,CAAR;AACA,QAAIwsC,KAAK/xB,MAAMkwB,aAAN,CAAoB8B,KAApB,CAA0BK,UAAnC;;AAEA,QAAIluB,EAAE,CAAF,MAASA,EAAEntB,CAAF,CAAb,EAAmB;;AAElB,UAAIwC,IAAI,CAAR,EAAW;AACVrC,YAAIR,KAAKkjB,KAAL,CAAWtU,IAAIvO,KAAK,IAAIwC,CAAT,CAAf,CAAJ;AACA;;AAED,aAAOu4C,GAAG5tB,EAAE,CAAChtB,IAAI,CAAJ,GAAQH,CAAT,IAAcA,CAAhB,CAAH,EAAuBmtB,EAAEhtB,CAAF,CAAvB,EAA6BgtB,EAAE,CAAChtB,IAAI,CAAL,IAAUH,CAAZ,CAA7B,EAA6CmtB,EAAE,CAAChtB,IAAI,CAAL,IAAUH,CAAZ,CAA7C,EAA6DuO,IAAIpO,CAAjE,CAAP;AAEA,KARD,MAQO;;AAEN,UAAIqC,IAAI,CAAR,EAAW;AACV,eAAO2qB,EAAE,CAAF,KAAQ4tB,GAAG5tB,EAAE,CAAF,CAAH,EAASA,EAAE,CAAF,CAAT,EAAeA,EAAE,CAAF,CAAf,EAAqBA,EAAE,CAAF,CAArB,EAA2B,CAAC5e,CAA5B,IAAiC4e,EAAE,CAAF,CAAzC,CAAP;AACA;;AAED,UAAI3qB,IAAI,CAAR,EAAW;AACV,eAAO2qB,EAAEntB,CAAF,KAAQ+6C,GAAG5tB,EAAEntB,CAAF,CAAH,EAASmtB,EAAEntB,CAAF,CAAT,EAAemtB,EAAEntB,IAAI,CAAN,CAAf,EAAyBmtB,EAAEntB,IAAI,CAAN,CAAzB,EAAmCuO,IAAIvO,CAAvC,IAA4CmtB,EAAEntB,CAAF,CAApD,CAAP;AACA;;AAED,aAAO+6C,GAAG5tB,EAAEhtB,IAAIA,IAAI,CAAR,GAAY,CAAd,CAAH,EAAqBgtB,EAAEhtB,CAAF,CAArB,EAA2BgtB,EAAEntB,IAAIG,IAAI,CAAR,GAAYH,CAAZ,GAAgBG,IAAI,CAAtB,CAA3B,EAAqDgtB,EAAEntB,IAAIG,IAAI,CAAR,GAAYH,CAAZ,GAAgBG,IAAI,CAAtB,CAArD,EAA+EoO,IAAIpO,CAAnF,CAAP;AAEA;AAED,GAjEoB;;AAmErB66C,SAAO;;AAENjtB,YAAQ,gBAAUutB,EAAV,EAAc9qB,EAAd,EAAkB/c,CAAlB,EAAqB;;AAE5B,aAAO,CAAC+c,KAAK8qB,EAAN,IAAY7nC,CAAZ,GAAgB6nC,EAAvB;AAEA,KANK;;AAQNF,eAAW,mBAAUxI,CAAV,EAAazyC,CAAb,EAAgB;;AAE1B,UAAI81B,KAAKjN,MAAMkwB,aAAN,CAAoB8B,KAApB,CAA0BO,SAAnC;;AAEA,aAAOtlB,GAAG2c,CAAH,IAAQ3c,GAAG91B,CAAH,CAAR,GAAgB81B,GAAG2c,IAAIzyC,CAAP,CAAvB;AAEA,KAdK;;AAgBNo7C,eAAY,YAAY;;AAEvB,UAAIhjD,IAAI,CAAC,CAAD,CAAR;;AAEA,aAAO,UAAUq6C,CAAV,EAAa;;AAEnB,YAAInuC,IAAI,CAAR;;AAEA,YAAIlM,EAAEq6C,CAAF,CAAJ,EAAU;AACT,iBAAOr6C,EAAEq6C,CAAF,CAAP;AACA;;AAED,aAAK,IAAIzyC,IAAIyyC,CAAb,EAAgBzyC,IAAI,CAApB,EAAuBA,GAAvB,EAA4B;AAC3BsE,eAAKtE,CAAL;AACA;;AAED5H,UAAEq6C,CAAF,IAAOnuC,CAAP;AACA,eAAOA,CAAP;AAEA,OAfD;AAiBA,KArBU,EAhBL;;AAuCN42C,gBAAY,oBAAUC,EAAV,EAAc9qB,EAAd,EAAkBC,EAAlB,EAAsB+qB,EAAtB,EAA0B/nC,CAA1B,EAA6B;;AAExC,UAAIgoC,KAAK,CAAChrB,KAAK6qB,EAAN,IAAY,GAArB;AACA,UAAInrB,KAAK,CAACqrB,KAAKhrB,EAAN,IAAY,GAArB;AACA,UAAIkrB,KAAKjoC,IAAIA,CAAb;AACA,UAAIkoC,KAAKloC,IAAIioC,EAAb;;AAEA,aAAO,CAAC,IAAIlrB,EAAJ,GAAS,IAAIC,EAAb,GAAkBgrB,EAAlB,GAAuBtrB,EAAxB,IAA8BwrB,EAA9B,GAAmC,CAAC,CAAE,CAAF,GAAMnrB,EAAN,GAAW,IAAIC,EAAf,GAAoB,IAAIgrB,EAAxB,GAA6BtrB,EAA9B,IAAoCurB,EAAvE,GAA4ED,KAAKhoC,CAAjF,GAAqF+c,EAA5F;AAEA;;AAhDK;;AAnEc,CAAtB;;AA4HA;;AAEA;;;;;;AAMA33B,QAAQmwB,KAAR,GAAgBA,KAAhB;;AAGA;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BA;AACA;;AAEAnwB,QAAQo5C,aAAR;;AAGA;AACA,CAAC,UAAU2J,IAAV,EAAgB;;AAEb,MAAI,OAAOC,MAAP,KAAkB,UAAlB,IAAgCA,OAAOC,GAA3C,EAAgD;;AAE5C;AACAD,WAAO,EAAP,EAAW,YAAY;AACnB,aAAOhjD,OAAP;AACH,KAFD;AAIH,GAPD,MAOO,IAAI,OAAO2D,MAAP,KAAkB,WAAlB,IAAiC,QAAO4H,OAAP,yCAAOA,OAAP,OAAmB,QAAxD,EAAkE;;AAErE;AACA5H,WAAO4H,OAAP,GAAiBvL,OAAjB;AAEH,GALM,MAKA,IAAI+iD,SAASr6B,SAAb,EAAwB;;AAE3B;AACAq6B,SAAK/iD,OAAL,GAAeA,OAAf;AAEH;AAEJ,CArBD","file":"gamelab.js","sourcesContent":["//TODO: list the fxns needed for arrays only\r\n\r\nlet arrays = {\r\n\r\n\r\n};\r\n;//Simplified expressions for setTimeout and setInterval\r\nlet delay = (fxn, timing) => {\r\n  setTimeout(fxn, timing);\r\n};\r\n\r\nlet repeat = (fxn, timing) => {\r\n  setInterval(fxn, timing);\r\n};\r\n;let clog = (a, b, c) => {\r\n  console.log(a, b, c);\r\n};\r\n\r\nlet dlog = () => {\r\n  if (Gamelab.config.DEV)\r\n    console.log(a, b, c)\r\n};\r\n;\r\n//TODO: list the fxns needed for numbers only\r\n\r\nlet numbers = {\r\n\r\n  getMinAndMaxByPair:function(a, b){\r\n\r\n    if(!(a || b))\r\n    return console.error('null or undefined args');\r\n\r\n    if(typeof a == 'number' && !b)\r\n    return {min:a, max:a}\r\n    else if(a >= b)\r\n    {\r\n      return {\r\n        min:b, max:a\r\n      }\r\n    }\r\n    else\r\n    {\r\n      return {\r\n        min:a, max:b\r\n      }\r\n    }\r\n  }\r\n\r\n};\r\n;let TypeCode = {\r\n\r\n  DEV:false,\r\n\r\n  //Display message in console\r\n  info: function(arg1, arg2) {\r\n\r\n    if(!this.DEV)\r\n    return;\r\n\r\n    console.info(arg1, arg2);\r\n\r\n  },\r\n\r\n  log:function(arg1, arg2){\r\n\r\n    if(!this.DEV)\r\n    return;\r\n\r\n      console.log(arg1, arg2);\r\n\r\n  },\r\n\r\n  /* ERRORS always show */\r\n  error:function(arg1, arg2){\r\n\r\n    if(!this.DEV)\r\n    return;\r\n\r\n      console.error(arg1, arg2);\r\n\r\n  },\r\n\r\n\r\n  warn:function(arg1, arg2){\r\n\r\n    if(!this.DEV)\r\n    return;\r\n\r\n      console.error(arg1, arg2);\r\n\r\n  },\r\n\r\n  //obj is number or becomes fallback\r\n  number: function(number, fallback = 0) {\r\n\r\n    number = typeof(number) == 'number' ? number : fallback;\r\n\r\n  },\r\n\r\n  //obj is string or becomes fallback\r\n  string: function(string, fallback) {\r\n\r\n    string = typeof(string) == 'string' ? string : fallback;\r\n\r\n  },\r\n\r\n  //obj is Array or becomes wrapped in [] as [obj]\r\n  arrayWrap: function(obj) {\r\n    if (obj instanceof Array)\r\n      return obj;\r\n    else\r\n      return [obj];\r\n  },\r\n\r\n  //obj or array-of-objects are ALL truthy (return=true) or not (return=false)\r\n  allDefined: function(obj_all) {\r\n\r\n    var list = this.arrayWrap(obj_all);\r\n\r\n    var failed = false;\r\n\r\n    for (var x in list) {\r\n      if (!list[x]) {\r\n        failed = true;\r\n        console.error('Failed to define @ TypeCode.Define()');\r\n      }\r\n    };\r\n\r\n    return !failed;\r\n  },\r\n\r\n  //getPreferredPropertyByKey(): uses the property[key] if present, if not returns same property passed in\r\n  getPreferredPropertyByKey:function(property, key, warning){\r\n\r\n    if(property.hasOwnProperty(key))\r\n    {\r\n      this.warn(warning);\r\n      return property[key];\r\n    }\r\n\r\n    else {\r\n      return property;\r\n    }\r\n  },\r\n\r\n\r\n  //obj's are all of type or return false\r\n  psuedoTypeCheck: function(obj, psuedotype = [], throwing = false) //obj is type or is encapsulated into type\r\n  {\r\n    var list = this.arrayWrap(obj);\r\n\r\n    for (var x in list) {\r\n      if (typeof(list[x]) !== psuedotype && !(list[x] instanceof psuedotype)) {\r\n        if (!throwing)\r\n          return console.error(error);\r\n        else\r\n          throw new console.error(error);\r\n      }\r\n    }\r\n\r\n    return true;\r\n  },\r\n\r\n  getAllFuncs: function(obj) {\r\n\r\n    return Object.getOwnPropertyNames(obj).filter(function (p) {\r\n        return typeof obj[p] === 'function';\r\n    });\r\n\r\n  },\r\n\r\n  getProtoFuncs: function(obj) {\r\n\r\n    return Object.getOwnPropertyNames(obj.__proto__).filter(function (p) {\r\n        return typeof obj[p] === 'function';\r\n    });\r\n\r\n  },\r\n\r\n  truthOrDie:function(list, exitMessage) //All members of Array are truthy or the program exits with Error()\r\n  {\r\n    function findError(obj, error) {\r\n      return obj || new Error(error)\r\n    };\r\n\r\n    for (var x in list) {\r\n\r\n        let e = findError(list[x], exitMessage);\r\n\r\n        if (e instanceof Error) {\r\n            console.Error(e);\r\n        }\r\n      };\r\n  },\r\n\r\n  truthyPropsPerArray: function(obj, propKeys, kill) {\r\n\r\n    var list = this.arrayWrap(obj),\r\n      keys = this.arrayWrap(propKeys);\r\n\r\n    let error = \"The required truthy property has non-truthy value.\";\r\n\r\n    function findError(obj, prop) {\r\n      return obj[prop] || new Error(error)\r\n    };\r\n\r\n    var failed = false;\r\n\r\n    for (var x in list) {\r\n      for (var y in keys) {\r\n        let e = findError(list[x], keys[y]);\r\n        if (e instanceof Error) {\r\n          failed = true;\r\n          if (kill)\r\n            throw e;\r\n          else\r\n            console.error(e);\r\n        }\r\n      }\r\n    }\r\n\r\n    return !failed;\r\n  },\r\n\r\n  typeArgsExtract: function(obj, type) //obj is type or is each-converted into type\r\n  {\r\n    if (obj instanceof type) {\r\n      return obj;\r\n    } else {\r\n      obj = [obj];\r\n    }\r\n    return obj;\r\n  },\r\n\r\n  typeOrHalt: function(obj, type) //obj is type or error is thrown\r\n  {\r\n    if (obj instanceof type) {\r\n      return obj;\r\n    } else {\r\n      throw new Error('object not of required type');\r\n      console.info(obj);\r\n      console.info(type + \"?\");\r\n    }\r\n    return obj;\r\n  },\r\n\r\n  typeOrError: function(obj, type) //obj is type or error is logged, execution continues\r\n  {\r\n    if (obj instanceof type) {\r\n      return obj;\r\n    } else {\r\n      console.log(new Error('object not of required type'));\r\n      console.info(obj);\r\n      console.info(type + \"?\");\r\n    }\r\n    return obj;\r\n  },\r\n\r\n  check:function(object, propKey, propValue)\r\n  {\r\n    if(!object[propKey])\r\n    {\r\n       object[propKey] = propValue;\r\n    }\r\n  }\r\n};\r\n;/**@author\r\n Jordan Blake\r\n * */\r\n\r\n/**@copyright\r\n Copyright 2018\r\n **/\r\n\r\n\r\n//Gamelab: the main module object:\r\nlet Gamelab_Module = function() {\r\n\r\n  var module = {\r\n\r\n    settings: {\r\n\r\n      DEBUG: false,\r\n\r\n      gui_mode: true,\r\n\r\n      recursionCount: 0,\r\n\r\n      errorLimit: 20\r\n    },\r\n\r\n    errors: 0,\r\n\r\n    stopDraw:false,\r\n\r\n    defSize() {\r\n      if (this.WIDTH == 0) {\r\n        this.WIDTH = document.body.clientWidth;\r\n      }\r\n\r\n      if (this.HEIGHT == 0) {\r\n        this.HEIGHT = document.body.clientHeight;\r\n      }\r\n\r\n    },\r\n\r\n    getGameWindow(ix = 0) {\r\n      return this.game_windows[0]\r\n    },\r\n\r\n    WIDTH: 0,\r\n\r\n    HEIGHT: 0,\r\n\r\n    game_windows: [],\r\n\r\n    gs_renderables: [],\r\n\r\n    gs_events: [],\r\n\r\n    spriteTypes: [],\r\n\r\n    systemSpriteTypes: ['player', 'enemy', 'background', 'interactive', 'terrain', 'weapon', 'subsprite'],\r\n\r\n    __gameWindowList: [],\r\n\r\n    all: function() {\r\n      var all_objects = [];\r\n      this.game_windows.forEach(function(item) {\r\n        all_objects = all_objects.concat(item.drawables);\r\n      });\r\n      console.info('Gamelab.all():', all_objects);\r\n      return all_objects;\r\n    },\r\n\r\n    init: function() {\r\n\r\n      this.testSquare = new Gamelab.Sprite();\r\n\r\n\r\n\r\n    },\r\n\r\n    onButton:function(gpix=0, callback){\r\n      if(typeof gpix == 'function')\r\n      {\r\n        callback = gpix;\r\n        gpix = 0;\r\n      }\r\n      new Gamelab.GamepadEvent().Gamepads([gpix]).Keys();\r\n    },\r\n\r\n    objectDestroyed(obj) {\r\n      var dead = true;\r\n\r\n      for (var x in this.game_windows) {\r\n        let gw = this.game_windows[x];\r\n\r\n        for (var y in gw.objects) {\r\n          if (gw.objects[y] === obj)\r\n            dead = false;\r\n        }\r\n      }\r\n      return dead;\r\n    },\r\n\r\n    getObjectById(id) {\r\n      for (var x = 0; x < this.all_objects.length; x++) {\r\n        if (this.all_objects[x].id == id) {\r\n          return this.all_objects[x];\r\n        }\r\n      }\r\n    },\r\n\r\n    interlog: function(message, div) //recursive safe :: won't go crazy with recursive logs :: log message every x times this is called\r\n    {\r\n      this.recursionCount++;\r\n      if (!isNaN(div) && this.settings.recursionCount % div == 0) {\r\n        //   console.log('Interval Log:'+  message);\r\n      }\r\n    },\r\n\r\n\r\n    create_id: function() {\r\n      var S4 = function() {\r\n        return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\r\n      };\r\n      return (S4() + S4() + \"-\" + S4() + \"-\" + S4() + \"-\" + S4() + \"-\" + S4() + S4() + S4());\r\n    },\r\n\r\n\r\n    error: function(quit, message) {\r\n\r\n      if (quit) {\r\n        throw new Error(message);\r\n      } else {\r\n        console.error('E!' + message);\r\n      }\r\n    },\r\n\r\n    info: function(m) {\r\n\r\n      if (Gamelab.DEBUG) {\r\n        console.info('Info:' + m);\r\n      }\r\n    },\r\n\r\n\r\n    log: function(m) {\r\n\r\n      if (Gamelab.DEBUG) {\r\n        console.log('Gamelab:' + m);\r\n      }\r\n    },\r\n\r\n    initializers: [],\r\n\r\n    addInitializer: function(i) {\r\n\r\n      this.initializers.push(i);\r\n\r\n    },\r\n\r\n    _gameWindow: {},\r\n\r\n    setGameWindow: function(gameWindow) {\r\n      this._gameWindow = gameWindow;\r\n    },\r\n\r\n    ExtendEvents: function(extendedObject, extendedKey, extendor, extendorKey) {\r\n      var evtLink = new GSEventLink(extendedObject, extendedKey, extendor, extendorKey);\r\n\r\n      this.all_objects.push(new GSEventLink(extendedObject, extendedKey, extendor, extendorKey));\r\n\r\n      var parent = extendedObject;\r\n\r\n      // console.log(parent);\r\n\r\n      if (parent) {\r\n        console.log('Gamelab:EXTENDING EVENTS:' + extendedKey + \":\" + extendorKey);\r\n\r\n        if (parent.onRun) //Any extendable object has an onRun ... OR\r\n        {\r\n          parent.onRun(extendor, extendorKey);\r\n\r\n        }\r\n        if (parent.onComplete) //object has an onComplete\r\n        {\r\n          parent.onComplete(extendor, extendorKey);\r\n\r\n        }\r\n      }\r\n    },\r\n\r\n\r\n    assignAll: function(object, args, keys) {\r\n\r\n      __gamelabInstance.each(keys, function(ix, item) {\r\n\r\n        object[ix] = args[ix];\r\n\r\n      });\r\n\r\n    },\r\n\r\n\r\n    loadSprites:function(sprites, callback){\r\n\r\n      var LEN = sprites.length, COUNT = 0;\r\n\r\n      if(sprites instanceof Array)\r\n      {\r\n              sprites.forEach(function(spr){\r\n\r\n                spr.onLoad(function(){\r\n\r\n                  COUNT += 1;\r\n\r\n                  if(COUNT >= LEN)\r\n                  {\r\n                    callback(sprites);\r\n                  }\r\n\r\n                });\r\n\r\n              });\r\n      }\r\n\r\n\r\n      else if(typeof sprites == 'object')\r\n      {\r\n        LEN = Object.keys(sprites).length;\r\n\r\n        for(var x in sprites)\r\n        {\r\n          var spr = sprites[x];\r\n          if(spr.constructor.name == 'Sprite' ||\r\n           spr.constructor.name == 'BoneSprite' ||\r\n           spr.constructor.name == 'SpriteGroup' ||\r\n          spr.constructor.name == 'Animation')\r\n          {\r\n            spr.onLoad(function(){\r\n\r\n              COUNT += 1;\r\n\r\n              if(COUNT >= LEN)\r\n              {\r\n                callback(sprites);\r\n              }\r\n            });\r\n          }\r\n        }\r\n      }\r\n    },\r\n\r\n    each: function(list, onResult, onComplete) {\r\n      for (var i in list) {\r\n        onResult(i, list[i]);\r\n      }\r\n\r\n      if (typeof(onComplete) === 'function') {\r\n        onComplete(false, list)\r\n      };\r\n\r\n    },\r\n\r\n    ready_callstack: [],\r\n\r\n    ready: function(callback) {\r\n\r\n      this.ready_callstack.push(callback);\r\n\r\n    },\r\n    reload: function() {\r\n\r\n      this.callReady();\r\n\r\n    },\r\n\r\n    callReady: function() {\r\n\r\n      var funx = this.ready_callstack;\r\n\r\n      var gameWindow = this.game_windows[0],\r\n        module = this;\r\n\r\n      //call every function in the ready_callstack\r\n\r\n      this.each(funx, function(ix, call) {\r\n\r\n        call(module, gameWindow);\r\n\r\n      });\r\n\r\n      this.InputSystem.init();\r\n\r\n      this.__running = true;\r\n\r\n    },\r\n\r\n    getArg: function(args, keys, fallback) {\r\n\r\n      if (typeof(keys) == 'string') {\r\n        keys = [keys]; //always array\r\n      }\r\n      for (var x = 0; x < keys.length; x++) {\r\n        var k = keys[x];\r\n\r\n        if (args && args.hasOwnProperty(k)) {\r\n          return args[k]; //return first argument match\r\n        }\r\n      }\r\n      return fallback;\r\n    },\r\n\r\n    normalArgs: function(args) {\r\n\r\n      var a = {};\r\n\r\n      function normal(str) {\r\n        return str.toLowerCase().replace('-', '').replace(' ', '').replace('_', '')\r\n      };\r\n\r\n      for (var x in args) {\r\n        a[normal(x)] = args[x];\r\n      }\r\n\r\n      return a;\r\n    },\r\n\r\n    isNormalStringMatch: function(str1, str2) {\r\n\r\n      return str1.toLowerCase().replace(' ', '') == str2.toLowerCase().replace(' ', '');\r\n\r\n    },\r\n\r\n    instance_type_pairs: function() {\r\n\r\n      //get an array of all instance/type pairs added to the library\r\n\r\n      //example : [ {constructor_name:Sprite, type:enemy_basic}, {constructor_name:Animation, type:enemy_attack}  ];\r\n\r\n      var objectList = [];\r\n\r\n      this.each(this.all_objects, function(ix, item) {\r\n\r\n        objectList.push({\r\n          constructor_name: item.constructor.name,\r\n          type: item.type\r\n        });\r\n\r\n      });\r\n\r\n      return objectList;\r\n\r\n    },\r\n\r\n    getById: function(id) {\r\n\r\n      for (var x in this.all_objects) {\r\n        if (this.all_objects[x].id == id) {\r\n          return this.all_objects[x];\r\n\r\n        }\r\n\r\n      }\r\n\r\n    },\r\n\r\n    select: function(constructor_name, name, group /*ignoring spaces and CAPS/CASE on type match*/ ) {\r\n\r\n      var query = [];\r\n\r\n      var __inst = this;\r\n\r\n      this.each(Gamelab.all(), function(ix, item) {\r\n\r\n        if (constructor_name == '*' || item.constructor.name == constructor_name) {\r\n\r\n          if (group == '*' || __inst.isNormalStringMatch(group, item.group)) {\r\n\r\n            if (name == '*' || __inst.isNormalStringMatch(name, item.name)) {\r\n\r\n              query.push(item);\r\n\r\n            }\r\n          }\r\n        }\r\n      });\r\n\r\n      return query;\r\n    }\r\n  }\r\n\r\n  return module;\r\n\r\n};\r\n\r\nlet GamelabApi = {\r\n  get: function() {\r\n\r\n\r\n  },\r\n\r\n  post: function(object) {\r\n    //TODO decycle the object before saving\r\n\r\n    if (!object.id) {\r\n      object.id = Gamelab.create_id();\r\n\r\n    }\r\n\r\n    var name = object.name,\r\n      type = object.constructor.name,\r\n      contents = jstr(object),\r\n      id = object.id;\r\n\r\n\r\n  }\r\n\r\n};\r\n\r\n\r\nclass GSO //Gamelab-Overrideable\r\n{\r\n  constructor(args = {}) {\r\n\r\n    this.run_ext = args.run_ext || [];\r\n\r\n    this.complete_ext = args.complete_ext || [];\r\n  }\r\n\r\n  /*****\r\n   * Overridable / Extendable functions\r\n   * -allows stacking of external object-function calls\r\n   ******/\r\n\r\n  onRun(caller, callkey) {\r\n    this.run_ext = this.run_ext || [];\r\n\r\n    if (this.run_ext.indexOf(caller[callkey]) == -1) {\r\n      this.run_ext.push({\r\n        caller: caller,\r\n        callkey: callkey\r\n      });\r\n    }\r\n  }\r\n\r\n  onComplete(caller, callkey) {\r\n    this.complete_ext = this.complete_ext || [];\r\n\r\n    if (this.complete_ext.indexOf(caller[callkey]) == -1) {\r\n      this.complete_ext.push({\r\n        caller: caller,\r\n        callkey: callkey\r\n      });\r\n    }\r\n  }\r\n\r\n  call_on_run() {\r\n    //call any function extension that is present\r\n    for (var x = 0; x < this.run_ext.length; x++) {\r\n      this.run_ext[x].caller[this.run_ext[x].callkey]();\r\n    }\r\n  }\r\n\r\n  call_on_complete() {\r\n    //call any function extension that is present\r\n    for (var x = 0; x < this.complete_ext.length; x++) {\r\n      this.complete_ext[x].caller[this.complete_ext[x].callkey]();\r\n    }\r\n  }\r\n\r\n}\r\n\r\nlet Gamelab = Gamelab_Module();\r\n\r\n\r\nGamelab.DEV = true;\r\n\r\n\r\nif (typeof module !== 'undefined' && module.exports) {\r\n\r\n  //This library is being instaniated via require() aka node.js require or similar library loader\r\n  module.exports = Gamelab;\r\n\r\n} else {\r\n\r\n\r\n}\r\n\r\n/***************\r\n * TODO : fix the above duplicate references, which exist now for backward compatibility with previouslyh authored code\r\n *  -apply find and replace accross the codebase\r\n * ****************/\r\n\r\n/********\r\n * jstr() : public function for stringifying objects and arrays (uses pretty print style)\r\n * *********/\r\n\r\nfunction jstr(obj) {\r\n\r\n  return JSON.stringify(obj);\r\n\r\n};\r\n\r\nGamelab.jstr = jstr;\r\n\r\n/**********\r\n * $Q : Selector Function\r\n *  -allows string-based-selection of game-objects.\r\n * **********/\r\n\r\nfunction $Q(selector) {\r\n\r\n  //declare events:\r\n\r\n  console.log(selector);\r\n\r\n  var query = [];\r\n\r\n  //handle selector / selection of objects:\r\n\r\n  if (typeof selector !== 'string') {\r\n\r\n    if (selector instanceof Array) {\r\n\r\n    } else {\r\n\r\n\r\n    }\r\n\r\n  } else {\r\n\r\n\r\n    if (selector && selector !== '*') {\r\n\r\n      var s = selector || '';\r\n\r\n      console.info('selector:' + s);\r\n\r\n\r\n      var mainSelector = $Q.before('[', s).trim(),\r\n        msfChar = mainSelector.substring(0, 1);\r\n\r\n      var __targetClassName = \"*\";\r\n\r\n      var output = [];\r\n\r\n      var cleanSelectorString = function(str) {\r\n        return str.replace(\",\", \"\");\r\n      };\r\n\r\n      switch (msfChar.toLowerCase()) {\r\n        case \".\":\r\n\r\n          console.info('Selecting by \".\" or class');\r\n\r\n          __targetClassName = cleanSelectorString($Q.after('.', mainSelector));\r\n\r\n          console.info('Target class is:' + __targetClassName);\r\n\r\n          break;\r\n\r\n        case \"*\":\r\n\r\n          console.info('Selecting by \"*\" or ANY object in the library instance');\r\n\r\n          __targetClassName = \"*\";\r\n\r\n          break;\r\n\r\n      }\r\n\r\n      var criterion = $Q.between('[', ']', s),\r\n        cparts = criterion.split('=');\r\n\r\n      var __targetGroup = \"*\",\r\n        __targetName = \"*\";\r\n\r\n      var getParts = function() {\r\n\r\n        if (cparts.length >= 2) {\r\n\r\n          switch (cparts[0].toLowerCase()) {\r\n\r\n            case \"name\":\r\n\r\n              //get all objects according to name=name\r\n\r\n              console.log('Q():Detected parts in selector:' + jstr(cparts));\r\n\r\n              __targetName = cleanSelectorString(cparts[1]);\r\n\r\n              break;\r\n\r\n            case \"group\":\r\n\r\n              console.log('Q():Detected parts in selector:' + jstr(cparts));\r\n\r\n              __targetGroup = cleanSelectorString(cparts[1]);\r\n\r\n              break;\r\n\r\n          }\r\n\r\n        }\r\n\r\n        if (cparts.length >= 4) {\r\n\r\n          cparts[2] = cparts[2].replace(\",\", \"\");\r\n\r\n          switch (cparts[2].toLowerCase()) {\r\n\r\n            case \"name\":\r\n\r\n              //get all objects according to name=name\r\n\r\n              console.log('Q():Detected parts in selector:' + jstr(cparts));\r\n\r\n              __targetName = cleanSelectorString(cparts[3]);\r\n\r\n              break;\r\n\r\n            case \"group\":\r\n\r\n              console.log('Q():Detected parts in selector:' + jstr(cparts));\r\n\r\n              __targetGroup = cleanSelectorString(cparts[3]);\r\n\r\n              break;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      };\r\n\r\n      getParts(cparts);\r\n\r\n      query = Gamelab.select(__targetClassName, __targetName, __targetGroup);\r\n\r\n    } else if (selector == '*') {\r\n\r\n      query = Gamelab.all();\r\n\r\n    }\r\n\r\n  }\r\n\r\n\r\n  query.each = function(callback) {\r\n\r\n    var objects = [];\r\n\r\n    for (var x = 0; x < this.length; x++) {\r\n      if (typeof x == 'number') {\r\n\r\n        callback(x, this[x]);\r\n      }\r\n\r\n    }\r\n\r\n\r\n  };\r\n\r\n  query.on = function(evt_key, selectorObject, controller_ix, callback) //handle each event such as on('collide') OR on('stick_left_0') << first controller stick_left\r\n  {\r\n\r\n    if (typeof evt_key == 'function' && typeof selectorObject == 'function') {\r\n      //this is a special pattern of if(f() == true){ runFunction(); };\r\n\r\n      var boolTrigger = evt_key,\r\n        boolCall = selectorObject,\r\n\r\n        boolEvent = new Gamelab.BoolEvent().On(boolTrigger).Call(boolCall);\r\n\r\n    }\r\n\r\n\r\n    var criterion = $Q.between('[', ']', evt_key);\r\n\r\n    if (criterion.indexOf('===') >= 0) {\r\n      criterion = criterion.replace('===', '=');\r\n    }\r\n\r\n    if (criterion.indexOf('==') >= 0) {\r\n      criterion = criterion.replace('==', '=').replace('==', 0);\r\n    }\r\n\r\n    var cparts = criterion.split('=');\r\n\r\n    var __targetGroup = \"*\",\r\n      __targetName = \"*\";\r\n\r\n    if (evt_key.indexOf('[') >= 0) {\r\n      evt_key = $Q.before('[', evt_key).trim();\r\n\r\n    }\r\n\r\n\r\n    var padding = 0;\r\n\r\n    //if controller_ix is function, and callback not present, then controller_ix is the callback aka optional argument\r\n\r\n    if (controller_ix && typeof controller_ix == 'function' && !callback) {\r\n      callback = controller_ix;\r\n      controller_ix = 0;\r\n    }\r\n\r\n    //optional argument: if controller_ix is function, and callback not present, then callback is selectorObject\r\n\r\n    if (selectorObject && typeof selectorObject == 'function' && !callback) {\r\n\r\n      callback = selectorObject;\r\n\r\n      selectorObject = $Q('*');\r\n\r\n      controller_ix = 0;\r\n    };\r\n\r\n    var evt_profile = {};\r\n\r\n    //which controller?\r\n\r\n    evt_profile.cix = controller_ix;\r\n\r\n    //Need the control key: 'left_stick', 'button_0', etc..\r\n\r\n    evt_profile.evt_key = evt_key;\r\n\r\n    if ($Q.contains_any(['stick', 'button', 'click', 'key'], evt_profile.evt_key)) {\r\n\r\n      var button_mode = evt_profile.evt_key.indexOf('button') >= 0;\r\n\r\n      Gamelab.GamepadAdapter.on(evt_profile.evt_key, 0, function(x, y) {\r\n\r\n        callback(x, y);\r\n\r\n      });\r\n\r\n      console.info('detected input event key in:' + evt_profile.evt_key);\r\n\r\n      console.info('TODO: rig events');\r\n\r\n    }\r\n\r\n    //TODO: test collision events:\r\n    else if ($Q.contains_any(['collide', 'collision', 'hit', 'touch'], evt_profile.evt_key)) {\r\n\r\n      //   console.info('Rigging a collision event');\r\n\r\n      //   console.info('detected collision event key in:' + evt_profile.evt_key);\r\n\r\n      //  console.info('TODO: rig collision events');\r\n\r\n      this.each(function(ix, item1) {\r\n\r\n        // console.info('Collision Processing 1:' + item1.name);\r\n        //  console.info('Collision Processing 1:' + item1.type);\r\n\r\n        selectorObject.each(function(iy, item2) {\r\n\r\n          //    console.info('Collision Processing 2:' + item2.name);\r\n          //   console.info('Collision Processing 2:' + item2.type);\r\n\r\n          if (typeof(item1.onUpdate) == 'function') {\r\n\r\n            var update = function(sprite) {\r\n\r\n              console.log('Box collide::' + jstr([this, item2]));\r\n\r\n              if (this.hasBoxCollision(item2, padding)) {\r\n\r\n                callback(this, item2);\r\n\r\n              };\r\n\r\n            };\r\n\r\n            item1.onUpdate(update);\r\n\r\n          }\r\n\r\n\r\n        });\r\n\r\n      });\r\n\r\n\r\n    } else {\r\n      console.info('Rigging a property event');\r\n\r\n      //TODO: test property-watch events:\r\n\r\n      console.info('detected property threshhold event key in:' + evt_profile.evt_key);\r\n\r\n      console.info('TODO: rig property events');\r\n\r\n      var condition = \"_\",\r\n        key = criterion || evt_profile.evt_key;\r\n\r\n      if (key.indexOf('[') >= 0 || key.indexOf(']') >= 0) {\r\n        key = $Q.between('[', ']', key);\r\n\r\n      }\r\n\r\n      var evt_parts = [];\r\n\r\n      var run = function() {\r\n        console.error('Sprite property check was not set correctly');\r\n\r\n      };\r\n\r\n      if (key.indexOf('>=') >= 0) {\r\n        condition = \">=\";\r\n\r\n\r\n      } else if (key.indexOf('<=') >= 0) {\r\n        condition = \"<=\";\r\n      } else if (key.indexOf('>') >= 0) {\r\n        condition = \">\";\r\n      } else if (key.indexOf('<') >= 0) {\r\n        condition = \"<\";\r\n      } else if (key.indexOf('=') >= 0) {\r\n        condition = \"=\";\r\n      }\r\n\r\n      evt_parts = key.split(condition);\r\n\r\n      for (var x = 0; x < evt_parts.length; x++) {\r\n        evt_parts[x] = evt_parts[x].replace('=', '').replace('=', '').trim(); //remove any trailing equals and trim()\r\n\r\n      }\r\n\r\n      var mykey, number;\r\n\r\n      // alert(evt_parts[0]);\r\n\r\n      try {\r\n\r\n        mykey = evt_parts[0];\r\n\r\n        number = parseFloat(evt_parts[1]);\r\n\r\n      } catch (e) {\r\n        console.log(e);\r\n      }\r\n\r\n      console.info('Gamelab:Processing condition with:' + condition);\r\n\r\n      switch (condition) {\r\n\r\n        case \">=\":\r\n\r\n\r\n          run = function(obj, key) {\r\n            if (obj[key] >= number) {\r\n              callback();\r\n            }\r\n          };\r\n\r\n          break;\r\n\r\n        case \"<=\":\r\n\r\n          run = function(obj, key) {\r\n            if (obj[key] <= number) {\r\n              callback();\r\n            }\r\n          };\r\n\r\n          break;\r\n\r\n\r\n        case \">\":\r\n\r\n          run = function(obj, key) {\r\n            if (obj[key] > number) {\r\n              callback();\r\n            }\r\n          };\r\n\r\n          break;\r\n\r\n        case \"<\":\r\n\r\n          run = function(obj, key) {\r\n            if (obj[key] < number) {\r\n              callback();\r\n            }\r\n          };\r\n\r\n          break;\r\n\r\n        case \"=\":\r\n\r\n          run = function(obj, key) {\r\n            if (obj[key] == number) {\r\n              callback();\r\n            }\r\n          };\r\n\r\n          break;\r\n\r\n      }\r\n\r\n\r\n      /************\r\n       * Attach update to each member\r\n       *\r\n       * **************/\r\n\r\n      var keys = mykey.split('.'),\r\n        propkey = \"\";\r\n\r\n      this.each(function(ix, item) {\r\n\r\n        var object = {};\r\n\r\n        if (keys.length == 1) {\r\n          object = item;\r\n\r\n          propkey = mykey;\r\n\r\n        } else if (keys.length == 2) {\r\n          object = item[keys[0]];\r\n\r\n          propkey = keys[1];\r\n\r\n\r\n        } else if (keys.length == 3) {\r\n          object = item[keys[0]][keys[1]];\r\n\r\n          propkey = keys[2];\r\n\r\n        } else {\r\n          console.error(\":length of '.' notation out of range. We use max length of 3 or prop.prop.key.\");\r\n\r\n        }\r\n\r\n        if (typeof item.onUpdate == 'function') {\r\n\r\n\r\n          var spr = item;\r\n\r\n          item.onUpdate(function(sprite) {\r\n\r\n            run(object, propkey);\r\n\r\n          });\r\n\r\n        }\r\n\r\n      });\r\n\r\n    }\r\n\r\n  };\r\n\r\n\r\n  return query;\r\n\r\n}\r\n\r\n\r\n$Q.each = function(obj, callback, complete) {\r\n\r\n  for (var x in obj) {\r\n    callback(obj);\r\n\r\n  }\r\n\r\n  if (typeof(complete) == 'function') {\r\n    complete(obj);\r\n\r\n  }\r\n\r\n};\r\n\r\n\r\n$Q.before = function(c1, test_str) {\r\n  var start_pos = 0;\r\n  var end_pos = test_str.indexOf(c1, start_pos);\r\n  return test_str.substring(start_pos, end_pos);\r\n};\r\n\r\n\r\n$Q.contains = function(c1, test_str) {\r\n  return test_str.indexOf(c1) >= 0;\r\n};\r\n\r\n$Q.contains_all = function(cList, test_str) {\r\n  for (var x = 0; x < cList.length; x++) {\r\n    if (test_str.indexOf(cList[x]) < 0) {\r\n      return false;\r\n\r\n    }\r\n  }\r\n\r\n  return true;\r\n\r\n};\r\n\r\n$Q.contains_any = function(cList, test_str) {\r\n\r\n  for (var x = 0; x < cList.length; x++) {\r\n    if (test_str.indexOf(cList[x]) >= 0) {\r\n      return true;\r\n\r\n    }\r\n  }\r\n\r\n  return false;\r\n\r\n};\r\n\r\n$Q.after = function(c1, test_str) {\r\n  var start_pos = test_str.indexOf(c1) + 1;\r\n  var end_pos = test_str.length;\r\n  return test_str.substring(start_pos, end_pos);\r\n};\r\n\r\n$Q.between = function(c1, c2, test_str) {\r\n  var start_pos = test_str.indexOf(c1) + 1;\r\n  var end_pos = test_str.indexOf(c2, start_pos);\r\n  return test_str.substring(start_pos, end_pos)\r\n};\r\n\r\n\r\n/****************************************\r\n *  Developer's own test-function:\r\n *      -Q.test_selector_method():\r\n * ***************************************/\r\n\r\n$Q.test_selector_method = function() { //leftover method of hand-testing\r\n  var Q_TestStrings = ['*', '.Sprite', '*[group=\"enemy_type_0\"]', '.Sprite[group=\"enemy_type_0\"]'];\r\n\r\n  for (var x = 0; x < Q_TestStrings.length; x++) {\r\n    var test = Q_TestStrings[x];\r\n\r\n    console.info('testing:' + test);\r\n\r\n    $Q(test);\r\n  }\r\n\r\n  console.log('Testing stick left');\r\n\r\n  this.on('stick_left_0');\r\n\r\n  console.log('Testing button');\r\n\r\n  this.on('button_0');\r\n\r\n\r\n  console.log('Testing collide');\r\n\r\n  this.on('collide');\r\n\r\n\r\n  console.log('Testing button');\r\n\r\n  this.on('collide');\r\n\r\n  console.log('Testing prop');\r\n\r\n  this.on('health>=0');\r\n\r\n\r\n};\r\n\r\n\r\nGamelab.$Q = $Q;\r\n\r\nGamelab.query = $Q;\r\n\r\n\r\n/********************\r\n * Gamelab.InputSystem\r\n * Various Keyboard + mouse Input Events\r\n ********************/\r\n\r\nGamelab.InputSystem = {\r\n\r\n  //PC input events\r\n\r\n  Mouse: {\r\n    Position: {\r\n      x: 0,\r\n      y: 0\r\n    },\r\n    Speed: {\r\n      x: 0,\r\n      y: 0\r\n    },\r\n    setPosition(x, y) {\r\n\r\n      this.Speed.x = x - this.Position.x;\r\n\r\n      this.Speed.y = y - this.Position.y;\r\n\r\n      this.Position.x = x;\r\n\r\n      this.Position.y = y;\r\n\r\n    },\r\n    isIdle: function() {\r\n      return this.speed.x == 0 && this.speed.y == 0;\r\n    }\r\n  },\r\n\r\n  events: {\r\n\r\n    mousemove: [],\r\n    mousepos: [],\r\n    leftclick: [],\r\n    rightclick: [],\r\n    middleclick: [],\r\n    wheelup: [],\r\n    wheelDown: []\r\n  },\r\n\r\n  keymap: {},\r\n\r\n  keyReplace: function(str) {\r\n    return str.toLowerCase().replace('space', ' ').replace('left', String.fromCharCode(37)).replace('left', String.fromCharCode(37)).replace('up', String.fromCharCode(38)).replace('right', String.fromCharCode(39)).replace('down', String.fromCharCode(40));\r\n  },\r\n\r\n  extendKey: function(evt_key, callback, onFinish) {\r\n\r\n    evt_key = this.keyReplace(evt_key);\r\n\r\n    Gamelab.InputSystem.keymap[evt_key] = {\r\n\r\n      down: false,\r\n\r\n      callback: function() {\r\n        callback(evt_key);\r\n      }\r\n    };\r\n\r\n    return Gamelab.InputSystem.keymap[evt_key];\r\n\r\n  },\r\n\r\n  extend: function(evt_key, downCall, upCall, onFinish) {\r\n\r\n    evt_key = evt_key.toLowerCase();\r\n\r\n    //each event-group has object-type\r\n    Gamelab.InputSystem.events[evt_key] = Gamelab.InputSystem.events[evt_key] || [];\r\n\r\n    Gamelab.InputSystem.events[evt_key].push({\r\n\r\n      down: downCall,\r\n\r\n      up: upCall\r\n\r\n    });\r\n\r\n  },\r\n\r\n  init: function() {\r\n\r\n    var MOUSE = this.Mouse;\r\n\r\n    window.setInterval(function() {\r\n\r\n      Gamelab.each(Gamelab.InputSystem.keymap, function(im, kmapItem) {\r\n\r\n        if (kmapItem.down == true) {\r\n\r\n          kmapItem.callback();\r\n\r\n        }\r\n\r\n      });\r\n\r\n    }, 10);\r\n\r\n    document.onkeydown = document.onkeyup = function(e) {\r\n\r\n      e = e || event; // to deal with IE\r\n\r\n      var gs_key_string = 'key_' + String.fromCharCode(e.keyCode),\r\n\r\n        evt_object = Gamelab.InputSystem['keymap'][gs_key_string] || Gamelab.InputSystem['keymap'][gs_key_string.toLowerCase()];\r\n\r\n      if (evt_object) {\r\n        evt_object.down = e.type == 'keydown';\r\n\r\n      }\r\n\r\n    }\r\n\r\n    var canvases = document.querySelectorAll('canvas.gamewindow');\r\n\r\n\r\n    function getMousePos(e, c) {\r\n\r\n      var x;\r\n      var y;\r\n      if (e.pageX || e.pageY) {\r\n        x = e.pageX;\r\n        y = e.pageY;\r\n      } else {\r\n        x = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;\r\n        y = e.clientY + document.body.scrollTop + document.documentElement.scrollTop;\r\n      }\r\n      x -= c.offsetLeft;\r\n      y -= c.style.top;\r\n      return {\r\n        x: x,\r\n        y: y\r\n      };\r\n    }\r\n\r\n    let InputSystem = Gamelab.InputSystem;\r\n\r\n    function mouseMoving(event, c) {\r\n\r\n      var pos = getMousePos(event, c);\r\n\r\n      MOUSE.setPosition(pos.x, pos.y);\r\n\r\n      if (InputSystem.events['mousemove']) {\r\n        Gamelab.each(InputSystem.events['mousemove'], function(ix, el) {\r\n\r\n          el.down(pos.x, pos.y);\r\n\r\n        });\r\n      }\r\n\r\n    };\r\n\r\n    //Interval for mouse-idle time : run mouse move again with same position, no difference\r\n    setInterval(function() {\r\n\r\n      if (InputSystem.events['mousepos']) {\r\n\r\n        var pos = MOUSE.Position;\r\n\r\n        Gamelab.each(InputSystem.events['mousepos'], function(ix, el) {\r\n\r\n          el.down(pos.x, pos.y);\r\n\r\n        });\r\n      }\r\n\r\n    }, 10);\r\n\r\n\r\n    for (var x = 0; x < canvases.length; x++) {\r\n      var c = canvases[x];\r\n\r\n      function applyMouseMove(e) {\r\n        mouseMoving(e, c);\r\n      }\r\n\r\n      console.info('Gamelab-lib-code:main.js: InputSystem applying mousemove');\r\n\r\n      document.addEventListener(\"mousemove\", applyMouseMove);\r\n\r\n      c.onmousedown = function(e) {\r\n        //    alert(JSON.stringify(Gamelab.InputSystem, true, 2));\r\n\r\n        var value = e.which;\r\n        var pos = getMousePos(e, c);\r\n        var InputSystem = Gamelab.InputSystem;\r\n\r\n        e.preventDefault();\r\n\r\n        switch (e.which) {\r\n          case 1:\r\n\r\n            for (var x in InputSystem.events) {\r\n\r\n              if (InputSystem.events[x] instanceof Array && x == 'leftclick') {\r\n\r\n                Gamelab.each(InputSystem.events[x], function(ix, el) {\r\n\r\n                  el.down(pos.x, pos.y);\r\n                });\r\n              }\r\n            }\r\n\r\n            break;\r\n          case 2:\r\n            // alert('Middle Mouse button pressed.');\r\n\r\n            for (var x in Gamelab.InputSystem.events) {\r\n\r\n              if (InputSystem.events[x] instanceof Array && x == 'middleclick') {\r\n\r\n                Gamelab.each(InputSystem.events[x], function(ix, el) {\r\n\r\n                  el.down(pos.x, pos.y);\r\n                });\r\n              }\r\n            }\r\n            break;\r\n          case 3:\r\n            //  alert('Right Mouse button pressed.');\r\n\r\n\r\n            for (var x in Gamelab.InputSystem.events) {\r\n\r\n\r\n              if (InputSystem.events[x] instanceof Array && x == 'rightclick') {\r\n\r\n\r\n                Gamelab.each(InputSystem.events[x], function(ix, el) {\r\n\r\n                  el.down(pos.x, pos.y);\r\n                });\r\n\r\n                return false;\r\n              }\r\n\r\n\r\n            }\r\n\r\n            break;\r\n          default:\r\n\r\n            return 0;\r\n            //alert('You have a strange Mouse!');\r\n\r\n        }\r\n\r\n\r\n        e.preventDefault();\r\n        return 0;\r\n      };\r\n\r\n      c.onmouseup = function(e) {\r\n\r\n        //    alert(JSON.stringify(Gamelab.InputSystem, true, 2));\r\n\r\n        var value = e.which;\r\n        var pos = getMousePos(e, c);\r\n        var InputSystem = Gamelab.InputSystem;\r\n\r\n\r\n        e.preventDefault();\r\n\r\n        switch (e.which) {\r\n          case 1:\r\n\r\n            for (var x in InputSystem.events) {\r\n\r\n\r\n              if (InputSystem.events[x] instanceof Array && x == 'leftclick') {\r\n\r\n\r\n                Gamelab.each(InputSystem.events[x], function(ix, el) {\r\n\r\n                  el.up(pos.x, pos.y);\r\n                });\r\n              }\r\n\r\n\r\n            }\r\n\r\n            break;\r\n          case 2:\r\n            // alert('Middle Mouse button pressed.');\r\n\r\n\r\n            for (var x in Gamelab.InputSystem.events) {\r\n\r\n\r\n              if (InputSystem.events[x] instanceof Array && x == 'middleclick') {\r\n\r\n\r\n                Gamelab.each(InputSystem.events[x], function(ix, el) {\r\n\r\n                  el.up(pos.x, pos.y);\r\n                });\r\n              }\r\n\r\n\r\n            }\r\n            break;\r\n          case 3:\r\n            //  alert('Right Mouse button pressed.');\r\n\r\n\r\n            for (var x in Gamelab.InputSystem.events) {\r\n\r\n\r\n              if (InputSystem.events[x] instanceof Array && x == 'rightclick') {\r\n\r\n\r\n                Gamelab.each(InputSystem.events[x], function(ix, el) {\r\n\r\n                  el.up(pos.x, pos.y);\r\n                });\r\n\r\n\r\n                return false;\r\n\r\n              }\r\n\r\n\r\n            }\r\n\r\n            break;\r\n          default:\r\n\r\n            return 0;\r\n            //alert('You have a strange Mouse!');\r\n\r\n        }\r\n\r\n\r\n      };\r\n    }\r\n\r\n\r\n  }\r\n\r\n\r\n};\r\n\r\n//Override the existing window.onload function\r\n\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n\r\n  Gamelab.callReady();\r\n\r\n});\r\n\r\nGamelab.file_system = {\r\n\r\n  localizedSource: function(src, hostUrl) {\r\n\r\n    hostUrl = hostUrl || \"../\";\r\n\r\n    var gs_folder_ix = src.indexOf('assets/game');\r\n\r\n    return hostUrl + src.substring(gs_folder_ix, src.length);\r\n\r\n  },\r\n\r\n  loadJSON: function(filepath, callback) {\r\n\r\n    function readTextFile(file, callback) {\r\n      var rawFile = new XMLHttpRequest();\r\n      rawFile.open(\"GET\", file, false);\r\n      rawFile.onreadystatechange = function() {\r\n        if (rawFile.readyState === 4) {\r\n          if (rawFile.status === 200 || rawFile.status == 0) {\r\n            callback(rawFile.responseText);\r\n          }\r\n        }\r\n      }\r\n      rawFile.send(null);\r\n    };\r\n\r\n    readTextFile('file:///' + filepath, callback);\r\n\r\n  },\r\n\r\n  loadLevel: function(jsonText, gw, callback) {\r\n\r\n    var data = JSON.parse(jsonText);\r\n\r\n    if (typeof(gw) == 'function' || !gw) {\r\n      callback = gw || callback || function() {};\r\n\r\n      gw = Gamelab.game_windows[0];\r\n    }\r\n\r\n    $.each(data.sprites, function(ix, xitem) {\r\n\r\n      if (typeof(xitem.src) == 'string') {\r\n\r\n        xitem.src = Gamelab.file_system.localizedSource(xitem.src);\r\n      }\r\n\r\n      __gamelabInstance.each(xitem, function(iy, yitem) {\r\n\r\n        if (yitem.src) {\r\n\r\n          yitem.src = Gamelab.file_system.localizedSource(yitem.src);\r\n\r\n        }\r\n\r\n        __gamelabInstance.each(yitem, function(iz, zitem) {\r\n\r\n          if (zitem.src) {\r\n            zitem.src = Gamelab.file_system.localizedSource(zitem.src);\r\n\r\n          }\r\n\r\n\r\n        });\r\n\r\n\r\n      });\r\n\r\n      xitem = new Gamelab.Sprite(xitem);\r\n\r\n      gw.add(xitem);\r\n      //sprite.image = sprite.selected_animation.image;\r\n\r\n\r\n      if (ix >= data.sprites.length - 1) {\r\n\r\n        //last sprite is loaded //WHY DOESN't this work?\r\n\r\n        callback(false, data);\r\n      }\r\n\r\n    });\r\n\r\n  },\r\n\r\n  loadJSONLevel: function(filepath, gw, callback) {\r\n\r\n    if (typeof(gw) == 'function' || !gw) {\r\n      callback = gw || callback || function() {};\r\n\r\n      gw = Gamelab.game_windows[0];\r\n    }\r\n\r\n    this.loadJSON(filepath, function(data) {\r\n\r\n      //localize .src up to three levels of recursion (.src must be altered to refer locally)\r\n\r\n      $.each(data.sprites, function(ix, xitem) {\r\n\r\n        if (typeof(xitem.src) == 'string') {\r\n\r\n          xitem.src = Gamelab.file_system.localizedSource(xitem.src);\r\n        }\r\n\r\n        __gamelabInstance.each(xitem, function(iy, yitem) {\r\n\r\n          if (yitem.src) {\r\n\r\n            yitem.src = Gamelab.file_system.localizedSource(yitem.src);\r\n\r\n          }\r\n\r\n          __gamelabInstance.each(yitem, function(iz, zitem) {\r\n\r\n            if (zitem.src) {\r\n              zitem.src = Gamelab.file_system.localizedSource(zitem.src);\r\n\r\n            }\r\n\r\n\r\n          });\r\n\r\n\r\n        });\r\n\r\n        xitem = new Gamelab.Sprite(xitem);\r\n\r\n        gw.add(xitem);\r\n        //sprite.image = sprite.selected_animation.image;\r\n\r\n\r\n        if (ix >= data.sprites.length - 1) {\r\n\r\n          //last sprite is loaded //WHY DOESN't this work?\r\n\r\n          callback(false, data);\r\n        }\r\n\r\n\r\n      });\r\n\r\n\r\n    });\r\n\r\n  }\r\n\r\n\r\n};\r\n\r\n\r\n\r\n\r\n//reference loadJSON direct from Gamelab::\r\nGamelab.loadJSON = Gamelab.file_system.loadJSON;\r\n//reference loadJSON as loadJson::\r\nGamelab.file_system.loadJson = Gamelab.file_system.loadJSON;\r\nGamelab.loadJson = Gamelab.loadJSON;\r\n\r\n\r\n\r\nGamelab.ready(function(lib) {\r\n\r\n  Gamelab.log('Gamelab: library is ready');\r\n\r\n});\r\n\r\n\r\n/* Screen */\r\n\r\nlet Screen = {\r\n\r\n  size: function() {\r\n    return new Gamelab.Vector(Gamelab.WIDTH, Gamelab.HEIGHT);\r\n  },\r\n\r\n  center: function() {\r\n    return new Gamelab.Vector(Gamelab.WIDTH / 2, Gamelab.HEIGHT / 2).round();\r\n  }\r\n\r\n};\r\n;\r\n/**************************\r\n  EventInterfaceMap: StringKeys:\r\n\r\n    * (must implement without option)\r\n    @ (may implement optional)\r\n*****************************/\r\n\r\n\r\nlet EventInterfaceMap = {  //className / must have named functions whyen carrying Symbol of className\r\n\r\n  Sprite: ['@onUpdate', '@onDestroy'],\r\n\r\n  Animation: ['@onRun', '@onComplete', '*onCollide'],\r\n\r\n  Motion: ['@onCommit', '@onComplete', '*onCollide'],\r\n\r\n  Shot: ['@onShoot', '*onCollide', '*onCollide'],\r\n\r\n  Terrain: ['@onCollide'],\r\n\r\n  Interactive: ['@onCollide'],\r\n\r\n  Global: ['@onUpdate'],\r\n\r\n  check: function(instance) {\r\n    for (var x in this) {\r\n      if (x == 'check')\r\n        continue;\r\n      else {\r\n        if (this[x] instanceof Array) {\r\n          this[x].forEach(function(f) {\r\n            var fkey = f.replace('@', '');\r\n            if (!instance.getOwnPropertyNames.indexOf(fkey) >= 0)\r\n              throw new Error('Object must implement function by name of:' + fkey);\r\n\r\n          });\r\n        }\r\n      }\r\n    };\r\n  }\r\n}\r\n\r\n/**************************\r\n  ObjectFeatureInterfaceMap:\r\n      Indicates classNames, and what they must carry as functions\r\n*****************************/\r\n\r\nlet ObjectFeatureMap = { //className / must have named function properties when carrying Symbol of className\r\n\r\n  Sprite: ['@spatial', '@data'],\r\n\r\n  SpriteGroup:['@relative_spatial', '@data'],\r\n\r\n  SpriteBrush: ['@spatial', '@data'],\r\n\r\n  Frame:['@spatial'],\r\n\r\n  Particle:['@spatial'],\r\n\r\n  RectangularLine:['@spatial'],\r\n\r\n  Circle:['@spatial'],\r\n\r\n  Animation: ['@anchored', '@framedriven', '@effectdriven', '@data'],\r\n\r\n  Line2d:['@spatial', '@pointarrayflippable', '@selftransposable',  '@data'],\r\n\r\n  Text:['@spatial', '@text', '@colored'],\r\n\r\n};\r\n\r\nGamelab.ObjectFeatureMap = ObjectFeatureMap;\r\n\r\n\r\nlet InputIFM = {\r\n\r\n  GamepadButtons: ['@onButton'],\r\n\r\n  GamepadSticks: ['@onStick'],\r\n\r\n  Keyboard: ['@onKey'],\r\n\r\n  MouseMove: ['@onMouseMove'],\r\n\r\n  MouseButton: ['@onMouseButton'],\r\n\r\n  MouseWheel: ['@onMouseWheel'],\r\n\r\n  LeapMotion: ['@onLeapMotion']\r\n\r\n};\r\n\r\n\r\nlet UIEditables = {\r\n\r\n  Sprite: ['size', 'position', 'rotation'],\r\n\r\n  Animation: ['frameBounds', 'etc']\r\n\r\n};\r\n\r\n\r\nlet UIOption = function(name, hint, script) {\r\n  return {\r\n    name,\r\n    hint,\r\n    script\r\n  }\r\n};\r\n\r\nlet UIPrefab = {\r\n\r\n  MainSelect: {\r\n    Interactive: {\r\n\r\n      name: 'FourwayClasticRect',\r\n\r\n      hint: 'Object is collideable on four rectangular sides',\r\n\r\n      script: '#MY-SCRIPT-PATH'\r\n    }\r\n  },\r\n\r\n  FormEditables: {\r\n\r\n    Interactive: []\r\n  }\r\n};\r\n\r\n\r\n\r\nlet UIPrefabMainSelect = {\r\n\r\n  Background: ['Bound']\r\n\r\n};\r\n\r\n\r\nlet getCustomPrefabMeta = function() { //get name and file/data resources for each custom prefab\r\n\r\n};\r\n\r\n/**********************************\r\n\r\n  UIObjectSelectMap:\r\n\r\n    -Just the system default options\r\n\r\n*********************************/\r\n\r\nlet UIObjectPrefabs = {\r\n\r\n  Sprite: ['Side-Scroll-Player', 'Collider', 'Spaceship', 'Robot'],\r\n\r\n};\r\n;\r\n;(function() {\r\n\r\n  /**\r\n   * Creates a new Camera\r\n   * @param {number} x=0 position-x\r\n   * @param {number} y=0 position-y\r\n   * @param {number} z=0 position-z\r\n   * @returns {Camera}\r\n   */\r\n\r\n  class Camera {\r\n    constructor(x, y, z) {\r\n      if (isNaN(x)) {\r\n        x = 0;\r\n      }\r\n\r\n      if (isNaN(y)) {\r\n        y = 0;\r\n      }\r\n\r\n      if (isNaN(z)) {\r\n        z = 0;\r\n      }\r\n\r\n         /**\r\n          * @property {Vector} position the vector-position of Camera\r\n          * @memberof Camera\r\n          **********/\r\n\r\n      this.position = new Gamelab.Vector(x, y, z);\r\n\r\n      this.speed = new Gamelab.Vector(0, 0, 0);\r\n    }\r\n\r\n    update(){\r\n        this.position.x += this.speed.x;\r\n        this.position.y += this.speed.y;\r\n    }\r\n\r\n  }\r\n\r\n  Gamelab.Camera = Camera;\r\n\r\n})();\r\n;\r\n// Converts from degrees to radians.\r\nMath.radians = function(degrees) {\r\n  return degrees * Math.PI / 180;\r\n};\r\n\r\n// Converts from radians to degrees.\r\nMath.degrees = function(radians) {\r\n  return radians * 180 / Math.PI;\r\n};\r\n\r\nclass Circle {\r\nconstructor(radius){\r\nthis.radius = radius;\r\n}\r\nRadius(r)\r\n{\r\n  this.radius = r;\r\n  return this;\r\n}\r\ngetRandomCircumferencePoints(count){\r\n  if(isNaN(count))\r\n  return console.error('needs 1st argument of number --count');\r\n  var points = [], radius = this.radius;\r\n  while (count) {\r\n      var pt_angle = Math.random() * 2 * Math.PI;\r\n      var p = new Gamelab.Vector(Math.cos(pt_angle)*this.radius, Math.sin(pt_angle)* this.radius);\r\n      p.r = pt_angle * 180 / Math.PI;\r\n      points.push(p);\r\n      count--;\r\n  }\r\n  return points;\r\n}\r\ngetRandomPoints(count=1.0){\r\n  if(isNaN(count))\r\n  return console.error('needs 1st argument of number --count');\r\n  var points = [], radius = this.radius;\r\n  while (count) {\r\n      var pt_angle = Math.random() * 2 * Math.PI;\r\n      var pt_radius_sq = Math.random() * radius * radius;\r\n      var x = Math.sqrt(pt_radius_sq) * Math.cos(pt_angle);\r\n      var y = Math.sqrt(pt_radius_sq) * Math.sin(pt_angle);\r\n      points.push(new Gamelab.Vector(x, y));\r\n      count--;\r\n  }\r\n  return points;\r\n}\r\n\r\ngetCircumferencePoint(r)\r\n{\r\n  var pt_angle = Math.radians(r);\r\n  var p = new Gamelab.Vector(Math.cos(pt_angle)*this.radius, Math.sin(pt_angle)* this.radius);\r\n  return p;\r\n}\r\n\r\n\r\n}\r\n\r\n\r\nGamelab.Circle = Circle;\r\n;\r\n\r\n\r\n\r\nlet Collision = {\r\n\r\n  boxCollide(pos1, size1, pos2, size2) {\r\n    return pos1.x >= pos2.x - size1.x &&\r\n      pos1.x <= pos2.x + size2.x &&\r\n      pos1.y >= pos2.y - size1.y &&\r\n      pos1.y <= pos2.y + size2.y;\r\n  },\r\n\r\n  spriteMouseCollide(obj1, obj2, gw){\r\n\r\n    gw = gw || Gamelab.game_windows[0];\r\n    let scale = gw.scale || 1.0;\r\n    var camPos = new Gamelab.Vector(0, 0, 0);\r\n    obj1.padding = obj1.padding || new Gamelab.Vector(0, 0, 0);\r\n\r\n    let S = function(value){ return value * scale; };\r\n\r\n    var paddingX = Math.round(obj1.padding.x * S(obj1.size.x) ),\r\n      paddingY = Math.round(obj1.padding.y * S(obj1.size.y)),\r\n      left = S(obj1.position.x) + paddingX + camPos.x,\r\n      right = S(obj1.position.x) + S(obj1.size.x) - paddingX + camPos.x,\r\n      top = S(obj1.position.y) + camPos.y + paddingY,\r\n      bottom = S(obj1.position.y) + S(obj1.size.y) - paddingY + camPos.y;\r\n    if (right > obj2.position.x && left < obj2.position.x + obj2.size.x &&\r\n      bottom > obj2.position.y && top < obj2.position.y + obj2.size.y) {\r\n      return true;\r\n    }\r\n\r\n  },\r\n\r\n  spriteCollide(obj1, obj2, gw) {\r\n    gw = gw || Gamelab.game_windows[0];\r\n    let scale = gw.scale || 1.0;\r\n    var camPos = new Gamelab.Vector(0, 0, 0);\r\n    obj1.padding = obj1.padding || new Gamelab.Vector(0, 0, 0);\r\n\r\n    let S = function(value){ return value * scale; };\r\n\r\n    var paddingX = Math.round(obj1.padding.x * S(obj1.size.x) ),\r\n      paddingY = Math.round(obj1.padding.y * S(obj1.size.y)),\r\n      left = S(obj1.position.x) + paddingX + camPos.x,\r\n      right = S(obj1.position.x) + S(obj1.size.x) - paddingX + camPos.x,\r\n      top = S(obj1.position.y) + camPos.y + paddingY,\r\n      bottom = S(obj1.position.y) + S(obj1.size.y) - paddingY + camPos.y;\r\n    if (right > S(obj2.position.x) && left < S(obj2.position.x) + S(obj2.size.x) &&\r\n      bottom > S(obj2.position.y) && top < S(obj2.position.y) + S(obj2.size.y)) {\r\n      return true;\r\n    }\r\n  },\r\n\r\n\r\n  //takes 2 arrays, returns array (empy array means no-collision)\r\n  spriteCollideArray(obj1, obj2, gw) {\r\n\r\n          var collisions = [],\r\n              spritesX = obj1 instanceof Array ? obj1 : [obj1],\r\n              spritesY = obj2 instanceof Array ? obj2 : [obj2];\r\n\r\n          for(var x  = 0; x < spritesX.length; x++)\r\n          {\r\n            for(var y  = 0; y < spritesY.length; y++)\r\n            {\r\n              if(this.spriteCollide(spritesX[x], spritesY[y]))\r\n              {\r\n                collisions.push({object:spritesX[x], collider:spritesY[y]});\r\n              }\r\n            }\r\n          }\r\n\r\n          return collisions;\r\n      },\r\n\r\n  spriteCollideTop(obj1, obj2, gw) {\r\n    gw = gw || Gamelab.game_windows[0];\r\n\r\n    var camPos = new Gamelab.Vector(0, 0, 0);\r\n\r\n    obj1.padding = obj1.padding || new Gamelab.Vector(0, 0, 0);\r\n\r\n    var paddingX = Math.round(obj1.padding.x * obj1.size.x),\r\n\r\n      paddingY = Math.round(obj1.padding.y * obj1.size.y),\r\n      left = obj1.position.x + paddingX + camPos.x,\r\n\r\n      right = obj1.position.x + obj1.size.x - paddingX + camPos.x,\r\n\r\n      top = obj1.position.y + camPos.y + paddingY,\r\n      bottom = obj1.position.y + obj1.size.y - paddingY + camPos.y;\r\n\r\n    if (right > obj2.position.x && left < obj2.position.x + obj2.size.x &&\r\n      bottom > obj2.position.y && top < obj2.position.y + obj2.size.y\r\n    ) {\r\n\r\n      return true;\r\n\r\n    }\r\n\r\n  },\r\n\r\n  /*\r\n   *\r\n   *  ##Not known to be working -->> Below function\r\n   *\r\n   * */\r\n\r\n  pixelCollide(sourceSprite, targetSprite, gw) {\r\n    gw = gw || Gamelab.game_windows[0];\r\n\r\n    var camPos = new Gamelab.Vector(0, 0, 0);\r\n\r\n    /* Box model detection, return true on collision */\r\n    function hitBox(source, target) {\r\n      /* Source and target objects contain x, y and width, height */\r\n      return !(\r\n        ((source.y + source.height) < (target.y)) ||\r\n        (source.y > (target.y + target.height)) ||\r\n        ((source.x + source.width) < target.x) ||\r\n        (source.x > (target.x + target.width))\r\n      );\r\n    }\r\n\r\n    var source = {\r\n\r\n        position: sourceSprite.position,\r\n\r\n        pixelMap: sourceSprite.selected_animation.pixelMap\r\n\r\n      },\r\n\r\n      target = {\r\n\r\n        position: targetSprite.position,\r\n\r\n        pixelMap: targetSprite.selected_animation.pixelMap\r\n\r\n      };\r\n\r\n    // Loop through all the pixels in the source image\r\n    for (var s = 0; s < source.pixelMap.length; s++) {\r\n      var sourcePixel = source.pixelMap[s];\r\n      // Add positioning offset\r\n      var sourceArea = {\r\n        x: sourcePixel.x + sourceSprite.position.x,\r\n        y: sourcePixel.y + sourceSprite.position.y,\r\n        width: 1,\r\n        height: 1\r\n      };\r\n\r\n      var relatedPixel;\r\n\r\n      // Loop through all the pixels in the target image\r\n      for (var t = 0; t < target.pixelMap.length; t++) {\r\n        var targetPixel = target.pixelMap[t];\r\n        // Add positioning offset\r\n        var targetArea = {\r\n          x: targetPixel.x + targetSprite.position.x,\r\n          y: targetPixel.y + targetSprite.position.y,\r\n          width: 1,\r\n          height: 1\r\n        };\r\n\r\n        /* Use the earlier aforementioned hitbox function */\r\n        if (hitBox(sourceArea, targetArea)) {\r\n          return true;\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n\r\nGamelab.Collision = Collision;\r\n;\r\n//RGBColor:: Color object\r\nclass RGBColor {\r\n  constructor(r = 0, g = 0, b = 0, a = 0) {\r\n    this.r = r;\r\n    this.g = g;\r\n    this.b = b;\r\n    this.a = a;\r\n  }\r\n\r\n  //Create color from string (rgba-string or hex-string to RGBAColor{})\r\n  fromString(str) {\r\n    if(str.indexOf('#') >= 0) //color-string is hex-color-string\r\n    {\r\n      str = Gamelab.ColorCalc.hexToRgba(str);\r\n    }\r\n\r\n    str = str.replace(/^\\s*#|\\s*$/g, '');\r\n    str = str.toLowerCase();\r\n    if (ColorStrings[str]) str = ColorStrings[str];\r\n\r\n    var match;\r\n    // RGB(A)\r\n    if ((match = str.match(/\\d+/g))) {\r\n\r\n      return new Gamelab.RGBColor(\r\n        parseInt(match[0], 10),\r\n        parseInt(match[1], 10),\r\n        parseInt(match[2], 10),\r\n        1.0\r\n      );\r\n    }\r\n  }\r\n\r\n  //Create color from pixel-data\r\n  fromData(data) {\r\n    return new Gamelab.RGBColor(\r\n      parseInt(data[0], 10),\r\n      parseInt(data[1], 10),\r\n      parseInt(data[2], 10),\r\n      1.0\r\n    );\r\n\r\n  }\r\n\r\n  //Distance between two colors (a 3d distance fxn)\r\n  distance(color) {\r\n    var sumOfSquares = 0;\r\n    sumOfSquares += Math.pow(this.r - color.r, 2);\r\n    sumOfSquares += Math.pow(this.g - color.g, 2);\r\n    sumOfSquares += Math.pow(this.b - color.b, 2);\r\n    return Math.sqrt(sumOfSquares);\r\n  }\r\n\r\n  //Fuzzy Match with tolerance for distance\r\n  match_by_tolerance(color, tolerance) {\r\n\r\n    var matches = {\r\n      r: color.r,\r\n      g: color.g,\r\n      b: color.b\r\n    };\r\n\r\n    var total_diff = 0;\r\n\r\n    for (var x in matches) {\r\n      var diff = Math.abs(color[x] - this[x]);\r\n\r\n      //console.log('COLOR-DIFF: --1::' + jstr(this) + ':: --2::' + jstr(color));\r\n\r\n      total_diff += diff;\r\n    }\r\n\r\n    return total_diff <= tolerance;\r\n\r\n  }\r\n\r\n};\r\n\r\n\r\nGamelab.RGBColor = RGBColor;\r\n\r\n//Color calculations::\r\nGamelab.ColorCalculator = {\r\n\r\n  hexToRgbArray(hex) {\r\n  var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n  return result ? [\r\n    parseInt(result[1], 16),\r\n    parseInt(result[2], 16),\r\n    parseInt(result[3], 16)\r\n  ] : null;\r\n  },\r\n\r\n  rgbFromString: function(rgba_string) {\r\n    return new Gamelab.RGBColor(rgba_string);\r\n  },\r\n\r\n  hexToRgba: function(hex) {\r\n    var c;\r\n    if (/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)) {\r\n      c = hex.substring(1).split('');\r\n      if (c.length == 3) {\r\n        c = [c[0], c[0], c[1], c[1], c[2], c[2]];\r\n      }\r\n      c = '0x' + c.join('');\r\n      return 'rgba(' + [(c >> 16) & 255, (c >> 8) & 255, c & 255].join(',') + ',1)';\r\n    }\r\n    throw new Error('Bad Hex');\r\n  },\r\n\r\n  scaledRGBAFromHex:function(hexcolor_a, hexcolor_b, scalePoint){\r\n\r\n    //get the point between color_a and color_b using value of 0-1 ::\r\n    //scalePoint of 0 = color_a as rgba & scalePoint of 1.0 will return color_b as rgba\r\n\r\n    var rgba_a = this.hexToRgbArray(hexcolor_a),\r\n    rgba_b = this.hexToRgbArray(hexcolor_b);\r\n\r\n\r\n    var finalRgba={\r\n      0:rgba_a[0] + ((rgba_a[0] - rgba_b[0]) * scalePoint * -1.0),\r\n      1:rgba_a[1] + ((rgba_a[1] - rgba_b[1]) * scalePoint * -1.0),\r\n      2:rgba_a[2] + ((rgba_a[2] - rgba_b[2]) * scalePoint * -1.0),\r\n      3:1.0\r\n    };\r\n\r\n    //first 3 values are rounded / whole number\r\n    [0, 1, 2].forEach(function(x){\r\n      if(finalRgba[x] >= 255)\r\n      {\r\n        finalRgba[x] = 255\r\n      }\r\n      finalRgba[x] = Math.round(finalRgba[x]);\r\n    });\r\n\r\n    return \"rgba(\"+ finalRgba[0] +  \",\" + finalRgba[1] + \",\" + finalRgba[2] + \", 1.0)\" ;\r\n  }\r\n\r\n};\r\n\r\n//Css Colors by name::\r\nvar ColorStrings = {\r\n  aliceblue: 'rgb(240, 248, 255)',\r\n  antiquewhite: 'rgb(250, 235, 215)',\r\n  aqua: 'rgb(0, 255, 255)',\r\n  aquamarine: 'rgb(127, 255, 212)',\r\n  azure: 'rgb(240, 255, 255)',\r\n  beige: 'rgb(245, 245, 220)',\r\n  bisque: 'rgb(255, 228, 196)',\r\n  black: 'rgb(0, 0, 0)',\r\n  blanchedalmond: 'rgb(255, 235, 205)',\r\n  blue: 'rgb(0, 0, 255)',\r\n  blueviolet: 'rgb(138, 43, 226)',\r\n  brown: 'rgb(165, 42, 42)',\r\n  burlywood: 'rgb(222, 184, 135)',\r\n  cadetblue: 'rgb(95, 158, 160)',\r\n  chartreuse: 'rgb(127, 255, 0)',\r\n  chocolate: 'rgb(210, 105, 30)',\r\n  coral: 'rgb(255, 127, 80)',\r\n  cornflowerblue: 'rgb(100, 149, 237)',\r\n  cornsilk: 'rgb(255, 248, 220)',\r\n  crimson: 'rgb(220, 20, 60)',\r\n  cyan: 'rgb(0, 255, 255)',\r\n  darkblue: 'rgb(0, 0, 139)',\r\n  darkcyan: 'rgb(0, 139, 139)',\r\n  darkgoldenrod: 'rgb(184, 134, 11)',\r\n  darkgray: 'rgb(169, 169, 169)',\r\n  darkgreen: 'rgb(0, 100, 0)',\r\n  darkgrey: 'rgb(169, 169, 169)',\r\n  darkkhaki: 'rgb(189, 183, 107)',\r\n  darkmagenta: 'rgb(139, 0, 139)',\r\n  darkolivegreen: 'rgb(85, 107, 47)',\r\n  darkorange: 'rgb(255, 140, 0)',\r\n  darkorchid: 'rgb(153, 50, 204)',\r\n  darkred: 'rgb(139, 0, 0)',\r\n  darksalmon: 'rgb(233, 150, 122)',\r\n  darkseagreen: 'rgb(143, 188, 143)',\r\n  darkslateblue: 'rgb(72, 61, 139)',\r\n  darkslategray: 'rgb(47, 79, 79)',\r\n  darkslategrey: 'rgb(47, 79, 79)',\r\n  darkturquoise: 'rgb(0, 206, 209)',\r\n  darkviolet: 'rgb(148, 0, 211)',\r\n  deeppink: 'rgb(255, 20, 147)',\r\n  deepskyblue: 'rgb(0, 191, 255)',\r\n  dimgray: 'rgb(105, 105, 105)',\r\n  dimgrey: 'rgb(105, 105, 105)',\r\n  dodgerblue: 'rgb(30, 144, 255)',\r\n  firebrick: 'rgb(178, 34, 34)',\r\n  floralwhite: 'rgb(255, 250, 240)',\r\n  forestgreen: 'rgb(34, 139, 34)',\r\n  fuchsia: 'rgb(255, 0, 255)',\r\n  gainsboro: 'rgb(220, 220, 220)',\r\n  ghostwhite: 'rgb(248, 248, 255)',\r\n  gold: 'rgb(255, 215, 0)',\r\n  goldenrod: 'rgb(218, 165, 32)',\r\n  gray: 'rgb(128, 128, 128)',\r\n  green: 'rgb(0, 128, 0)',\r\n  greenyellow: 'rgb(173, 255, 47)',\r\n  grey: 'rgb(128, 128, 128)',\r\n  honeydew: 'rgb(240, 255, 240)',\r\n  hotpink: 'rgb(255, 105, 180)',\r\n  indianred: 'rgb(205, 92, 92)',\r\n  indigo: 'rgb(75, 0, 130)',\r\n  ivory: 'rgb(255, 255, 240)',\r\n  khaki: 'rgb(240, 230, 140)',\r\n  lavender: 'rgb(230, 230, 250)',\r\n  lavenderblush: 'rgb(255, 240, 245)',\r\n  lawngreen: 'rgb(124, 252, 0)',\r\n  lemonchiffon: 'rgb(255, 250, 205)',\r\n  lightblue: 'rgb(173, 216, 230)',\r\n  lightcoral: 'rgb(240, 128, 128)',\r\n  lightcyan: 'rgb(224, 255, 255)',\r\n  lightgoldenrodyellow: 'rgb(250, 250, 210)',\r\n  lightgray: 'rgb(211, 211, 211)',\r\n  lightgreen: 'rgb(144, 238, 144)',\r\n  lightgrey: 'rgb(211, 211, 211)',\r\n  lightpink: 'rgb(255, 182, 193)',\r\n  lightsalmon: 'rgb(255, 160, 122)',\r\n  lightseagreen: 'rgb(32, 178, 170)',\r\n  lightskyblue: 'rgb(135, 206, 250)',\r\n  lightslategray: 'rgb(119, 136, 153)',\r\n  lightslategrey: 'rgb(119, 136, 153)',\r\n  lightsteelblue: 'rgb(176, 196, 222)',\r\n  lightyellow: 'rgb(255, 255, 224)',\r\n  lime: 'rgb(0, 255, 0)',\r\n  limegreen: 'rgb(50, 205, 50)',\r\n  linen: 'rgb(250, 240, 230)',\r\n  magenta: 'rgb(255, 0, 255)',\r\n  maroon: 'rgb(128, 0, 0)',\r\n  mediumaquamarine: 'rgb(102, 205, 170)',\r\n  mediumblue: 'rgb(0, 0, 205)',\r\n  mediumorchid: 'rgb(186, 85, 211)',\r\n  mediumpurple: 'rgb(147, 112, 219)',\r\n  mediumseagreen: 'rgb(60, 179, 113)',\r\n  mediumslateblue: 'rgb(123, 104, 238)',\r\n  mediumspringgreen: 'rgb(0, 250, 154)',\r\n  mediumturquoise: 'rgb(72, 209, 204)',\r\n  mediumvioletred: 'rgb(199, 21, 133)',\r\n  midnightblue: 'rgb(25, 25, 112)',\r\n  mintcream: 'rgb(245, 255, 250)',\r\n  mistyrose: 'rgb(255, 228, 225)',\r\n  moccasin: 'rgb(255, 228, 181)',\r\n  navajowhite: 'rgb(255, 222, 173)',\r\n  navy: 'rgb(0, 0, 128)',\r\n  oldlace: 'rgb(253, 245, 230)',\r\n  olive: 'rgb(128, 128, 0)',\r\n  olivedrab: 'rgb(107, 142, 35)',\r\n  orange: 'rgb(255, 165, 0)',\r\n  orangered: 'rgb(255, 69, 0)',\r\n  orchid: 'rgb(218, 112, 214)',\r\n  palegoldenrod: 'rgb(238, 232, 170)',\r\n  palegreen: 'rgb(152, 251, 152)',\r\n  paleturquoise: 'rgb(175, 238, 238)',\r\n  palevioletred: 'rgb(219, 112, 147)',\r\n  papayawhip: 'rgb(255, 239, 213)',\r\n  peachpuff: 'rgb(255, 218, 185)',\r\n  peru: 'rgb(205, 133, 63)',\r\n  pink: 'rgb(255, 192, 203)',\r\n  plum: 'rgb(221, 160, 221)',\r\n  powderblue: 'rgb(176, 224, 230)',\r\n  purple: 'rgb(128, 0, 128)',\r\n  red: 'rgb(255, 0, 0)',\r\n  rosybrown: 'rgb(188, 143, 143)',\r\n  royalblue: 'rgb(65, 105, 225)',\r\n  saddlebrown: 'rgb(139, 69, 19)',\r\n  salmon: 'rgb(250, 128, 114)',\r\n  sandybrown: 'rgb(244, 164, 96)',\r\n  seagreen: 'rgb(46, 139, 87)',\r\n  seashell: 'rgb(255, 245, 238)',\r\n  sienna: 'rgb(160, 82, 45)',\r\n  silver: 'rgb(192, 192, 192)',\r\n  skyblue: 'rgb(135, 206, 235)',\r\n  slateblue: 'rgb(106, 90, 205)',\r\n  slategray: 'rgb(112, 128, 144)',\r\n  slategrey: 'rgb(112, 128, 144)',\r\n  snow: 'rgb(255, 250, 250)',\r\n  springgreen: 'rgb(0, 255, 127)',\r\n  steelblue: 'rgb(70, 130, 180)',\r\n  tan: 'rgb(210, 180, 140)',\r\n  teal: 'rgb(0, 128, 128)',\r\n  thistle: 'rgb(216, 191, 216)',\r\n  tomato: 'rgb(255, 99, 71)',\r\n  turquoise: 'rgb(64, 224, 208)',\r\n  violet: 'rgb(238, 130, 238)',\r\n  wheat: 'rgb(245, 222, 179)',\r\n  white: 'rgb(255, 255, 255)',\r\n  whitesmoke: 'rgb(245, 245, 245)',\r\n  yellow: 'rgb(255, 255, 0)',\r\n  yellowgreen: 'rgb(154, 205, 50)',\r\n\r\n\r\n  //special map Colors\r\n  map_orange: 'rgb(255, 106, 0)',\r\n  map_green: 'rgb(76, 255, 0)',\r\n  map_red: 'rgb(255, 0, 0)',\r\n  map_blue: 'rgb(0, 38, 255)',\r\n  map_darkgreen: 'rgb(38, 127, 0)',\r\n  map_yellow: 'rgb(255, 216, 0)',\r\n  map_aqua: 'rgb(0, 255, 255)',\r\n  map_grey: 'rgb(128, 128, 128)',\r\n  map_gray: 'rgb(128, 128, 128)',\r\n  map_darkgrey: 'rgb(64, 64, 64)',\r\n  map_darkgray: 'rgb(64, 64, 64)',\r\n  map_black: 'rgb(0, 0, 0)',\r\n};\r\n\r\nvar RE_RGB = /^rgb\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)$/;\r\n\r\nGamelab.Colors = {};\r\n\r\nfor (var x in ColorStrings) {\r\n  if (ColorStrings.hasOwnProperty(x)) {\r\n    Gamelab.Colors[x] = new Gamelab.RGBColor().fromString(x);\r\n  }\r\n}\r\n;\r\n\r\n\r\nGamelab.config = Gamelab.config || {\r\n    DEV:true,\r\n    maxErrors:50\r\n};\r\n;(function() {\r\n  console.log('Line() class... creating');\r\n\r\n  var Curves = { //ALL HAVE INPUT AND OUTPUT OF: 0-1.0\r\n    // no easing, no acceleration\r\n    linearNone: function(t) {\r\n      return t\r\n    },\r\n\r\n    zero:function(t){\r\n      return 0;\r\n    },\r\n\r\n    // accelerating from zero velocity\r\n    easeInQuadratic: function(t) {\r\n      return t * t\r\n    },\r\n    // decelerating to zero velocity\r\n    easeOutQuadratic: function(t) {\r\n      return t * (2 - t)\r\n    },\r\n    // acceleration until halfway, then deceleration\r\n    easeInOutQuadratic: function(t) {\r\n      return t < .5 ? 2 * t * t : -1 + (4 - 2 * t) * t\r\n    },\r\n    // accelerating from zero velocity\r\n    easeInCubic: function(t) {\r\n      return t * t * t\r\n    },\r\n    // decelerating to zero velocity\r\n    easeOutCubic: function(t) {\r\n      return (--t) * t * t + 1\r\n    },\r\n    // acceleration until halfway, then deceleration\r\n    easeInOutCubic: function(t) {\r\n      return t < .5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1\r\n    },\r\n    // accelerating from zero velocity\r\n    easeInQuartic: function(t) {\r\n      return t * t * t * t\r\n    },\r\n    // decelerating to zero velocity\r\n    easeOutQuartic: function(t) {\r\n      return 1 - (--t) * t * t * t\r\n    },\r\n    // acceleration until halfway, then deceleration\r\n    easeInOutQuartic: function(t) {\r\n      return t < .5 ? 8 * t * t * t * t : 1 - 8 * (--t) * t * t * t\r\n    },\r\n    // accelerating from zero velocity\r\n    easeInQuintic: function(t) {\r\n      return t * t * t * t * t\r\n    },\r\n    // decelerating to zero velocity\r\n    easeOutQuintic: function(t) {\r\n      return 1 + (--t) * t * t * t * t\r\n    },\r\n    // acceleration until halfway, then deceleration\r\n    easeInOutQuintic: function(t) {\r\n      return t < .5 ? 16 * t * t * t * t * t : 1 + 16 * (--t) * t * t * t * t\r\n    }\r\n  }\r\n\r\n  Gamelab.Curves = Curves;\r\n\r\n  var inOutCurves = {\r\n    quadratic: function(t) {\r\n      return t < .5 ? 2 * t * t : -1 + (4 - 2 * t) * t\r\n    },\r\n    cubic: function(t) {\r\n      return t < .5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1\r\n    },\r\n    quartic: function(t) {\r\n      return t < .5 ? 8 * t * t * t * t : 1 - 8 * (--t) * t * t * t\r\n    },\r\n    quintic: function(t) {\r\n      return t < .5 ? 16 * t * t * t * t * t : 1 + 16 * (--t) * t * t * t * t\r\n    },\r\n    linear: function(t) {\r\n      return t;\r\n    } //provided for consistency / in case 'linear' is needed\r\n  };\r\n\r\n\r\n  Gamelab.Curves.Smooth = inOutCurves;\r\n  Gamelab.Curves.InOut = inOutCurves;\r\n\r\n\r\n})();\r\n;\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass FeildSpan {\r\n  constructor(a, b, transition = 'linear', duration = 500) {\r\n    //console.log('FeildSpan(a, b, transition) :: transition may be the key-name of a curve or \"random\"');\r\n\r\n    if(typeof a == 'number' && b == undefined)\r\n      transition = 'fixed';\r\n\r\n    this.a = a;\r\n    this.b = b;\r\n    this.transition = transition;\r\n    this.duration = duration;\r\n    this.ticker = 0;\r\n\r\n    this.Duration = function(d) {\r\n      this.duration = d;\r\n      return this;\r\n    };\r\n\r\n    this.Clone = function() {\r\n      return new FeildSpan(this.a, this.b, this.transition, this.duration);\r\n    };\r\n\r\n    this.max = function(){\r\n      if(typeof this.a == 'number' && typeof this.b !== 'number')\r\n      return this.a;\r\n      else\r\n      return this.a >= this.b ? this.a : this.b;\r\n    };\r\n\r\n    this.Reset = function() {\r\n      this.ticker = 0;\r\n      return this;\r\n    };\r\n\r\n    this.getValue = function() {\r\n\r\n      if(this.transition == 'fixed')\r\n      return this.a;\r\n\r\n      var option = this,\r\n\r\n        value = 0,\r\n\r\n        diff = option.a - option.b;\r\n        option.duration = option.duration || 500;\r\n        var tvalue = option.transition;\r\n\r\n        var curveMethod;\r\n\r\n      for (var x in Twix.Curves) {\r\n        if (x.toLowerCase() == option.transition.toLowerCase())\r\n          curveMethod = Twix.Curves[x].None || Twix.Curves[x].In;\r\n      }\r\n\r\n      if(tvalue == 'random-once' && this.testValue !== undefined)\r\n      {\r\n        return this.testValue;\r\n      }\r\n\r\n      else if (tvalue == 'random-once' || tvalue == 'random') {\r\n\r\n        option.ticker += 1;\r\n\r\n        var finalValue = option.a;\r\n\r\n        if (option.a <= option.b) {\r\n          return option.a + Math.abs((Math.random() * diff));\r\n        } else {\r\n          return option.a - Math.abs((Math.random() * diff));\r\n        }\r\n\r\n\r\n      } else if (curveMethod) {\r\n\r\n        var portion = Math.round((option.ticker / option.duration) * 100) / 100;\r\n\r\n        option.ticker += 1;\r\n\r\n        diff = Math.abs(diff);\r\n\r\n        var curveStep = Math.abs(curveMethod(portion) * diff);\r\n\r\n        var finalValue = option.a;\r\n\r\n        finalValue += option.a > option.b ? curveStep * -1 : curveStep;\r\n\r\n        if (option.ticker >= option.duration) {\r\n          return option.b;\r\n        }\r\n\r\n        return Math.round(finalValue * 100) / 100;\r\n      }\r\n    };\r\n\r\n\r\n    this.testValue = this.getValue();\r\n\r\n  }\r\n}\r\n\r\n\r\n\r\nclass ColorFeildSpan {\r\n\r\n  constructor(a, b, transition = 'linear', duration = 500, colors=[]) {\r\n\r\n    if(typeof a == 'string' && b == undefined)\r\n      transition = 'fixed';\r\n\r\n    this.a = a;\r\n    this.b = b;\r\n    this.transition = transition;\r\n    this.duration = duration;\r\n    this.ticker = 0;\r\n    this.colors = colors;\r\n\r\n    this.Duration = function(d) {\r\n      this.duration = d;\r\n      return this;\r\n    };\r\n\r\n    this.Clone = function() {\r\n      return new ColorFeildSpan(this.a, this.b, this.transition, this.duration, this.colors);\r\n    };\r\n\r\n    this.hasVariance = function(){\r\n        return this.transition !== 'fixed';\r\n    };\r\n\r\n    this.PrepareColors = function(){\r\n      //runs 100 X , creates set of differential colors on the specified scale\r\n\r\n      for (var x = 0.0; x <= 1.0; x += 0.01) {\r\n        //use the x value to get the set of y values for this transition | curve (ex 'cubic')\r\n        var tvalue = this.transition !== 'random' ? this.transition : 'linear';\r\n        var option = this,\r\n          value = 0;\r\n\r\n        var curveMethod;\r\n\r\n        option.duration = option.duration || 500;\r\n\r\n        //if 'random' then create a linear scale to select from\r\n        if (this.transition == 'random') {\r\n          tvalue = 'linear';\r\n        }\r\n\r\n        if(this.transition == 'fixed')\r\n        {\r\n        this.colors.push(Gamelab.ColorCalculator.scaledRGBAFromHex(option.a, option.a, 0));\r\n        continue;\r\n        }\r\n\r\n        var portion = x;\r\n\r\n        this.colors.push(Gamelab.ColorCalculator.scaledRGBAFromHex(option.a, option.b, portion));\r\n      };\r\n\r\n      return this;\r\n    };\r\n\r\n    this.Reset = function() {\r\n      this.ticker = 0;\r\n      return this;\r\n    };\r\n\r\n    this.min = function(){\r\n\r\n      if(typeof this.a == 'number' && this.b == undefined)\r\n      return this.a;\r\n\r\n      if(this.a <= this.b)\r\n      return this.a;\r\n      else{\r\n        return this.b;\r\n      }\r\n    };\r\n\r\n    this.max = function(){\r\n\r\n      if(typeof this.a == 'number' && this.b == undefined)\r\n      return this.a;\r\n\r\n      if(this.a >= this.b)\r\n      return this.a;\r\n      else{\r\n        return this.b;\r\n      }\r\n    };\r\n\r\n    this.getPortion = function(){\r\n      return this.ticker / this.duration;\r\n    };\r\n\r\n\r\n    //getValue :: returns the color for current step\r\n    this.getValue = function() {\r\n      //calculate portion as step 0.0 - 1.0\r\n      var portion = this.ticker / this.duration;\r\n\r\n      //increment ticker\r\n      this.ticker += 1;\r\n\r\n      //handle random transition\r\n      if (this.transition == 'random') {\r\n        return this.colors[Math.floor(Math.random() * this.colors.length)];\r\n      }\r\n\r\n      if(this.transition == 'fixed')\r\n      return this.colors[0];\r\n\r\n      //get the correct array-member of index 0-99 using portion\r\n      return this.colors[Math.floor(portion * 100)];\r\n    };\r\n\r\n  }\r\n\r\n}\r\n\r\nGamelab.FeildSpan = FeildSpan;\r\nGamelab.ColorFeildSpan = ColorFeildSpan;\r\n;class FiringClock {\r\n  constructor() {\r\n    this.ticker = 0;\r\n    this.skip = 0;\r\n    this.duration = 200;\r\n    this.repeats = 0;\r\n    this.callback = function() {};\r\n    this.callback_arguments = {};\r\n    this.chance = 1.0;\r\n    this.every = 1.0;\r\n    this.skipMin = -1;\r\n    this.skipMax = -1;\r\n    this.lockout = 0; //when > 0 cannot fire / locked;\r\n  }\r\n\r\n  Reset(){\r\n    this.ticker = 0;\r\n    return this;\r\n  }\r\n\r\n  NeverDie(){\r\n    this.duration = Infinity;\r\n    return this;\r\n  }\r\n\r\n  Callback(c, args) {\r\n    this.callback = c;\r\n    this.callback_arguments = args;\r\n    return this;\r\n  }\r\n\r\n  Repeat(repeats) {\r\n    this.repeats = repeats;\r\n    return this;\r\n  }\r\n\r\n  Skip(min, max) {\r\n    this.skipMin = min;\r\n    this.skipMax = max;\r\n    return this;\r\n  }\r\n\r\n  Duration(d) {\r\n    this.duration = d;\r\n    return this;\r\n  }\r\n\r\n  Lockout(l)\r\n  {\r\n    this.lockout = l;\r\n    return this;\r\n  }\r\n\r\n  Every(millis)\r\n  {\r\n    if(millis >= 1)\r\n    this.every = millis;\r\n    return this;\r\n  }\r\n\r\n  Chance(c) {\r\n    this.chance = c;\r\n    return this;\r\n  }\r\n\r\n  hasChance() {\r\n    return this.lockout <= 0 && Math.random() * 1.0 <= this.chance;\r\n  }\r\n\r\n  skipTime() {\r\n    return this.ticker >= this.skipMin && this.ticker <= this.skipMax;\r\n  }\r\n\r\n  fire(callback) {\r\n\r\n    this.lockout--;\r\n\r\n    if (!this.hasChance())\r\n      return;\r\n\r\n    if (callback)\r\n      this.callback = callback;\r\n\r\n    if(this.ticker % this.every !== 0)\r\n    return;\r\n\r\n    if (this.repeat > 0 && this.ticker >= this.duration) {\r\n      this.ticker = 0;\r\n      this.repeat--;\r\n    }\r\n\r\n    if (this.ticker <= this.duration && !this.skipTime()) {\r\n      this.callback(this.callback_arguments);\r\n    }\r\n\r\n    this.ticker += 1;\r\n  }\r\n}\r\n\r\nGamelab.FiringClock = FiringClock;\r\n;/**\r\n * Creates a new GameWindow\r\n * <iframe style='width:400px; height:450px; overflow:hidden;' src='./html/iframe-error.html'> </iframe>\r\n * @param   {Object} canvas the canvas element for this gameWindow. --GameWindow's if not supplied, the constructor will create a full-screen canvas, if a canvas.\r\n * @param   {Array} drawables=[] a list of drawable objects to be drawn. --Drawables can also be added after constructor call.\r\n * @returns {GameWindow} a Gamelab.GameWindow object\r\n * */\r\n\r\nclass GameWindow {\r\n  constructor(canvas = false, drawables = []) {\r\n\r\n    /**\r\n     * list of all drawables in the window.\r\n     *\r\n     * @property this.drawables\r\n     * @memberof GameWindow\r\n     **********/\r\n\r\n    this.drawables = drawables;\r\n    this.bool_events = Gamelab.bool_events || [];\r\n    this.settings = {};\r\n\r\n\r\n    this.paused = false;\r\n    this.drawFromWindows = false;\r\n\r\n    /**\r\n     * the html-canvas of the GameWindow.\r\n     *\r\n     * @property this.canvas\r\n     * @memberof GameWindow\r\n     **********/\r\n\r\n    this.canvas = canvas || false;\r\n\r\n    this.engaged = true;\r\n\r\n    if (!canvas) {\r\n      console.info('GameWindow() had no {canvas:canvas} argument. Creating a new canvas in document.body...');\r\n      this.canvas = document.createElement('CANVAS');\r\n      this.canvas.setAttribute('class', 'gamewindow');\r\n      document.body.append(this.canvas);\r\n    }\r\n\r\n    this.context = this.canvas.getContext('2d');\r\n\r\n    document.body.style.position = \"absolute\";\r\n    document.body.style.width = \"100%\";\r\n    document.body.style.height = \"100%\";\r\n\r\n    /**\r\n     * the camera of the GameWindow. --An instance of Gamelab.Camera\r\n     *\r\n     * @property this.camera\r\n     * @memberof GameWindow\r\n     **********/\r\n\r\n\r\n    this.camera = new Gamelab.Camera();\r\n\r\n    this.camera.target = false;\r\n\r\n    Gamelab.camera = this.camera;\r\n\r\n    var __inst = this;\r\n\r\n    this.Size();\r\n\r\n    this.update_ext = [];\r\n    this.resize_ext = [];\r\n\r\n    window.onresize = function() {\r\n\r\n      if (__inst.isAbsoluteSize)\r\n        return;\r\n\r\n      __inst.Size();\r\n\r\n      __inst.resize_ext.forEach(function(f){\r\n\r\n          f.bind(this).call();\r\n\r\n      });\r\n\r\n    };\r\n\r\n    this.ctx = this.canvas.getContext('2d');\r\n\r\n    Gamelab.game_windows.push(this);\r\n\r\n\r\n    window.onerror = function() {\r\n\r\n      Gamelab.errors += 1;\r\n\r\n      console.log('Canvas Error --');\r\n\r\n      if (Gamelab.errors > Gamelab.config.maxErrors) {\r\n        Gamelab.stopDraw = true;\r\n\r\n        var call = call || window.setTimeout(function() {\r\n\r\n          if (call) {\r\n            window.clearTimeout(call);\r\n          }\r\n          console.log('%cDraw stopped at errorLimit:' + Gamelab.settings.errorLimit, 'color:darkorange;');\r\n\r\n        }, 200);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    this.domElement = this.canvas;\r\n\r\n  }\r\n\r\n  FromArray(array){\r\n    this.drawFromWindows = [];\r\n    return this;\r\n  }\r\n\r\n  Offscreen(o){\r\n    this.offscreen = o;\r\n    this.canvas.display = 'none';\r\n    return this;\r\n  }\r\n\r\n  isPaused() {\r\n    return this.paused;\r\n  }\r\n\r\n  setPause(p) {\r\n    this.paused = p;\r\n    return this;\r\n  }\r\n\r\n  getImageData(x, y, w, h) {\r\n\r\n    return this.ctx.getImageData(x, y, w, h);\r\n\r\n  }\r\n\r\n\r\n  /**\r\n   * returns the gameWindow.canvas property, an HTMLCanvasElement\r\n   *\r\n   * @function\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n  getCanvas() {\r\n    return this.canvas;\r\n  }\r\n\r\n\r\n  /**\r\n   * returns a vector(x, y) showing the center of the GameWindow\r\n   *\r\n   * @function\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n\r\n  center() {\r\n    return new Gamelab.Vector(Math.round(this.canvas.width / 2), Math.round(this.canvas.height / 2));\r\n  }\r\n\r\n  \r\n\r\n  TrackStat() {\r\n\r\n    this.__trackStat = true;\r\n    return this;\r\n  }\r\n\r\n\r\n  GridUnit(x, y, w, h, srcImage_Path) {\r\n\r\n    var size = new Gamelab.Vector(w, h),\r\n      position = new Gamelab.Vector(x, y);\r\n\r\n    var sprite;\r\n\r\n    if (srcImage_Path) {\r\n      sprite = new Gamelab.Sprite(srcImage_Path);\r\n      sprite.Size(size);\r\n      sprite.Pos(position);\r\n\r\n      Gamelab.game_windows[0].add(sprite);\r\n    }\r\n\r\n    return {\r\n      size: size,\r\n      position: position\r\n    };\r\n  }\r\n\r\n\r\n  onMouseMove(callback) {\r\n\r\n    var canvas = this.canvas;\r\n\r\n    this.canvas.addEventListener('mousemove', function(evt) {\r\n\r\n      var x = evt.clientX,\r\n        y = evt.clientY;\r\n\r\n      const rect = canvas.getBoundingClientRect();\r\n\r\n      x -= rect.left;\r\n      y -= rect.top;\r\n\r\n      callback(x, y);\r\n\r\n    });\r\n  }\r\n\r\n\r\n  onMouseClick(callback) {\r\n    var canvas = this.canvas;\r\n    this.canvas.addEventListener('click', function(evt) {\r\n      var x = evt.clientX,\r\n        y = evt.clientY;\r\n      const rect = canvas.getBoundingClientRect();\r\n      x -= rect.left;\r\n      y -= rect.top;\r\n      callback(x, y, evt);\r\n    });\r\n  }\r\n\r\n\r\n  onMouseWheel(callback, kill) {\r\n    var canvas = this.canvas;\r\n    this.canvas.addEventListener('mousewheel', function(evt) {\r\n      var x = evt.clientX,\r\n        y = evt.clientY;\r\n      const rect = canvas.getBoundingClientRect();\r\n      x -= rect.left;\r\n      y -= rect.top;\r\n      callback(x, y, evt.wheelDelta > 0 ? 1 : -1, evt);\r\n      if (kill) {\r\n        evt.preventDefault();\r\n        return true;\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n  /**\r\n   * creates an array of gridUnits\r\n   *\r\n   * @function\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n  GridStyle(total_x, total_y, w, h, srcImage_Path) {\r\n\r\n    if (!(this.grid instanceof Array)) {\r\n      this.grid = [];\r\n    }\r\n\r\n    function GridUnit(x, y, w, h, srcImage_Path) {\r\n\r\n      var size = new Gamelab.Vector(w, h),\r\n        position = new Gamelab.Vector(x, y);\r\n\r\n      var sprite;\r\n\r\n      if (srcImage_Path) {\r\n        sprite = new Gamelab.Sprite(srcImage_Path);\r\n        sprite.Size(size);\r\n        sprite.Pos(position);\r\n\r\n        Gamelab.game_windows[0].add(sprite);\r\n      }\r\n\r\n      return {\r\n        size: size,\r\n        position: position\r\n      };\r\n    };\r\n\r\n    for (var y = 0; y < total_y; y++) {\r\n\r\n      for (var x = 0; x < total_x; x++) {\r\n\r\n        this.grid.push(new GridUnit(x * w, y * h, w, h, srcImage_Path));\r\n\r\n      }\r\n\r\n    }\r\n    return this;\r\n  }\r\n\r\n  getCanvas() {\r\n    return this.canvas;\r\n  }\r\n\r\n  /**\r\n   * adds an update to the GameWindow:: update to be called every 20 milliseconds\r\n   *\r\n   * @function\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n\r\n  onUpdate(f) {\r\n\r\n    this.update_ext.push(f);\r\n\r\n  }\r\n\r\n\r\n  /**\r\n   * adds a resize call to the GameWindow:: resize to be called when window size changes\r\n   *\r\n   * @function\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n\r\n  onResize(r) {\r\n\r\n    this.resize_ext.push(r);\r\n\r\n  }\r\n\r\n  /**\r\n   * the main update for the GameWindow:: called automatically after call of GameWindow.start() or GameWindow.animate()\r\n   *\r\n   * @function\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n  update() {\r\n\r\n    if (this.isPaused())\r\n      return;\r\n\r\n\r\n          if (this.camera && this.camera.update)\r\n            this.camera.update();\r\n\r\n    var sortDrawables = function(arr, key) {\r\n      return arr.sort((a, b) => {\r\n        return a[key] - b[key];\r\n      });\r\n    };\r\n\r\n    sortDrawables(this.drawables, \"layer\");\r\n\r\n    Gamelab.each(this.drawables, function(ix, item) {\r\n\r\n      if (item && typeof(item.def_update) == 'function') {\r\n        item.def_update(item);\r\n      }\r\n\r\n      if (item && typeof(item.update) == 'function') {\r\n        item.update(item);\r\n      }\r\n\r\n\r\n      if (item && ['SpriteArray', 'RobotixArray', 'RobotixVerticalChain'].indexOf(item.constructor.name) >= 0 &&\r\n        typeof item.each == 'function') {\r\n\r\n        item.each(function(ix, graphic) {\r\n\r\n          graphic.update(graphic);\r\n\r\n        });\r\n\r\n      }\r\n\r\n    });\r\n\r\n    Gamelab.each(this.bool_events, function(ix, item) {\r\n\r\n      if (item && item.bool()) {\r\n        item.callback();\r\n      }\r\n\r\n    });\r\n\r\n\r\n    for (var x in this.update_ext) {\r\n      this.update_ext[x]();\r\n    }\r\n\r\n\r\n  }\r\n\r\n  reset_draw() {\r\n    this.before_draw_ext = function() {};\r\n  }\r\n\r\n  disengage() {\r\n    this.drawables = [];\r\n    this.engaged = false;\r\n    this.reset_draw();\r\n  }\r\n\r\n  engage() {\r\n    this.engaged = true;\r\n  }\r\n\r\n  draw(canvas) {\r\n\r\n    if(canvas instanceof HTMLCanvasElement)\r\n    this.ctx.drawImage(canvas, 0, 0, canvas.width, canvas.height);\r\n\r\n    else if(typeof canvas == 'object' && canvas.canvas instanceof HTMLCanvasElement)\r\n    this.ctx.drawImage(canvas.canvas, canvas.canvas.width, canvas.canvas.height);\r\n\r\n    if (this.isPaused())\r\n      return;\r\n\r\n    var __gameWindow = this;\r\n\r\n    if (this.before_draw_ext) {\r\n      this.before_draw_ext();\r\n    }\r\n\r\n    Gamelab.each(this.drawables, function(ix, item) {\r\n\r\n      if (typeof item.draw == 'function') {\r\n        item.draw(__gameWindow.ctx, __gameWindow.camera);\r\n      }\r\n\r\n    });\r\n\r\n\r\n    if (this.after_draw_ext) {\r\n      this.after_draw_ext();\r\n    }\r\n\r\n  }\r\n\r\n\r\n  defineComplete(getComplete){\r\n    this.getComplete = getComplete;\r\n    return this;\r\n  }\r\n\r\n  complete(){\r\n\r\n    if(this.complete_callback)\r\n    this.complete_callback();\r\n\r\n  }\r\n\r\n  onComplete(completion){\r\n    this.complete_callback = completion;\r\n    return this;\r\n  }\r\n\r\n\r\n  /**\r\n   * adds a call before the GameWindow draw()\r\n   *\r\n   * @function\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n  onBeforeDraw(f) {\r\n\r\n    var boundCall = f.bind(this);\r\n\r\n    if (!this.before_draw_ext)\r\n      this.before_draw_ext = function() {};\r\n\r\n    var beforeDraw = this.before_draw_ext.bind(this);\r\n\r\n    this.before_draw_ext = function() {\r\n      beforeDraw();\r\n      boundCall();\r\n    };\r\n\r\n  }\r\n\r\n  removeSelf(){\r\n    this.canvas.parentNode.removeChild(this.canvas);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * adds a call after the GameWindow draw()\r\n   *\r\n   * @function\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n\r\n  onAfterDraw(f) {\r\n\r\n    var boundCall = f.bind(this);\r\n\r\n    if (!this.after_draw_ext)\r\n      this.after_draw_ext = function() {};\r\n\r\n\r\n    var afterDraw = this.after_draw_ext.bind(this);\r\n\r\n    this.after_draw_ext = function() {\r\n      afterDraw();\r\n      boundCall();\r\n    };\r\n\r\n  }\r\n\r\n  /**\r\n   * sets the size of the GameWindow\r\n   *\r\n   * @function\r\n   * @param {integer} w the width of the GameWindow\r\n   * @param {integer} h the HEIGHT of the GameWindow\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n  Size(w, h, isAbsoluteSize) { //call with no args to fill to browser-window-size;\r\n\r\n    w = w || this.canvas.parentNode.clientWidth;\r\n\r\n    h = h || this.canvas.parentNode.clientHeight;\r\n\r\n    var c = this.canvas;\r\n\r\n    if (c) {\r\n      c.setAttribute('width', w)\r\n    };\r\n\r\n    if (c) {\r\n      c.setAttribute('height', h)\r\n    };\r\n\r\n    Gamelab.WIDTH = w;\r\n\r\n    Gamelab.HEIGHT = h;\r\n\r\n    this.canvas.width = w;\r\n\r\n    this.canvas.height = h;\r\n\r\n    this.size = new Gamelab.Vector(w, h);\r\n\r\n    this.isAbsoluteSize = isAbsoluteSize || false;\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n  /**\r\n   * adds an object to the GameWindow\r\n   *\r\n   * @function\r\n   * @param {Object} obj the object to be added (Sprite)\r\n   * @param {Boolean} onBottom if true, adds to the bottom of layer-stack in GameWindow\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n  add(obj) {\r\n\r\n    if(obj instanceof Array)\r\n    {\r\n      var $gw = this;\r\n      obj.forEach(function(o){\r\n          $gw.add(o);\r\n      });\r\n      return;\r\n    }\r\n\r\n    var __inst = this;\r\n\r\n    if (obj instanceof Gamelab.Camera) {\r\n\r\n      this.camera = obj;\r\n\r\n    } else if (obj instanceof Gamelab.GSEvent) {\r\n\r\n      if (Gamelab.__running) {\r\n\r\n        return console.error('Events can only be added before Gamstack.animate() is called::aka before the main update / loop begins');\r\n      } else {\r\n\r\n        obj.apply();\r\n\r\n      }\r\n    } else {\r\n\r\n      this.drawables.push(obj);\r\n\r\n    };\r\n\r\n    return obj;\r\n\r\n  }\r\n\r\n  /**\r\n   * set background-color of GameWindow\r\n   *\r\n   * @function\r\n   * @param {string} c the new background-color for GameWindow\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n  Background(c) {\r\n    this.canvas.style.background = c;\r\n    this.canvas.style.backgroundColor = c;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * removes an object from the GameWindow\r\n   *\r\n   * @function\r\n   * @param {Object} obj the object to be removed (Sprite)\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n  remove(obj) {\r\n    var ix = this.drawables.indexOf(obj);\r\n    if (ix >= 0) {\r\n      this.drawables.splice(ix, 1);\r\n    }\r\n  }\r\n\r\n  has(obj) {\r\n\r\n    var ix = this.drawables.indexOf(obj);\r\n\r\n    if (ix >= 0) {\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n\r\n  removeDeadObjects() {\r\n\r\n    var $window = this;\r\n\r\n    this.drawables.forEach(function(sprite) {\r\n\r\n      if (sprite.life <= 0) {\r\n        $window.remove(sprite);\r\n        if (sprite.die_callback) {\r\n          sprite.die_callback();\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n  cleanup(){\r\n\r\n    this.removeDeadObjects();\r\n\r\n  }\r\n\r\n\r\n  /**\r\n   * begins the animation-loop of GameWindow.\r\n   *\r\n   * @function\r\n   * @param {number} time optional time parameter for usage with Tween\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n  run(time=0, options={}){\r\n\r\n    if(options.DEV || options.dev)\r\n    {\r\n      this.start(time);\r\n    }\r\n\r\n    else\r\n    this.animate(time);\r\n\r\n  }\r\n\r\n  animate(time) {\r\n\r\n    if (!this.engaged)\r\n      return;\r\n\r\n    if(this.drawFromWindows instanceof Array)\r\n    {\r\n      this.drawFromWindows.forEach(function(w){\r\n        this.draw(w);\r\n      });\r\n      return;\r\n    }\r\n\r\n    if(this.getComplete && this.getComplete())\r\n    {\r\n      return;\r\n    }\r\n\r\n    var __inst = this;\r\n\r\n    requestAnimationFrame(function() {\r\n      __inst.animate();\r\n    });\r\n\r\n    if (this.__stats) {\r\n      this.__stats.begin();\r\n      this.__statsMS.begin();\r\n      this.__statsMB.update();\r\n    }\r\n\r\n    Gamelab.isAtPlay = true;\r\n\r\n    this.update();\r\n\r\n    if (!this.isPaused()) {\r\n      if (window.TWEEN)\r\n        TWEEN.update(time);\r\n\r\n      if (this.settings.hasOwnProperty('autoClear') && this.settings.autoClear == false) {\r\n\r\n      } else {\r\n        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n      }\r\n\r\n      this.draw();\r\n\r\n      if (this.__stats) {\r\n        this.__stats.end();\r\n        this.__statsMS.end();\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * begins the animation-loop of GameWindow, with performance Stats shown on-screen\r\n   *\r\n   * @function\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n\r\n  start() {\r\n\r\n    if (typeof(Stats) == 'function') //Stats library exists\r\n    {\r\n      //basic stat animation\r\n      this.__stats = new Stats();\r\n      this.__stats.showPanel(0); // 0: fps, 1: ms, 2: mb, 3+: custom\r\n\r\n      this.__stats.dom.style.left = '10%';\r\n\r\n      this.__stats.dom.setAttribute('class', 'stat');\r\n\r\n      this.canvas.parentNode.appendChild(this.__stats.dom);\r\n\r\n      //basic stat animation\r\n      this.__statsMS = new Stats();\r\n      this.__statsMS.showPanel(1); // 0: fps, 1: ms, 2: mb, 3+: custom\r\n\r\n      this.__statsMS.dom.style.left = '10%';\r\n\r\n      this.__statsMS.dom.style.marginLeft = '90px';\r\n\r\n      this.__statsMS.dom.setAttribute('class', 'stat');\r\n\r\n      this.canvas.parentNode.appendChild(this.__statsMS.dom);\r\n\r\n      //basic stat animation\r\n      this.__statsMB = new Stats();\r\n      this.__statsMB.showPanel(2); // 0: fps, 1: ms, 2: mb, 3+: custom\r\n\r\n      this.__statsMB.dom.style.left = '10%';\r\n\r\n      this.__statsMB.dom.setAttribute('class', 'stat');\r\n\r\n      this.__statsMB.dom.style.marginLeft = '180px';\r\n\r\n      this.canvas.parentNode.appendChild(this.__statsMB.dom);\r\n    }\r\n\r\n    this.animate();\r\n  }\r\n}\r\n\r\nGamelab.GameWindow = GameWindow;\r\n;/**\r\n * Creates a new Module\r\n * @param   {string} uri the uri that the .js file is located at\r\n * @param   {Function} callback=function(){} The callback to call after the module is loaded\r\n * @returns {Module} a Gamelab.Module object\r\n * */\r\n\r\nclass Module {\r\n\r\n  constructor(uri, callback) {\r\n    if (uri)\r\n      this.load(uri, callback);\r\n  }\r\n\r\n  readFile(fileObject, callback) {\r\n    var reader = new FileReader();\r\n    reader.onload = function(e) {\r\n      callback(reader.result);\r\n    }\r\n    reader.readAsText(fileObject);\r\n  }\r\n\r\n  load(uri, callback) {\r\n\r\n    var __object = this;\r\n\r\n    this.uri = uri;\r\n\r\n    callback = callback || function() {};\r\n\r\n    callback = callback.bind(this);\r\n\r\n    var script = document.createElement('SCRIPT'),\r\n\r\n    executeNow = false;\r\n\r\n    if (uri.toLowerCase().endsWith('.js')) {\r\n      script.src = uri;\r\n    } else {\r\n      //assumed to be raw value\r\n      var data = uri;\r\n      executeNow = true;\r\n      script.appendChild(document.createTextNode(data));\r\n    }\r\n\r\n    //be sure the window.module is set to new {}\r\n    window.module = window.module || {};\r\n\r\n    //define onload fxn\r\n    script.onload = function() {\r\n\r\n      var construct = window.module.exports;\r\n      callback(construct, uri);\r\n\r\n    };\r\n\r\n    if(executeNow)\r\n    {\r\n      setTimeout(function(){\r\n        var construct = window.module.exports;\r\n        callback(construct, uri);\r\n      }, 250);\r\n    }\r\n\r\n    //append to the document\r\n    document.head.appendChild(script);\r\n\r\n  }\r\n\r\n};\r\n\r\nGamelab.Module = Module;\r\n\r\n\r\nclass Code {\r\n\r\n  constructor() {\r\n\r\n  }\r\n\r\n  loadAndRun(uri, callback) {\r\n\r\n    var __object = this;\r\n\r\n    this.uri = uri;\r\n\r\n    callback = callback || function() {};\r\n\r\n    callback = callback.bind(this);\r\n\r\n    var script = document.createElement('SCRIPT');\r\n    script.src = uri;\r\n\r\n    //be sure the window.module is set to new {}\r\n    window.module = window.module || {};\r\n\r\n    //define onload fxn\r\n    script.onload = function() {\r\n      var construct = window.module.exports;\r\n      var value;\r\n      if (typeof construct == 'function') {\r\n        value = window.module.exports();\r\n      }\r\n\r\n      callback(value, construct, uri);\r\n\r\n    };\r\n    //append to the document\r\n    document.head.appendChild(script);\r\n  }\r\n}\r\n\r\n\r\nGamelab.Code = Code;\r\n;\r\nclass Mouse {\r\n  constructor(domElement){\r\n    this.position = new Gamelab.Vector(0, 0);\r\n    this.domElement = domElement.domElement || domElement;\r\n  }\r\n  onMouseMove(call)\r\n  {\r\n    let $mouse = this;\r\n    this.domElement.addEventListener('mousemove', function(evt){\r\n        $mouse.position = new Gamelab.Vector(evt.clientX, evt.clientY);\r\n        call.bind($mouse)($mouse.position.x, $mouse.position.y);\r\n    });\r\n    return this;\r\n  }\r\n  onMouseUp(call)\r\n  {\r\n    let $mouse = this;\r\n    this.domElement.addEventListener('mouseup', function(evt){\r\n        call.bind($mouse)(true);\r\n    });\r\n    return this;\r\n  }\r\n  onMouseDown(call)\r\n  {\r\n    let $mouse = this;\r\n    this.domElement.addEventListener('mousedown', function(evt){\r\n        call.bind($mouse)(false);\r\n    });\r\n    return this;\r\n  }\r\n  onMouseOver(call)\r\n  {\r\n    let $mouse = this;\r\n    this.domElement.addEventListener('mouseover', function(evt){\r\n      $mouse.position = new Gamelab.Vector(evt.clientX, evt.clientY);\r\n      call.bind($mouse)($mouse.position.x, $mouse.position.y);\r\n    });\r\n    return this;\r\n  }\r\n  onMouseOut(call)\r\n  {\r\n    let $mouse = this;\r\n    this.domElement.addEventListener('mouseout', function(evt){\r\n      $mouse.position = new Gamelab.Vector(evt.clientX, evt.clientY);\r\n      call.bind($mouse).call($mouse.position.x, $mouse.position.y);\r\n    });\r\n    return this;\r\n  }\r\n\r\n  onLeftClick(call)\r\n  {\r\n    let $mouse = this;\r\n    this.domElement.addEventListener('click', function(evt){\r\n      evt = evt || window.event;\r\n      if(evt.which == 1)\r\n      (function(){\r\n        $mouse.position = new Gamelab.Vector(evt.clientX, evt.clientY);\r\n        call.bind($mouse)($mouse.position.x, $mouse.position.y);\r\n      })();\r\n    });\r\n  }\r\n  onRightClick(call)\r\n  {\r\n    let $mouse = this;\r\n    this.domElement.addEventListener('contextmenu', function(evt){\r\n\r\n      (function(){\r\n        $mouse.position = new Gamelab.Vector(evt.clientX, evt.clientY);\r\n        call.bind($mouse)($mouse.position.x, $mouse.position.y);\r\n      })();\r\n\r\n      evt.preventDefault();\r\n\r\n      return false;\r\n\r\n    });\r\n  }\r\n  onMouseWheel(call){\r\n\r\n    var $mouse = this;\r\n\r\n    window.addEventListener(\"wheel\", event => {\r\n        const delta = Math.sign(event.deltaY);\r\n        call.bind($mouse)(event.deltaY);\r\n    });\r\n\r\n  }\r\n  onMiddleButton(call)\r\n  {\r\n    var $mouse = this;\r\n    this.domElement.addEventListener('click', function(evt){\r\n      evt = evt || window.event;\r\n      if(evt.which == 2)\r\n      (function(){\r\n        $mouse.position = new Gamelab.Vector(evt.clientX, evt.clientY);\r\n        call.bind($mouse)($mouse.position.x, $mouse.position.y);\r\n      })();\r\n    });\r\n  }\r\n};\r\n\r\nGamelab.Mouse = Mouse;\r\n;\r\n(function(){\r\n\r\n  class OffscreenCanvas {\r\n\r\n    constructor(canvas, x, y){\r\n      this.canvas = canvas;\r\n      this.x = x;\r\n      this.y = y;\r\n\r\n      this.ctx = this.canvas.getContext('2d');\r\n    }\r\n    draw(ctx)\r\n    {\r\n      ctx.draw(this.canvas, this.x, this.y);\r\n    }\r\n\r\n  }\r\n\r\n  Gamelab.OffscreenCanvas = OffscreenCanvas;\r\n\r\n\r\n})();\r\n;\r\nlet RData = {\r\n  applyParentAndChildRelationship(parent, child, trackBy){\r\n    var UniqueList = (list) => {\r\n      list.addUnique = function(i){ if(this.indexOf(i) ==0){this.push(i)} };\r\n      return list;\r\n    };\r\n    parent.children = parent.children || [];\r\n    parent.children = UniqueList(parent.children);\r\n    child.parent = parent;\r\n    parent.children.addUnique(child);\r\n  }\r\n};\r\n\r\n\r\nGamelab.RData = RData;\r\nGamelab.RelationalData = RData;\r\nGamelab.Data = RData;\r\n;\n\n/**\n * Creates an instance of Rectangle.\n * @param   {Gamelab.Vector} min the minimum vector point (x,y)\n * @param   {Gamelab.Vector} max the maximum vector point (x,y)\n *\n * @returns {Rectangle} a Rectangle object\n */\n\nclass Rectangle {\n    constructor(x1, y1, x2, y2) {\n      this.Min(x1, y1);\n      this.Max(x2, y2);\n    }\n    Min(x, y)\n    {\n      this.min = new Gamelab.Vector(x, y);\n      return this;\n    }\n    Max(x, y)\n    {\n      this.max = new Gamelab.Vector(x, y);\n      return this;\n    }\n}\n;\n\n\n\nlet VectorBounds = Rectangle;\n\nGamelab.VectorBounds =VectorBounds;\n\nGamelab.Rectangle = Rectangle;\n\n/**\n * Takes the min and max vectors plus termPoint ('termination-point'), returns VectorFrameBounds\n *  *use this to define the bounds of an Animation object.\n * @param   {Vector} min the minimum vector point (x,y)\n * @param   {Vector} max the maximum vector point (x,y)\n * @param   {Vector=} termPoint the optional termination vector point (x,y) : defaults to the value of 'max'\n * -While a min and max Gamelab.Vector(x,y) will describe the grid-size of Animation frames,\n * the termPoint will indicate the last frame on-grid for this set of frames --Animation may stop early on the 'grid')\n * @returns {VectorFrameBounds} a VectorFrameBounds object\n */\n\nclass VectorFrameBounds {\n    constructor(min, max, termPoint) {\n        this.min = min;\n        this.max = max;\n        this.termPoint = termPoint || new Gamelab.Vector(this.max.x, this.max.y, this.max.z);\n    }\n}\n;\n\nGamelab.VectorFrameBounds = VectorFrameBounds;\n\n\nvar GeoMath = {\n\n        rotatePointsXY:function(x,y,angle) {\n\n            var theta = angle*Math.PI/180;\n\n            var point = {};\n            point.x = x * Math.cos(theta) - y * Math.sin(theta);\n            point.y = x * Math.sin(theta) + y * Math.cos(theta);\n\n            point.z = 0;\n\n            return point\n        }\n\n}\n\nGamelab.GeoMath = GeoMath;\n;/**\r\n * Renderable : consistent base-type for graphic-objects\r\n * @param   {Object} args the object of arguments\r\n * @returns {Renderable} a Gamelab.Renderable object.\r\n * */\r\n\r\nclass Renderable {\r\n  constructor(args = {}) {\r\n    //  Gamelab.FeatureInject(this, args);\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * A game-image object based on HTMLImage element. Creates GameImage, attaches gameImage.domElement --an instance of HTMLImageElement\r\n * @param   {string} src the sourcePath of the image-file.\r\n * @returns {GameImage} a Gamelab.GameImage object.\r\n * */\r\n\r\nclass GameImage extends Renderable {\r\n\r\n  constructor(src = {}, onCreate = function() {\r\n    I('image: used default fxn argument:');\r\n  }) {\r\n\r\n    super(src);\r\n\r\n    if (typeof src == 'object' && !(src instanceof HTMLCanvasElement)) {\r\n      return src;\r\n    }\r\n\r\n    if (typeof src == 'string') {\r\n      this.domElement = document.createElement('IMG');\r\n      this.domElement.src = src;\r\n    } else if (src instanceof HTMLCanvasElement) {\r\n      this.domElement = src;\r\n    }\r\n\r\n\r\n    this.domElement.onerror = function() {\r\n      this.__error = true;\r\n      //console.dev('--image error');\r\n    };\r\n\r\n  }\r\n};\r\n\r\nGamelab.GameImage = GameImage;\r\n;\r\n\r\n\r\nclass Script{\r\n\r\n  constructor(uri, callback){\r\n\r\n    this.src = uri || '';\r\n\r\n    if(uri && callback)\r\n    {\r\n    this.load(uri, callback);\r\n    }\r\n    else{\r\n      console.info('Created Script() without uri + callback --1st and 2nd arguments. To use object call script.load()');\r\n    }\r\n\r\n  }\r\n\r\n  load(uri, callback){\r\n\r\n    var __object = this;\r\n\r\n    callback = callback || function(){};\r\n\r\n    callback.bind(this);\r\n\r\n    var script = document.createElement('SCRIPT');\r\n    script.src = uri;\r\n\r\n    //define onload fxn\r\n    script.onload = function(){\r\n\r\n      var construct = module.exports;\r\n      callback(construct);\r\n\r\n    };\r\n\r\n    //append to the document\r\n    document.head.appendChild(script);\r\n\r\n  }\r\n\r\n};\r\n\r\nGamelab.Script = Script;\r\n\r\n\r\nclass Scriptable{\r\n\r\n  constructor(object, siblings){\r\n\r\n    this.object = object;\r\n\r\n    this.siblings = siblings;\r\n\r\n  }\r\n\r\n  Object(object)\r\n  {\r\n    this.object = object;\r\n    return this;\r\n  }\r\n\r\n\r\n  load(url, callback){\r\n\r\n    var __object = this;\r\n\r\n    callback = callback || function(){};\r\n\r\n    callback = callback.bind(this);\r\n\r\n    var script = document.createElement('SCRIPT');\r\n    script.src = url;\r\n\r\n    //define onload fxn\r\n    script.onload = function(){\r\n\r\n      var construct = window.module.exports;\r\n\r\n      var MOD = construct(__object.object, __object.siblings);\r\n\r\n      callback.bind(__object).call(MOD, __object.object, __object.siblings);\r\n    };\r\n\r\n    //append to the document\r\n    document.head.appendChild(script);\r\n\r\n  }\r\n\r\n};\r\n\r\nGamelab.Scriptable = Scriptable;\r\n;\r\n\r\n\r\n\r\nclass Texel {\r\n  constructor(x, y, w, h){\r\n    this.size = new Gamelab.Vector(w, h);\r\n    this.x = x;\r\n    this.y = y;\r\n  }\r\n}\r\n\r\n\r\nclass TexelArray {\r\n\r\n  constructor(texels, onCreate){\r\n\r\n      onCreate = onCreate || function(){};\r\n\r\n      var array = this;\r\n\r\n      texels = texels || [];\r\n\r\n      this.texels = [];\r\n\r\n      this.id = Gamelab.create_id();\r\n\r\n      var $object = this;\r\n\r\n      texels.forEach(function(v){\r\n\r\n        $object.texels.push(v);\r\n\r\n      });\r\n\r\n      onCreate.bind(this).call();\r\n  }\r\n\r\n  Clone(object){\r\n    if(object.texels instanceof Array)\r\n    return new Gamelab.TexelArray(object.texels);\r\n    else\r\n    return console.error('needs array-type@ on 1st arg: .texels');\r\n  }\r\n\r\n  push(item){\r\n    this.texels.push(item);\r\n  }\r\n  add(item)\r\n  {\r\n    this.texels.push(item);\r\n  }\r\n\r\n  FromData(data)\r\n  {\r\n    var jsonData = JSON.parse(JSON.stringify(data));\r\n    return new TexelArray(jsonData.texels);\r\n  }\r\n}\r\n\r\nGamelab.Texel = Texel;\r\nGamelab.TexelArray = TexelArray;\r\n;\r\n\r\nvar Trigonometry = {\r\n\r\n  rotate_from_xy:function(cx, cy, x, y, angle) {\r\n      var radians = (Math.PI / 180) * angle,\r\n          cos = Math.cos(radians),\r\n          sin = Math.sin(radians),\r\n          nx = (cos * (x - cx)) + (sin * (y - cy)) + cx,\r\n          ny = (cos * (y - cy)) - (sin * (x - cx)) + cy;\r\n      return new Gamelab.Vector(nx, ny);\r\n  },\r\n\r\n  rotational_speed:function(angle, speed){\r\n    // Move towards the player\r\n    var radians = (angle / 360) * Math.PI * 2.0;\r\n    return new Gamelab.Vector(Math.cos(radians) * speed, Math.sin(radians) * speed);\r\n  },\r\n\r\n  find_point_on_circle:function(x, y, radius, degrees){\r\n\r\n  }\r\n};\r\n\r\n\r\nGamelab.Trig = Trigonometry;\r\nGamelab.Trigonometry = Trigonometry;\r\n;\r\n\r\n\r\n  var linkedCurves = {\r\n\r\n    quadratic: function(t) {\r\n      return t < .5 ? 2 * t * t : -1 + (4 - 2 * t) * t\r\n    },\r\n\r\n    cubic: function(t) {\r\n      return t < .5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1\r\n    },\r\n\r\n    quartic: function(t) {\r\n      return t < .5 ? 8 * t * t * t * t : 1 - 8 * (--t) * t * t * t\r\n    },\r\n\r\n    quintic: function(t) {\r\n      return t < .5 ? 16 * t * t * t * t * t : 1 + 16 * (--t) * t * t * t * t\r\n    },\r\n\r\n    linear: function(t) {\r\n      return t;\r\n    } //provided for consistency / in case 'linear' is needed\r\n\r\n  };\r\n\r\n\r\nlet Twix = {\r\n\r\n  Curves:{\r\n    //ALL HAVE INPUT AND OUTPUT OF: 0-1.0\r\n      // no easing, no acceleration\r\n      Linear: {\r\n        None: function(t) {\r\n          return t;\r\n        }\r\n      },\r\n\r\n      Quadratic: {\r\n        In: function(t) {\r\n          return t * t;\r\n        },\r\n        Out: function(t) {\r\n          return t * (2 - t);\r\n        },\r\n        Seamless: function(t) {\r\n          return t < .5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\r\n        }\r\n      },\r\n\r\n      Cubic: {\r\n        In: function(t) {\r\n          return t * t * t;\r\n        },\r\n        Out: function(t) {\r\n          return (--t) * t * t + 1;\r\n        },\r\n        Seamless: function(t) {\r\n          return t < .5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\r\n        }\r\n      },\r\n\r\n      Quartic: {\r\n        In: function(t) { return t * t * t * t; },\r\n        Out: function(t) { return 1 - (--t) * t * t * t; },\r\n        Seamless: function(t) { return t < .5 ? 8 * t * t * t * t : 1 - 8 * (--t) * t * t * t; }\r\n      },\r\n\r\n      Quintic: {\r\n        In: function(t) { return t * t * t * t * t; },\r\n        Out: function(t) { return 1 + (--t) * t * t * t * t; },\r\n        Seamless: function(t) { return t < .5 ? 16 * t * t * t * t * t : 1 + 16 * (--t) * t * t * t * t; }\r\n      }\r\n  },\r\n\r\n  LinkedCurves:linkedCurves\r\n\r\n};\r\n\r\n\r\n\r\nconst TranceCurves = {};\r\n\r\nTranceCurves.Exponential = (value, power, min, max) => {\r\n\r\n};\r\n\r\nTranceCurves.Power = (value, power, min, max) => {\r\n\r\n};\r\n\r\n\r\nconst TrigFunctions = {};\r\n\r\nTrigFunctions.Sine = {};\r\n\r\nTrigFunctions.Cosine = {};\r\n\r\nTrigFunctions.Tangent = {};\r\n\r\n\r\nconst SpecialFunctions = {};\r\n\r\nSpecialFunctions.Sawtooth = (t) => { return t <= 1.0 ? t : 0; };\r\n\r\nSpecialFunctions.Square = () => {};\r\n\r\nSpecialFunctions.Triangle = () => {};\r\n\r\nSpecialFunctions.Floor = () => {};\r\n\r\nSpecialFunctions.Sign = () => {};\r\n\r\nGamelab.core = Gamelab.core || {};\r\n\r\nGamelab.core.XYFunctions = {};\r\n\r\nGamelab.core.XYFunctions.SpecialFunctions = SpecialFunctions;\r\n\r\n\r\n\r\nconst SigmaFunctions = {};\r\n\r\nconst GammaFunctions = {};\r\n;(function() {\r\n  console.log('Vector class... creating');\r\n\r\n  /**\r\n   * Creates a Vector object with x, y, and --optional z.\r\n   * @param   {number} x the x coordinate\r\n   * @param   {number} y the y coordinate\r\n   * @param   {number} z the optional z coordinate\r\n   * @param   {number} r the optional r value\r\n   * @returns {Vector} a Vector object\r\n   */\r\n\r\n\r\nfunction single_numeric_x(x, y, z)\r\n{\r\n  return typeof x == 'number' && y == undefined && z == undefined;\r\n}\r\n\r\n\r\n  class Vector {\r\n    constructor(x, y, z, r) {\r\n\r\n      var copied = false;\r\n\r\n      if (typeof(x) == 'object' && x.hasOwnProperty('x') && x.hasOwnProperty('y')) //optionally pass vector3\r\n      {\r\n        this.x = x.x;\r\n        this.y = x.y;\r\n        this.z = x.z || 0;\r\n\r\n        if (this.z == null) {\r\n          this.z = 0;\r\n        }\r\n\r\n        this.valid_check();\r\n\r\n        copied = true;\r\n      }\r\n\r\n      if (!copied) {\r\n\r\n        if(single_numeric_x(x, y, z))\r\n        {\r\n          this.x = x;\r\n          this.y = x;\r\n          this.z = x;\r\n        }\r\n        else{\r\n          if (z == null) {\r\n            z = 0;\r\n          }\r\n\r\n                  this.x = x;\r\n                  this.y = y;\r\n                  this.z = z;\r\n                  this.r = r;\r\n        }\r\n\r\n        this.valid_check();\r\n      }\r\n    }\r\n\r\n    valid_check() {\r\n      if (this.x == undefined) {\r\n        this.x = 0;\r\n      }\r\n      if (this.y == undefined) {\r\n        this.y = 0;\r\n      }\r\n      if (this.z == undefined) {\r\n        this.z = 0;\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Subtracts another Vector from this vector and returns a vector for the resulting difference.\r\n     *\r\n     * @function\r\n     * @param {Vector} v the vector to be subtracted from this vector\r\n     * @memberof Vector\r\n     **********/\r\n\r\n    sub(x, y, z) {\r\n      var v = new Gamelab.Vector(x, y, z);\r\n      return new Gamelab.Vector(this.x - v.x, this.y - v.y, this.z - v.z);\r\n    }\r\n\r\n    /**\r\n     * Adds another Vector to this vector and returns a vector for the resulting sum.\r\n     *\r\n     * @function\r\n     * @param {Vector} v the vector to be added to this vector\r\n     * @memberof Vector\r\n     **********/\r\n\r\n    add(x, y, z) {\r\n      var v = new Gamelab.Vector(x, y, z);\r\n      return new Gamelab.Vector(this.x + v.x, this.y + v.y, this.z + v.z);\r\n    }\r\n\r\n    /**\r\n     * Multiplies another Vector by this vector and returns a vector for the resulting product.\r\n     *\r\n     * @function\r\n     * @param {Vector} v the vector that this vector will by muliplied by\r\n     * @memberof Vector\r\n     **********/\r\n\r\n    mult(x, y, z) {\r\n      var v = new Gamelab.Vector(x, y, z);\r\n      return new Gamelab.Vector(this.x * v.x, this.y * v.y, this.z * v.z);\r\n    }\r\n\r\n    /**\r\n     * Gets vector of absolute values.\r\n     *\r\n     * @function\r\n     * @param {Vector} v the absolute vector\r\n     * @memberof Vector\r\n     **********/\r\n\r\n    abs() {\r\n      return new Gamelab.Vector(Math.abs(this.x), Math.abs(this.y), Math.abs(this.z));\r\n    }\r\n\r\n    /**\r\n     * Divides another Vector by this vector and returns a vector for the resulting quotient.\r\n     *\r\n     * @function\r\n     * @param {Vector} v the vector for this vector to be divided by\r\n     * @memberof Vector\r\n     **********/\r\n\r\n    div(x, y, z) {\r\n      var v = new Gamelab.Vector(x, y, z);\r\n      return new Gamelab.Vector(this.x / v.x, this.y / v.y, this.z / v.z);\r\n    }\r\n\r\n    /**\r\n     * Rounds this vector to the nearest set of whole numbers and returns the result.\r\n     *\r\n     * @function\r\n     * @memberof Vector\r\n     * @returns {Vector} a Gamelab.Vector object\r\n     **********/\r\n\r\n    round(multiple=1.0) {\r\n      var d = multiple;\r\n      if(isNaN(d) || d < 1)\r\n      {\r\n        d = 1;\r\n      }\r\n\r\n      var z = !isNaN(this.z) ? this.z : 0;\r\n      return new Gamelab.Vector(Math.round(this.x * d) / d, Math.round(this.y * d) / d, Math.round(this.z  * d) / d);\r\n    }\r\n\r\n    /**\r\n     * Floors this vector to the nearest set of whole numbers and returns the result (subtractive-only, an x of 1.7 becomes 1)\r\n     *\r\n     * @function\r\n     * @memberof Vector\r\n     * @returns {Vector} a Gamelab.Vector object\r\n     **********/\r\n\r\n     floor(multiple=1.0) {\r\n       var d = multiple;\r\n       if(isNaN(d) || d < 1)\r\n       {\r\n         d = 1;\r\n       }\r\n\r\n       var z = !isNaN(this.z) ? this.z : 0;\r\n       return new Gamelab.Vector(Math.floor(this.x * d) / d, Math.floor(this.y * d) / d, Math.floor(this.z  * d) / d);\r\n     }\r\n\r\n    /**\r\n     * Ceils this vector to the nearest set of whole numbers  and returns the result (additive-only, an x of 1.2 becomes 2)\r\n     *\r\n     * @function\r\n     * @memberof Vector\r\n     * @returns {Vector} a Gamelab.Vector object\r\n     **********/\r\n\r\n     ceil(multiple=1.0) {\r\n       var d = multiple;\r\n       if(isNaN(d) || d < 1)\r\n       {\r\n         d = 1;\r\n       }\r\n\r\n       var z = !isNaN(this.z) ? this.z : 0;\r\n       return new Gamelab.Vector(Math.ceil(this.x * d) / d, Math.ceil(this.y * d) / d, Math.ceil(this.z  * d) / d);\r\n     }\r\n\r\n\r\n     above_zero_xy(){\r\n\r\n       return this.x > 0 && this.y > 0;\r\n\r\n     }\r\n\r\n    /**\r\n     * Creates new vector, with the negated x,y,z values (-x-y-z), returns the resulting vector\r\n     *\r\n     * @function\r\n     * @memberof Vector\r\n     * @returns {Vector} a Gamelab.Vector object\r\n     **********/\r\n\r\n    neg() {\r\n      return new Gamelab.Vector(-this.x, -this.y, -this.z);\r\n    }\r\n\r\n    seek(x, y, speedValue=1.0)\r\n    {\r\n      var targetInc;\r\n\r\n      if(typeof x == 'object' && typeof y == 'number')\r\n      {\r\n        speedValue = y;\r\n        y = undefined;\r\n        targetInc = new Gamelab.Vector(x).sub(this).mult(speedValue);\r\n      }\r\n      else{\r\n        targetInc = new Gamelab.Vector(x, y).sub(this).mult(speedValue);\r\n      }\r\n      return this.add(targetInc);\r\n    }\r\n\r\n    half(){\r\n      return this.div(2);\r\n    }\r\n\r\n    /**\r\n     * An equals-test for vectors. Returns true OR false.\r\n     *\r\n     * @function\r\n     * @memberof Vector\r\n     * @returns {boolean} a true OR false value\r\n     **********/\r\n\r\n    equals(x, y, z) {\r\n      var v = new Gamelab.Vector(x, y, z);\r\n      return this.x == v.x && this.y == v.y && this.z == v.z;\r\n    }\r\n\r\n    /**\r\n     * Gets  the specific distance between this and the argument-vector. --applies to x and y of two vectors. Returns a single number.\r\n     *\r\n     * @function\r\n     * @memberof Vector\r\n     * @returns {number} the specific distance between this and the argument-vector\r\n     **********/\r\n\r\n    distance(v) {\r\n      var dist = this.sub(v);\r\n      return Math.sqrt(dist.x * dist.x + dist.y * dist.y);\r\n    }\r\n\r\n\r\n    is_between(v1, v2) {\r\n      //TODO : overlap vectors return boolean\r\n\r\n      return this.x >= v1.x && this.x <= v2.x &&\r\n        this.y >= v1.y && this.y <= v2.y &&\r\n        this.z >= v1.z && this.z <= v2.z;\r\n    }\r\n\r\n    /**\r\n     * Returns a vector-multiple: the original-size, multiplied by a random between the minFloat and maxFloat arguments.\r\n     *\r\n     * @function\r\n     * @memberof Vector\r\n     * @returns {Vector} the resulting vector.\r\n     **********/\r\n\r\n    randomize(minFloat, maxFloat) {\r\n      var random = (Math.random() * (maxFloat - minFloat) + minFloat) * 1000 / 1000;\r\n      return this.mult(random);\r\n    }\r\n\r\n    /**\r\n     * Returns a speed vector, based on rotation.\r\n     *\r\n     * @function\r\n     * @param {number} rotation in degrees, 0-360\r\n     * @param {number} speed the level of speed to apply, default being 1\r\n     * @returns {Vector}\r\n     * @memberof Vector\r\n     **********/\r\n\r\n    rotationalSpeedPoints(rotation, speed) {\r\n      var r = rotation;\r\n      if (isNaN(speed)) {\r\n        speed = 1;\r\n      }\r\n      if (typeof(rotation) == 'object' && rotation.x) {\r\n        r = rotation.x;\r\n      }\r\n\r\n      return new Gamelab.Vector(Math.cos((r) * 3.14 / 180) * speed, Math.sin((r) * 3.14 / 180) * speed);\r\n    }\r\n\r\n    /**\r\n     * Returns the right-handed angle of degrees between two two position-vectors.\r\n\r\n     * @memberof Vector\r\n     * @function\r\n     * @param {Vector} p1 the 1st vector-argument\r\n     * @param {Vector} p2 the 2nd vector-argument\r\n     * @returns {number} the resulting angle in degrees.\r\n     **********/\r\n\r\n    angleBetween(p1, p2) {\r\n      return Math.atan2(p2.y - p1.y, p2.x - p1.x) * 180 / Math.PI;\r\n    }\r\n\r\n    //apply minimum value to all values\r\n    min2d() {\r\n\r\n      function minimize(object, key1, key2) {\r\n        if (object[key1] < object[key2])\r\n          object[key2] = object[key1];\r\n\r\n        if (object[key2] < object[key1])\r\n          object[key1] = object[key2];\r\n      };\r\n\r\n      minimize(this, 'x', 'y');\r\n\r\n      return this;\r\n    }\r\n\r\n\r\n    //apply maximum value to all values\r\n    max2d() {\r\n\r\n      function maximize(object, key1, key2) {\r\n        if (object[key1] > object[key2])\r\n          object[key2] = object[key1];\r\n\r\n        if (object[key2] > object[key1])\r\n          object[key1] = object[key2];\r\n      };\r\n\r\n      maximize(this, 'x', 'y');\r\n\r\n      return this;\r\n    }\r\n\r\n  };\r\n\r\n  let Vector3 = Vector,\r\n    Pos = Vector,\r\n    Size = Vector,\r\n    Position = Vector,\r\n    Vector2 = Vector,\r\n    Rotation = Vector;\r\n\r\n  Gamelab.Vector = Vector;\r\n\r\n  //synonymous w/ Vector::\r\n  Gamelab.Vector2d = Vector;\r\n  Gamelab.Vector2D = Vector;\r\n  Gamelab.Rotation = Vector;\r\n  Gamelab.Pos = Vector;\r\n  Gamelab.Position = Vector;\r\n  Gamelab.Size = Vector;\r\n\r\n  //The above are a list of synonymous expressions for Vector. All of these do the same thing in this library (store and manipulate x,y,z values)\r\n\r\n  var VectorMath = {\r\n\r\n    rotatePointsXY(x, y, angle) {\r\n\r\n      var theta = angle * Math.PI / 180;\r\n\r\n      var point = {};\r\n      point.x = x * Math.cos(theta) - y * Math.sin(theta);\r\n      point.y = x * Math.sin(theta) + y * Math.cos(theta);\r\n\r\n      point.z = 0;\r\n\r\n      return new Gamelab.Vector(point.x, point.y, point.z);\r\n    }\r\n\r\n  }\r\n\r\n  Gamelab.VectorMath = VectorMath;\r\n\r\n})();\r\n;(function() {\r\n  console.log('GSEvent class... creating');\r\n\r\n  class GSEvent {\r\n\r\n    constructor(args = {}) {\r\n\r\n      //  Gamelab.Modifiers.informable(this, args);\r\n\r\n    }\r\n  }\r\n\r\n  class MouseMoveEvent {\r\n    constructor(callback) {\r\n      callback = callback || function(x, y) {};\r\n\r\n      this.Callback(callback);\r\n    }\r\n    Callback(cb) {\r\n      Gamelab.InputSystem.extend('mousemove', function(x, y) {\r\n\r\n        cb(x, y);\r\n\r\n      });\r\n    }\r\n  };\r\n\r\n  Gamelab.MouseMoveEvent = MouseMoveEvent;\r\n\r\n  class MousePosEvent {\r\n    constructor(callback) {\r\n      callback = callback || function(x, y) {};\r\n\r\n      this.Callback(callback);\r\n    }\r\n    Callback(cb) {\r\n      Gamelab.InputSystem.extend('mousepos', function(x, y) {\r\n\r\n        cb(x, y);\r\n\r\n      });\r\n    }\r\n  };\r\n\r\n  Gamelab.MousePosEvent = MousePosEvent;\r\n\r\n  class MouseLeftClickEvent {\r\n    constructor(callback) {\r\n      callback = callback || function(x, y) {};\r\n\r\n      this.Callback(callback);\r\n    }\r\n    Callback(cb) {\r\n\r\n      Gamelab.InputSystem.extend('leftclick', function(x, y) {\r\n\r\n        cb(x, y);\r\n\r\n      });\r\n    }\r\n  };\r\n\r\n  Gamelab.MouseLeftClickEvent = MouseLeftClickEvent;\r\n\r\n  class MouseRightClickEvent {\r\n    constructor(callback) {\r\n      callback = callback || function(x, y) {};\r\n\r\n      this.Callback(callback);\r\n    }\r\n    Callback(cb) {\r\n\r\n      Gamelab.InputSystem.extend('rightclick', function(x, y) {\r\n\r\n        cb(x, y);\r\n\r\n      });\r\n    }\r\n  };\r\n\r\n  Gamelab.MouseRightClickEvent = MouseRightClickEvent;\r\n\r\n  function GSEventLink(extendedObject, extendedKey, extendor, extendorKey) {\r\n    this.parent_id = extendedObject.id,\r\n\r\n      this.child_id = extendor.id,\r\n\r\n      this.parent_key = extendedKey,\r\n\r\n      this.child_key = extendorKey;\r\n  };\r\n\r\n  /**\r\n   * Creates an instance of InputEvent\r\n   * <info-bit> Gamelab.InputEvent runs a callback function when a specified input is triggered</info-bit>\r\n   *\r\n   * <tip is=\"p\">Instead of calling\r\n   *\r\n   * @param   {Object} args object of arguments\r\n   * @param   {number} args.btnix the index of controller-button to be applied\r\n   * @param   {number} args.gpix the index of pc-gamepad --the 1st gamepad will have index 0\r\n   * @param   {number} args.stickix the controller-stick-index to be applied\r\n   * @param   {Array} args.keys array of strings for keys to be applied\r\n   * @param   {Function} args.callback the function to call when InputEvent is triggered\r\n   * @returns {Gamelab.InputEvent} a Gamelab.InputEvent object\r\n   */\r\n\r\n\r\n  class InputEvent extends GSEvent {\r\n    constructor(args) {\r\n      super(args);\r\n\r\n      var btnix = args.btnix || args.button_ix || false,\r\n\r\n        gpix = args.gpix || args.gamepad_ix || 0,\r\n\r\n        callback = args.callback || function() {\r\n\r\n\r\n        };\r\n\r\n      var six = args.stickix || args.six || args.stick_ix || false;\r\n\r\n      var inputKey = six !== false ? 'stick_' + six : btnix !== false ? 'button_' + btnix : false;\r\n\r\n      //Keys:\r\n\r\n      var keyboardKeys = TypeCode.arrayWrap(args.keys || []);\r\n\r\n      //Run the Q() function\r\n\r\n      if (keyboardKeys instanceof Array) {\r\n\r\n        Gamelab.each(keyboardKeys, function(ix, keyitem) {\r\n\r\n          Gamelab.InputSystem.extendKey('key_' + keyitem.toLowerCase(), function() {\r\n\r\n            callback(keyitem.toLowerCase());\r\n\r\n          });\r\n        });\r\n      }\r\n\r\n      if (inputKey && gpix >= 0) {\r\n\r\n        Gamelab.GamepadAdapter.on(inputKey, gpix, function(x, y) {\r\n\r\n          callback(x, y);\r\n\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n\r\n  /**\r\n   *\r\n   * @extends InputEvent\r\n   *\r\n   * Creates an instance of KeyboardEvent\r\n   * <info-bit> Gamelab.KeyboardEvent runs a callback function when keyboard-keys are pressed</info-bit>\r\n   * @param   {Array | string} keys the Array of keys or single string-key for this event\r\n   * @param   {Function} callback the callback-function to be called when this event is triggered\r\n\r\n   * @returns {Gamelab.KeyboardEvent}\r\n   */\r\n\r\n  class KeyboardEvent extends InputEvent {\r\n    constructor(keys = keys instanceof Array ? keys : [keys], callback = function() {}) {\r\n\r\n      super({});\r\n\r\n      this.keys = keys;\r\n\r\n      this.callback = callback;\r\n\r\n    }\r\n\r\n    init() {\r\n      var keyboardKeys = this.keys;\r\n\r\n      var __inst = this;\r\n\r\n      if (keyboardKeys instanceof Array) {\r\n\r\n        Gamelab.each(keyboardKeys, function(ix, keyitem) {\r\n\r\n          Gamelab.InputSystem.extendKey('key_' + keyitem.toLowerCase(), function() {\r\n\r\n            __inst.callback(keyitem.toLowerCase());\r\n\r\n          });\r\n        });\r\n      }\r\n    }\r\n\r\n    Keys(keys = []) {\r\n      this.keys = TypeCode.arrayWrap(keys)\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    Call(callback = function() {}) {\r\n      this.callback = callback;\r\n\r\n      this.init();\r\n\r\n      return this;\r\n    }\r\n  };\r\n\r\n  /**\r\n   *\r\n   * @extends InputEvent\r\n   *\r\n   * Creates an instance of GamepadEvent\r\n   * <info-bit> Gamelab.GamepadEvent runs a callback function when any specified gamepad-buttons or gamepad-sticks are pressed</info-bit>\r\n   * @param   {Array | string} gamepadKeys the Array of gamepadKeys or single string-key, representing gamepad-buttons or gamepad-sticks for this event\r\n   * @param   {Function} callback the callback-function to be called when this event is triggered\r\n\r\n   * @returns {Gamelab.GamepadEvent}\r\n   */\r\n\r\n  class GamepadEvent extends InputEvent {\r\n    constructor() {\r\n\r\n      super({});\r\n\r\n      this.gps = [0];\r\n      this.keys = [];\r\n\r\n      this.callback = function(){};\r\n\r\n    }\r\n\r\n    Gamepads(gps = []) {\r\n\r\n      this.gps = TypeCode.arrayWrap(gps);\r\n\r\n      return this;\r\n    }\r\n\r\n    init() {\r\n\r\n      var gamepadKeys = TypeCode.arrayWrap(this.keys || []);\r\n\r\n      var __inst = this;\r\n\r\n      Gamelab.GamepadAdapter.on(gamepadKeys, this.gps, function(x, y) {\r\n\r\n        __inst.callback(x, y);\r\n\r\n      });\r\n    }\r\n\r\n    Keys(keys = []) {\r\n\r\n      this.keys = TypeCode.arrayWrap(keys);\r\n\r\n      for(var x  = 0; x < this.keys.length; x++)\r\n      {\r\n        if(typeof this.keys[x] == 'number'){ //must change to a string\r\n            this.keys[x] = (this.keys[x] + '');\r\n        }\r\n      }\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    Call(callback = function() {}) {\r\n      this.callback = callback;\r\n\r\n      this.init();\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  class CollisionEvent extends GSEvent {\r\n    constructor(args = {}) {\r\n      super(args);\r\n\r\n    }\r\n\r\n    /**\r\n     * applies objects and siblings to be compared for the CollisionEvent instance\r\n     * @memberof CollisionEvent\r\n     * @param   {Array} objects the main-objects for collision processing\r\n     * @param   {Array} siblings the comparable-objects for collision processing\r\n     * @returns {CollisionEvent} the current instance of CollisionEvent, reference to 'this' keyword\r\n     */\r\n\r\n    OnCollision(objects, siblings) {\r\n\r\n      this.objects = TypeCode.arrayWrap(objects || this.objects || []);\r\n\r\n      this.siblings = TypeCode.arrayWrap(siblings || this.siblings || []);\r\n\r\n      return this;\r\n    }\r\n\r\n    /**\r\n     * applies a callback to be called whenever the onBool function returns true\r\n     * @memberof CollisionEvent\r\n     * @param   {callbackFunction} callbackFunction the function to be called --replaces the value of collisionEvent.callback\r\n\r\n     * @returns {CollisionEvent} the current instance of CollisionEvent, reference to 'this' keyword\r\n     */\r\n\r\n    Call(callbackFunction) {\r\n\r\n      this.callback = callbackFunction || this.callback || function() {};\r\n\r\n      let $collision = this;\r\n\r\n      this.objects.forEach(function($obj){\r\n\r\n        $obj.onUpdate(function(){\r\n\r\n          var $sprite = this;\r\n\r\n          $collision.siblings.forEach(function($sib){\r\n            if($sprite.hasBoxCollision($sib))\r\n            {\r\n              $collision.callback($sprite, $sib);\r\n            }\r\n          });\r\n        });\r\n      });\r\n\r\n\r\n      return this;\r\n\r\n    }\r\n  };\r\n\r\n  /**\r\n   * returns BoolEvent --allows code to run whenever a conditional-function returns true\r\n   * @param   {onBool} onBool the function to be tested each update\r\n   * @param   {call} call the function to be called when onBool returns true;\r\n\r\n   * @returns {BoolEvent} a Gamelab.BoolEvent object\r\n   */\r\n\r\n\r\n  class BoolEvent extends GSEvent {\r\n    constructor(onBool, callback) {\r\n\r\n      super({});\r\n\r\n      this.bool = onBool || function() {\r\n        console.info('CustomBoolEvent():needs .on function(){}. --Add this as 1st argument or via chainable On() function returning bool argument');\r\n      }\r\n      /*Defaults to false to avoid broken code*/\r\n\r\n      this.callback = callback || function() {\r\n        console.info('CustomBoolEvent():needs .callback function(){} --Add this as 2nd argument or via chainable Call() function');\r\n      };\r\n\r\n      Gamelab.gs_events.push(this);\r\n\r\n    }\r\n\r\n    /**\r\n     * applies a boolFunction to be tested for true each update\r\n     * @param   {boolFunction} boolFunction the function to be tested each update --replaces the value of boolEvent.onBool\r\n\r\n     * @returns {BoolEvent} the current instance of BoolEvent, reference to 'this' keyword\r\n     */\r\n\r\n    On(boolFunction) {\r\n\r\n      this.bool = boolFunction;\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * applies a callback to be called whenever the onBool function returns true\r\n     * @memberof BoolEvent\r\n     * @param   {callbackFunction} callbackFunction the function to be called --replaces the value of boolEvent.callback\r\n\r\n     * @returns {BoolEvent} the current instance of BoolEvent, reference to 'this' keyword\r\n     */\r\n\r\n    Call(callbackFunction) {\r\n\r\n      this.callback = callbackFunction || this.callback || function() {};\r\n\r\n      return this;\r\n\r\n    }\r\n  };\r\n\r\n  BoolEvent.Bool = BoolEvent.On;\r\n\r\n  Gamelab.GSEvent = GSEvent;\r\n\r\n  Gamelab.Event = GSEvent;\r\n\r\n  Gamelab.GSEventLink = GSEventLink;\r\n\r\n  Gamelab.InputEvent = InputEvent;\r\n\r\n  Gamelab.GamepadEvent = GamepadEvent;\r\n\r\n  Gamelab.KeyboardEvent = KeyboardEvent;\r\n\r\n  Gamelab.CollisionEvent = CollisionEvent;\r\n\r\n  Gamelab.BoxCollisionEvent = CollisionEvent;\r\n\r\n  Gamelab.BoolEvent = BoolEvent;\r\n\r\n})();\r\n;\n\n/**\n * Creates an instance of GamepadAdapter: --instead use the existing: Gamelab.GamepadAdapter, a working instance of this class.\n * -supports game-controller input for web-games\n * -accesses live gamepad input from the HTML5 Gamepad Api\n * @returns {GamepadAdapter} an instance of GamepadAdapter\n * */\n\nGamelab.gamepads = Gamelab.gamepads || [];\n\nclass GamepadAdapter {\n\n    constructor() {\n        this.__gamepads = [];\n        this.intervals = [];\n        let controller_stack = this;\n        let __gamepadMaster = this;\n        this.settings = {};\n        this.settings.xbox_pc = {\n          button_0:'a',\n          button_1:'b',\n          button_2:'x',\n          button_3:'y',\n          button_4:'lb',\n          button_5:'rb',\n          button_6:'lt',\n          button_7:'rt',\n          button_8:'select',\n          button_9:'start',\n          button_10:'left_stick_button',\n          button_11:'right_stick_button',\n          button_12:'up',\n          button_13:'down',\n          button_14:'right',\n          button_15:'left'\n        };\n\n        this.selectSettings('xbox_pc');\n\n        this.events = [];\n\n        window.addEventListener(\"gamepadconnected\", function (e) {\n            console.log(\"Gamepad connected at index %d: %s. %d buttons, %d axes.\",\n                e.gamepad.index, e.gamepad.id,\n                e.gamepad.buttons.length, e.gamepad.axes.length);\n\n            if (__gamepadMaster.mainLoop) {\n                window.clearInterval(__gamepadMaster.mainLoop);\n            }\n\n            __gamepadMaster.mainLoop = window.setInterval(function () {\n\n                var gps = navigator.getGamepads();\n\n                __gamepadMaster.gps = gps;\n\n                for (var x = 0; x < gps.length; x++) {\n\n                    var events = __gamepadMaster.__gamepads[x] ? __gamepadMaster.__gamepads[x] : {};\n\n                    __gamepadMaster.process(__gamepadMaster.gps[x], events);\n                }\n            }, 20);\n        });\n    }\n\n    selectSettings(name)\n    {\n      for(var x in this.settings)\n      {\n        if(x.toLowerCase() == name.toLowerCase())\n        {\n                this.selectedSettings = this.settings[x];\n        }\n      }\n    }\n\n    addButtonSettings(name, settings)\n    {\n      name = name || '#untitled';\n      this.settings[name] = settings;\n    }\n\n    gamepads() {\n\n        return navigator.getGamepads();\n\n    }\n\n    disconnect_all() {\n\n        for (var x = 0; x < this.intervals.length; x++) {\n\n            window.clearInterval(this.intervals[x]);\n\n        }\n    }\n\n    disconnect_by_index(game_pad_index) {\n\n        window.clearInterval(this.intervals[game_pad_index]);\n\n    }\n\n    hasAnyPad() {\n        return \"getGamepads\" in navigator;\n\n    }\n\n    Event(key, game_pad, callback) {\n        return {\n\n            key: key, game_pad: game_pad, callback: callback\n\n        }\n\n    }\n\n    GamepadEvents(args) {\n\n        var $adapter = this;\n\n        var gp = {};\n\n        gp.stick_left = args.stick_left || function (x, y) {\n\n            //  console.log('Def call');\n\n        }\n\n        gp.stick_right = args.stick_right || function (x, y) {\n\n        }\n\n        gp.buttons = [];\n\n        gp.extendFunc = function (f1, f2) {\n\n            var fc = f2;\n\n            return function (x, y) {\n\n                f2(x, y);\n\n                f1(x, y);\n\n            }\n\n        };\n\n\n                gp.normal_key = function(k){ //replace spaces and dashes with _\n                  for(var x = 0; x < 4; x++)\n                  {\n                    if(k.indexOf(' ') >= 0)\n                    {\n                        k = k.replace(' ', '_');\n                    }\n                    if(k.indexOf('-') >= 0)\n                    {\n                        k = k.replace('-', '_');\n                    }\n                  }\n\n                  return k.toLowerCase();\n                }\n\n                gp.on = function (key, callback) {\n\n                    var settings = $adapter.selectedSettings;\n\n                    key = this.normal_key(key);\n\n\n                                if (this[key] && key !== \"on\") {\n\n                                    var current_cb = typeof(this[key]) == 'function' ? this[key] : function (x, y) {\n                                    };\n\n                                    this[key] = this.extendFunc(callback, current_cb);\n                                }\n\n\n                    for(var x in settings)\n                    {\n                        var parts = x.split('_');\n\n                        if(this.normal_key(x) == key || this.normal_key(settings[x]) == key) //its in the settings\n                        {\n\n                                          var number;\n\n                                          try {\n\n                                              number = parseInt(parts[1]);\n\n                                              var current_cb = typeof(this['buttons'][number]) == 'function' ? this['buttons'][number] : function (x, y) {\n                                              };\n\n                                              this['buttons'][number] = this.extendFunc(callback, current_cb);\n\n                                          }\n                                          catch (e) {\n                                              console.error('could not parse \"on\" event with ' + key);\n\n                                          }\n                        }\n                    }\n                }\n\n        gp.constructor = {name: \"GamepadEvents\"};\n\n        this.__gamepads.push(gp);\n\n        Gamelab.gamepads = this.__gamepads;\n\n        return gp;\n\n    }\n\n    getGamepads() {\n        return Gamelab.gamepads;\n\n    }\n\n    process(gp, gpEvents) {\n\n        this.process_buttons(gp, gpEvents);\n\n        this.process_axes(gp, gpEvents);\n\n    }\n\n    process_axes(gp, events) {\n\n        if (!gp || !gp['axes']) {\n\n            return false;\n\n        }\n\n\n        for (var i = 0; i < gp.axes.length; i += 2) {\n\n            var axis1 = gp.axes[i], axia2 = gp.axes[i + 1];\n\n            var ix = (Math.ceil(i / 2) + 1), x = gp.axes[i], y = gp.axes[i + 1];\n\n            if (ix == 1 && events.stick_left) {\n                events.stick_left(x, y);\n\n            }\n\n            if (ix == 2 && events.stick_right) {\n                events.stick_right(x, y);\n\n            }\n\n            if (this.events && this.events['stick_' + i] && typeof(this.events['stick_' + i].callback) == 'function') {\n                this.events['stick_' + i].callback();\n\n            }\n        }\n\n    }\n\n\n    process_buttons(gp, events) {\n\n        if (!gp || !gp['buttons']) {\n            return false;\n\n        }\n\n        for (var i = 0; i < gp.buttons.length; i++) {\n\n            if (!events.buttons)\n                break;\n\n            else if (events.buttons.length > i && typeof(events.buttons[i]) == 'function') {\n                events.buttons[i](gp.buttons[i].pressed);\n            }\n            else if (events.buttons.length > i && typeof(events.buttons[i]) == 'object' && typeof(events.buttons[i].update) == 'function') {\n                events.buttons[i].update(events.buttons[i].pressed);\n\n            }\n            var clearance_1 = this.events && this.events[i], gpc, bkey = \"button_\" + i;\n\n            if (clearance_1) {\n                gpc = this.events[bkey] && !isNaN(this.events[bkey].game_pad) ? this.gamepads[this.events[bkey].game_pad] : this.events[bkey].game_pad;\n            }\n            ;\n\n            if (clearance_1 && gpc && typeof(this.events[bkey].callback) == 'function') {\n                //call the callback\n                this.events[i].callback();\n\n            }\n\n        }\n    }\n\n\n    on(key, gpix, callback) {\n\n        var keys = TypeCode.arrayWrap(key || []), gps = TypeCode.arrayWrap(gpix || []);;\n\n        for(var x in keys)\n        {\n            for(var y in gps)\n            {\n                if (gps[y] >= this.__gamepads.length) {\n\n                    this.__gamepads.push(this.GamepadEvents({}));\n\n                }\n\n                this.__gamepads[y].on(keys[x], callback);\n\n            }\n        }\n    }\n}\n\n/**********\n * NOTE: here we bind the instance, and NOT the instantiator.\n *\n * *********/\n\nif (!Gamelab.GamepadAdapter) {\n\n    Gamelab.GamepadAdapter = new GamepadAdapter();\n\n    // __gameInstance.gamepads.push(gamepad);\n\n}\n;\n/**\n * Creates a Sound instance. Implements HTML5-Audio object\n * --DevTODO : complete docs for the Sound class\n *\n * @param   {string} src the source-path of the targeted sound-file\n * @returns {Sound} instance of Gamelab.Sound\n * */\n\nclass Sound {\n\n    constructor(src, data) {\n\n        if (typeof(src) == 'object') {\n\n            this.sound = document.createElement('audio');\n\n            this.sound.volume = src.sound.volume;\n\n            this.sound.src = src.src;\n\n            this.src = src.src;\n        }\n\n        else if (typeof(src) == 'string') {\n\n            this.sound = document.createElement('audio');\n\n            this.sound.volume = 1;\n\n            this.sound.src = src;\n\n            this.src = src;\n\n        }\n\n        if(typeof(data)=='object') {\n            for (var x in data) {\n                if (x !== 'sound') {\n                    this[x] = data[x];\n\n                }\n            }\n        }\n\n        this.onLoad = this.onLoad || function () {\n            };\n\n        if (typeof(this.onLoad) == 'function') {\n\n            this.onLoad(this.sound);\n\n        }\n\n    }\n\n    Multiply(number){\n\n      var srcList = [];\n      for(var x = 0; x < number; x++)\n      {\n        srcList.push(this.src || this.sound.src);\n      }\n\n      return new Gamelab.SoundList(srcList).Volume(this.sound.volume);\n    }\n\n    Loop(loop)\n    {\n        this.sound.loop = loop || true;\n\n        return this;\n\n    }\n\n    loop(loop) //same as Loop()\n    {\n        this.sound.loop = loop || true;\n\n        return this;\n\n    }\n\n\n    Volume(val)\n    {\n        this.sound.volume = val;\n\n        return this;\n\n    }\n\n\n    volume(val) //same as Volume()\n    {\n\n        this.sound.volume = val;\n\n        return this;\n\n    }\n\n    Play() {\n\n        if(Gamelab.config && Gamelab.config.soundOff)\n        {\n          return;\n        }\n\n        if (typeof(this.sound) == 'object' && typeof(this.sound.play) == 'function') {\n\n            this.sound.play();\n\n        }\n\n        return this;\n\n    }\n\n    play() { //same as Play()\n      if(Gamelab.config && Gamelab.config.soundOff)\n      {\n        return;\n      }\n        if (typeof(this.sound) == 'object' && typeof(this.sound.play) == 'function') {\n\n            this.sound.play();\n        }\n        return this;\n    }\n\n}\n\n\nclass SoundList{\n\n    constructor(list)\n    {\n        this.cix = 1;\n\n        this.sounds = [];\n\n        if(list instanceof Array)\n        {\n            for(var x in list)\n            {\n                if(list[x].src)\n                {\n                    this.sounds.push(new Sound(list[x].src, list[x]));\n\n                }\n                else if(typeof(list[x]) == 'string')\n                {\n                    this.sounds.push(new Sound(list[x]));\n\n                }\n            }\n        }\n    }\n\n    add(src, name)\n    {\n        if(typeof(src) == 'object' && src.src)\n        {\n            this.sounds.push(new Sound(src.src, src));\n\n        }\n        else if(typeof(src) == 'string')\n        {\n            var data = {};\n\n            if(name)\n            {\n                data.name = name;\n            }\n\n            this.sounds.push(new Sound(list[x], data));\n\n        }\n\n    }\n\n    Volume(v)\n    {\n        for(var x = 0; x < this.sounds.length;x++)\n        {\n            this.sounds[x].volume(v);\n\n        }\n\n        return this;\n    }\n\n    volume(v)\n    {\n        for(var x = 0; x < this.sounds.length;x++)\n        {\n            this.sounds[x].volume(v);\n\n        }\n\n        return this;\n    }\n\n\n    PlayNext()\n    {\n      if(Gamelab.config && Gamelab.config.soundOff)\n      {\n        return;\n      }\n\n        this.sounds[this.cix % this.sounds.length].play();\n\n        this.cix += 1;\n\n    }\n\n    Play()\n    {\n\n      if(Gamelab.config && Gamelab.config.soundOff)\n      {\n        return;\n      }\n\n        this.sounds[this.cix % this.sounds.length].play();\n\n        this.cix += 1;\n\n\n    }\n\n    playNext() //same as PlayNext()\n    {\n      if(Gamelab.config && Gamelab.config.soundOff)\n      {\n        return;\n      }\n        this.sounds[this.cix % this.sounds.length].play();\n\n        this.cix += 1;\n\n    }\n\n    play() //same as Play()\n    {\n      if(Gamelab.config && Gamelab.config.soundOff)\n      {\n        return;\n      }\n\n        this.sounds[this.cix % this.sounds.length].play();\n\n        this.cix += 1;\n\n\n    }\n\n}\n\nGamelab.Sound = Sound;\n\nGamelab.SoundList = SoundList;\n\n\n\n\nclass Audio {\n\n  constructor(){\n\n\n  }\n\n}\n\nGamelab.Audio = Audio;\n;\r\nclass Ai {\r\n\r\n  constructor(settings){\r\n    for(var x in settings)\r\n    this[x] = settings[x];\r\n  }\r\n    /**\r\n     * update\r\n     * @function\r\n     * @memberof Ai\r\n     **********/\r\n\r\n    update() {\r\n\r\n    }\r\n\r\n    onUpdate(fun) {\r\n\r\n      fun = fun.bind(this);\r\n\r\n      let update = this.update.bind(this);\r\n      let __inst = this;\r\n\r\n      this.update = function(__inst) {\r\n        update(__inst);\r\n        fun(__inst);\r\n      };\r\n    }\r\n};\r\n\r\nGamelab.Ai = Ai;\r\nGamelab.AI = Ai;\r\n;(function() {\r\n  console.log('Animation class... creating');\r\n\r\n  /**\r\n   *\r\n   * Creates an instance of Animation with one or more Frames.\r\n   *\r\n   * <example-marker data-class='Animation' data-info='Use JQuery fnxs to load content into the div outside of this p-element. Do not use iframe' > </example-marker>\r\n   *\r\n   * @param   {string=} [src] the src-image-path for this Animation\r\n   * @returns {Animation} an Animation object\r\n   *\r\n   * @example\r\n   *\r\n   * //constructor call: Creates a single-frame Animation from src\r\n   * var singleFrameAnime = new Animation('directory/myFile.png');\r\n   *\r\n   * @example\r\n   * //constructor call with chainable function-calls: Creates multi-frame Animation from src, then sets properties with chainable-function-calls.\r\n   * var multiFrameAnime = new Gamelab.Animation('../images/characters/full/spaceman1.png') //constructor is called\r\n   * .FrameSize(130, 130)\r\n   * .FrameBounds(new Gamelab.Vector(9, 0), new Gamelab.Vector(23, 0), new Gamelab.Vector(23, 0))\r\n   * .Seesaw() //The Animation will play back-and-forth repeatedly (cycle through frames forwards, then backwards and so on.\r\n   * .Duration(900); //Animation lasts 900 millis OR just under 1 second\r\n   *\r\n   *  @design\r\n   *\r\n   * //single-responsibility : to define a list of frames, then progress that list of frames with a 'selected_frame' property\r\n   * var singleFrameAnime = new Animation('directory/myFile.png');\r\n   */\r\n\r\n  class Animation {\r\n\r\n    constructor(src = {}) {\r\n\r\n      var args = typeof(src) == 'object' ? src : {};\r\n\r\n      //Gamelab.Modifiers.informable(this, args);\r\n\r\n      /**\r\n       * @property {Vector} frameSize the frameSize of the Animation\r\n       * @memberof Animation\r\n       **********/\r\n\r\n      this.frameSize = this.frameSize || new Gamelab.Vector(args.frameSize || new Gamelab.Vector(0, 0));\r\n      this.size = this.size || new Gamelab.Vector(args.size || new Gamelab.Vector(0, 0));\r\n\r\n      this.type = 'Animation';\r\n\r\n      if (typeof src == 'string' || src instanceof HTMLCanvasElement) {\r\n        this.src = src;\r\n        this.image = new Gamelab.GameImage(src);\r\n        this.init_singleFrame();\r\n      } else if (args instanceof Gamelab.GameImage) {\r\n        //console.log('Animation(): args are an instance of GameImage');\r\n\r\n        this.image = args;\r\n      } else if (args instanceof HTMLImageElement) {\r\n        //console.log('Animation(): args was an instance of HTMLImageElement');\r\n\r\n        this.image = new Gamelab.GameImage(args);\r\n      } else if (args instanceof Gamelab.Animation) {\r\n\r\n        this.image = args.image;\r\n\r\n      } else if (typeof(args) == 'object' && args.src) {\r\n        this.src = args.src;\r\n        this.image = new Gamelab.GameImage(args.src);\r\n      }\r\n\r\n      this.min_cix = 0;\r\n\r\n      this.visible = args.visible || true;\r\n\r\n\r\n\r\n      if (args.frameBounds && args.frameBounds.min && args.frameBounds.max) {\r\n\r\n        /**\r\n         * @property {VectorFrameBounds} frameBounds the frameBounds of the Animation, has three Vectors\r\n         * @memberof Animation\r\n         **********/\r\n\r\n        this.frameBounds = new Gamelab.VectorFrameBounds(args.frameBounds.min, args.frameBounds.max, args.frameBounds.termPoint);\r\n\r\n      } else {\r\n\r\n        this.frameBounds = new Gamelab.VectorFrameBounds(new Gamelab.Vector(0, 0, 0), new Gamelab.Vector(0, 0, 0), new Gamelab.Vector(0, 0, 0));\r\n\r\n      }\r\n\r\n      this.scale = 1.0;\r\n\r\n\r\n      this.origin = new Gamelab.Vector(0, 0, 0);\r\n\r\n      this.position = new Gamelab.Vector(0, 0);\r\n\r\n      this.rotation = new Gamelab.Vector(0, 0, 0);\r\n\r\n      this.frameOffset = this.getArg(args, 'frameOffset', new Gamelab.Vector(0, 0, 0));\r\n\r\n      this.apply2DFrames();\r\n\r\n      this.flipX = this.getArg(args, 'flipX', false);\r\n\r\n      this.cix = 0;\r\n\r\n      /**\r\n       * @property {Frame} selected_frame the selected_frame of the Animation, a Gamelab.Frame\r\n       * @memberof Animation\r\n       **********/\r\n\r\n      this.selected_frame = this.frames[0] || false;\r\n\r\n      this.timer = 0;\r\n\r\n      this.duration = args.duration || 2000;\r\n\r\n      this.seesaw_mode = args.seesaw_mode || false;\r\n\r\n      this.reverse_frames = args.reverse_frames || false;\r\n\r\n      this.run_ext = args.run_ext || [];\r\n\r\n      this.complete_ext = args.complete_ext || [];\r\n\r\n\r\n      this.Scale(this.scale);\r\n\r\n      // this.colorMap = this.createColorMap(5);\r\n\r\n    }\r\n\r\n    set img_src(value) {\r\n      this.src = value;\r\n    }\r\n\r\n    get img_src() {\r\n      return this.src;\r\n    }\r\n\r\n    Origin(x, y, z) {\r\n      this.origin = new Gamelab.Vector(x, y, z);\r\n\r\n      this.frames.forEach(function($f) {\r\n        $f.origin = new Gamelab.Vector(x, y, z);\r\n      });\r\n      if (this.selected_frame) {\r\n        this.selected_frame.origin = new Gamelab.Vector(x, y, z);\r\n      }\r\n      return this;\r\n    }\r\n\r\n    Position(x, y, z) {\r\n      this.position = new Gamelab.Vector(x, y, z);\r\n\r\n      this.frames.forEach(function($f) {\r\n\r\n        $f.position = new Gamelab.Vector(x, y, z);\r\n\r\n      });\r\n\r\n      return this;\r\n    }\r\n\r\n    Size(x, y) {\r\n\r\n      this.size = new Gamelab.Vector(x, y);\r\n      this.frames.forEach(function(f) {\r\n\r\n        f.Size(x, y);\r\n\r\n      });\r\n      return this;\r\n    }\r\n\r\n    Bone(b) {\r\n      this.bone = b;\r\n      return this;\r\n    }\r\n\r\n    ParentBone(b) {\r\n      this.parentBone = b;\r\n      return this;\r\n    }\r\n\r\n    Rotation(x, y, z) {\r\n\r\n      this.rotation = new Gamelab.Vector(x, y, z);\r\n\r\n      this.frames.forEach(function($frame) {\r\n        $frame.Rotation(x, y, z);\r\n      });\r\n\r\n      return this;\r\n    }\r\n\r\n    Src(src, options = {}) {\r\n\r\n      if (typeof src == 'string') {\r\n\r\n        console.log('setting GameImage with string:' + src);\r\n        this.src = src;\r\n        this.image = new Gamelab.GameImage(src);\r\n\r\n      } else if (src instanceof GameImage) {\r\n        //console.log('Animation(): args are an instance of GameImage');\r\n\r\n        this.image = src;\r\n      } else if (src instanceof HTMLImageElement) {\r\n        //console.log('Animation(): args are an instance of HTMLImageElement');\r\n\r\n        this.image = new Gamelab.GameImage(src);\r\n      }\r\n\r\n      if (!options.frameBounds)\r\n        this.init_singleFrame();\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    Scale(s) {\r\n\r\n      this.scale = s;\r\n\r\n      if (this.image && this.image.domElement && this.image.domElement.width > 0) {\r\n        this.size = new Gamelab.Vector(this.image.domElement.width * s, this.image.domElement.height * s).round();\r\n        this.Size(this.size);\r\n      }\r\n\r\n      if (this.frames instanceof Array)\r\n        this.frames.forEach(function(f) {\r\n\r\n          f.Scale(s);\r\n\r\n        });\r\n\r\n      return this;\r\n    }\r\n\r\n    Size(x, y, z) {\r\n\r\n      this.size = new Gamelab.Vector(x, y, z);\r\n\r\n      this.frames.forEach(function(f) {\r\n        f.size = new Gamelab.Vector(x, y, z);\r\n      });\r\n\r\n      return this;\r\n    }\r\n\r\n    Image(src) {\r\n\r\n      if (typeof(src) == 'string') {\r\n\r\n        //console.log('setting GameImage with string:' + src);\r\n        this.src = src;\r\n        this.image = new Gamelab.GameImage(src);\r\n\r\n      } else if (src instanceof Gamelab.GameImage) {\r\n        //console.log('Animation(): args are an instance of GameImage');\r\n\r\n        this.image = src;\r\n      } else if (src instanceof HTMLImageElement) {\r\n        console.log('Animation(): args was an instance of HTMLImageElement');\r\n\r\n        this.image = new Gamelab.GameImage(src);\r\n      }\r\n\r\n      this.init_singleFrame();\r\n\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * sets this Animation to a single-frame-animation, from existing image\r\n     * @function\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    init_singleFrame() {\r\n\r\n      var $anime = this;\r\n\r\n      $anime.load_call = $anime.load_call || function() {};\r\n\r\n      this.image.domElement.onload = function() {\r\n\r\n        //alert('Anime loaded');\r\n\r\n        //first run callback assigned by the api-fxns\r\n        $anime.load_call();\r\n\r\n        if ($anime.frameSize.x == 0 && !$anime.__isInit) //indicates zero frame size\r\n          $anime.FrameSize($anime.image.domElement.width, $anime.image.domElement.height)\r\n          .FrameBounds(new Gamelab.Vector(0, 0), new Gamelab.Vector(0, 0));\r\n\r\n        if ($anime.size.x == 0  && !$anime.__isInit) //indicates zero size\r\n          $anime.Size($anime.frameSize.mult(new Gamelab.Vector($anime.scale, $anime.scale)));\r\n\r\n        if(!$anime.__isInit)\r\n        $anime.apply2DFrames();\r\n\r\n      };\r\n\r\n      Gamelab.log('Animation():set single-frame animation');\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    /*****\r\n     * Overridable / Extendable functions\r\n     * -allows stacking of external object-function calls\r\n     ******/\r\n\r\n\r\n    /**\r\n     * Provides a function to be called when this Animation.image loads.\r\n     *\r\n     * @function\r\n     * @params {Function} call the function to be called on load\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    onLoad(call) {\r\n\r\n      var $anime = this;\r\n      call = call || function() {};\r\n\r\n      this.load_call = call;\r\n\r\n      this.image.domElement.onload = function() {\r\n\r\n        call.bind($anime).call();\r\n\r\n      };\r\n\r\n    }\r\n\r\n    /**\r\n     * Provides a function to be called whenever this Animation starts. Function should run every time the Animation reaches frame-index 0\r\n     *\r\n     * @function\r\n     * @params {Function} call the function to be called on start\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    onRun(call) {\r\n\r\n      if (this.run_ext.indexOf(call) == -1) {\r\n        this.run_ext.push(call.bind(this));\r\n      }\r\n    }\r\n\r\n\r\n    /**\r\n     * Provides a function to be called whenever this Animation completes. Function should run every time the Animation reaches it's last frame-index.\r\n     *\r\n     * @function\r\n     * @params {Function} call the function to be called on complete\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    onComplete(call) {\r\n\r\n      if (this.complete_ext.indexOf(call) == -1) {\r\n        this.complete_ext.push(call.bind(this));\r\n      }\r\n    }\r\n\r\n\r\n    /**\r\n     * Provides a single and only function to be called whenever this Animation completes. Function should run every time the Animation reaches it's last frame-index.\r\n     *\r\n     * @function\r\n     * @params {Function} call the function to be called on complete\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    soleComplete(call) {\r\n      this.complete_ext = [];\r\n      if (this.complete_ext.indexOf(call) == -1) {\r\n        this.complete_ext.push(call.bind(this));\r\n      }\r\n    }\r\n\r\n    call_on_run() {\r\n      //call any function extension that is present\r\n      for (var x = 0; x < this.run_ext.length; x++) {\r\n        this.run_ext[x](this);\r\n      }\r\n    }\r\n\r\n    call_on_complete() {\r\n      //call any function extension that is present\r\n      for (var x = 0; x < this.complete_ext.length; x++) {\r\n        this.complete_ext[x](this);\r\n      }\r\n    }\r\n\r\n\r\n    Visible(v) {\r\n      this.visible = v;\r\n      return this;\r\n    }\r\n\r\n\r\n    FrameSize(w, h) {\r\n      this.frameSize = new Gamelab.Vector(w, h);\r\n      this.__isInit = true;\r\n      this.apply2DFrames();\r\n      return this;\r\n    }\r\n\r\n    Hang() {\r\n      this._hang = true;\r\n      return this;\r\n    }\r\n\r\n    ResetHang(){\r\n      this._hang = false;\r\n      this.cix = this.min_cix;\r\n    }\r\n\r\n    DefineGridFrames(x1, y1, x2, y2, xFinal, yFinal) {\r\n      var maxFrame;\r\n\r\n      if (typeof xFinal == 'number' && typeof yFinal == 'number')\r\n        maxFrame = new Gamelab.Vector(xFinal, yFinal);\r\n\r\n      this.frameBounds = new Gamelab.VectorFrameBounds(\r\n        new Gamelab.Vector(x1, y1), new Gamelab.Vector(x2, y2), maxFrame);\r\n      this.__isInit = true;\r\n      this.apply2DFrames();\r\n      return this;\r\n    }\r\n\r\n    FrameOffset(x, y) {\r\n      this.frameOffset = new Gamelab.Vector(x, y);\r\n      return this;\r\n    }\r\n\r\n    Seesaw() {\r\n      if (!this.seesaw_mode) {\r\n        this.seesaw_mode = true;\r\n      }\r\n      return this;\r\n    }\r\n\r\n    Duration(millis) {\r\n      this.duration = millis;\r\n      return this;\r\n    }\r\n\r\n\r\n    /**\r\n     * Reverses all frames of the animation. Frames are then expected to run backwards.\r\n     *\r\n     * @function\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    ReverseFrames() {\r\n\r\n      this.reverse_frames = true;\r\n      return this;\r\n    }\r\n\r\n    /**\r\n     * Sets the animation a a single frame / full-image. Use before img is loaded\r\n     *\r\n     * @function\r\n     * @param {Vector} frameSize optional size param\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    SingleFrame() {\r\n      this.init_singleFrame();\r\n      return this;\r\n    }\r\n\r\n    getArg(args, key, fallback) {\r\n\r\n      if (args.hasOwnProperty(key)) {\r\n        return args[key];\r\n      } else {\r\n        return fallback;\r\n      }\r\n    }\r\n\r\n    init() {\r\n      this.apply2DFrames();\r\n      return this;\r\n    }\r\n\r\n\r\n    apply2DFrames() {\r\n      this.frames = [];\r\n\r\n      if (!this.size) {\r\n        this.Size(this.frameSize.x, this.frameSize.y);\r\n      }\r\n\r\n      var fcount = 0;\r\n      var quitLoop = false;\r\n\r\n      for (let y = this.frameBounds.min.y; y <= this.frameBounds.max.y; y++) {\r\n        for (let x = this.frameBounds.min.x; x <= this.frameBounds.max.x; x++) {\r\n\r\n          let framePos = {\r\n            x: x * this.frameSize.x + this.frameOffset.x,\r\n            y: y * this.frameSize.y + this.frameOffset.y\r\n          };\r\n\r\n          var f = new Gamelab.Frame().Image(this.image).FramePos(framePos).FrameSize(this.frameSize).Origin(this.origin).Size(this.size || this.frameSize).Position(this.position || framePos);\r\n          f.Rotation(this.rotation);\r\n\r\n          this.frames.push(f);\r\n\r\n          if (x >= this.frameBounds.termPoint.x && y >= this.frameBounds.termPoint.y) {\r\n            quitLoop = true;\r\n            break;\r\n          }\r\n\r\n          fcount += 1;\r\n\r\n          if (quitLoop)\r\n            break;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      this.frames[0] = this.selected_frame = this.frames[0] || new Gamelab.Frame().Image(this.image).FrameSize(this.frameSize).Size(this.frameSize);\r\n\r\n      if (this.seesaw_mode) {\r\n\r\n        // console.log('Animation: applying seesaw');\r\n\r\n        var frames_reversed = this.frames.slice().reverse();\r\n\r\n        this.frames.pop();\r\n\r\n        this.frames = this.frames.concat(frames_reversed);\r\n\r\n      }\r\n      if (this.reverse_frames) {\r\n        this.frames.reverse();\r\n      }\r\n    }\r\n\r\n    scaleOf(sized_Object) {\r\n\r\n      var s = TypeCode.getPreferredPropertyByKey(sized_Object, 'size', 'argument had nested size variable. Using this instead.');\r\n\r\n      return s.div(this.frameSize);\r\n\r\n    }\r\n\r\n    init_colorMap() {\r\n      TypeCode.info('init_colorMap()');\r\n\r\n      if (!TypeCode.allDefined([this.image, this.image.domElement]))\r\n        return [];\r\n\r\n      this.canvasObject = this.canvasObject || new Gamelab.OffscreenCanvasRendering(this.image);\r\n\r\n      this.colorMap = this.colorMap || this.ColoredPixelGrid();\r\n\r\n      return this.colorMap;\r\n    }\r\n\r\n\r\n    ColoredPixelGrid() {\r\n\r\n      var image = this.image.domElement,\r\n\r\n        ctx = this.canvasObject.ctx,\r\n\r\n        grid = [],\r\n\r\n        frameSizeDiv = this.selected_frame.frameSize.div(12).round();\r\n\r\n      for (var x = 0; x <= image.width; x += frameSizeDiv.x) {\r\n        for (var y = 0; y <= image.height; y += frameSizeDiv.y) {\r\n          // Fetch pixel at current position\r\n          var pixel = ctx.getImageData(x, y, 1, 1);\r\n          // Check that opacity is above zero\r\n          if (pixel.data[3] != 0) {\r\n\r\n            var vector = new Gamelab.Vector(x, y),\r\n\r\n              gridObject = {\r\n\r\n                position: vector,\r\n\r\n                size: frameSizeDiv\r\n              };\r\n\r\n            grid.push(gridObject);\r\n          }\r\n        }\r\n      }\r\n\r\n      return grid;\r\n    }\r\n\r\n\r\n    /**\r\n     * Returns the existing ColorMap for this animation.\r\n     *\r\n     * @function\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    getCurrentPixelMap() {\r\n\r\n      TypeCode.info('getCurrentPixelMap()');\r\n      var map = [];\r\n      var frame = this.selected_frame;\r\n      let __inst = this;\r\n\r\n      this.colorMap = this.init_colorMap();\r\n\r\n      for (var x in this.colorMap) {\r\n        var c = this.colorMap[x];\r\n\r\n        if (Gamelab.Collision.boxCollide(frame.framePos, frame.frameSize, c.position, c.size)) {\r\n          map.push(c);\r\n        }\r\n      }\r\n\r\n      return map;\r\n\r\n    }\r\n\r\n    /**\r\n     * Sets the frame to a specific array-index.\r\n     *\r\n     * @function\r\n     * @param {number} ix the frame-index to apply.\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    setFrame(ix) {\r\n      this.selected_frame = this.frames[ix];\r\n    }\r\n\r\n\r\n    /**\r\n     * extends the update of this animation with a new function to be called during the update\r\n     * --repeated calls will extend, (not replace) the update --Allows multiple extensions of the update\r\n     * @function\r\n     * @memberof Animation\r\n     * @param {function} fun the function to be appended to sprite.update\r\n     *\r\n     *  * @example\r\n     * // extend the behavior of your animation\r\n     * myAnime.onUpdate(function(spr)\r\n     *\r\n     *                    console.log('extended update'); //runs automatically whenever animation.update runs\r\n     *\r\n     *                   });\r\n     *\r\n     **********/\r\n\r\n\r\n    onUpdate(fun) {\r\n\r\n      fun = fun.bind(this);\r\n\r\n      let update = this.update_frame.bind(this);\r\n      let __inst = this;\r\n      this.update_frame = function(__inst) {\r\n        update(__inst);\r\n        fun(__inst);\r\n      };\r\n    }\r\n\r\n    soleUpdate(fun) {\r\n\r\n      fun = fun.bind(this);\r\n\r\n      let __inst = this;\r\n      this.update_frame = function(__inst) {\r\n        fun(__inst);\r\n      };\r\n    }\r\n\r\n    update_frame() {\r\n\r\n      this.selected_frame = this.frames[Math.round(this.cix) % this.frames.length];\r\n    }\r\n\r\n    reset() {\r\n\r\n      this.apply2DFrames();\r\n\r\n      this.cix = 0;\r\n    }\r\n\r\n    /**\r\n     * Applies a continuous animation. Use this in parent-sprite's update if continuous animation is required.\r\n     * Also works as a single call at any time during game-update.\r\n     *\r\n     * @function\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    run() {\r\n\r\n      if (this.__frametype == 'single') {\r\n        return 0;\r\n      }\r\n\r\n      this.apply2DFrames();\r\n\r\n      this.cix += 1;\r\n\r\n      this.update_frame();\r\n    }\r\n\r\n    /**\r\n     * animate():: same as run()\r\n     *\r\n     * @function\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    animate() {\r\n\r\n\r\n      if (this.__frametype == 'single') {\r\n        return 0;\r\n      }\r\n\r\n\r\n      if(!this.applied)\r\n      {\r\n        this.apply2DFrames();\r\n        this.applied = true;\r\n      }\r\n\r\n\r\n\r\n      //update once:\r\n      //this.update();\r\n\r\n  //    console.log('anime-len:' +this.frames.length);\r\n\r\n  //    console.log('cix:' +this.cix);\r\n\r\n      if (this.cix % this.frames.length == 0) {\r\n\r\n        this.engage();\r\n\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Engages, or updates the animation for a one full frame-cycle.\r\n     *\r\n     * @function\r\n     * @param {number} duration the number of milliseconds the animation should take.\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    engage(duration) {\r\n\r\n      this.call_on_run();\r\n\r\n      duration = duration || this.duration || this.frames.length * 20;\r\n\r\n      if (this.__frametype == 'single') {\r\n        return 0;\r\n      }\r\n\r\n      //note support of min_cix (eg: min_cix of 1 if top-row starts 1 frame later than bottom)\r\n      if (this.cix >= this.frames.length - 1 || this.cix < this.min_cix && !this._hang) {\r\n        this.cix = this.min_cix;\r\n      }\r\n\r\n      let __inst = this;\r\n\r\n      //we have a target\r\n      this.tween = new TWEEN.Tween(this)\r\n        .easing(__inst.curve || TWEEN.Easing.Linear.None)\r\n\r\n        .to({\r\n          cix: this.min_cix + (this.frames.length - 1)\r\n        }, duration)\r\n        .onUpdate(function() {\r\n          //console.log(objects[0].position.x,objects[0].position.y);\r\n\r\n          //__inst.cix = Math.ceil(__inst.cix);\r\n\r\n          __inst.update_frame();\r\n\r\n        })\r\n        .onComplete(function() {\r\n          //console.log(objects[0].position.x, objects[0].position.y);\r\n\r\n            if(!__inst._hang)\r\n          __inst.cix = __inst.min_cix;\r\n\r\n          __inst.call_on_complete();\r\n\r\n          __inst.isComplete = true;\r\n\r\n          __inst.apply2DFrames();\r\n\r\n        });\r\n\r\n\r\n      if (this.cix == this.min_cix)\r\n        this.tween.start();\r\n\r\n\r\n    }\r\n  };\r\n\r\n  /** @memberof Gamelab */\r\n\r\n  Animation.prototype.FrameBounds = Animation.prototype.DefineGridFrames;\r\n\r\n  Gamelab.Animation = Animation;\r\n\r\n  Gamelab.Animation.continuous = Gamelab.Animation.run; //'continuous is an alternate reference to 'run'.'\r\n\r\n  Gamelab.Animation.update = Gamelab.Animation.update_frame; //alt ref\r\n\r\n  Gamelab.Animation.continue = Gamelab.Animation.run; //'continue is an alternate reference to 'run'.'\r\n\r\n})();\r\n;class Bone {\r\n  constructor() {\r\n    this.parent = undefined;\r\n    this.target = undefined;\r\n  }\r\n  updatePositionRotation() {\r\n    //  console.log('Parent-Rotation:' + this.parentAnimation.rotation.x);\r\n    var rotatedOffset = Gamelab.VectorMath.rotatePointsXY(this.offset.x, this.offset.y, this.parent.rotation.x),\r\n    fullPosition = this.parent.position.add(rotatedOffset);\r\n    this.target.Position(fullPosition);\r\n    this.RotateTarget(this.target.rotation);\r\n    return fullPosition;\r\n  }\r\n\r\n  RotateTarget(x, y, z) {\r\n    this.target.Rotation(x, y, z);\r\n    return this;\r\n  }\r\n\r\n  Parent(p) {\r\n    this.parent = p;\r\n    return this;\r\n  }\r\n  Target(t) {\r\n    this.target = t;\r\n    return this;\r\n  }\r\n}\r\n\r\nGamelab.Bone = Bone;\r\n\r\nclass BoneState {\r\n  constructor(boneList) {\r\n    var states = [];\r\n    boneList.forEach(function(bone) {\r\n      states.push({\r\n        bone: bone,\r\n        offset: new Gamelab.Vector(),\r\n        rotation: new Gamelab.Vector(),\r\n        size: new Gamelab.Vector(),\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\nGamelab.BoneState = BoneState;\r\n;;\r\n\r\n\r\nclass Box2D{\r\n\r\n  constructor(pos, size){\r\n    this.Position(pos | 0);\r\n    this.Size(size | 0);\r\n  }\r\n\r\n  Position(x, y)\r\n  {\r\n    this.position = new Gamelab.Vector(x, y);\r\n    return this;\r\n  }\r\n  Size(x, y)\r\n  {\r\n    this.size = new Gamelab.Vector(x, y);\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\n\r\n\r\nGamelab.Box2D = Box2D;\r\n;;(function() {\r\n  console.log('Frame class... creating');\r\n\r\n  /**\r\n   * Creates an instance of Frame\r\n   *\r\n   * <info-bit>Gamelab.Frame is called automatically by Gamelab.Sprite and Gamelab.Animation.\r\n   * Gamelab.Frame does not take arguments.\r\n   * It is instantiated, then initilized with chainable function-calls.</info-bit>\r\n   *\r\n   * @returns {Frame}\r\n   *\r\n   * @example\r\n   *\r\n   * var selected_frame = new Gamelab.Frame().Image(gameImage).Size(frameSizeVector);\r\n   */\r\n\r\n\r\n  class Frame {\r\n    constructor() {\r\n      var __inst = this;\r\n      this.framePos = new Gamelab.Vector(0, 0);\r\n      this.origin = new Gamelab.Vector(0, 0);\r\n      this.rotation = new Gamelab.Vector(0, 0, 0);\r\n    }\r\n\r\n    Image(src) {\r\n      this.image = new Gamelab.GameImage(src);\r\n      return this;\r\n    }\r\n\r\n    onLoad(fxn) {\r\n\r\n      fxn = fxn || function() {};\r\n      fxn = fxn.bind(this);\r\n      this.image.domElement.onload = function() {\r\n        fxn();\r\n      };\r\n\r\n    }\r\n\r\n    Origin(x, y, z) {\r\n      this.origin = new Gamelab.Vector(x, y, z);\r\n      return this;\r\n    }\r\n\r\n    Rotation(x, y, z) {\r\n      this.rotation = new Gamelab.Vector(x, y, z);\r\n      return this;\r\n    }\r\n\r\n    FramePos(p) {\r\n      this.framePos = new Gamelab.Vector(p, p, p);\r\n\r\n      return this;\r\n    }\r\n\r\n    FrameSize(x, y, z) {\r\n      this.frameSize = new Gamelab.Vector(x, y, z);\r\n      return this;\r\n    }\r\n\r\n    Scale(s)\r\n    {\r\n      if(this.image && this.image.domElement)\r\n      {\r\n        this.size = new Gamelab.Vector(Math.round(this.image.domElement.width * s), Math.round(this.image.domElement.height * s));\r\n      }\r\n    }\r\n\r\n    StoreOffscreen() {\r\n\r\n      this.offscreen = this.offscreen || new Gamelab.OffscreenCanvasRendering(this.image);\r\n\r\n      for (var x in this.offscreen) {\r\n        if (x == 'ctx' || x == 'canvas')\r\n          this[x] = this.offscreen[x];\r\n      }\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    getURL() {\r\n      this.StoreOffscreen();\r\n      return this.offscreen.canvas.toDataURL();\r\n    }\r\n\r\n    getColoredPixelGrid(unitSize = 5, ctx) {\r\n\r\n      var grid = [];\r\n\r\n      ctx = ctx || this.ctx;\r\n\r\n      let min = this.framePos,\r\n        max = this.framePos.add(this.frameSize);\r\n\r\n\r\n      for (var x = min.x; x <= max.x; x += unitSize) {\r\n        for (var y = min.y; y <= max.y; y += unitSize) {\r\n          // Fetch pixel at current position\r\n          var pixel = ctx.getImageData(x, y, 1, 1);\r\n          // Check that opacity is above zero\r\n          if (pixel.data[3] != 0) {\r\n\r\n            var vector = new Gamelab.Vector(x, y),\r\n\r\n              gridObject = {\r\n\r\n                position: vector,\r\n\r\n                x:x,\r\n                y:y,\r\n\r\n                size: new Gamelab.Vector(unitSize, unitSize),\r\n\r\n                pixel: pixel,\r\n\r\n                rotation:this.rotation\r\n\r\n              };\r\n\r\n            grid.push(gridObject);\r\n          }\r\n        }\r\n      }\r\n\r\n      return grid;\r\n    }\r\n\r\n    getNonColoredPixelGrid(unitSize = 5, ctx) {\r\n\r\n      var grid = [];\r\n\r\n      ctx = ctx || this.ctx;\r\n\r\n      let min = this.framePos,\r\n        max = this.framePos.add(this.frameSize);\r\n\r\n\r\n      for (var x = min.x; x <= max.x; x += unitSize) {\r\n        for (var y = min.y; y <= max.y; y += unitSize) {\r\n          // Fetch pixel at current position\r\n          var pixel = ctx.getImageData(x, y, 1, 1);\r\n          // Check that opacity is above zero\r\n          if (pixel.data[3] == 0) {\r\n\r\n            var vector = new Gamelab.Vector(x, y),\r\n\r\n              gridObject = {\r\n\r\n                position: vector,\r\n\r\n                x:x,\r\n                y:y,\r\n\r\n                size: new Gamelab.Vector(unitSize, unitSize),\r\n\r\n                pixel: pixel,\r\n\r\n                rotation:this.rotation\r\n\r\n              };\r\n\r\n            grid.push(gridObject);\r\n          }\r\n        }\r\n      }\r\n\r\n      return grid;\r\n    }\r\n\r\n    getFullPixelGrid(unitSize = 5, ctx) {\r\n\r\n      ctx = ctx || this.ctx;\r\n\r\n      var grid = [];\r\n\r\n      let min = this.framePos,\r\n        max = this.framePos.add(this.frameSize);\r\n\r\n      for (var x = min.x; x <= max.x; x += unitSize) {\r\n        for (var y = min.y; y <= max.y; y += unitSize) {\r\n          // Fetch pixel at current position\r\n          var pixel = ctx.getImageData(x, y, 1, 1);\r\n          // Check that opacity is above zero\r\n\r\n\r\n          var vector = new Gamelab.Vector(x, y),\r\n\r\n            gridObject = {\r\n\r\n              position: vector,\r\n\r\n              x:x,\r\n              y:y,\r\n\r\n              size: new Gamelab.Vector(unitSize, unitSize),\r\n\r\n              pixel: pixel,\r\n\r\n              rotation:this.rotation\r\n\r\n            };\r\n\r\n          grid.push(gridObject);\r\n        }\r\n      }\r\n\r\n      return grid;\r\n    }\r\n\r\n\r\n    /**\r\n     * Creates and returns a ColorMap for this animation, allowing opacity-based pixel-collision.\r\n     *\r\n     * @function\r\n     * @param {number} unitDimen a Colormap grid-unit-size --A larger unitDimen decreases accuracy, and results in faster-processing.\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    createColorMap(size, ctx) {\r\n\r\n      this.StoreOffscreen();\r\n\r\n      ctx = ctx || this.ctx;\r\n\r\n      this.colorMap = this.colorMap || this.getColoredPixelGrid(size, ctx);\r\n\r\n      return this.colorMap;\r\n    }\r\n\r\n    createNonColorMap(size, ctx) {\r\n      this.StoreOffscreen();\r\n      ctx = ctx || this.ctx;\r\n      this.nonColorMap = this.nonColorMap || this.getNonColoredPixelGrid(size, ctx);\r\n      return this.nonColorMap;\r\n    }\r\n\r\n\r\n    createPixelMap(size, altImage) {\r\n      if(this.image.domElement instanceof HTMLCanvasElement)\r\n      {\r\n        this.canvas = this.image.domElement;\r\n        ctx = this.ctx = this.canvas.getContext('2d');\r\n      }\r\n      else{\r\n        this.StoreOffscreen();\r\n        ctx = ctx || this.ctx;\r\n      }\r\n\r\n      this.pixelMap = this.pixelMap || this.getFullPixelGrid(size, this.testCtx);\r\n      return this.fullPixelMap;\r\n    }\r\n\r\n  }\r\n\r\n  Gamelab.Frame = Frame;\r\n\r\n})();\r\n;class Line2d extends Scriptable {\r\n  constructor() {\r\n    super();\r\n    this.Object(this);\r\n    this.points = [];\r\n    this.position = new Gamelab.Vector(0, 0);\r\n    this.rotation = new Gamelab.Vector(0, 0);\r\n    this.size = new Gamelab.Vector(0, 0);\r\n    this.index = 0;\r\n    this.lineWidth = 1.0;\r\n    this.timer = 0;\r\n    this.phase_index = 0;\r\n    this.call = function() {};\r\n  }\r\n\r\n  StepFunction(call) {\r\n    this.call = call;\r\n    return this;\r\n  }\r\n\r\n  next() {\r\n    this.index += 1;\r\n    return this.points[this.index % this.points.length];\r\n  }\r\n\r\n  Color(c) {\r\n    this.color = c;\r\n    return this;\r\n  }\r\n\r\n  GradientCall(fxn, colorStops=[]){\r\n    this.colorStops = colorStops;\r\n    this.gradient_call = fxn.bind(this);\r\n      return this;\r\n  }\r\n\r\n  ShadowBlur(shadowBlur, color){\r\n      this.shadowBlur = shadowBlur;\r\n      this.shadowColor = color;\r\n    return this;\r\n  }\r\n\r\n  Opacity(o){\r\n    this.opacity = o;\r\n    return this;\r\n  }\r\n\r\n  AnimateShadowBlur(minBlur, maxBlur, color, stepFunction){\r\n    this.shadowBlur = minBlur;\r\n    this.shadowColor = color;\r\n    this.minBlur = minBlur;\r\n    this.maxBlur = maxBlur;\r\n    this.blurStepFunction = stepFunction.bind(this);\r\n    this.blurTimer = 0;\r\n    return this;\r\n  }\r\n\r\n  collide(gameObject, lineCollisionCallback=function(){}){\r\n    var gop = gameObject.position, gos = gameObject.size;\r\n    var COLLIDE = false, LINE = this;\r\n    this.points.forEach(function(p){\r\n      if(p.x  >= gop.x && p.x <= gop.x + gos.x &&\r\n      p.y  >= gop.y && p.y <= gop.y + gos.y)\r\n      {\r\n        COLLIDE = true;\r\n        lineCollisionCallback(p, LINE.points);\r\n      }\r\n    });\r\n    return COLLIDE;\r\n  }\r\n\r\n  Fill() {\r\n    for (var x = 1; x <= this.size.x; x++) {\r\n          var x_total = this.size.x;\r\n          var out_of_1 = x / x_total;\r\n        //  console.log('using x portion::' + out_of_1);\r\n          var y = (this.size.y * this.call(out_of_1, 1.0)),\r\n          pos = new Gamelab.Vector(Gamelab.VectorMath.rotatePointsXY(x, y, this.rotation.x));\r\n                    var next_x = this.position.x + pos.x,\r\n            next_y = this.position.y + pos.y,\r\n          last_point = this.points[this.points.length - 1];\r\n          if(!last_point)\r\n          {\r\n            last_point = new Gamelab.Vector(0, 0);\r\n          }\r\n          var next_point = new Gamelab.Vector(next_x, next_y);\r\n          next_point.r = next_point.angleBetween(last_point, next_point);\r\n          this.points.push(next_point);\r\n      }\r\n    return this;\r\n  }\r\n\r\n  getOffsetPos(pos){\r\n    var offset = this.window_offset || new Gamelab.Vector(0, 0);\r\n    return pos.add(offset);\r\n  }\r\n\r\n  LineWidth(number)\r\n  {\r\n    this.lineWidth = number;\r\n    return this;\r\n  }\r\n\r\n  Layer(l)\r\n  {\r\n    this.layer = l;\r\n    return this;\r\n  }\r\n\r\n  GlobalComposite(gc)\r\n  {\r\n    this.globalComposite = gc;\r\n    return this;\r\n  }\r\n\r\n  draw(ctx, camera) {\r\n    ctx = ctx || Gamelab.game_windows[0].ctx;\r\n    camera = camera || Gamelab.game_windows[0].camera;\r\n\r\n    this.ctx = ctx;\r\n    var points = this.points;\r\n    ctx.save();\r\n    ctx.strokeStyle = this.color;\r\n    ctx.lineWidth = this.lineWidth;\r\n    ctx.beginPath();\r\n    this.timer += 1;\r\n    var lastPoint = false;\r\n\r\n    if (points instanceof Array) {\r\n      for (var x = 0; x < points.length; x++) {\r\n        var p = points[x];\r\n        if(x >= 1)\r\n        {\r\n          lastPoint = points[x];\r\n          if(this.gradient_call)\r\n          {\r\n            this.gradient = this.gradient_call(lastPoint, p, this.colorStops);\r\n            ctx.strokeStyle = this.gradient || this.color;\r\n          }\r\n        }\r\n        var position = p.position || p;\r\n        var real_pos = position.sub(camera.position);\r\n        if (real_pos.hasOwnProperty('x') && real_pos.hasOwnProperty('y')) {\r\n          ctx.lineTo(real_pos.x, real_pos.y);\r\n        }\r\n      }\r\n    }\r\n\r\n    var blurTime = this.timer % (this.maxBlur - this.minBlur),\r\n    blurLen = this.maxBlur - this.minBlur;\r\n    this.phase_index = Math.floor(this.timer / (this.maxBlur - this.minBlur));\r\n\r\n    if(this.shadowBlur)\r\n    {\r\n        ctx.shadowBlur = this.shadowBlur;\r\n    }\r\n    if(this.blurStepFunction)\r\n    {\r\n      ctx.shadowBlur = this.minBlur +  this.blurStepFunction(blurTime / blurLen, 1.0) * (this.maxBlur - this.minBlur);\r\n    }\r\n    if(this.shadowColor)\r\n    {\r\n      ctx.shadowColor = this.shadowColor;\r\n    }\r\n    if(this.globalComposite)\r\n    {\r\n      ctx.globalCompositeOperation = this.globalComposite;\r\n    }\r\n    if(typeof this.opacity == 'number')\r\n    {\r\n      ctx.globalAlpha = this.opacity;\r\n    }\r\n\r\n    ctx.stroke();\r\n\r\n    if(this.fillStyle)\r\n    {\r\n      ctx.fillStyle = this.fillStyle;\r\n      ctx.closePath();\r\n      ctx.fill();\r\n    }\r\n    ctx.restore();\r\n  }\r\n\r\n}\r\n\r\nGamelab.Line2d = Line2d;\r\n\r\nGamelab.Line2D = Line2d;\r\n;\nclass Mesh\n{\n    constructor(vertices, position)\n    {\n    this.vertices = vertices;\n    this.position = position;\n    }\n}\n\n\nGamelab.Mesh = Mesh;\n;class Particle {\r\n\r\n  constructor(options = {}, gameWindow) {\r\n\r\n    var canvas = document.createElement('CANVAS');\r\n\r\n    options.size = options.size || new Gamelab.Vector(2000, 2000);\r\n\r\n    this.options = options;\r\n\r\n    this.trackableSpeed = false;\r\n\r\n    canvas.width = options.size.x;\r\n    canvas.height = options.size.y;\r\n    canvas.style.display = 'none';\r\n\r\n    this.duration = 500;\r\n\r\n    //refers to an approxomated size\r\n    this.referenceSize = new Gamelab.Vector(0, 0);\r\n\r\n    this.startSize = this.referenceSize;\r\n\r\n    if (!this.life)\r\n      this.Life(70, 70, 'random');\r\n\r\n    this.DefaultValues();\r\n\r\n    this.NormalizeOptions(options);\r\n\r\n    this.Options(options);\r\n\r\n    if (options.duration)\r\n      this.duration = options.duration;\r\n\r\n    var sourceSprites = [],\r\n      livingSprites = [],\r\n      ctx = canvas.getContext('2d');\r\n\r\n    this.sourceSprites = [];\r\n\r\n    this.gameWindow = gameWindow;\r\n    this.ctx = ctx;\r\n    this.canvas = canvas;\r\n\r\n    this.sprites = [];\r\n    this.layer = 0;\r\n    this.ticker = 0;\r\n    this.total = 0;\r\n    this.position = new Gamelab.Vector(200, 200);\r\n  }\r\n\r\n  Layer(l) {\r\n    this.layer = l;\r\n    return this;\r\n  }\r\n\r\n  Prerender(inTestMode = false) {\r\n\r\n    this.prerendered = true;\r\n    this.precanvas = document.createElement('CANVAS');\r\n\r\n    this.precanvas.width = 200;\r\n    this.precanvas.height = 200;\r\n\r\n\r\n    var testDom;\r\n\r\n    if (inTestMode) {\r\n      testDom = document.createElement('DIV');\r\n      testDom.style.position = 'fixed';\r\n      testDom.style.overflow = 'scroll';\r\n      testDom.style.width = '60%';\r\n      testDom.style.height = '60%';\r\n      this.testDom = testDom;\r\n    }\r\n\r\n    this.prectx = this.precanvas.getContext('2d');\r\n\r\n    this.image = document.createElement('img');\r\n    this.image.src = this.options.src;\r\n\r\n    this.portions = [];\r\n\r\n    this.presprites = [];\r\n\r\n    for (var x = 0; x <= 64; x++) {\r\n      this.portions.push(Math.round((x / 64) * 100) / 100);\r\n    }\r\n\r\n    var $object = this;\r\n\r\n    var fw = 0,\r\n      fh = 0;\r\n\r\n\r\n\r\n    var $sprite = new Gamelab.Sprite(this.image.src);\r\n\r\n    this.isPrerendered = true;\r\n\r\n    var V = Gamelab.Vector;\r\n\r\n    this.presprite = $sprite;\r\n\r\n    $sprite.onLoad(function() {\r\n\r\n      fw = this.size.x;\r\n      fh = this.size.y;\r\n\r\n  //    console.log('size-x:' + fw);\r\n\r\n  //    console.log('size-y:' + fh);\r\n\r\n      $object.precanvas.style.width = this.size.x * 64 + 'px';\r\n      $object.precanvas.style.height = this.size.y + 'px';\r\n\r\n      $object.precanvas.width = this.size.x * 64;\r\n      $object.precanvas.height = this.size.y;\r\n\r\n      if ($object.testDom)\r\n        $object.testDom.style.height = (this.size.y + 35) + 'px';\r\n\r\n      this.testSize = this.size;\r\n\r\n      var colorOptions = $object.options.color,\r\n        colorOptionSet = numbers.getMinAndMaxByPair(colorOptions.a, colorOptions.b);\r\n\r\n      var colors = new Gamelab.ColorFeildSpan(colorOptionSet.min, colorOptionSet.max, 'linear').PrepareColors();\r\n\r\n      var all_colors = colors.colors,\r\n        max_ix = 64;\r\n\r\n      var frames = [];\r\n\r\n      $sprite.effectDataList = [];\r\n\r\n      for (var ix = 0; ix < 64; ix++) {\r\n\r\n        var colorIndex = Math.floor((ix / max_ix) * all_colors.length);\r\n\r\n        this.pushColorEffectCanvas(all_colors[colorIndex % all_colors.length]);\r\n        this.ColorEffect(all_colors[colorIndex % all_colors.length]);\r\n\r\n        //  var opacity = 1.0 - (ix / 64);\r\n\r\n        //  this.Opacity(opacity);\r\n        this.Position(ix * fw, 0);\r\n        this.draw($object.prectx);\r\n      }\r\n\r\n\r\n      //modify the draw function\r\n      $object.presprite.draw = function(ctx, camera) {\r\n\r\n        var sprite = this;\r\n\r\n        this.Layer($object.layer);\r\n\r\n        this.ScrollFactor(0);\r\n\r\n        var frame = false;\r\n\r\n        if (sprite.active) {\r\n\r\n          if (sprite.selected_animation instanceof Object && sprite.selected_animation.hasOwnProperty('selected_frame')) {\r\n            frame = sprite.selected_animation.selected_frame;\r\n          }\r\n\r\n          //match frame position w/ sprite position\r\n          frame.Position(sprite.position);\r\n\r\n          var xpos = frame.position.x,\r\n            ypos = frame.position.y;\r\n\r\n          var p = sprite.position;\r\n\r\n          var x = p.x,\r\n            y = p.y,\r\n            scrollFactor = sprite.scrollFactor >= -1.0 && sprite.scrollFactor <= 1.0 ? sprite.scrollFactor : 1.0;\r\n\r\n          if (sprite.noScroll) {\r\n            scrollFactor = 0;\r\n          }\r\n\r\n          //optional animation : gameSize\r\n\r\n          var targetSize = sprite.size || sprite.selected_animation.size;\r\n          var realWidth = targetSize.x;\r\n          var realHeight = targetSize.y;\r\n\r\n\r\n          var origin = sprite.origin || new Gamelab.Vector(realWidth / 2, realHeight / 2);\r\n\r\n          //optional animation : offset\r\n\r\n          var rotation;\r\n\r\n          if (typeof(sprite.rotation) == 'object') {\r\n            rotation = sprite.rotation.x;\r\n\r\n          } else {\r\n            rotation = sprite.rotation;\r\n          }\r\n\r\n          var pct = this.ticker / (this.life + 1);\r\n\r\n          if (pct > 1.0 || isNaN(pct))\r\n            pct = 1.0;\r\n\r\n          if (!(this.effectCanvasList instanceof Array))\r\n            alert('not an array');\r\n\r\n          var index = Math.floor((this.effectCanvasList.length - 1) * pct);\r\n\r\n          if (isNaN(index) || index > this.effectCanvasList.length)\r\n            index = 0;\r\n\r\n\r\n          var targetCanvas = this.effectCanvasList[index];\r\n\r\n          if (targetCanvas instanceof HTMLCanvasElement)\r\n            Gamelab.Canvas.draw_image_frame(targetCanvas, frame.framePos, frame.frameSize, new Gamelab.Vector2D(Math.round(xpos + (origin.x)), Math.round(ypos + (origin.y))), new Gamelab.Vector2D(realWidth, realHeight), rotation % 360, ctx, sprite.flipX, sprite.flipY, origin, this.opacity, false);\r\n\r\n        }\r\n      };\r\n\r\n      if (this.testDom) {\r\n        testDom.style.zIndex = 9999;\r\n        testDom.style.top = '20%';\r\n        testDom.style.left = '20%';\r\n        testDom.appendChild($object.precanvas);\r\n        document.body.appendChild(testDom);\r\n      }\r\n\r\n    });\r\n\r\n\r\n\r\n    return this;\r\n  }\r\n\r\n  DefaultValues() {\r\n    var def_life = 50;\r\n\r\n    if (!(this.options.composite || this.options.globalComposite || this.options.gobalCompositeOperation))\r\n      this.Composite('source-over');\r\n\r\n    if (!this.options.scale)\r\n      this.Scale(0.6, 0.8, 'quadratic', def_life);\r\n\r\n    if (!this.options.speed)\r\n      this.Speed(7.5, 1.0, 'linear', def_life);\r\n\r\n    if (!(this.options.alpha || this.options.opacity))\r\n      this.Alpha(1.0, 0.1, 'quintic', def_life);\r\n\r\n    if (!this.options.color)\r\n      this.Color(false);\r\n  }\r\n\r\n  NormalizeOptions(options) {\r\n\r\n\r\n    if (typeof options.angle == 'number')\r\n      options.angle = {\r\n        a: options.angle\r\n      };\r\n\r\n    if (typeof options.scale == 'number')\r\n      options.scale = {\r\n        a: options.scale\r\n      };\r\n\r\n    if (typeof options.speed == 'number')\r\n      options.speed = {\r\n        a: options.speed\r\n      };\r\n\r\n    if (typeof options.alpha == 'number')\r\n      options.alpha = {\r\n        a: options.alpha\r\n      };\r\n\r\n    if (typeof options.color == 'string')\r\n      options.color = {\r\n        a: options.color\r\n      };\r\n\r\n  }\r\n\r\n  Options(options) {\r\n\r\n\r\n    this.Composite(options.composite || options.globalComposite || options.gobalCompositeOperation || 'source-over');\r\n\r\n    if (options.life)\r\n      this.Life(options.life.a, options.life.b, options.life.transition, 500);\r\n\r\n\r\n    var life = this.life.Clone().getValue();\r\n\r\n    if (options.angle)\r\n      this.Angle(options.angle.a, options.angle.b, options.angle.transition, life);\r\n\r\n    if (options.scale)\r\n      this.Scale(options.scale.a, options.scale.b, options.scale.transition, life);\r\n\r\n    if (options.speed)\r\n      this.Speed(options.speed.a, options.speed.b, options.speed.transition, life);\r\n\r\n    if (options.alpha)\r\n      this.Alpha(options.alpha.a, options.alpha.b, options.alpha.transition, life);\r\n\r\n    if (options.color)\r\n      this.Color(options.color.a, options.color.b, options.color.transition, life);\r\n  }\r\n\r\n\r\n  //flipX :: reverse the x-speed of sprite over x-axis\r\n  FlipX(value) {\r\n    this.flipX = value;\r\n\r\n    if (this.flipX) {\r\n      if (this.options.speed.a > 0) {\r\n        this.options.speed.a = -this.options.speed.a;\r\n      }\r\n      if (this.options.speed.b > 0) {\r\n        this.options.speed.b = -this.options.speed.b;\r\n      }\r\n    } else {\r\n      if (this.options.speed.a < 0) {\r\n        this.options.speed.a = -this.options.speed.a;\r\n      }\r\n      if (this.options.speed.b < 0) {\r\n        this.options.speed.b = -this.options.speed.b;\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  //Define the src (image) of the particle\r\n  Src(src) {\r\n\r\n    this.sourceSprites = [];\r\n    this.options.src = src;\r\n\r\n\r\n    var options = this.options;\r\n\r\n  //  console.info(this.options);\r\n\r\n    var maxlife;\r\n\r\n    if(options.life instanceof Object)\r\n    {\r\n       maxlife = options.life.a && !options.life.b ? options.life.a : options.life.a > options.life.b ? options.life.a : options.life.b;\r\n    }\r\n\r\n    else if(typeof options.life == 'number')\r\n    {\r\n      maxlife = options.life;\r\n    }\r\n\r\n    this.options.max = maxlife * 60;\r\n\r\n      if(this.options.max > 2000)\r\n      {\r\n        this.options.max = 2000;\r\n      }\r\n\r\n    for (var x = 0; x < this.options.max; x++) {\r\n      var sprite = new Gamelab.Sprite(this.options.src).Scale(this.options.scale.a);\r\n\r\n      var particle = this;\r\n\r\n      if (x == 0)\r\n        sprite.onLoad(function() {\r\n          particle.referenceSize = this.size;\r\n        });\r\n\r\n      sprite.options = this.options;\r\n      this.sourceSprites.push(sprite);\r\n    }\r\n\r\n\r\n    this.sourceSprites.oldest = function() {\r\n\r\n      var maxTicker = 0,\r\n        nextObjectIndex = 0;\r\n\r\n      for (var x = 0; x < this.length; x++) {\r\n        if (typeof this[x] == 'object' && this[x].ticker >= maxTicker) {\r\n          maxTicker = this[x].ticker;\r\n          nextObjectIndex = x;\r\n        }\r\n      }\r\n      return this[nextObjectIndex];\r\n    };\r\n\r\n    this.sourceSprites.countLiving = function() {\r\n      var total = 0;\r\n      for (var x = 0; x < this.length; x++) {\r\n        if (this[x].ticker >= 1) {\r\n          total++;\r\n        }\r\n      }\r\n\r\n    //  console.log('TOTAL LIVING blts::' + total);\r\n      return total;\r\n    };\r\n\r\n\r\n    return this;\r\n  }\r\n\r\n  //Total particles to draw from\r\n  Stock(stock) {\r\n    this.options.stock = stock;\r\n    return this;\r\n  }\r\n\r\n\r\n  OffsetAllByX(x) {\r\n\r\n    var particle = this;\r\n\r\n    this.sprites.forEach(function(sprite) {\r\n      if (!sprite.detached_particle && sprite.flipX == particle.flipX)\r\n        sprite.position.x += x;\r\n      else {\r\n        sprite.detached_particle = true;\r\n      }\r\n    });\r\n\r\n    return this;\r\n  }\r\n\r\n  //composite :: example value = 'lighter'\r\n  Composite(c) {\r\n    this.options.globalCompositeOperation = c;\r\n    return this;\r\n  }\r\n\r\n  //Life span\r\n  Life(a, b, transition, duration = 500) {\r\n    this.life = new Gamelab.FeildSpan(a, b, transition, duration);\r\n    return this;\r\n  }\r\n\r\n  Color(a, b, transition, life) {\r\n    if(!a)\r\n    {\r\n      this.options.color = false;\r\n      return false;\r\n    }\r\n    this.options.color = new Gamelab.ColorFeildSpan(a, b, transition, life).PrepareColors();\r\n  }\r\n\r\n  //scale transition\r\n  Scale(a, b, transition, life) {\r\n    this.options.scale = new Gamelab.FeildSpan(a, b, transition, life);\r\n    return this;\r\n  }\r\n\r\n  //allowable angles\r\n  Angle(a, b, transition, life) {\r\n    this.options.angle = new Gamelab.FeildSpan(a, b, transition, life);\r\n    return this;\r\n  }\r\n\r\n  //alpha transition\r\n  Alpha(a, b, transition, life) {\r\n    this.options.alpha = new Gamelab.FeildSpan(a, b, transition, life);\r\n    return this;\r\n  }\r\n\r\n  //speed transition\r\n  Speed(a, b, transition, life) {\r\n    this.options.speed = new Gamelab.FeildSpan(a, b, transition, life);\r\n    return this;\r\n  }\r\n\r\n  LockRotation(r) {\r\n    this.lockedRotation = r;\r\n    return this;\r\n  }\r\n\r\n\r\n  addParticles(total) {\r\n\r\n    var options = this.options;\r\n\r\n    var positions = [];\r\n\r\n    if (options.shape instanceof Gamelab.Circle)\r\n      positions = ['border', 'perimeter'].indexOf(options.pointMode) >= 0 ? options.shape.getRandomCircumferencePoints(total) : options.shape.getRandomPoints(total);\r\n    for (var x = 0; x < total; x++) {\r\n\r\n      this.total += 1;\r\n      var sprite;\r\n\r\n      var ix = x + this.sourceSprites.countLiving();\r\n\r\n      if(ix < this.sourceSprites.length)\r\n      sprite = this.sourceSprites[ix];\r\n      else{\r\n        sprite = this.sourceSprites.oldest();\r\n      }\r\n    //  console.info(sprite);\r\n    //  console.info(this.sourceSprites);\r\n      if (this.total >= this.sourceSprites.length) {\r\n        //console.info(sprite);\r\n      }\r\n      this.lastSprite = sprite;\r\n    //  console.info(sprite);\r\n    //  console.log(ix);\r\n    //  console.log(this.sourceSprites.length);\r\n      sprite.ticker = 0;\r\n      sprite.speed = new Gamelab.Vector(0, 0);\r\n\r\n\r\n      //temp scroll factor -zero\r\n\r\n      sprite.ScrollFactor(0);\r\n\r\n      if (this.presprite && this.options.color && this.options.color.hasVariance()) {\r\n        sprite.effectCanvasList = this.presprite.effectCanvasList;\r\n        sprite.draw = this.presprite.draw;\r\n      }\r\n\r\n      if (this.gameWindow.has(sprite))\r\n        this.gameWindow.remove(sprite);\r\n\r\n      if (this.sprites.indexOf(sprite) >= 0)\r\n        this.sprites.splice(this.sprites.indexOf(sprite), 1);\r\n\r\n      if (sprite.constructor.name !== 'Sprite') {\r\n        console.error('not a sprite');\r\n      }\r\n\r\n      sprite.detached_particle = false;\r\n      sprite.flipX = this.flipX;\r\n\r\n      var particle = this;\r\n\r\n      sprite.flyByRotation = function(angle, speed) {\r\n        this.speed = Gamelab.Trig.rotational_speed(angle, speed);\r\n        this.position = this.position.add(this.speed);\r\n      };\r\n\r\n      sprite.speed = new Gamelab.Vector(0, 0);\r\n\r\n      sprite.gunOptions = {};\r\n\r\n      sprite.gunOptions.life = this.life.Clone();\r\n\r\n      sprite.life = sprite.gunOptions.life.getValue();\r\n\r\n      if (isNaN(sprite.life) || sprite.life == 0)\r\n        console.error('Not a number OR isZero --sprite.life');\r\n\r\n      sprite.gunOptions.angle = options.angle.Duration(sprite.life).Clone();\r\n\r\n      if (options.color && options.color.hasVariance())\r\n      sprite.gunOptions.color = options.color.Duration(sprite.life).Clone();\r\n\r\n      sprite.gunOptions.alpha = options.alpha.Duration(sprite.life).Clone();\r\n\r\n      sprite.gunOptions.speed = options.speed.Duration(sprite.life).Clone();\r\n\r\n      sprite.gunOptions.scale = options.scale.Duration(sprite.life).Clone();\r\n\r\n      sprite.opacity = sprite.gunOptions.alpha.getValue();\r\n\r\n      if (this.options.color && !this.presprite && this.options.color.hasVariance()) {\r\n        sprite.color = sprite.gunOptions.color.getValue();\r\n      }\r\n\r\n\r\n      sprite.scale = sprite.gunOptions.scale.getValue();\r\n\r\n      if (!this.presprite && this.options.color && this.options.color.hasVariance())\r\n        sprite.ColorEffect(sprite.color);\r\n\r\n\r\n      sprite.globalCompositeOperation = options.globalCompositeOperation || 'lighter';\r\n\r\n\r\n      var angleDiff = Math.abs(options.angle.a - options.angle.b);\r\n\r\n      if(sprite.hasOwnProperty('r'))\r\n      {\r\n       sprite.fly_angle = sprite.r;\r\n      }\r\n      else{\r\n        sprite.fly_angle = sprite.gunOptions.angle.getValue();\r\n      }\r\n\r\n\r\n      sprite.Scale(sprite.scale);\r\n\r\n      if (positions.length >= 1) {\r\n        if (x < positions.length) {\r\n          sprite.Position(this.position.add(positions[x]));\r\n\r\n          if(positions[x] && positions[x].hasOwnProperty('r') && !isNaN(positions[x].r) &&\r\n           positions[x].r >= -360 && positions[x].r <= 360)\r\n          {\r\n            sprite.r = positions[x].r;\r\n          }\r\n        } else {\r\n          sprite.Position(this.position);\r\n        }\r\n\r\n      } else {\r\n        sprite.Position(this.trackablePosition || this.position);\r\n      }\r\n\r\n      var gameWindow = this.gameWindow;\r\n\r\n\r\n      if (this.lockedRotation) {\r\n        sprite.Rotation(this.lockedRotation);\r\n      }\r\n\r\n      sprite.update = function() {\r\n\r\n        this.ticker += 1;\r\n\r\n        this.life -= 1;\r\n\r\n        if (this.life <= 0) {\r\n          //console.log('REMOVING PARTICLE');\r\n          particle.sprites.splice(particle.sprites.indexOf(this), 1);\r\n          gameWindow.remove(this);\r\n        }\r\n\r\n        this.scale = this.gunOptions.scale.getValue();\r\n\r\n        this.Scale(this.scale);\r\n\r\n        if (!particle.isPrerendered && particle.options.color && particle.options.color.hasVariance()) {\r\n          this.color = this.gunOptions.color.getValue();\r\n          this.ColorEffect(this.color);\r\n        }\r\n\r\n        this.Opacity(this.gunOptions.alpha.getValue());\r\n\r\n        this.gunSpeed = this.gunOptions.speed.getValue();\r\n\r\n        this.flyByRotation(this.r ? this.r % 360 : this.fly_angle % 360, this.gunSpeed);\r\n\r\n        if (particle.trackableSpeed) {\r\n          this.position = this.position.add(particle.trackableSpeed);\r\n        }\r\n        if (particle.trackablePosition) {\r\n          this.position = particle.trackablePosition;\r\n        }\r\n      };\r\n\r\n      this.sprites.push(sprite);\r\n      this.gameWindow.add(sprite);\r\n    }\r\n  }\r\n\r\n  resetTicker() {\r\n    this.ticker = 0;\r\n    return this;\r\n  }\r\n\r\n\r\n  assignTrackableSpeed(speed) {\r\n\r\n    this.trackableSpeed = speed;\r\n    return this;\r\n  }\r\n\r\n\r\n  assignTrackablePosition(position) {\r\n\r\n    this.trackablePosition = position;\r\n    return this;\r\n  }\r\n\r\n  assignLinesAndSelector(lineList, lineSelector) {\r\n    this.lines = lines;\r\n    return this;\r\n  }\r\n\r\n\r\n  enter(number) {\r\n\r\n    this.ticker += 1;\r\n\r\n    this.addParticles(number);\r\n\r\n    //return an api for assigning various updates::\r\n\r\n    var $p = this;\r\n\r\n    return this;\r\n\r\n  }\r\n}\r\n\r\nGamelab.Particle = Particle;\r\n\r\nclass Effect extends Particle {\r\n\r\n  constructor() {\r\n    super(...arguments);\r\n\r\n  }\r\n}\r\n\r\nGamelab.Effect = Effect;\r\n;class RectangularLine {\r\n  constructor() {\r\n    this.position = new Gamelab.Vector(0, 0);\r\n    this.rotation = new Gamelab.Vector(0, 0);\r\n    this.size = new Gamelab.Vector(0, 0);\r\n    this.gradient = undefined;\r\n    this.active = true;\r\n    this.invisible = false;\r\n  }\r\n  Gradient(a, b) {\r\n    this.gradientColorA = a;\r\n    this.gradientColorB = b;\r\n    return this;\r\n  }\r\n  Thickness(t) {\r\n    this.thickness = t;\r\n    return this;\r\n  }\r\n  draw(ctx, camera) {\r\n\r\n    if(!this.invisible && this.active)\r\n    {\r\n      this.ctx = ctx;\r\n      let gradient = this.ctx.createLinearGradient(0, 0, this.size.x, 0);\r\n      gradient.addColorStop(0, this.gradientColorA || 'white');\r\n      gradient.addColorStop(0, this.gradientColorB || 'white');\r\n      this.gradient = gradient;\r\n\r\n      ctx.strokeStyle = this.gradient || 'white';\r\n      ctx.lineWidth = this.thickness || 4.0;\r\n\r\n      ctx.beginPath();\r\n      ctx.strokeRect(this.position.x, this.position.y, this.size.x, this.size.y);\r\n    }\r\n\r\n  }\r\n}\r\n\r\nGamelab.RectangularLine = RectangularLine;\r\n;/**\r\n * Creates a new Sprite.\r\n *\r\n * <info-bit>Gamelab.Sprite is a container for 2D Animations.\r\n * -apply Sprite class to create a 2D game-object.\r\n *\r\n * Sprites hold reference to their-own Animations and Sounds.</info-bit>\r\n * <iframe style='width:400px; height:450px; overflow:hidden;' src='../client/examples/js-class/Sprite.html'> </iframe>\r\n\r\n * @param   {string} src the srcPath for the image of the Sprite\r\n * @param   {number} scale=1.0 the scale to be applied to size of each animation-frame\r\n *\r\n * @returns {Sprite} a Gamelab.Sprite object\r\n *\r\n */\r\n\r\n\r\nclass Sprite {\r\n  constructor(src = {}, scale) {\r\n    var args = typeof src == 'object' ? src : {};\r\n\r\n    this.handleAnimationArgs(args);\r\n    this.animations = [];\r\n    this.layer = 0;\r\n    this.type = 'Sprite';\r\n\r\n    //create size property\r\n    this.size = new Gamelab.Vector(0, 0);\r\n    this.active = true; //defaults to active or visible\r\n    this.ticker = 0;\r\n\r\n    this.scale = scale || 1.0;\r\n\r\n    //apply canvas-src if passed\r\n    this.handleCanvasArgs(src);\r\n\r\n    //apply remaining args\r\n    this.apply_args(args);\r\n\r\n    if (!this.selected_animation)\r\n      this.SingleFrame();\r\n  }\r\n\r\n  handleCanvasArgs(src) {\r\n    if (src instanceof HTMLCanvasElement) {\r\n      this.src = src;\r\n      this.selected_animation = new Gamelab.Animation(src);\r\n      this.image = this.selected_animation.image;\r\n      this.animations = [];\r\n      this.animations.push(this.selected_animation);\r\n      this.SingleFrame();\r\n    } else if (typeof src == 'string') {\r\n      this.src = src;\r\n\r\n      var srcTail = this.src.split('/').pop();\r\n      //set name to part of file-name, if name falsy\r\n      if(srcTail)\r\n      {\r\n        this.name = this.name || srcTail.split('.')[0];\r\n      }\r\n\r\n      this.selected_animation = new Gamelab.Animation(src);\r\n      this.image = this.selected_animation.image;\r\n      this.animations = [];\r\n      this.animations.push(this.selected_animation);\r\n      this.SingleFrame();\r\n    }\r\n  }\r\n\r\n  handleAnimationArgs(args) {\r\n    if (args instanceof Gamelab.Animation) //instantiate from animation\r\n    {\r\n      console.dev('args was Gamelab.Animation', args);\r\n      args = {\r\n        selected_animation: args,\r\n        image: args.image,\r\n        size: new Gamelab.Vector(args.frameSize)\r\n      };\r\n    }\r\n  }\r\n\r\n  Layer(l) {\r\n    this.layer = l;\r\n    return this;\r\n  }\r\n\r\n  Size(x, y, z) {\r\n    this.size = new Gamelab.Vector(x, y, z);\r\n    if (this.selected_animation && this.selected_animation.frames instanceof Array) {\r\n      this.selected_animation.Size(vector);\r\n    }\r\n    return this.size;\r\n  }\r\n\r\n  static_image_load(img) {\r\n    this.size = new Gamelab.Vector(img.width * this.scale, img.height * this.scale).round();\r\n  }\r\n\r\n  pushColorEffectCanvas(color) {\r\n    this.effectCanvasList = this.effectCanvasList || [];\r\n\r\n    var canvas = document.createElement('CANVAS');\r\n    var img = this.image.domElement;\r\n\r\n    canvas.width = img.width;\r\n    canvas.height = img.height;\r\n\r\n    var ctx = canvas.getContext('2d');\r\n    ctx.drawImage(img, 0, 0, img.width, img.height);\r\n    ctx.fillStyle = color;\r\n    ctx.globalAlpha = 0.67;\r\n    ctx.globalCompositeOperation = \"source-atop\";\r\n    ctx.fillRect(0, 0, img.width, img.height);\r\n    ctx.globalCompositeOperation = \"source-over\";\r\n\r\n    this.effectCanvasList.push(canvas);\r\n\r\n    return this;\r\n  }\r\n\r\n  GlobalComposite(g) {\r\n    this.globalCompositeOperation = g;\r\n    return this;\r\n  }\r\n\r\n  ColorEffect(color, opacity=0.666) {\r\n    this.clearEffects();\r\n    this.effectCanvas = this.effectCanvas || document.createElement('CANVAS');\r\n\r\n    var img = this.image.domElement;\r\n    this.effectCanvas.width = img.width;\r\n    this.effectCanvas.height = img.height;\r\n\r\n    this.effectCtx = this.effectCtx || this.effectCanvas.getContext('2d');\r\n    this.effectCtx.drawImage(img, 0, 0, img.width * this.scale, img.height * this.scale);\r\n\r\n    this.effectCtx.fillStyle = color;\r\n    this.effectCtx.globalAlpha = opacity;\r\n    this.effectCtx.globalCompositeOperation = \"source-atop\";\r\n    this.effectCtx.fillRect(0, 0, img.width, img.height);\r\n    this.effectCtx.globalCompositeOperation = \"source-over\";\r\n    this.data = this.effectCtx.getImageData(0, 0, this.effectCanvas.width, this.effectCanvas.height);\r\n    return this;\r\n  }\r\n\r\n  DrawToCanvas() {\r\n    this.clearEffects();\r\n    this.effectCanvas = this.effectCanvas || document.createElement('CANVAS');\r\n    var img = this.image.domElement;\r\n    this.effectCanvas.width = img.width;\r\n    this.effectCanvas.height = img.height;\r\n    this.effectCtx = this.effectCtx || this.effectCanvas.getContext('2d');\r\n    this.effectCtx.drawImage(img, 0, 0, img.width, img.height);\r\n    this.image.domElement = this.effectCanvas;\r\n    return this;\r\n  }\r\n\r\n  doCanvasEffects() {\r\n\r\n    if(!this.stored)\r\n    {\r\n      this.clearEffects();\r\n    }\r\n\r\n    this.effectCanvas = this.effectCanvas || document.createElement('CANVAS');\r\n    this.effectCanvasList = this.effectCanvasList || [];\r\n\r\n    var img = this.image.domElement;\r\n\r\n    this.img = img;\r\n    this.effectCanvas.width = img.width;\r\n    this.effectCanvas.height = img.height;\r\n    this.effectCtx = this.effectCtx || this.effectCanvas.getContext('2d');\r\n    this.effectCtx.drawImage(img, 0, 0, img.width, img.height);\r\n\r\n    this.data = this.effectCtx.getImageData(0, 0, this.effectCanvas.width, this.effectCanvas.height);\r\n    this.effectCanvasList.push(this.effectCanvas);\r\n\r\n    this.stored = true;\r\n    this.effectFrames = [];\r\n  }\r\n\r\n  resetEffectFrames(){\r\n    this.effectFrames = [];\r\n    return this;\r\n  }\r\n\r\n  addFilterFrame(api, callback) {\r\n\r\n    this.effectCanvasList = this.effectCanvasList || [];\r\n    this.effectFrames = this.effectFrames || [];\r\n    this.effectCanvasTimer =  0;\r\n\r\n    if(api.timer == 0)\r\n    {\r\n  //    alert('doing effects');\r\n      this.doCanvasEffects();\r\n    }\r\n\r\n    var data = this.effectCtx.getImageData(0, 0, this.effectCanvas.width, this.effectCanvas.height);\r\n    api.next(data);\r\n    this.effectFrames.push(data);\r\n//    console.log('added effect data');\r\n  }\r\n\r\n  DoubleBackFilterFrames(){\r\n    this.effectFrames = this.effectFrames.concat(this.effectFrames.slice().reverse());\r\n    return;\r\n  }\r\n\r\n  addImageFrame(image, callback) {\r\n    this.effectCanvasTimer =  0;\r\n    this.effectCanvas.width = this.size.x;\r\n    this.effectCanvas.height = this.size.y;\r\n    this.effectCtx.drawImage(image, 0, 0, this.size.x, this.size.y);\r\n    var data = this.effectCtx.getImageData(0, 0, this.effectCanvas.width, this.effectCanvas.height);\r\n    console.info('effect', data);\r\n    this.effectFrames.push(data);\r\n    console.log('added effect data');\r\n  }\r\n\r\n  clearEffects() {\r\n    if (this.effectCanvas && this.effectCtx)\r\n      this.effectCtx.clearRect(0, 0, this.effectCanvas.width, this.effectCanvas.height);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * runs a function for the onload event of this sprite's image\r\n   *\r\n   * @function\r\n   * @param {Function} f the function to be called on load\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  onLoad(f) {\r\n\r\n    if (this.src instanceof HTMLCanvasElement) {\r\n      var f = f || function() {};\r\n      f.bind(this).call(false);\r\n    }\r\n\r\n    if (this.image && this.image.domElement) {\r\n      var img = this.image.domElement,\r\n        load = img.onload;\r\n      f = f || function() {};\r\n      f.bind(this);\r\n      this.load_call = f;\r\n      var $sprite = this;\r\n      img.onload = function() {\r\n\r\n        $sprite.load_total += 1;\r\n\r\n        load.bind($sprite).call(false, $sprite);\r\n        //  $sprite.static_image_load(img);\r\n        $sprite.load_call(false, $sprite);\r\n      };\r\n\r\n      img.onerror = function(err) {\r\n        $sprite.load_call(true, $sprite);\r\n      }\r\n    }\r\n    else if(this.anime && this.anime.frames instanceof Array)\r\n    {\r\n            this.load_call = f;\r\n            f.bind(this).call();\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  Opacity(o) {\r\n\r\n    this.opacity = o;\r\n    return this;\r\n  }\r\n\r\n\r\n  /**********\r\n   * @ignore\r\n   **********/\r\n\r\n  apply_args(args = {}) {\r\n\r\n    this.FromData(args, true); //Using a FUNCTIONAL COPY --heavy to process\r\n\r\n    function array_instance(list) {\r\n      return list.slice(0);\r\n    };\r\n\r\n    if (args.image instanceof Gamelab.GameImage && !this.image) {\r\n      this.image = args.image;\r\n    }\r\n\r\n    if(typeof args.name == 'string')\r\n    this.name = args.name;\r\n\r\n    //life is either provided or assumed to be approx 4 seconds\r\n    this.life = args.life || 4000 / 50;\r\n\r\n    this.description = args.description || \"__spriteDesc\";\r\n\r\n    this.opacity = args.opacity || 1.0;\r\n\r\n    this.color = args.color || '#ffffff';\r\n\r\n\r\n    /**\r\n     * @property {String} id the unique identifier of the Sprite --called automatically on constructor.\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n    this.id = this.create_id();\r\n\r\n\r\n    /**\r\n     * @property {Array} animations the array of animations attached to the Sprite\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n    var listnames = ['animations', 'bones', 'meshes', 'scripts', 'events', 'sounds'];\r\n\r\n    var $object = this;\r\n\r\n    listnames.forEach(function(ln) {\r\n\r\n      $object[ln] = array_instance(Gamelab.getArg(args, ln, []));\r\n\r\n    });\r\n\r\n\r\n    /**\r\n     * @property {Array} scripts the array of scripts attached to the Sprite\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n    this.motions = Gamelab.getArg(args, 'motions', []);\r\n    this.particles = Gamelab.getArg(args, 'particles', []);\r\n    this.shots = Gamelab.getArg(args, 'shots', []);\r\n    this.init_ext = Gamelab.getArg(args, 'init_ext', []);\r\n    this.group = Gamelab.getArg(args, 'group', 'one');\r\n    this.scrollFactor = args.scrollFactor || 1.0;\r\n    this.noScroll = args.noScroll || false;\r\n\r\n    if (this.noScroll) {\r\n      this.scrollFactor = 0;\r\n    }\r\n\r\n\r\n    /**\r\n     * @property {Vector} speed the speed of the Sprite\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n    this.speed = new Gamelab.Vector(Gamelab.getArg(args, 'speed', new Gamelab.Vector(0, 0)));\r\n\r\n    /**\r\n     * @property {Vector} size the vector-size of the Sprite\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n    this.size = new Gamelab.Vector(Gamelab.getArg(args, 'size', new Gamelab.Vector(0, 0)));\r\n\r\n\r\n    /**\r\n     * @property {Vector} position the position of the Sprite\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n    this.position = new Gamelab.Vector(Gamelab.getArg(args, 'position', new Gamelab.Vector(0, 0, 0)));\r\n    this.realPosition = new Gamelab.Vector(Gamelab.getArg(args, 'realPosition', new Gamelab.Vector(0, 0, 0)));\r\n    this.collision_bounds = Gamelab.getArg(args, 'collision_bounds', new Gamelab.VectorBounds(new Gamelab.Vector(0, 0, 0), new Gamelab.Vector(0, 0, 0)));\r\n\r\n\r\n    this.GROUNDED = false;\r\n\r\n    /**\r\n     *\r\n     *\r\n     * @property {Vector} rotation the rotation of the Sprite\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n    this.rotation = new Gamelab.Vector(Gamelab.getArg(args, 'rotation', new Gamelab.Vector(0, 0, 0)));\r\n\r\n\r\n    /**\r\n     * @property {number} scale the scale of the Sprite, controls draw-size\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n    this.scale = args.scale || 1.0;\r\n    this.acceleration = Gamelab.getArg(args, 'acceleration', new Gamelab.Vector(0, 0, 0));\r\n    this.rot_speed = new Gamelab.Vector(Gamelab.getArg(args, 'rot_speed', new Gamelab.Vector(0, 0)));\r\n    this.rot_accel = new Gamelab.Vector(Gamelab.getArg(args, 'rot_accel', new Gamelab.Vector(0, 0)));\r\n    this.padding = Gamelab.getArg(args, 'padding', new Gamelab.Vector(0, 0, 0));\r\n\r\n\r\n    var __inst = this;\r\n\r\n    //Apply / instantiate Sound(), Gamelab.Motion(), and Gamelab.Animation() args...\r\n\r\n\r\n    Gamelab.each(this.shots, function(ix, item) {\r\n      __inst.shots[ix] = new Gamelab.Shot(item);\r\n    });\r\n\r\n    Gamelab.each(this.sounds, function(ix, item) {\r\n      __inst.sounds[ix] = new Gamelab.Sound(item);\r\n    });\r\n\r\n    Gamelab.each(this.motions, function(ix, item) {\r\n      __inst.motions[ix] = new Gamelab.TweenMotion(item);\r\n    });\r\n\r\n    Gamelab.each(this.animations, function(ix, item) {\r\n      __inst.animations[ix] = new Gamelab.Animation(item);\r\n    });\r\n\r\n    Gamelab.each(this.particles, function(ix, item) {\r\n      __inst.particles[ix] = new Gamelab.GSProton(item);\r\n    });\r\n\r\n    //Apply initializers:\r\n\r\n    Gamelab.each(this.init_ext, function(ix, item) {\r\n      __inst.addInitializer(item);\r\n    });\r\n\r\n    if (!this.selected_animation && args.selected_animation) {\r\n\r\n      //console.dev('applying animation:' + jstr(args.selected_animation));\r\n      this.selected_animation = new Gamelab.Animation(args.selected_animation);\r\n\r\n      this.animations = [];\r\n      if (this.animations.indexOf(this.selected_animation) == -1)\r\n        this.animations.push(this.selected_animation);\r\n    }\r\n  }\r\n\r\n  RealPosition() {\r\n    return this.realPosition;\r\n  }\r\n\r\n  Origin(x, y) {\r\n    this.origin = new Gamelab.Vector(x, y);\r\n    var sprite = this;\r\n    this.animations.forEach(function($anime) {\r\n      $anime.Origin(sprite.origin);\r\n    });\r\n  }\r\n\r\n\r\n  /**\r\n   * Clones a sprite from existing data\r\n   *\r\n   * @function\r\n   * @param {Object} object the data to be cloned\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  Clone(sprite) {\r\n    console.log('using Clone() function');\r\n    var clone = new Gamelab.Sprite(sprite.src);\r\n    clone.Anime(new Gamelab.Animation(sprite.anime));\r\n    clone.apply_args(sprite);\r\n    return clone;\r\n  }\r\n\r\n  draw(ctx, camera) {\r\n\r\n    var sprite;\r\n\r\n    if (this.constructor.name == 'SpriteBrush') {\r\n      sprite = this.selected_sprite;\r\n    } else {\r\n      sprite = this;\r\n    }\r\n\r\n    camera = camera || false;\r\n\r\n    if (!camera && Gamelab.game_windows[0] && Gamelab.game_windows[0].camera)\r\n      camera = Gamelab.game_windows[0].camera;\r\n\r\n    else if (!camera) {\r\n      camera = {\r\n        position: new Gamelab.Vector(0, 0, 0)\r\n      };\r\n    }\r\n\r\n    if (sprite.invisible)\r\n      return;\r\n\r\n    if (sprite.active && (this.DRAWOFFSCREEN || sprite.onScreen(Gamelab.WIDTH, Gamelab.HEIGHT))) {\r\n      this.draw_current_frame(ctx, camera);\r\n    }\r\n  }\r\n\r\n  setSoleUpdate(callback) {\r\n    this.update = function() {\r\n      callback.bind(this).call();\r\n    };\r\n  }\r\n\r\n  onCollision(object, callback) {\r\n    this.onUpdate(function() {\r\n      var collisions = Gamelab.Collision.spriteCollideArray([this], object);\r\n      collisions.forEach(function(c) {\r\n        callback(c.object, c.collider);\r\n      });\r\n    });\r\n  }\r\n\r\n  onListCollision(object, callback) {\r\n    this.onUpdate(function() {\r\n      callback(Gamelab.Collision.spriteCollideArray([this], object));\r\n    });\r\n  }\r\n\r\n  draw_current_frame(ctx, camera) {\r\n\r\n    var sprite;\r\n\r\n    if (this.constructor.name == 'SpriteBrush') {\r\n      sprite = this.selected_sprite;\r\n    } else {\r\n      sprite = this;\r\n    }\r\n\r\n    var frame = false,\r\n      frameList = [];\r\n\r\n    if (this.effectCanvas) {\r\n      this.size = new Gamelab.Vector(this.effectCanvas.width * this.scale, this.effectCanvas.height * this.scale),\r\n      this.origin = this.size.div(2.0);\r\n\r\n      console.log('drawing effect canvas');\r\n\r\n    return  Gamelab.Canvas.draw_image_frame(this.effectCanvas, new Gamelab.Vector(0, 0), this.size, new Gamelab.Vector2D(Math.round(this.position.x + (this.origin.x)), Math.round(this.position.y + (this.origin.y))), this.size, this.rotation.x, ctx, this.flipX, this.flipY, this.origin, this.opacity, this.globalCompositeOperation || false);\r\n    }\r\n\r\n    if (sprite.active) {\r\n\r\n      if (sprite.selected_animation instanceof Array && sprite.selected_animation.length >= 1) {\r\n        sprite.selected_animation.forEach(function(anime) {\r\n          frameList.push(anime.selected_frame);\r\n        });\r\n      }\r\n\r\n      if (sprite.selected_animation instanceof Object && sprite.selected_animation.hasOwnProperty('selected_frame')) {\r\n        frame = sprite.selected_animation.selected_frame;\r\n      }\r\n\r\n      var p = sprite.position;\r\n\r\n      var camera_pos = camera.position || {\r\n        x: 0,\r\n        y: 0,\r\n        z: 0\r\n      };\r\n\r\n      if (!sprite.hasOwnProperty('scrollFactor')) {\r\n        sprite.scrollFactor = 1.0;\r\n      }\r\n\r\n      var x = p.x,\r\n        y = p.y,\r\n        scrollFactor = sprite.scrollFactor >= -1.0 && sprite.scrollFactor <= 1.0 ? sprite.scrollFactor : 1.0;\r\n\r\n      if (sprite.noScroll) {\r\n        scrollFactor = 0;\r\n      }\r\n\r\n\r\n      //optional animation : gameSize\r\n\r\n      var targetSize = sprite.size || sprite.selected_animation.size;\r\n\r\n      var realWidth = targetSize.x;\r\n      var realHeight = targetSize.y;\r\n\r\n\r\n      var origin = sprite.origin || new Gamelab.Vector(realWidth / 2, realHeight / 2);\r\n\r\n      //optional animation : offset\r\n\r\n      var rotation;\r\n\r\n      if (typeof(sprite.rotation) == 'object') {\r\n        rotation = sprite.rotation.x;\r\n\r\n      } else {\r\n        rotation = sprite.rotation;\r\n      }\r\n\r\n\r\n      if (this.image && this.image.domElement instanceof HTMLCanvasElement) {\r\n        var x = this.position.x,\r\n          y = this.position.y;\r\n\r\n        x -= camera_pos.x * scrollFactor || 0;\r\n        y -= camera_pos.y * scrollFactor || 0;\r\n        //  console.log('sprite:: canvas draw!! ');\r\n        return Gamelab.Canvas.draw_image_frame(this.image.domElement, new Gamelab.Vector(0, 0), this.size, new Gamelab.Vector2D(Math.round(x + (origin.x)), Math.round(y + (origin.y))), new Gamelab.Vector2D(realWidth, realHeight), rotation % 360, ctx, sprite.flipX, sprite.flipY, origin, this.opacity, this.globalCompositeOperation || false);\r\n      }\r\n\r\n\r\n      if (!(sprite.selected_animation && sprite.selected_animation.selected_frame)) {\r\n        return;\r\n      }\r\n\r\n      var frame = sprite.selected_animation.selected_frame;\r\n\r\n      if (frame && frame.image && frame.image.data) {\r\n\r\n        ctx.putImageData(frame.image.data, x, y, 0, 0, sprite.size.x, sprite.size.y);\r\n\r\n      } else {\r\n\r\n        if (frameList.length >= 1) {\r\n\r\n          frameList.forEach(function(frame) {\r\n\r\n            var realWidth = frame.size.x;\r\n            var realHeight = frame.size.y;\r\n\r\n            var xpos = frame.position.x,\r\n              ypos = frame.position.y;\r\n\r\n            x += sprite.position.x;\r\n            y += sprite.position.y;\r\n\r\n            x -= camera_pos.x * scrollFactor || 0;\r\n            y -= camera_pos.y * scrollFactor || 0;\r\n\r\n            sprite.realPosition = new Gamelab.Vector(x, y);\r\n\r\n            if (frame.rotation && typeof frame.rotation.x == 'number') {\r\n              rotation = frame.rotation.x;\r\n            }\r\n\r\n            if (frame.origin) {\r\n              origin = frame.origin;\r\n              //console.log('drawing with origin:' + origin.x + ':' + origin.y);\r\n            }\r\n\r\n\r\n            if (frame && frame.image)\r\n              Gamelab.Canvas.draw_image_frame(sprite.effectCanvas ? sprite.effectCanvas : frame.image.domElement, frame.framePos, frame.frameSize, new Gamelab.Vector2D(Math.round(xpos + (origin.x)), Math.round(ypos + (origin.y))), new Gamelab.Vector2D(realWidth, realHeight), rotation % 360, ctx, sprite.flipX, sprite.flipY, origin, this.opacity, this.globalCompositeOperation || false);\r\n\r\n          });\r\n\r\n        } else {\r\n          var fx = frame.position.x,\r\n            fy = frame.position.y,\r\n            pos = new Gamelab.Vector(x + fx, y + fy);\r\n\r\n          pos.x -= camera_pos.x * scrollFactor || 0;\r\n          pos.y -= camera_pos.y * scrollFactor || 0;\r\n          sprite.realPosition = pos;\r\n          if (frame.image.domElement instanceof HTMLImageElement || frame.image.domElement instanceof HTMLCanvasElement) {\r\n            Gamelab.Canvas.draw_image_frame(this.effectCanvas ? this.effectCanvas : frame.image.domElement, frame.framePos, frame.frameSize, new Gamelab.Vector2D(Math.round(pos.x + (origin.x)), Math.round(pos.y + (origin.y))), new Gamelab.Vector2D(realWidth, realHeight), rotation % 360, ctx, sprite.flipX, sprite.flipY, origin, this.opacity, this.globalCompositeOperation || false);\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * adds an animation to the sprites\r\n   *\r\n   * @function\r\n   * @param {Object} object the animation to be added\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n\r\n  Add(object) {\r\n\r\n    if (object instanceof Gamelab.Animation) {\r\n      this.animations.add(object);\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  get animation() {\r\n    return this.selected_animation;\r\n  }\r\n\r\n  get anime() {\r\n    return this.selected_animation;\r\n  }\r\n\r\n  Anime(anime) {\r\n    if (anime)\r\n      this.selected_animation = anime;\r\n    return this;\r\n  }\r\n\r\n\r\n  Animation(anime) {\r\n    if (anime)\r\n      this.selected_animation = anime;\r\n    return this;\r\n  }\r\n\r\n\r\n  FromData(data = {}, fxlCopy = false) {\r\n    for (var x in data) {\r\n      if (fxlCopy || typeof(data[x]) !== 'function')\r\n        this[x] = data[x];\r\n    }\r\n\r\n    if(data.update)\r\n    {\r\n      this.update=  data.update;\r\n    }\r\n    return this;\r\n  }\r\n\r\n  FromSourceImage(src) {\r\n    return new this.constructor(src);\r\n  }\r\n\r\n  /**************************************************************\r\n   * scales the sprite.size property according to image-size.\r\n   * @param {number} scaleFloat a 0-1+ value\r\n   *\r\n   * @function\r\n   * @memberof Sprite\r\n   **************************************************************/\r\n\r\n  Scale(scaleFloat, frameSize = {}) {\r\n\r\n    this.scale = scaleFloat;\r\n\r\n    if (this.anime && this.anime.frameSize && this.anime.frameSize.above_zero_xy()) {\r\n      frameSize = this.anime.frameSize;\r\n    }\r\n\r\n    var size_x = frameSize.x || this.image.domElement.width,\r\n      size_y = frameSize.y || this.image.domElement.height;\r\n\r\n    var size = new Gamelab.Vector(size_x * scaleFloat, size_y * scaleFloat);\r\n\r\n\r\n    if (!this.size || isNaN(this.size.x) || isNaN(this.size.y))\r\n      this.size = new Gamelab.Vector(0, 0);\r\n\r\n\r\n\r\n    var diffpos = size.sub(this.size).half();\r\n\r\n    this.position.x -= diffpos.x;\r\n    this.position.y -= diffpos.y;\r\n    this.size = size;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**************************************************************\r\n   * applies a float value arg to Sprite.scrollFactor\r\n   * @param {number} s a 0-1+ value\r\n   *\r\n   * @function\r\n   * @memberof Sprite\r\n   **************************************************************/\r\n\r\n\r\n  ScrollFactor(s) {\r\n    this.scrollFactor = s;\r\n    return this;\r\n  }\r\n\r\n  engage(obj) //engages an object having an engage function\r\n  {\r\n    obj.parent = this;\r\n    if (obj.engage) {\r\n      obj.engage();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * pass argument v to the sprite.life property.\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {number} v number of render-updates that this Sprite will last. --update occurs 60+ times per second, or less, depending on performance\r\n   * @returns {Sprite} the sprite object --enables chainable function calls\r\n   **********/\r\n\r\n  Life(v) {\r\n    this.life = v;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * initializes sprites. triggers all functions previously passed to the addInitializer function.\r\n   * Use this function when a sprite, instantiated from json-data, carries initializers.\r\n   * --This feature is built for the purpose of data-persistence. --sprites from json-file may carry behaviors onto the scene.\r\n   *\r\n   * @function\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  init() {\r\n\r\n\r\n  }\r\n\r\n  /**\r\n   * extends the init function.\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {function} fun the function to be passed into the init function of the sprite\r\n   **********/\r\n\r\n  addInitializer(fun) {\r\n    let boundFun = fun.bind(this)\r\n    if (this.init_ext.indexOf(boundFun) < 0) {\r\n      this.init_ext.push(boundFun)\r\n    };\r\n  }\r\n\r\n  /*****************************\r\n   * Getters\r\n   ***************************/\r\n\r\n  /**\r\n   * returns the 'id' property of the sprite\r\n   * @function\r\n   * @memberof Sprite\r\n   * @returns {string}\r\n   **********/\r\n\r\n  get_id() {\r\n    return this.id;\r\n  }\r\n\r\n  /**********\r\n   * @ignore\r\n   **********/\r\n\r\n  to_map_object(size, framesize) {\r\n\r\n    this.__mapSize = new Gamelab.Vector(size || this.size);\r\n\r\n    this.frameSize = new Gamelab.Vector(framesize || this.size);\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n  /*****************************\r\n   * Setters and Creators\r\n   ***************************/\r\n\r\n  /**\r\n   * creates a unique string id property for the sprite.\r\n   * @function\r\n   * @memberof Sprite\r\n   * @returns {string}\r\n   **********/\r\n\r\n  create_id() {\r\n\r\n    return Gamelab.create_id();\r\n\r\n  }\r\n\r\n  /**\r\n   * returns a maximum scaled size, according to max dimensions of width and height\r\n   * @param {number} mx the maximum size.x for the returned size\r\n   * @param {number} my the maximum size.y for the returned size\r\n   * @function\r\n   * @memberof Sprite\r\n   * @returns {Vector} a vector of x,y,z? values\r\n   **********/\r\n\r\n  getSizeByMax(mx, my) {\r\n\r\n    var size = new Gamelab.Vector(this.size);\r\n    var wth = size.y / size.x;\r\n    var htw = size.x / size.y;\r\n\r\n    if (size.x > mx) {\r\n      size.x = mx;\r\n      size.y = size.x * wth;\r\n    }\r\n\r\n    if (size.y > my) {\r\n      size.y = my;\r\n      size.x = size.y * htw;\r\n    }\r\n\r\n    return size;\r\n  }\r\n\r\n  /*****************************\r\n   *  assert the existence of a speed{} property\r\n   *  sprite.speed (vector) is created if not existing in sprite\r\n   *  @memberof Sprite\r\n   ***************************/\r\n\r\n  assertSpeed() {\r\n    if (!this.speed) {\r\n      this.speed = new Gamelab.Vector(0, 0, 0);\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * set the 'selected_animation' property to a single-frame-animation\r\n   * @function\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  SingleFrame() {\r\n\r\n    if (!this.image || !this.image.domElement) {\r\n      return this;\r\n    }\r\n\r\n    var __inst = this,\r\n      load = this.image.domElement.onload || function() {};\r\n\r\n    if (this.size && this.size.x !== 0 && this.size.y !== 0)\r\n      return;\r\n\r\n    var _obj = this;\r\n\r\n    if (this.image.domElement instanceof HTMLCanvasElement) {\r\n      if (_obj.size && _obj.size.x !== 0 && _obj.size.y !== 0) {\r\n\r\n      } else {\r\n        __inst.size = new Gamelab.Vector(__inst.image.domElement.width, __inst.image.domElement.height);\r\n        __inst.selected_animation = new Gamelab.Animation(this.image.domElement).FrameSize(__inst.size);\r\n        __inst.animations = [];\r\n        __inst.animations.push(__inst.selected_animation);\r\n        __inst.Scale(__inst.scale || 1.0);\r\n      }\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    this.image.domElement.onload = function() {\r\n\r\n      load(false, __inst);\r\n\r\n      if (_obj.size && _obj.size.x !== 0 && _obj.size.y !== 0) {\r\n\r\n      } else {\r\n        __inst.size = new Gamelab.Vector(__inst.image.domElement.width, __inst.image.domElement.height);\r\n        __inst.selected_animation = new Gamelab.Animation(__inst.image).FrameSize(__inst.size);\r\n        __inst.animations = [];\r\n        __inst.animations.push(__inst.selected_animation);\r\n        __inst.Scale(__inst.scale || 1.0);\r\n      }\r\n\r\n    };\r\n\r\n    Gamelab.log('set single-frame animation');\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n\r\n  /**\r\n   * set the 'life' property to a specified integer\r\n   * @function\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  LifeSpan(value) {\r\n    this.life = value;\r\n  }\r\n\r\n  /**\r\n   * set the 'life' property to a specified integer\r\n   * @function\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  Life(value) //same as LifeSpan\r\n  {\r\n    this.life = value;\r\n  }\r\n\r\n  /**\r\n   * tells if sprite has been taken out of game\r\n   * @function\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  isDead(gw) {\r\n    gw = gw || Gamelab.game_windows[0];\r\n    return this.hasOwnProperty('life') && this.life <= 0;\r\n  }\r\n\r\n  /**\r\n   * sets life to 0, then ending the sprite\r\n   * @function\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  die(gw) {\r\n    this.life = 0;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * indicates if any portion of the sprite is within screen bounds --uses Gamelab.WIDTH, Gamelab.HEIGHT OR any w,h arguments passed to this method\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {number} w optional screen-width argument, defaults to Gamelab.WIDTH\r\n   * @param {number} h optional screen-height argument, defaults to Gamelab.HEIGHT\r\n   * @returns {boolean} a true or false value to show if any part of the sprite is on-screen\r\n   **********/\r\n\r\n  onScreen(w, h, gw) {\r\n\r\n    w = w || Gamelab.WIDTH;\r\n    h = h || Gamelab.HEIGHT;\r\n    gw = gw || Gamelab.game_windows[0];\r\n\r\n    var camera = gw && gw.camera ? gw.camera : Gamelab && Gamelab.camera ? Gamelab.camera : {\r\n        position: new Gamelab.Vector(0, 0, 0)\r\n      },\r\n      scrollFactor = this.noScroll ? 0 : this.scrollFactor;\r\n\r\n    var sprite = this,\r\n      p = sprite.position,\r\n      camera_pos = camera.position || {\r\n        x: 0,\r\n        y: 0,\r\n        z: 0\r\n      };\r\n\r\n    if (!sprite.hasOwnProperty('scrollFactor')) {\r\n      sprite.scrollFactor = 1.0;\r\n    }\r\n\r\n    var x = p.x,\r\n      y = p.y,\r\n      scrollFactor = sprite.scrollFactor >= -1.0 && sprite.scrollFactor <= 1.0 ? sprite.scrollFactor : 1.0;\r\n\r\n    if (sprite.noScroll) {\r\n      scrollFactor = 0;\r\n    }\r\n\r\n    x -= camera_pos.x * scrollFactor || 0;\r\n    y -= camera_pos.y * scrollFactor || 0;\r\n\r\n    return x + sprite.size.x > -1000 - w && x < w + 1000 &&\r\n      y + sprite.size.y > 0 - 1000 - h && y < h + 1000;\r\n  }\r\n\r\n  /*****************************\r\n   * Updates\r\n   ***************************/\r\n\r\n  /*****************************\r\n   * update()\r\n   * -starts empty:: is applied recursively by Gamelab.js as the main sprite-update\r\n   ***************************/\r\n\r\n  /**\r\n   * the main update for the sprite --applied recursively by GameWindow\r\n   * @function\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  update(sprite) {}\r\n\r\n\r\n  updateBySpeed() {\r\n    this.position.x += this.speed.x;\r\n    this.position.y += this.speed.y;\r\n  }\r\n\r\n  /*****************************\r\n   *  onUpdate(fun)\r\n   * -args: 1 function(sprite){ } //the self-instance/sprite is passed into the function()\r\n   * -overrides and maintains existing code for update(){} function\r\n   ***************************/\r\n\r\n\r\n  /**\r\n   * extends the update of this sprite with a new function to be called during the update\r\n   * --repeated calls will extend, (not replace) the update --Allows multiple extensions of the update\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {function} fun the function to be appended to sprite.update\r\n   *\r\n   *  * @example\r\n   * // extend the behavior of your sprite\r\n   * mySprite.onUpdate(function(spr)\r\n   *\r\n   *                    console.log('extended update'); //runs automatically whenever sprite.update runs\r\n   *\r\n   *                   });\r\n   *\r\n   **********/\r\n\r\n\r\n  onUpdate(fun) {\r\n\r\n    fun = fun.bind(this);\r\n\r\n    let update = this.update.bind(this);\r\n\r\n    let __inst = this;\r\n\r\n    this.update = function(__inst) {\r\n\r\n      update(__inst);\r\n\r\n      fun(__inst);\r\n\r\n    };\r\n  }\r\n\r\n  /*****************************\r\n   *  travelLineTwoWay()\r\n   *  -sprite travels line: any Line() or object with property of line\r\n   ***************************/\r\n\r\n  /********************************************************************************\r\n   * sprite travels on a line in a back-and-forth motion --to the end of the line, and back.\r\n   * #Dev-todo:MORE ON THIS\r\n   * @function\r\n   * @memberof Sprite\r\n   *********************************************************************************/\r\n\r\n  travelLineTwoWay(lineObject, speed, curveKey, offset) {\r\n\r\n    speed = speed || 1;\r\n\r\n    var motionCurveOptions = [\"linear\", \"quadratic\", \"cubic\"];\r\n    curveKey = curveKey || \"linear\";\r\n    var line = lineObject;\r\n\r\n    if (lineObject.line) {\r\n      line = lineObject.line;\r\n    }\r\n\r\n    this.__crtLineIx = this.__crtLineIx || 0;\r\n\r\n    var __inst = this,\r\n      pctFloat = __inst.__crtLineIx % ((line.points.length - 1) / 2) / ((line.points.length - 1) / 2);\r\n\r\n    if (__inst.__crtLineIx >= ((line.points.length - 1) / 2)) {\r\n      pctFloat = 1.0 - pctFloat;\r\n    }\r\n\r\n    var ixChange = Gamelab.Curves.InOut[curveKey](pctFloat) * speed * 0.5;\r\n\r\n    if (curveKey == 'linear') {\r\n      ixChange = speed;\r\n    }\r\n\r\n    ixChange = Math.ceil(ixChange);\r\n\r\n    if (ixChange < 1) {\r\n      ixChange = 1;\r\n    }\r\n\r\n    __inst.position = new Gamelab.Vector(line.points[__inst.__crtLineIx]);\r\n\r\n    //console.log(ixChange);\r\n\r\n    __inst.__crtLineIx += ixChange;\r\n\r\n    if (__inst.__crtLineIx >= line.points.length) {\r\n      line.points = line.points.reverse();\r\n      __inst.__crtLineIx = 0;\r\n    }\r\n\r\n    if (offset instanceof Gamelab.Vector) {\r\n      this.position = this.position.add(offset);\r\n    }\r\n  }\r\n\r\n\r\n  /*****************************\r\n   *  travelLineOnLoop()\r\n   *  -sprite travels line: any Line() or object with property of line\r\n   ***************************/\r\n\r\n  /**\r\n   * the sprite travels one line in a looping motion --useful for traveling Square, Circle, or other enclosed Lines.\r\n   * #Dev-todo:MORE ON THIS\r\n   * @function\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  travelLineOnLoop(lineObject, speed, curveKey, offset) {\r\n\r\n    speed = speed || 1;\r\n\r\n    var motionCurveOptions = [\"linear\", \"quadratic\", \"cubic\"];\r\n\r\n    curveKey = curveKey || \"linear\";\r\n\r\n    var line = lineObject;\r\n\r\n    if (lineObject.line) {\r\n      line = lineObject.line;\r\n    }\r\n\r\n    this.__crtLineIx = this.__crtLineIx || 0;\r\n\r\n    var __inst = this,\r\n\r\n      pctFloat = __inst.__crtLineIx % ((line.points.length - 1) / 2) / ((line.points.length - 1) / 2);\r\n\r\n    if (__inst.__crtLineIx >= ((line.points.length - 1) / 2)) {\r\n      pctFloat = 1.0 - pctFloat;\r\n\r\n    }\r\n\r\n    var ixChange = Gamelab.Curves.InOut[curveKey](pctFloat) * speed * 0.5;\r\n\r\n    if (curveKey == 'linear') {\r\n      ixChange = speed;\r\n    }\r\n\r\n    ixChange = Math.ceil(ixChange);\r\n\r\n    if (ixChange < 1) {\r\n      ixChange = 1;\r\n    }\r\n\r\n    __inst.position = new Gamelab.Vector(line.points[__inst.__crtLineIx]);\r\n\r\n    // console.log(ixChange);\r\n\r\n    __inst.__crtLineIx += ixChange;\r\n\r\n    if (__inst.__crtLineIx >= line.points.length) {\r\n      __inst.__crtLineIx = 0;\r\n    }\r\n\r\n    if (offset instanceof Gamelab.Vector) {\r\n      this.position = this.position.add(offset);\r\n    }\r\n  }\r\n\r\n  /*****************************\r\n   *  shoot(sprite)\r\n   *  -fire a shot from the sprite:: as in a firing gun or spaceship\r\n   *  -takes options{} for number of shots anglePerShot etc...\r\n   *  -TODO: complete and test this code\r\n   ***************************/\r\n\r\n\r\n  /**\r\n   * fire a Shot, or bullet-Sprite from the Sprite\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Object} options an object of arguments\r\n   * @param {Gamelab.Animation} animation the animation to fire from the Sprite\r\n   * @param {number} speed the speed of the shot that is projected\r\n   * @param {Gamelab.Vector} position the initial position of the shot: defaults to current Sprite position\r\n   * @param {Gamelab.Vector} size the Vector size of the shot\r\n   * @param {Gamelab.Vector} rot_offset the rotational offset to apply: controls direction of the shot\r\n   **********/\r\n\r\n  shoot(options, gw) {\r\n    //character shoots an animation\r\n    gw = gw || Gamelab.game_windows[0];\r\n    this.prep_key = 'shoot';\r\n\r\n    let animation = options.bullet || options.animation || options.anime || new Gamelab.Animation();\r\n    let speed = options.speed || options.velocity || 1;\r\n\r\n\r\n    let size = options.size || new Gamelab.Vector(10, 10, 0);\r\n    let position = new Gamelab.Vector(options.position) || new Gamelab.Vector(this.position);\r\n\r\n\r\n    let rot_offset = options.rot_offset || options.rotation || 0;\r\n    let total = options.total || 1;\r\n    let rot_disp = options.rot_disp || 0; //the full rotational-dispersion of the bullets\r\n\r\n    let life = options.life || 900;\r\n    let shots = [];\r\n    for (var x = 0; x < total; x++) {\r\n\r\n      var __playerInst = this;\r\n      if (Gamelab.isAtPlay) {\r\n        var bx = position.x,\r\n          by = position.y,\r\n          bw = size.x,\r\n          bh = size.y;\r\n\r\n        var shot = new Gamelab.Sprite().FromData({\r\n          active: true,\r\n          position: new Gamelab.Vector(position),\r\n          size: new Gamelab.Vector(size),\r\n          speed: speed,\r\n          image: animation.image,\r\n          rotation: new Gamelab.Vector(0, 0, 0),\r\n          flipX: false,\r\n          life: options.life,\r\n          noScroll: true\r\n        });\r\n\r\n\r\n        shot.Animation(animation);\r\n\r\n        rot_offset = new Gamelab.Vector(rot_offset, 0, 0);\r\n        shot.position.x = bx, shot.position.y = by;\r\n\r\n        //Danger On this line: annoying math --dispersing rotation of bullets by rot_disp\r\n\r\n        var div = rot_disp / total;\r\n        var rotPlus = div * x + div / 2 - rot_disp / 2;\r\n\r\n        shot.rotation.x = rot_offset.x + rotPlus;\r\n        //  shot.origin = new Gamelab.Vector(position);\r\n\r\n        shot.speed = new Gamelab.Vector(Math.cos((shot.rotation.x) * 3.14 / 180) * speed, Math.sin((shot.rotation.x) * 3.14 / 180) * speed);\r\n        shots.push(shot);\r\n\r\n        shot.onUpdate(function(spr) {\r\n          // console.log('update:rotation:' + shot.rotation.x);\r\n        });\r\n        gw.add(shot);\r\n      }\r\n    }\r\n    return shots;\r\n  }\r\n\r\n  /**\r\n   * create a sub-sprite belonging to the current sprite\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Object} options an object of arguments\r\n   * @param {Animation} animation the animation to fire from the Sprite\r\n   * @param {number} speed the speed of the shot that is projected\r\n   * @param {Vector} position the initial position of the shot: defaults to current Sprite position\r\n   * @param {Vector} size the Vector size of the shot\r\n   * @param {Vector} offset the positional offset to apply\r\n   * @returns {Sprite} a Gamelab.Sprite object\r\n   **********/\r\n\r\n  subsprite(options, gw) {\r\n\r\n    gw = gw || Gamelab.game_windows[0];\r\n\r\n    let animation = options.animation || new Gamelab.Animation();\r\n    let position = options.position || new Gamelab.Vector(this.position);\r\n    let offset = options.offset || new Gamelab.Vector(0, 0, 0);\r\n    let size = new Gamelab.Vector(options.size || this.size);\r\n\r\n    if (Gamelab.isAtPlay) {\r\n\r\n      var subsprite = gw.add(new Gamelab.Sprite().FromData({\r\n        active: true,\r\n        position: position,\r\n        size: size,\r\n        offset: offset,\r\n        image: animation.image,\r\n        rotation: new Gamelab.Vector(0, 0, 0),\r\n        flipX: false,\r\n        scrollFactor: this.scrollFactor,\r\n        noScroll: this.noScroll\r\n      }));\r\n\r\n      subsprite.Animation(animation);\r\n\r\n      return subsprite;\r\n\r\n    } else {\r\n      console.error('No subsprite when not at play');\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * switch to the next frame on sprite.selected_animation\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Animation} animation the optional animation to switch to before animate is called, defaults to the existing sprite.selected_animation\r\n   **********/\r\n\r\n  animate(animation) {\r\n    if (Gamelab.isAtPlay) {\r\n      if (animation) {\r\n        this.Animation(animation)\r\n      }\r\n\r\n      if (this.effectFrames instanceof Array && this.effectFrames.length && this.effectFrames.length >= 1) {\r\n        this.effectCanvasTimer += 1;\r\n\r\n        console.log('drawing from effect');\r\n\r\n        var data = this.effectFrames[this.effectCanvasTimer % this.effectFrames.length];\r\n      //  this.clearEffects();\r\n        this.effectCtx.putImageData(data, 0, 0);\r\n        console.log('animated data');\r\n      } else if (this.effectCanvas) {\r\n        this.effectCanvasTimer += 1;\r\n        //do nothing\r\n      } else if (this.selected_animation) {\r\n        this.selected_animation.run();\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * run a function when the sprite.selected_animation is complete\r\n   *\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Function} fun the function to call when the animation is complete\r\n   *\r\n   **********/\r\n  onAnimationComplete(fun) {\r\n    this.selected_animation.onComplete(fun);\r\n  }\r\n\r\n  grounded(value) {\r\n    if (value)\r\n      this.GROUNDED = value;\r\n    return this.GROUNDED;\r\n  }\r\n\r\n\r\n  /**\r\n   * get the vector-position at the center of the sprite, based on its current position and size\r\n   * @function\r\n   * @memberof Sprite\r\n   *\r\n   * @returns (Vector) a vector-position pinpointing the current-center of the sprite\r\n   *\r\n   **********/\r\n  center() {\r\n    return new Gamelab.Vector(this.position.x + this.size.x / 2, this.position.y + this.size.y / 2, 0);\r\n  }\r\n\r\n\r\n  /*****************************\r\n   *  System Use / Collision\r\n   ***************************/\r\n\r\n\r\n  /*****************************\r\n   * @ignore\r\n   ***************************/\r\n\r\n  shortest_stop(item, callback) {\r\n    var diff_min_y = item.min ? item.min.y : Math.abs(item.position.y - this.position.y + this.size.y);\r\n    var diff_min_x = item.min ? item.min.x : Math.abs(item.position.x - this.position.x + this.size.x);\r\n    var diff_max_y = item.max ? item.max.y : Math.abs(item.position.y + item.size.y - this.position.y);\r\n    var diff_max_x = item.max ? item.max.x : Math.abs(item.position.x + item.size.x - this.position.y);\r\n\r\n    var dimens = {\r\n      top: diff_min_y,\r\n      left: diff_min_x,\r\n      bottom: diff_max_y,\r\n      right: diff_max_x\r\n    };\r\n\r\n    var minkey = \"\",\r\n      min = 10000000;\r\n\r\n    for (var x in dimens) {\r\n      if (dimens[x] < min) {\r\n        min = dimens[x];\r\n        minkey = x; // a key of top left bottom or right\r\n      }\r\n    }\r\n\r\n    callback(minkey);\r\n  }\r\n\r\n  /*************\r\n   * #BE CAREFUL\r\n   * -with this function :: change sensitive / tricky / 4 way collision\r\n   * *************/\r\n\r\n  /**\r\n   * determine if sprite overlaps on x-axis with another sprite\r\n   *\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Sprite} item the Sprite to compare with\r\n   * @param {number} padding the 0-1.0 float value of padding to use on self when testing overlap\r\n   * @returns {boolean} a true || false var showing if overlap has occured\r\n   *\r\n   **********/\r\n\r\n  overlap_x(item, padding) {\r\n    if (!padding) {\r\n      padding = 0;\r\n    }\r\n\r\n    var p1 = this.position,\r\n      p2 = item.position;\r\n    var paddingX = Math.round(padding * this.size.x),\r\n\r\n      paddingY = Math.round(padding * this.size.y),\r\n      left = p2.x + paddingX,\r\n      right = p2.x + this.size.x - paddingX;\r\n\r\n    return right > p1.x && left < p1.x + item.size.x;\r\n  }\r\n\r\n  /*************\r\n   * #BE CAREFUL\r\n   * -with this function :: change sensitive / tricky / 4 way collision\r\n   * *************/\r\n\r\n  /**\r\n   * determine if sprite overlaps on y-axis with another sprite\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Sprite} item the Sprite to compare with\r\n   * @param {number} padding the 0-1.0 float value of padding to use on self when testing overlap\r\n   * @returns {boolean} a true || false var showing if overlap has occured\r\n   *\r\n   **********/\r\n\r\n  overlap_y(item, padding) {\r\n    if (!padding) {\r\n      padding = 0;\r\n    }\r\n\r\n    var p1 = this.position,\r\n      p2 = item.position;\r\n\r\n    var paddingX = Math.round(padding * this.size.x),\r\n      paddingY = Math.round(padding * this.size.y),\r\n\r\n      top = p2.y + paddingY,\r\n      bottom = p2.y + this.size.y - paddingY;\r\n\r\n    return bottom > p1.y && top < p1.y + item.size.x;\r\n\r\n  }\r\n\r\n\r\n  /*************\r\n   * #BE CAREFUL\r\n   * -with this function :: change sensitive / tricky / 4 way collision\r\n   * *************/\r\n\r\n\r\n  /**\r\n   * stop collision on x-axis with another sprite\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Sprite} item the Sprite with which to collide-stop on the x-axis\r\n   **********/\r\n\r\n  collide_stop_x(item) {\r\n\r\n    var apart = false;\r\n    var ct = 500;\r\n\r\n    while (!apart && ct > 0) {\r\n      ct--;\r\n\r\n      var diffX = this.center().sub(item.center()).x;\r\n      var distX = Math.abs(this.size.x / 2 + item.size.x / 2 - Math.round(this.size.x * this.padding.x));\r\n\r\n      if (Math.abs(diffX) < distX) {\r\n        this.position.x -= diffX > 0 ? -1 : 1;\r\n      } else {\r\n        this.speed.x = 0;\r\n        apart = true;\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n\r\n  /**\r\n   * restore a sprite from existing json-data --applies to data-persistence\r\n   *\r\n   * @function\r\n   * @memberof Sprite\r\n   *\r\n   * @returns (Sprite)\r\n   **********/\r\n\r\n  restoreFrom(data) {\r\n    data.image = new GameImage(data.src || data.image.src);\r\n    return new Gamelab.Sprite(data);\r\n  }\r\n\r\n  ColoredRect(color, w, h) {\r\n    var canvas = document.createElement('canvas');\r\n    canvas.width = w;\r\n    canvas.height = h;\r\n    var ctx = canvas.getContext('2d');\r\n    this.canvas = canvas;\r\n    ctx.fillStyle = color;\r\n    ctx.fillRect(0, 0, w, h);\r\n    this.image = new Gamelab.GameImage(canvas);\r\n    this.ctx = ctx;\r\n    this.size = new Gamelab.Vector(w, h);\r\n    return this;\r\n  }\r\n\r\n  AsCanvasTiles(tilesX, tilesY, unitWidth, unitHeight) {\r\n\r\n    var canvas = document.createElement('canvas');\r\n\r\n    var width = unitWidth * tilesX + unitWidth,\r\n      height = unitHeight * tilesY + unitHeight;\r\n\r\n    canvas.width = width;\r\n    canvas.height = height;\r\n\r\n    this.size = new Gamelab.Vector(w, h);\r\n\r\n    var ctx = canvas.getContext('2d');\r\n\r\n    this.canvas = canvas;\r\n    this.srcImageSave = new Gamelab.GameImage(this.image.domElement.src);\r\n\r\n    var $object = this;\r\n\r\n    this.srcImageSave.domElement.onload = function() {\r\n\r\n      for (var x = 0; x < tilesX; x++) {\r\n        for (var y = 0; y < tilesY; y++) {\r\n          ctx.drawImage(this, x * $object.size.x, y * $object.size.y, unitWidth, unitHeight);\r\n        }\r\n      }\r\n    };\r\n\r\n\r\n    this.image = new Gamelab.GameImage(canvas);\r\n    this.ctx = ctx;\r\n    return this;\r\n  }\r\n\r\n\r\n  /*****************************\r\n   * @ignore\r\n   * #IN-TESTING\r\n   *  fromFile(file_path)\r\n   *  -TODO : complete this function based on code to load Sprite() from file, located in the spritemaker.html file\r\n   *  -TODO: test this function\r\n   ***************************/\r\n\r\n  fromFile(file_path) {\r\n    if (typeof file_path == 'string') {\r\n      var __inst = this;\r\n      $.getJSON(file_path, function(data) {\r\n        __inst = new Gamelab.Sprite(data);\r\n      });\r\n    }\r\n  }\r\n\r\n  /*****************************\r\n   * return a decycled json-string for the sprite --without circular references\r\n   * @returns {string} a json string\r\n   ***************************/\r\n\r\n  toJSONString() {\r\n    return jstr(JSON.decycle(this));\r\n  }\r\n\r\n};\r\n\r\nGamelab.Sprite = Sprite;\r\n;//Any animation may have one or more frames of an effect::\r\n\r\n\r\nclass SpriteEffects{\r\n\r\nconstructor(){\r\n  this.effects = Gamelab.ImageEffects;\r\n}\r\n\r\ninit(sprite){\r\n\r\n  this.parentSprite = sprite.constructor.name.indexOf('Animation') >= 0 ? sprite : sprite.animations[0];\r\n\r\n  this.effects.forEach(function(fx){\r\n\r\n\r\n\r\n  });\r\n\r\n}\r\n\r\n}\r\n\r\n\r\n\r\nclass AnimationEffects{\r\n\r\nconstructor(){\r\n\r\n}\r\n\r\ninit(){\r\n\r\n}\r\n\r\n}\r\n;\r\nclass Text {\r\n\r\n  constructor(value){\r\n\r\n    this.Text(value);\r\n\r\n    this.FontSize(15);\r\n    this.FontFamily('Arial');\r\n\r\n    this.color = 'white';\r\n\r\n    this.shadowColor = 'black';\r\n    this.shadowBlur = 0;\r\n\r\n    this.position = new Gamelab.Vector(0, 0);\r\n\r\n  }\r\n\r\n  Text(t){\r\n\r\n    this.text = t;\r\n    this.value = t;\r\n    return this;\r\n  }\r\n\r\n  Shadow(color, blur){\r\n      this.shadowColor = color;\r\n      this.shadowBlur = blur;\r\n      return this;\r\n  }\r\n\r\n  Font(fsize, ffamily){\r\n    this.FontSize(fsize);\r\n    this.FontFamily(ffamily)\r\n    return this;\r\n  }\r\n\r\n  Color(c)\r\n  {\r\n    this.color = c;\r\n    return this;\r\n  }\r\n\r\n  FontSize(value){\r\n    if(typeof value !== 'string')\r\n    value = value + '';\r\n\r\n    value = value.replace('px', '') + 'px';\r\n\r\n    this.fontSize = value;\r\n    return this;\r\n  }\r\n  FontFamily(value)\r\n  {\r\n    this.fontFamily = value;\r\n    return this;\r\n  }\r\n\r\n\r\n    getOffsetPos(pos){\r\n      var offset = this.window_offset || new Gamelab.Vector(0, 0);\r\n      return pos.add(offset);\r\n    }\r\n\r\n  draw(ctx, camera){\r\n\r\n    console.log(\"DRAWING object.text.js\");\r\n\r\n    var x = this.position.x + camera.position.x,\r\n     y = this.position.y + camera.position.y;\r\n\r\n     if(ctx.save)\r\n     {\r\n    ctx.save();\r\n    }\r\n\r\n    ctx.fillStyle = this.color;\r\n\r\n    ctx.font = this.fontSize + ' ' + this.fontFamily;\r\n\r\n    var size = ctx.measureText(this.text);\r\n\r\n\r\n    ctx.shadowColor = this.shadowColor;\r\n\r\n    ctx.shadowBlur = this.shadowBlur;\r\n\r\n    //use the width of capital M as approximate text height\r\n\r\n    this.size = new Gamelab.Vector(size.width, ctx.measureText('M').width);\r\n\r\n    var pos = new Gamelab.Vector(x, y),\r\n    realPos = this.getOffsetPos(pos);\r\n\r\n    ctx.fillText(this.text, realPos.x, realPos.y);\r\n\r\n    ctx.restore();\r\n\r\n  }\r\n}\r\n\r\n\r\nGamelab.Text = Text;\r\n;/**\n * Creates a GravityForce instance.\n *\n *@param   {Object} args the object of arguments\n * @param   {string} args.name optional\n * @param   {string} args.description optional\n * @param   {Array} args.subjects the subjects to be pulled by the GravityForce\n * @param   {Array} args.clasticObjects any clastic object or array-of-objects that should have collision-stop behavior with subjects\n * @param   {Vector} args.max the max speed of the gravity-force, similar to concept of 'terminal velocity'\n * @param   {number} args.accel the increment of acceleration for each update called, while subjects are falling\n *\n * @returns {GravityForce} a GravityForce object\n */\n\n(function () {\n    console.log('Force class... creating');\n\n    class GravityForce {\n        constructor(args = {}) {\n            this.name = args.name || \"\";\n\n            this.description = args.description || \"\";\n\n            this.subjects = args.subjects || [];\n\n            this.clasticObjects = args.clasticObjects || [];\n\n            this.topClastics = args.topClastics || [];\n\n            this.max = args.max || new Gamelab.Vector(3, 3, 3);\n            this.accel = args.accel || new Gamelab.Vector(1.3, 1.3, 1.3);\n\n\n            for (var x in this.clasticObjects) {\n                if (!this.clasticObjects[x] instanceof Gamelab.Sprite) {\n                    this.clasticObjects[x] = Gamelab.getById(this.clasticObjects[x].id);\n                }\n\n            }\n\n\n            for (var x in this.topClastics) {\n                if (!this.topClastics[x] instanceof Gamelab.Sprite) {\n                    this.topClastics[x] = Gamelab.getById(this.topClastics[x].id);\n                }\n\n            }\n\n\n            for (var x in this.subjects) {\n                if (!this.subjects[x] instanceof Gamelab.Sprite) {\n                    this.subjects[x] = Gamelab.getById(this.subjects[x].id);\n                }\n\n            }\n\n        }\n\n        getArg(args, key, fallback) {\n\n            if (args.hasOwnProperty(key)) {\n                return args[key];\n            }\n            else {\n                return fallback;\n\n            }\n        }\n\n\n        /**\n         * Updates position for all objects effected by this instance.\n         * @memberof GravityForce\n         */\n\n        update() {\n\n            var subjects = this.subjects;\n\n            var clasticObjects = this.clasticObjects;\n\n            var topClastics = this.topClastics;\n\n            var accel = this.accel || {};\n\n            var max = this.max || {};\n\n            Gamelab.each(subjects, function (ix, itemx) {\n\n                if(!itemx.jumping && !itemx.flying)\n                itemx.accelY(accel, max);\n\n                itemx.__inAir = true;\n\n\n                if (itemx.position.y >= itemx.groundMaxY) {\n                    itemx.position.y = itemx.groundMaxY;\n                }\n\n                itemx.groundMaxY = 3000000; //some crazy number you'll never reach in-game\n\n                Gamelab.each(topClastics, function (iy, itemy) {\n\n                    itemx.collide_stop_top(itemy);\n\n                });\n\n            });\n        }\n    };\n\n    let Force = GravityForce;\n\n    Gamelab.Force = Force;\n\n    Gamelab.GForce = Force;\n\n    Gamelab.GravityForce = GravityForce;\n\n})();\n;\r\nconsole.log('TODO:: complete Gamelab.Gravity class');\r\n\r\nclass Gravity {\r\n  constructor(){\r\n\r\n  }\r\n  //pull single object or list of objects\r\n  pull(object, accel=1.0, max=100){\r\n    var list = object instanceof Array ? object : [object];\r\n    list.forEach(function(item){\r\n        if(item.speed.y < max)\r\n        {\r\n          item.__inAir = true;\r\n          item.speed.y += accel;\r\n        }\r\n        else\r\n        {\r\n            item.speed.y = max;\r\n        }\r\n\r\n    });\r\n  }\r\n}\r\n\r\nGamelab.Gravity = Gravity;\r\n;\r\n\r\nclass Background extends Sprite{\r\n  constructor(){\r\n    super(arguments);\r\n  }\r\n  Repeat(x, y){\r\n    this.repeat = new Gamelab.Vector(x, y);\r\n    return this;\r\n  }\r\n  ScrollCycle(value){\r\n    this.scrollCycle = value;\r\n    return this;\r\n  }\r\n  draw(ctx, camera) {\r\n\r\n    var sprite;\r\n\r\n    if (this.constructor.name == 'SpriteBrush') {\r\n      sprite = this.selected_sprite;\r\n    } else {\r\n      sprite = this;\r\n    }\r\n\r\n    camera = camera || false;\r\n\r\n    if (!camera && Gamelab.game_windows[0] && Gamelab.game_windows[0].camera)\r\n      camera = Gamelab.game_windows[0].camera;\r\n\r\n    else if (!camera) {\r\n      camera = {\r\n        position: new Gamelab.Vector(0, 0, 0)\r\n      };\r\n    }\r\n\r\n    if (sprite.invisible)\r\n      return;\r\n\r\n    if (sprite.active && (this.DRAWOFFSCREEN || sprite.onScreen(Gamelab.WIDTH, Gamelab.HEIGHT))) {\r\n      this.draw_current_frame(ctx, camera);\r\n    }\r\n  }\r\n\r\n\r\n    draw_current_frame(ctx, camera) {\r\n\r\n      var sprite;\r\n\r\n      if (this.constructor.name == 'SpriteBrush') {\r\n        sprite = this.selected_sprite;\r\n      } else {\r\n        sprite = this;\r\n      }\r\n\r\n      var frame = false,\r\n        frameList = [];\r\n\r\n\r\n      if (sprite.active) {\r\n\r\n        if (sprite.selected_animation instanceof Array && sprite.selected_animation.length >= 1) {\r\n          sprite.selected_animation.forEach(function(anime) {\r\n            frameList.push(anime.selected_frame);\r\n          });\r\n        }\r\n\r\n        if (sprite.selected_animation instanceof Object && sprite.selected_animation.hasOwnProperty('selected_frame')) {\r\n          frame = sprite.selected_animation.selected_frame;\r\n        }\r\n\r\n        var p = sprite.position;\r\n\r\n        var camera_pos = camera.position || {\r\n          x: 0,\r\n          y: 0,\r\n          z: 0\r\n        };\r\n\r\n        if (!sprite.hasOwnProperty('scrollFactor')) {\r\n          sprite.scrollFactor = 1.0;\r\n        }\r\n\r\n        var x = p.x,\r\n          y = p.y,\r\n          scrollFactor = sprite.scrollFactor >= -1.0 && sprite.scrollFactor <= 1.0 ? sprite.scrollFactor : 1.0;\r\n\r\n        if (sprite.noScroll) {\r\n          scrollFactor = 0;\r\n        }\r\n\r\n\r\n        //optional animation : gameSize\r\n\r\n        var targetSize = sprite.size || sprite.selected_animation.size;\r\n\r\n        var realWidth = targetSize.x;\r\n        var realHeight = targetSize.y;\r\n\r\n\r\n        var origin = sprite.origin || new Gamelab.Vector(realWidth / 2, realHeight / 2);\r\n\r\n        //optional animation : offset\r\n\r\n        var rotation;\r\n\r\n        if (typeof(sprite.rotation) == 'object') {\r\n          rotation = sprite.rotation.x;\r\n\r\n        } else {\r\n          rotation = sprite.rotation;\r\n        }\r\n\r\n\r\n        if (this.image && this.image.domElement instanceof HTMLCanvasElement) {\r\n          var x = this.position.x,\r\n            y = this.position.y;\r\n\r\n          x -= camera_pos.x * scrollFactor || 0;\r\n          y -= camera_pos.y * scrollFactor || 0;\r\n          //  console.log('sprite:: canvas draw!! ');\r\n          return Gamelab.Canvas.draw_image_frame(this.image.domElement, new Gamelab.Vector(0, 0), this.size, new Gamelab.Vector2D(Math.round(x + (origin.x)), Math.round(y + (origin.y))), new Gamelab.Vector2D(realWidth, realHeight), rotation % 360, ctx, sprite.flipX, sprite.flipY, origin, this.opacity, this.globalCompositeOperation || false);\r\n        }\r\n\r\n\r\n        if (!(sprite.selected_animation && sprite.selected_animation.selected_frame)) {\r\n          return;\r\n        }\r\n\r\n        var frame = sprite.selected_animation.selected_frame;\r\n\r\n        if (frame && frame.image && frame.image.data) {\r\n\r\n          ctx.putImageData(frame.image.data, x, y, 0, 0, sprite.size.x, sprite.size.y);\r\n\r\n        } else {\r\n\r\n          if (frameList.length >= 1) {\r\n\r\n            frameList.forEach(function(frame) {\r\n\r\n              var realWidth = frame.size.x;\r\n              var realHeight = frame.size.y;\r\n\r\n              var xpos = frame.position.x,\r\n                ypos = frame.position.y;\r\n\r\n              x += sprite.position.x;\r\n              y += sprite.position.y;\r\n\r\n              x -= camera_pos.x * scrollFactor || 0;\r\n              y -= camera_pos.y * scrollFactor || 0;\r\n\r\n              sprite.realPosition = new Gamelab.Vector(x, y);\r\n\r\n              if (frame.rotation && typeof frame.rotation.x == 'number') {\r\n                rotation = frame.rotation.x;\r\n              }\r\n\r\n              if (frame.origin) {\r\n                origin = frame.origin;\r\n                //console.log('drawing with origin:' + origin.x + ':' + origin.y);\r\n              }\r\n\r\n\r\n              if (frame && frame.image)\r\n                Gamelab.Canvas.draw_image_frame(sprite.effectCanvas ? sprite.effectCanvas : frame.image.domElement, frame.framePos, frame.frameSize, new Gamelab.Vector2D(Math.round(xpos + (origin.x)), Math.round(ypos + (origin.y))), new Gamelab.Vector2D(realWidth, realHeight), rotation % 360, ctx, sprite.flipX, sprite.flipY, origin, this.opacity, this.globalCompositeOperation || false);\r\n\r\n            });\r\n\r\n          } else {\r\n            var fx = frame.position.x,\r\n              fy = frame.position.y,\r\n              pos = new Gamelab.Vector(x + fx, y + fy);\r\n\r\n            pos.x -= camera_pos.x * scrollFactor || 0;\r\n            pos.y -= camera_pos.y * scrollFactor || 0;\r\n            sprite.realPosition = pos;\r\n            if (frame.image.domElement instanceof HTMLImageElement || frame.image.domElement instanceof HTMLCanvasElement) {\r\n              Gamelab.Canvas.draw_image_frame(this.effectCanvas ? this.effectCanvas : frame.image.domElement, frame.framePos, frame.frameSize, new Gamelab.Vector2D(Math.round(pos.x + (origin.x)), Math.round(pos.y + (origin.y))), new Gamelab.Vector2D(realWidth, realHeight), rotation % 360, ctx, sprite.flipX, sprite.flipY, origin, this.opacity, this.globalCompositeOperation || false);\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n      }\r\n\r\n    }\r\n\r\n\r\n}\r\n\r\n\r\nGamelab.Background = Background;\r\n;/**\r\n * Creates a new BoneSprite.\r\n *\r\n * <info-bit>Gamelab.BoneSprite is a container for 2D Animations.\r\n * -apply Sprite class to create a 2D game-object.\r\n *\r\n * BoneSprites are a group of moving animations.</info-bit>\r\n * <iframe style='width:400px; height:450px; overflow:hidden;' src='../client/examples/js-class/Sprite.html'> </iframe>\r\n\r\n * @param   {string} src the srcPath for the image of the Sprite\r\n * @param   {number} scale=1.0 the scale to be applied to size of each animation-frame\r\n *\r\n * @returns {Sprite} a Gamelab.BoneSprite object\r\n */\r\n\r\nclass BoneSprite extends Sprite {\r\n  constructor(src = {}, scale = 1.0) {\r\n    super(src, scale);\r\n    this.bones = [];\r\n  }\r\n  addBone(oncreate) {\r\n    var bone = new Bone(this, this.size);\r\n    oncreate.bind(bone).call();\r\n    this.bones.push(bone);\r\n  }\r\n  updateBones(){\r\n\r\n    this.bones[0].SetParentPosition(this.position);\r\n\r\n    var boffset = this.bones[0].CalcOffset();\r\n\r\n    var count = 0;\r\n\r\n    for(var x = 0; x < this.bones.length; x+= 2)\r\n    {\r\n\r\n      if(this.bones[x] && this.bones[x + 1])\r\n      {\r\n        var b1 = this.bones[x], b2 = this.bones[x + 1];\r\n        boffset = b1.CalcOffset();\r\n        b2.SetParentPosition(boffset);\r\n        b2.CalcOffset(b1);\r\n      }\r\n    }\r\n\r\n  }\r\n  draw_current_frame(ctx, camera) {\r\n\r\n\r\n    var sprite = this;\r\n    var frameList = [];\r\n    if (sprite.active) {\r\n\r\n      if (sprite.selected_animation instanceof Array && sprite.selected_animation.length >= 1) {\r\n        sprite.selected_animation.forEach(function(anime) {\r\n\r\n          anime.selected_frame.parent = anime;\r\n          frameList.push(anime.selected_frame);\r\n\r\n        });\r\n      }\r\n\r\n      var origin = sprite.origin || new Gamelab.Vector(0, 0);\r\n      var rotation = sprite.rotation.x;\r\n\r\n      frameList.reverse().forEach(function(frame){\r\n\r\n        var realWidth = frame.size.x;\r\n        var realHeight = frame.size.y;\r\n\r\n        var x = frame.position.x,\r\n          y = frame.position.y;\r\n\r\n        if (frame.rotation && typeof frame.rotation.x == 'number') {\r\n          rotation = frame.rotation.x;\r\n        }\r\n\r\n        if (frame.origin) {\r\n          origin = frame.origin;\r\n          //console.log('drawing with origin:' + origin.x + ':' + origin.y);\r\n        }\r\n\r\n        var frame_offset = new Gamelab.Vector(0, 0);\r\n\r\n        if(frame.parent && frame.parent.frameOffset instanceof Gamelab.Vector)\r\n        {\r\n          //console.log('object.bonesprite.js:: frame-parent-offset');\r\n          frame_offset = frame.parent.frameOffset;\r\n        }\r\n\r\n        if (frame && frame.image)\r\n          Gamelab.Canvas.draw_image_frame(frame.image.domElement, new Gamelab.Vector(frame.framePos).add(frame_offset), frame.frameSize, new Gamelab.Vector2D(Math.round(x + (origin.x)), Math.round(y + (origin.y))), new Gamelab.Vector2D(realWidth, realHeight), rotation % 360, ctx, sprite.flipX, sprite.flipY, origin);\r\n      });\r\n\r\n    }\r\n\r\n  }\r\n};\r\n\r\nGamelab.BoneSprite = BoneSprite;\r\n;/**\r\n * Creates a new SpriteBrush.\r\n */\r\n\r\nclass SpriteBrush{\r\n  constructor(onCreate, mode = 'random') {\r\n    this.sprites = [];\r\n    this.overlaySprites = [];\r\n    this.mode = mode;\r\n    this.index = -1;\r\n    this.total = 0;\r\n    this.selected_sprite = {};\r\n    this.id = Gamelab.create_id();\r\n    onCreate = onCreate || function(){};\r\n    onCreate.bind(this);\r\n  }\r\n\r\n  addSprite(src, scale, callback) {\r\n    this.sprites.push(new Gamelab.Sprite(src, scale));\r\n    if(callback) callback.bind(this).call();\r\n  }\r\n  addOverlaySprite(src, scale, callback) {\r\n    console.info(`SpriteFill().addOverlay(): --adds an overlay.\r\n      Every overlay must fit with every sourceSprite, matching non-transparent pixels only`);\r\n    this.overlaySprites.push(new Gamelab.Sprite(src, scale));\r\n    if(callback) callback.bind(this).call();\r\n  }\r\n\r\n  removeAll(){\r\n    this.sprites = [];\r\n    this.overlaySprites = [];\r\n  }\r\n\r\n  next(){\r\n    this.index += 1;\r\n    switch(this.mode.toLowerCase())\r\n    {\r\n        case 'random':\r\n        var index = Math.floor(Math.random() * this.sprites.length);\r\n        this.selected_sprite = this.sprites[index];\r\n        return this.selected_sprite;\r\n        break;\r\n\r\n        case 'consecutive':\r\n        this.selected_sprite = this.sprites[this.index % this.sprites.length];\r\n        return this.selected_sprite;\r\n        break;\r\n    }\r\n  }\r\n\r\n  Clone(spritebrush)\r\n  {\r\n    var outputSprite = new Gamelab.SpriteBrush();\r\n    outputSprite.id = spritebrush.id;\r\n    var oix = 0;\r\n\r\n    spritebrush.sprites.forEach(function(sprite){\r\n        outputSprite.addSprite(sprite.src, sprite.size);\r\n        oix += 1;\r\n    });\r\n\r\n    spritebrush.overlaySprites.forEach(function(sprite){\r\n        outputSprite.addOverlaySprite(sprite.src, sprite.size);\r\n        oix += 1;\r\n    });\r\n    return outputSprite;\r\n  }\r\n\r\n  FromData(spritebrush)\r\n  {\r\n    var outputSprite = new Gamelab.SpriteBrush();\r\n\r\n    outputSprite.id = spritebrush.id;\r\n\r\n    var oix = 0;\r\n\r\n    spritebrush.sprites.forEach(function(sprite){\r\n\r\n        outputSprite.addSprite(sprite.src, sprite.size);\r\n\r\n        oix += 1;\r\n    });\r\n\r\n    spritebrush.overlaySprites.forEach(function(sprite){\r\n\r\n        outputSprite.addOverlaySprite(sprite.src, sprite.size);\r\n\r\n        oix += 1;\r\n    });\r\n\r\n    return outputSprite;\r\n  }\r\n};\r\n\r\nGamelab.SpriteBrush = SpriteBrush;\r\n;\r\n\r\n\r\nclass SpriteFactory {\r\n\r\n  constructor(onCreate){\r\n\r\n    this.sprites = [];\r\n\r\n    this.livingTotal = 0;\r\n\r\n    this.livingSprites = [];\r\n\r\n\r\n    this.livingSprites.oldest = function(){\r\n\r\n      var maxTicker = 0, nextObjectIndex = 0;\r\n\r\n      for(var x = 0; x < this.length; x++)\r\n      {\r\n        if(typeof this[x] == 'object' && this[x].ticker >= maxTicker)\r\n        {\r\n          maxTicker = this[x].ticker;\r\n          nextObjectIndex = x;\r\n        }\r\n      }\r\n      return this[nextObjectIndex];\r\n    };\r\n\r\n    this.livingSprites.countLiving = function(){\r\n      var total = 0;\r\n      for(var x = 0; x < this.length; x++)\r\n      {\r\n        if(this[x].ticker > 0)\r\n        {\r\n          total++;\r\n        }\r\n      }\r\n      return total;\r\n    };\r\n\r\n\r\n\r\n    this.sprites.oldest = function(){\r\n\r\n      var maxTicker = 0, nextObjectIndex = 0;\r\n\r\n      for(var x = 0; x < this.length; x++)\r\n      {\r\n        if(typeof this[x] == 'object' && this[x].ticker >= maxTicker)\r\n        {\r\n          maxTicker = this[x].ticker;\r\n          nextObjectIndex = x;\r\n        }\r\n      }\r\n      return this[nextObjectIndex];\r\n    };\r\n\r\n    this.sprites.countLiving = function(){\r\n      var total = 0;\r\n      for(var x = 0; x < this.length; x++)\r\n      {\r\n        if(this[x].ticker >= 1)\r\n        {\r\n          total++;\r\n        }\r\n      }\r\n      console.log('TOTAL LIVING blts::' + total);\r\n      return total;\r\n    };\r\n\r\n    if(typeof onCreate == 'function')\r\n    onCreate.bind(this).call();\r\n\r\n  }\r\n\r\n  Frequency(f){\r\n      this.frequency = f;\r\n      return this;\r\n  }\r\n\r\n  MenuSprite(sprite){\r\n\r\n    if(sprite)\r\n    this.menu_sprite = sprite;\r\n\r\n    return this.menu_sprite;\r\n  }\r\n\r\n  PrepareSprites(total=1, exampleSprite, onCreateSprite){\r\n\r\n    for(var x = 0; x < total; x++)\r\n    {\r\n      var s = new Gamelab.Sprite().FromData(exampleSprite);\r\n      this.sprites.push(s);\r\n    }\r\n\r\n    this.createSprite = onCreateSprite;\r\n\r\n    return this;\r\n  }\r\n\r\n    PrepareSpritesByArrayOrder(total=1, exampleSprites, loadFxn){\r\n\r\n      if(!exampleSprites instanceof Array)\r\n      exampleSprites = [exampleSprites];\r\n\r\n      for(var x = 0; x < total; x++)\r\n      {\r\n        var s = new Gamelab.Sprite().FromData(exampleSprites[x % exampleSprites.length]);\r\n        s.onLoad(loadFxn || function(){});\r\n        this.sprites.push(s);\r\n      }\r\n\r\n      return this;\r\n    }\r\n\r\n  enter(number=1, gameWindow)\r\n  {\r\n    var $controller = this;\r\n\r\n    for(var x = 0; x < number; x++)\r\n    {\r\n      //get next in stock::\r\n      var livingCount = this.sprites.countLiving();\r\n\r\n      var s = new Gamelab.Sprite().Clone(this.sprites[0]);\r\n\r\n      if(this.createSprite)\r\n      {\r\n        this.createSprite.bind(s).call();\r\n      }\r\n\r\n      this.livingSprites.push(s);\r\n\r\n      gameWindow.add(s);\r\n      this.livingTotal += 1;\r\n\r\n      if(this.onfire)\r\n      this.onfire(s);\r\n\r\n    }\r\n\r\n            return {\r\n\r\n              assignTrackableSpeed:function(speed){\r\n\r\n                  $p.trackableSpeed = speed;\r\n                  return this;\r\n              }\r\n              ,\r\n\r\n              assignLinesAndSelector:function(lineList, lineSelector){\r\n                  $p.lines = lines;\r\n                  return this;\r\n              }\r\n\r\n            }\r\n\r\n  }\r\n\r\n  onUpdate(update){\r\n    this.onupdate = update;\r\n    return this;\r\n  }\r\n\r\n  onFire(callback){\r\n\r\n    this.onfire = callback;\r\n    return this;\r\n  }\r\n\r\n  fire(gameWindow){\r\n      this.enter(1, gameWindow);\r\n  }\r\n\r\n}\r\n\r\nGamelab.SpriteFactory = SpriteFactory;\r\n;/**\r\n * Creates a new SpriteFill.\r\n */\r\n\r\nclass SpriteFill extends Sprite {\r\n  constructor(src = {}, scale = 1.0) {\r\n    super(src, scale);\r\n    this.sourceSprites = [];\r\n    this.overlaySprites = [];\r\n    this.shape = [];\r\n  }\r\n  //draw function is overwritten to nothing. --limits console errors --todo --complete\r\n  draw() {\r\n    return 0;\r\n  }\r\n  addSprite(src, scale, callback) {\r\n    this.sourceSprites.push(new Gamelab.Sprite(src, scale));\r\n    if(callback) callback.bind(this).call();\r\n  }\r\n  addOverlaySprite(src, scale, callback) {\r\n    console.info(`SpriteFill().addOverlay(): --adds an overlay.\r\n      Every overlay must fit with every sourceSprite, matching non-transparent pixels only`);\r\n    this.overlaySprites.push(new Gamelab.Sprite(src, scale));\r\n    if(callback) callback.bind(this).call();\r\n  }\r\n  SelectionMode(mode) {\r\n    this.selection_mode = mode || this.selected_mode || 'random';\r\n    return this.selection_mode;\r\n  }\r\n  BuildShape(onCreateShape) {\r\n    if(onCreateShape) onCreateShape.bind(this).call();\r\n    return this.shape;\r\n  }\r\n  enclose_rectangle() {\r\n    var rect = new Gamelab.Rectangle(Infinity, Infinity, -Infinity, -Infinity);\r\n    this.shape.forEach(function(point) {\r\n      if (point.x < rect.min.x) {\r\n        rect.min.x = point.x;\r\n      }\r\n      if (point.y < rect.min.y) {\r\n        rect.min.y = point.y;\r\n      }\r\n      if (point.x > rect.max.x) {\r\n        rect.max.x = point.x;\r\n      }\r\n      if (point.y > rect.max.y) {\r\n        rect.max.y = point.y;\r\n      }\r\n    });\r\n    return rect;\r\n  }\r\n\r\n  Fill() {\r\n\r\n    var bounds = this.enclose_rectangle();\r\n\r\n    //step 1: fill the shape with rectangles:\r\n\r\n    var tracker = new Gamelab.Vector(),\r\n      sprite = this.sourceSprites[0],\r\n      currentSize = new Gamelab.Vector(sprite.size),\r\n      currentIndex = 0;\r\n\r\n    this.offscreenCanvas = new Gamelab.OffscreenCanvas(document.createElement('CANVAS'), bounds.min.x, bounds.min.y);\r\n\r\n    var ctx = this.offscreenCanvas.ctx;\r\n\r\n    //apply loop through x, y bounds, fill with sprites\r\n    for (var x = bounds.min.x; x < bounds.max.x; x += currentSize.x) {\r\n      for (var y = bounds.min.y; y < bounds.max.y; y += currentSize.y) {\r\n        var nextSprite = new Gamelab.Sprite().FromData(this.sourceSprites[currentIndex]);\r\n        this.sprites.push(nextSprite);\r\n        currentSize = new Gamelab.Vector(nextSprite.size);\r\n        currentIndex += 1;\r\n        nextSprite.onLoad(function() {\r\n          this.draw(ctx);\r\n        });\r\n      }\r\n    }\r\n\r\n    return this.offscreenCanvas;\r\n\r\n  }\r\n\r\n};\r\n\r\nGamelab.SpriteFill = SpriteFill;\r\n;/**\r\n * Creates a new SpriteGroup.\r\n *\r\n * <info-bit>Gamelab.SpriteGroup is a container for RELATIVE-POSITIONED 2D Animations.\r\n * -apply Sprite class to create a 2D game-object.\r\n */\r\n\r\nclass SpriteGroup {\r\n  constructor(src = {}, scale = 1.0) {\r\n    this.sprites = [];\r\n    this.mainSprite = new Gamelab.Sprite(src, scale);\r\n  }\r\n\r\n  BasePosition(px, py){\r\n    this.basePosition = new Gamelab.Vector(px, py);\r\n    return this;\r\n  }\r\n\r\n  add(sprite){\r\n    this.sprites.push(sprite);\r\n    return this;\r\n  }\r\n};\r\n\r\nGamelab.SpriteGroup = SpriteGroup;\r\n;class FeatureSymbol {\r\n  constructor(key) {\r\n    this.key = key || \"@NONE\";\r\n    this.symbol = Symbol(key);\r\n  }\r\n}\r\n\r\nGamelab.FeatureSymbol = FeatureSymbol;\r\n\r\nGamelab.FeatureInjectors = Gamelab.FeatureInjectors || {};\r\n\r\nGamelab.FeatureInject = function(constructor, args) {\r\n\r\n  //console.log('Gamelab.FeatureInject()');\r\n\r\n  var GClassFeatures = {};\r\n\r\n\r\n  for (var y in Gamelab.ObjectFeatureMap) {\r\n\r\n    if (Gamelab[y] && typeof Gamelab[y] == 'function') {\r\n\r\n      var constructor = Gamelab[y];\r\n\r\n      GClassFeatures[y] = {};\r\n\r\n      //  console.log('Feature Symbol-key:' + Gamelab.ObjectFeatureMap[x][y]);\r\n\r\n      GClassFeatures[y].featureSymbols = GClassFeatures[y].featureSymbols || [];\r\n\r\n      for (var z in Gamelab.ObjectFeatureMap[y]) {\r\n\r\n        GClassFeatures[y].featureSymbols.push(new Gamelab.FeatureSymbol(Gamelab.ObjectFeatureMap[y][z]));\r\n\r\n        GClassFeatures[y].featureSymbols.hasKey = function(key) {\r\n\r\n          for (var x = 0; x < this.length; x++) {\r\n            if (typeof this[x].key !== 'string')\r\n              continue;\r\n\r\n            if (this[x].key.indexOf('@') == -1)\r\n              console.error('feature-keys must contain @');\r\n\r\n            //  console.log('eval key:' + this[x].key.split('@')[1]);\r\n\r\n            if (this[x].key.split('@')[1] == key)\r\n              return true;\r\n          }\r\n\r\n          return false;\r\n        };\r\n\r\n        GClassFeatures[y].featureSymbols.hasSymbol = function(symbol) {\r\n          for (var x in this) {\r\n            if (this[x].symbol == symbol)\r\n              return true;\r\n          }\r\n\r\n          return false;\r\n        };\r\n\r\n        //  console.info('adding feature-symbol:' + Gamelab.ObjectFeatureMap[x][y]);\r\n      }\r\n    } else {\r\n      console.error('Gamelab.ObjectFeatureMap: member by name of ' + x + ' does not exist as member of Gamelab');\r\n    }\r\n  }\r\n\r\n\r\n  console.info('FEATURES:', GClassFeatures);\r\n\r\n\r\n  for (var x in Gamelab.FeatureInjectors) {\r\n\r\n    //  console.log(Gamelab.FeatureInjectors[x]);\r\n\r\n    var props = TypeCode.getProtoFuncs(Gamelab.FeatureInjectors[x]);\r\n\r\n    for (var y = 0; y < props.length; y++) {\r\n      console.log(x + \":\" + props[y]);\r\n      for (var z in GClassFeatures)\r\n        if (GClassFeatures[z] && GClassFeatures[z].featureSymbols.hasKey(props[y])) {\r\n          Gamelab.FeatureInjectors[x][props[y]](Gamelab[z].prototype, args);\r\n        }\r\n    }\r\n  }\r\n\r\n};\r\n\r\n\r\nclass CssFeatures {\r\n\r\n  colored(obj){\r\n    obj.Color = function(c)\r\n    {\r\n      this.color = c;\r\n      return this;\r\n    }\r\n  }\r\n\r\n  color_transition(min_color, max_color){\r\n    this.min_color = min_color;\r\n    this.max_color = max_color;\r\n    return this;\r\n  }\r\n\r\n  text(obj){\r\n    obj.Text = function(value)\r\n    {\r\n      this.text = value;\r\n      return this;\r\n    }\r\n  }\r\n\r\n  opaque(obj){\r\n    obj.Opacity = function(o){\r\n      this.opacity = o;\r\n      return this;\r\n    }\r\n  }\r\n};\r\n\r\n\r\nclass DataFunctions {\r\n\r\n  data(obj){\r\n\r\n    obj.Name = function(n) {\r\n      this.name = n;\r\n      return this;\r\n    };\r\n\r\n    obj.Description = function(d){\r\n      this.description = d;\r\n      return this;\r\n    };\r\n\r\n    obj.Context = function(c) {\r\n      this.context = c;\r\n      return this;\r\n    };\r\n\r\n    obj.create_id = function(){\r\n      return Gamelab.create_id();\r\n    }\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n/***************************\r\nGeometryFeatures:\r\n  A functional dependency injector\r\n  injects properties and functions according to Symbols\r\n**************************/\r\nclass VectorFunctions {\r\n  constructor() {\r\n\r\n    this.name = 'VectorFunctionals';\r\n\r\n  }\r\n\r\n  collideable(obj) {\r\n    obj.collision_callback = function() {};\r\n    obj.onCollide = args.onCollide || function(collideables, callback) {\r\n      if (typeof(collideables) == 'function') {\r\n        callback = collideables;\r\n      }\r\n      this.collision_callback = callback || function() {};\r\n    };\r\n  }\r\n\r\n  spatial(obj) {\r\n\r\n    obj.Size = function(x, y, z) {\r\n\r\n      if (typeof(x) == 'object')\r\n        this.size = new Gamelab.Vector(x);\r\n\r\n      else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n        this.size = new Gamelab.Vector(x, y, z);\r\n\r\n      else //use x accross the vector\r\n        this.size = new Gamelab.Vector(x, x, x);\r\n\r\n      return this;\r\n    };\r\n\r\n    obj.Pos = function(x, y, z) {\r\n\r\n      if (typeof(x) == 'object')\r\n        this.position = new Gamelab.Vector(x);\r\n\r\n      else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n        this.position = new Gamelab.Vector(x, y, z);\r\n\r\n      else //use x accross the vector\r\n        this.position = new Gamelab.Vector(x, x, x);\r\n\r\n      return this;\r\n    };\r\n\r\n    obj.Rot = function(x, y, z) {\r\n\r\n      if (typeof(x) == 'object')\r\n        this.rotation = new Gamelab.Vector(x);\r\n\r\n      else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n        this.rotation = new Gamelab.Vector(x, y, z);\r\n\r\n      else //use x accross the vector\r\n        this.rotation = new Gamelab.Vector(x, x, x);\r\n\r\n      return this;\r\n    };\r\n\r\n    obj.Position = obj.Pos;\r\n\r\n    obj.Rotate = obj.Rot;\r\n\r\n    obj.Rotation = obj.Rot;\r\n\r\n  }\r\n\r\n  relative_spatial(obj){\r\n\r\n\r\n        obj.Size = function(x, y, z) {\r\n\r\n          if (typeof(x) == 'object')\r\n            this.size = new Gamelab.Vector(x);\r\n\r\n          else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n            this.size = new Gamelab.Vector(x, y, z);\r\n\r\n          else //use x accross the vector\r\n            this.size = new Gamelab.Vector(x, x, x);\r\n\r\n          return this;\r\n        };\r\n\r\n        obj.Pos = function(x, y, z) {\r\n\r\n          var bpx = 0;\r\n          if(this.basePosition &&  this.basePosition.x)\r\n          bpx = this.basePosition.x;\r\n\r\n          if (typeof(x) == 'object')\r\n            this.position = new Gamelab.Vector(bpx + x);\r\n\r\n          else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n            this.position = new Gamelab.Vector(bpx + x, y, z);\r\n\r\n          else //use x accross the vector\r\n            this.position = new Gamelab.Vector(bpx + x, x, x);\r\n\r\n          return this;\r\n        };\r\n\r\n        obj.Rot = function(x, y, z) {\r\n\r\n          var bx = 0;\r\n          if(this.baseRotation &&  this.baseRotation.x)\r\n          bx = this.baseRotation.x;\r\n\r\n          if (typeof(x) == 'object')\r\n            this.rotation = new Gamelab.Vector(bx + x);\r\n\r\n          else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n            this.rotation = new Gamelab.Vector(bx + x, y, z);\r\n\r\n          else //use x accross the vector\r\n            this.rotation = new Gamelab.Vector(bx + x, x, x);\r\n\r\n          return this;\r\n        };\r\n\r\n        obj.Position = obj.Pos;\r\n\r\n        obj.Rotate = obj.Rot;\r\n\r\n        obj.Rotation = obj.Rot;\r\n\r\n  }\r\n\r\n  posable(obj) {\r\n\r\n    obj.Pos = function(x, y, z) {\r\n\r\n      if (typeof(x) == 'object')\r\n        this.position = new Gamelab.Vector(x);\r\n\r\n      else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n        this.position = new Gamelab.Vector(x, y, z);\r\n\r\n      else //use x accross the vector\r\n        this.position = new Gamelab.Vector(x, x, x);\r\n\r\n      return this;\r\n    };\r\n\r\n    obj.Position = obj.Pos;\r\n\r\n  }\r\n\r\n  sizeable(obj) {\r\n\r\n    obj.Size = function(x, y, z) {\r\n\r\n      if (typeof(x) == 'object')\r\n        this.size = new Gamelab.Vector(x);\r\n\r\n      else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n        this.size = new Gamelab.Vector(x, y, z);\r\n\r\n      else //use x accross the vector\r\n        this.size = new Gamelab.Vector(x, x, x);\r\n\r\n      return this;\r\n    };\r\n\r\n    obj.Position = obj.Pos;\r\n\r\n  }\r\n\r\n  rotable(obj) {\r\n    obj.Rot = function(x, y, z) {\r\n\r\n      if (typeof(x) == 'object')\r\n        this.rotation = new Gamelab.Vector(x);\r\n\r\n      else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n        this.rotation = new Gamelab.Vector(x, y, z);\r\n\r\n      else //use x accross the vector\r\n        this.rotation = new Gamelab.Vector(x, x, x);\r\n\r\n      if (typeof this.Transpose == 'function') {\r\n        this.Transpose();\r\n      }\r\n\r\n      return this;\r\n    };\r\n\r\n    obj.Rotate = obj.Rot;\r\n\r\n    obj.Rotation = obj.Rot;\r\n\r\n  }\r\n\r\n  minable(obj) {\r\n    obj.Min = function(x, y, z) {\r\n\r\n      if (typeof(x) == 'object')\r\n        this.min = new Gamelab.Vector(x);\r\n\r\n      else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n        this.min = new Gamelab.Vector(x, y, z);\r\n\r\n      else //use x accross the vector\r\n        this.min = new Gamelab.Vector(x, x, x);\r\n\r\n      return this;\r\n    };\r\n\r\n    obj.Minimum = obj.Min;\r\n\r\n  }\r\n\r\n  maxable(obj) {\r\n    obj.Max = function(x, y, z) {\r\n\r\n      if (typeof(x) == 'object')\r\n        this.max = new Gamelab.Vector(x);\r\n\r\n      else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n        this.max = new Gamelab.Vector(x, y, z);\r\n\r\n      else //use x accross the vector\r\n        this.max = new Gamelab.Vector(x, x, x);\r\n\r\n      return this;\r\n    };\r\n\r\n    obj.Maximum = obj.Max;\r\n\r\n  }\r\n\r\n  boundable(obj) {\r\n    this.minable(obj);\r\n\r\n    this.maxable(obj);\r\n  }\r\n\r\n  selftransposable(obj) {\r\n    //apply the transposition\r\n    obj.Transpose = function(rotation, position) {\r\n\r\n      this.rotation = new Gamelab.Vector(rotation || this.rotation);\r\n\r\n      this.position = new Gamelab.Vector(position || this.position);\r\n\r\n      //TODO: Modify this trig function and its call below to an optional 3D rotation\r\n\r\n      for (var x = 0; x < this.points.length; x++) {\r\n\r\n        var p = this.points[x];\r\n\r\n        var np = Gamelab.Trig.rotate_from_xy(0, 0, p.x, p.y, this.rotation.x);\r\n\r\n        this.points[x] = this.position.add(np);\r\n\r\n      }\r\n      return this;\r\n    };\r\n\r\n  }\r\n\r\n  pointarrayflippable(obj) {\r\n    //apply the transposition\r\n    obj.FlipX = function() {\r\n\r\n      var middle = Math.floor(this.points.length / 2); //account for FlipX with length of --odd number\r\n\r\n      var x, y;\r\n\r\n      for (x = this.points.length - 1, y = 0; x > middle, y < middle; x--, y++) {\r\n\r\n        var p1 = this.points[x],\r\n          p2 = this.points[y];\r\n\r\n        [p1.x, p2.x] = [p2.x, p1.x];\r\n\r\n      }\r\n\r\n      return this;\r\n    };\r\n\r\n\r\n    //apply the transposition\r\n    obj.FlipY = function() {\r\n\r\n      var middle = Math.floor(this.points.length / 2); //account for FlipX with length of --odd number\r\n\r\n      var x, y;\r\n\r\n      for (x = this.points.length - 1, y = 0; x > middle, y < middle; x--, y++) {\r\n\r\n        var p1 = this.points[x],\r\n          p2 = this.points[y];\r\n\r\n        [p1.y, p2.y] = [p2.y, p1.y];\r\n\r\n      }\r\n\r\n      return this;\r\n    };\r\n\r\n  }\r\n\r\n  informable(obj, args) {\r\n    obj.name = Gamelab.getArg(args, 'name', \"__ObjectName\");\r\n\r\n    obj.description = Gamelab.getArg(args, 'description', false);\r\n\r\n    obj.group = Gamelab.getArg(args, 'group', 'one');\r\n  }\r\n\r\n  tweenable(obj) {\r\n\r\n    obj.curve_string = obj.curve_string || \"linearNone\";\r\n\r\n    obj.setTweenCurve = function(c) {\r\n\r\n      c = c || \"linear_none\";\r\n\r\n      var cps = c.split('_');\r\n\r\n      //alert(cps);\r\n\r\n      var s1 = cps[0].toLowerCase(),\r\n        s2 = cps[1].toLowerCase();\r\n\r\n      var curve = TWEEN.Easing.Linear.None;\r\n\r\n      obj.curve_string = 'linear_none'\r\n\r\n      Gamelab.each(TWEEN.Easing, function(ix, easing) {\r\n\r\n        Gamelab.each(TWEEN.Easing[ix], function(iy, easeType) {\r\n\r\n          if (ix == s1 && iy == s2) {\r\n\r\n            // alert('setting curve');\r\n\r\n            curve = TWEEN.Easing[ix][iy];\r\n\r\n            obj.curve_string = ix + '_' + iy;\r\n\r\n          }\r\n\r\n        });\r\n\r\n      });\r\n\r\n      obj.curve = curve;\r\n\r\n      return curve;\r\n\r\n    };\r\n\r\n    obj.curvesToArray = function() {\r\n\r\n      var c = [];\r\n\r\n      Gamelab.each(TWEEN.Easing, function(ix, easing) {\r\n\r\n        Gamelab.each(easing, function(iy, easeType) {\r\n\r\n          if (['in', 'out', 'inout', 'none'].indexOf(iy.toLowerCase()) >= 0) {\r\n\r\n            c.push(ix + \"_\" + iy);\r\n\r\n          }\r\n\r\n        });\r\n\r\n      });\r\n\r\n      return c;\r\n\r\n    }\r\n  }\r\n\r\n};\r\n\r\nGamelab.FeatureInjectors.CssFeatures = new CssFeatures();\r\n\r\nGamelab.FeatureInjectors.VectorFunctions = new VectorFunctions();\r\n\r\nGamelab.FeatureInjectors.DataFunctions = new DataFunctions();\r\n;/**\r\n * Creates Gamelab.js Canvas: The canvas-renderer for Gamelab games.\r\n\r\n @description\r\n This Canvas library handles the low-level drawing of Gamelab.Animation objects on HTML5Canvas.\r\n -Draws Sprites according to their rotation, size, and properties.\r\n * @returns {CanvasLib} a CanvasLib object.\r\n */\r\n\r\n(function() {\r\n\r\n  console.log('CanvasStack class... creating');\r\n\r\n  class GamelabCanvas {\r\n\r\n    constructor() {\r\n      this.__levelMaker = false;\r\n      //draw is synonymous w/ drawSprite\r\n      this.draw = this.draw_object;\r\n    }\r\n\r\n    isStopped() {\r\n      return Gamelab.stopDraw || false;\r\n    }\r\n\r\n    arc(p1, p2, options = {}) {\r\n\r\n      if (this.isStopped())\r\n        return;\r\n\r\n\r\n      var ctx = Gamelab.game_windows[0].ctx;\r\n\r\n      ctx.strokeStyle = options.strokeStyle || 'aqua';\r\n\r\n      ctx.beginPath();\r\n      ctx.arc(p1.x, p1.y, p2.x, p2.y, Math.PI * 2, true);\r\n      ctx.stroke();\r\n\r\n    }\r\n\r\n    draw_image_frame(image, framePos, frameSize, position, size, rotation, canvasContext, flipX, flipY, origin, globalAlpha, globalComposite) {\r\n\r\n      if (this.isStopped())\r\n        return;\r\n\r\n\r\n      var fx = framePos.x,\r\n        fy = framePos.y,\r\n        fw = frameSize.x,\r\n        fh = frameSize.y,\r\n        x = position.x,\r\n        y = position.y,\r\n        width = size.x,\r\n        height = size.y;\r\n\r\n\r\n      //save canvas state before draw\r\n      canvasContext.save();\r\n\r\n      //degrees rotation:\r\n      var deg = rotation;\r\n      deg = deg % 360;\r\n      var rad = deg * Math.PI / 180;\r\n      //Set the origin to the center of the image\r\n      canvasContext.translate(x, y);\r\n      canvasContext.rotate(rad);\r\n      //Rotate the canvas around the origin\r\n\r\n      canvasContext.translate(0, canvasContext.width);\r\n\r\n      if (flipX) {\r\n        canvasContext.scale(-1, 1);\r\n      } else {\r\n\r\n      }\r\n\r\n      if (flipY) {\r\n        canvasContext.scale(1, -1);\r\n      } else {\r\n\r\n      }\r\n\r\n      origin = origin || new Gamelab.Vector(width / 2, height / 2);\r\n\r\n      canvasContext.globalAlpha = globalAlpha || 1.0;\r\n\r\n      if(globalComposite)\r\n      {\r\n        canvasContext.globalCompositeOperation = globalComposite;\r\n      }\r\n\r\n      //draw the image\r\n      canvasContext.drawImage(image, fx, fy, fw, fh, origin.x * (-1), origin.y * (-1), width, height);\r\n      //reset the canvas\r\n      canvasContext.globalAlpha = 1.0;\r\n      canvasContext.restore();\r\n\r\n    }\r\n\r\n    draw_data(x, y, w, h, data, ctx) {\r\n\r\n      if (this.isStopped())\r\n        return;\r\n\r\n      ctx.putImageData(data, x, y, 0, 0, w, h);\r\n\r\n    }\r\n  }\r\n\r\n\r\n  Gamelab.Canvas = new GamelabCanvas();\r\n\r\n  Gamelab.GamelabCanvas = GamelabCanvas;\r\n\r\n  class OffscreenCanvasRendering {\r\n    constructor(psuedoImage) {\r\n\r\n      this.htmlImage = psuedoImage.domElement || psuedoImage;\r\n\r\n      this.testCanvas = document.createElement(\"CANVAS\");\r\n\r\n      this.testCtx = this.testCanvas.getContext(\"2d\");\r\n\r\n      this.testCanvas.width = this.htmlImage.width;\r\n\r\n      this.testCanvas.height = this.htmlImage.height;\r\n\r\n      this.testCanvas.style.zIndex = '9999';\r\n\r\n      this.testCtx.drawImage(this.htmlImage, 0, 0);\r\n\r\n      return {\r\n        canvas: this.testCanvas,\r\n        ctx: this.testCtx\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  Gamelab.OffscreenCanvasRendering = OffscreenCanvasRendering;\r\n\r\n})();\r\n;if (typeof JSON.decycle !== 'function') {\r\n    JSON.decycle = function decycle(object) {\r\n        \"use strict\";\r\n\r\n        var objects = [],   // Keep a reference to each unique object or array\r\n            paths = [];     // Keep the path to each unique object or array\r\n\r\n        return (function derez(value, path) {\r\n\r\n\r\n            var i,          // The loop counter\r\n                name,       // Property name\r\n                nu;         // The new object or array\r\n\r\n            switch (typeof value) {\r\n            case 'object':\r\n\r\n                if (!value) {\r\n                    return null;\r\n                }\r\n\r\n\r\n                for (i = 0; i < objects.length; i += 1) {\r\n                    if (objects[i] === value) {\r\n                        return {$ref: paths[i]};\r\n                    }\r\n                }\r\n\r\n// Otherwise, accumulate the unique value and its path.\r\n\r\n                objects.push(value);\r\n                paths.push(path);\r\n\r\n// If it is an array, replicate the array.\r\n\r\n                if (Object.prototype.toString.apply(value) === '[object Array]') {\r\n                    nu = [];\r\n                    for (i = 0; i < value.length; i += 1) {\r\n                        nu[i] = derez(value[i], path + '[' + i + ']');\r\n                    }\r\n                } else {\r\n\r\n// If it is an object, replicate the object.\r\n\r\n                    nu = {};\r\n                    for (name in value) {\r\n                        if (Object.prototype.hasOwnProperty.call(value, name)) {\r\n                            nu[name] = derez(value[name],\r\n                                path + '[' + JSON.stringify(name) + ']');\r\n                        }\r\n                    }\r\n                }\r\n                return nu;\r\n            case 'number':\r\n            case 'string':\r\n            case 'boolean':\r\n                return value;\r\n            }\r\n        }(object, '$'));\r\n    };\r\n}\r\n\r\nif (typeof JSON.retrocycle !== 'function') {\r\n    JSON.retrocycle = function retrocycle($) {\r\n        \"use strict\";\r\n\r\n        var px =\r\n            /^\\$(?:\\[(?:\\d?|\\\"(?:[^\\\\\\\"\\u0000-\\u001f]|\\\\([\\\\\\\"\\/bfnrt]|u[0-9a-zA-Z]{4}))*\\\")\\])*$/;\r\n\r\n        (function rez(value) {\r\n\r\n            var i, item, name, path;\r\n\r\n            if (value && typeof value === 'object') {\r\n                if (Object.prototype.toString.apply(value) === '[object Array]') {\r\n                    for (i = 0; i < value.length; i += 1) {\r\n                        item = value[i];\r\n                        if (item && typeof item === 'object') {\r\n                            path = item.$ref;\r\n                            if (typeof path === 'string' && px.test(path)) {\r\n                                value[i] = eval(path);\r\n                            } else {\r\n                                rez(item);\r\n                            }\r\n                        }\r\n                    }\r\n                } else {\r\n                    for (name in value) {\r\n                        if (typeof value[name] === 'object') {\r\n                            item = value[name];\r\n                            if (item) {\r\n                                path = item.$ref;\r\n                                if (typeof path === 'string' && px.test(path)) {\r\n                                    value[name] = eval(path);\r\n                                } else {\r\n                                    rez(item);\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }($));\r\n        return $;\r\n    };\r\n}\r\n\r\nvar json_stringify = JSON.stringify;\r\n\r\nJSON.stringify = function(object, arg2, arg3)\r\n{\r\n  var clean_object = JSON.decycle(object);\r\n  return json_stringify(clean_object, arg2, arg3);\r\n};\r\n\r\nvar json_parse = JSON.parse;\r\n\r\nJSON.parse = function(object, arg2, arg3){\r\n  var retro_object = JSON.retrocycle(object);\r\n  return json_parse(retro_object);\r\n};\r\n;/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\n\r\n/***************\r\n *\r\n * @ignore\r\n *\r\n * *****************/\r\n\r\nvar Stats = function () {\r\n\r\n\tvar mode = 0;\r\n\r\n\tvar container = document.createElement( 'div' );\r\n\tcontainer.style.cssText = 'position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000';\r\n\tcontainer.addEventListener( 'click', function ( event ) {\r\n\r\n\t\tevent.preventDefault();\r\n\t\tshowPanel( ++ mode % container.children.length );\r\n\r\n\t}, false );\r\n\r\n\t//\r\n\r\n\tfunction addPanel( panel ) {\r\n\r\n\t\tcontainer.appendChild( panel.dom );\r\n\t\treturn panel;\r\n\r\n\t}\r\n\r\n\tfunction showPanel( id ) {\r\n\r\n\t\tfor ( var i = 0; i < container.children.length; i ++ ) {\r\n\r\n\t\t\tcontainer.children[ i ].style.display = i === id ? 'block' : 'none';\r\n\r\n\t\t}\r\n\r\n\t\tmode = id;\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tvar beginTime = ( performance || Date ).now(), prevTime = beginTime, frames = 0;\r\n\r\n\tvar fpsPanel = addPanel( new Stats.Panel( 'FPS', '#0ff', '#002' ) );\r\n\tvar msPanel = addPanel( new Stats.Panel( 'MS', '#0f0', '#020' ) );\r\n\r\n\tif ( self.performance && self.performance.memory ) {\r\n\r\n\t\tvar memPanel = addPanel( new Stats.Panel( 'MB', '#f08', '#201' ) );\r\n\r\n\t}\r\n\r\n\tshowPanel( 0 );\r\n\r\n\treturn {\r\n\r\n\t\tREVISION: 16,\r\n\r\n\t\tdom: container,\r\n\r\n\t\taddPanel: addPanel,\r\n\t\tshowPanel: showPanel,\r\n\r\n\t\tbegin: function () {\r\n\r\n\t\t\tbeginTime = ( performance || Date ).now();\r\n\r\n\t\t},\r\n\r\n\t\tend: function () {\r\n\r\n\t\t\tframes ++;\r\n\r\n\t\t\tvar time = ( performance || Date ).now();\r\n\r\n\t\t\tmsPanel.update( time - beginTime, 200 );\r\n\r\n\t\t\tif ( time >= prevTime + 1000 ) {\r\n\r\n\t\t\t\tfpsPanel.update( ( frames * 1000 ) / ( time - prevTime ), 100 );\r\n\r\n\t\t\t\tprevTime = time;\r\n\t\t\t\tframes = 0;\r\n\r\n\t\t\t\tif ( memPanel ) {\r\n\r\n\t\t\t\t\tvar memory = performance.memory;\r\n\t\t\t\t\tmemPanel.update( memory.usedJSHeapSize / 1048576, memory.jsHeapSizeLimit / 1048576 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn time;\r\n\r\n\t\t},\r\n\r\n\t\tupdate: function () {\r\n\r\n\t\t\tbeginTime = this.end();\r\n\r\n\t\t},\r\n\r\n\t\t// Backwards Compatibility\r\n\r\n\t\tdomElement: container,\r\n\t\tsetMode: showPanel\r\n\r\n\t};\r\n\r\n};\r\n\r\nStats.Panel = function ( name, fg, bg ) {\r\n\r\n\tvar min = Infinity, max = 0, round = Math.round;\r\n\tvar PR = round( window.devicePixelRatio || 1 );\r\n\r\n\tvar WIDTH = 80 * PR, HEIGHT = 48 * PR,\r\n\t\t\tTEXT_X = 3 * PR, TEXT_Y = 2 * PR,\r\n\t\t\tGRAPH_X = 3 * PR, GRAPH_Y = 15 * PR,\r\n\t\t\tGRAPH_WIDTH = 74 * PR, GRAPH_HEIGHT = 30 * PR;\r\n\r\n\tvar canvas = document.createElement( 'canvas' );\r\n\tcanvas.width = WIDTH;\r\n\tcanvas.height = HEIGHT;\r\n\tcanvas.style.cssText = 'width:80px;height:48px';\r\n\r\n\tvar context = canvas.getContext( '2d' );\r\n\tcontext.font = 'bold ' + ( 9 * PR ) + 'px Helvetica,Arial,sans-serif';\r\n\tcontext.textBaseline = 'top';\r\n\r\n\tcontext.fillStyle = bg;\r\n\tcontext.fillRect( 0, 0, WIDTH, HEIGHT );\r\n\r\n\tcontext.fillStyle = fg;\r\n\tcontext.fillText( name, TEXT_X, TEXT_Y );\r\n\tcontext.fillRect( GRAPH_X, GRAPH_Y, GRAPH_WIDTH, GRAPH_HEIGHT );\r\n\r\n\tcontext.fillStyle = bg;\r\n\tcontext.globalAlpha = 0.9;\r\n\tcontext.fillRect( GRAPH_X, GRAPH_Y, GRAPH_WIDTH, GRAPH_HEIGHT );\r\n\r\n\treturn {\r\n\r\n\t\tdom: canvas,\r\n\r\n\t\tupdate: function ( value, maxValue ) {\r\n\r\n\t\t\tmin = Math.min( min, value );\r\n\t\t\tmax = Math.max( max, value );\r\n\r\n\t\t\tcontext.fillStyle = bg;\r\n\t\t\tcontext.globalAlpha = 1;\r\n\t\t\tcontext.fillRect( 0, 0, WIDTH, GRAPH_Y );\r\n\t\t\tcontext.fillStyle = fg;\r\n\t\t\tcontext.fillText( round( value ) + ' ' + name + ' (' + round( min ) + '-' + round( max ) + ')', TEXT_X, TEXT_Y );\r\n\r\n\t\t\tcontext.drawImage( canvas, GRAPH_X + PR, GRAPH_Y, GRAPH_WIDTH - PR, GRAPH_HEIGHT, GRAPH_X, GRAPH_Y, GRAPH_WIDTH - PR, GRAPH_HEIGHT );\r\n\r\n\t\t\tcontext.fillRect( GRAPH_X + GRAPH_WIDTH - PR, GRAPH_Y, PR, GRAPH_HEIGHT );\r\n\r\n\t\t\tcontext.fillStyle = bg;\r\n\t\t\tcontext.globalAlpha = 0.9;\r\n\t\t\tcontext.fillRect( GRAPH_X + GRAPH_WIDTH - PR, GRAPH_Y, PR, round( ( 1 - ( value / maxValue ) ) * GRAPH_HEIGHT ) );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n};\r\n;/**\r\n * Tween.js - Licensed under the MIT license\r\n * https://github.com/tweenjs/tween.js\r\n * ----------------------------------------------\r\n *\r\n * See https://github.com/tweenjs/tween.js/graphs/contributors for the full list of contributors.\r\n * Thank you all, you're awesome!\r\n */\r\n\r\n\r\n/*\r\n*\r\n* @ignore\r\n*\r\n* */\r\n\r\nvar TWEEN = TWEEN || (function () {\r\n\r\n\tvar _tweens = [];\r\n\r\n\treturn {\r\n\r\n\t\tgetAll: function () {\r\n\r\n\t\t\treturn _tweens;\r\n\r\n\t\t},\r\n\r\n\t\tremoveAll: function () {\r\n\r\n\t\t\t_tweens = [];\r\n\r\n\t\t},\r\n\r\n\t\tadd: function (tween) {\r\n\r\n\t\t\t_tweens.push(tween);\r\n\r\n\t\t},\r\n\r\n\t\tremove: function (tween) {\r\n\r\n\t\t\tvar i = _tweens.indexOf(tween);\r\n\r\n\t\t\tif (i !== -1) {\r\n\t\t\t\t_tweens.splice(i, 1);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tupdate: function (time, preserve) {\r\n\r\n\t\t\tif (_tweens.length === 0) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tvar i = 0;\r\n\r\n\t\t\ttime = time !== undefined ? time : TWEEN.now();\r\n\r\n\t\t\twhile (i < _tweens.length) {\r\n\r\n\t\t\t\tif (_tweens[i].update(time) || preserve) {\r\n\t\t\t\t\ti++;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t_tweens.splice(i, 1);\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\t};\r\n\r\n})();\r\n\r\n//removed polyfill\r\n\r\nTWEEN.now = Date.now;\r\n\r\nTWEEN.Tween = function (object) {\r\n\r\n\tvar _object = object;\r\n\tvar _valuesStart = {};\r\n\tvar _valuesEnd = {};\r\n\tvar _valuesStartRepeat = {};\r\n\tvar _duration = 1000;\r\n\tvar _repeat = 0;\r\n\tvar _repeatDelayTime;\r\n\tvar _yoyo = false;\r\n\tvar _isPlaying = false;\r\n\tvar _reversed = false;\r\n\tvar _delayTime = 0;\r\n\tvar _startTime = null;\r\n\tvar _easingFunction = TWEEN.Easing.Linear.None;\r\n\tvar _interpolationFunction = TWEEN.Interpolation.Linear;\r\n\tvar _chainedTweens = [];\r\n\tvar _onStartCallback = null;\r\n\tvar _onStartCallbackFired = false;\r\n\tvar _onUpdateCallback = null;\r\n\tvar _onCompleteCallback = null;\r\n\tvar _onStopCallback = null;\r\n\r\n\t// Set all starting values present on the target object\r\n\tfor (var field in object) {\r\n\t\t_valuesStart[field] = parseFloat(object[field], 10);\r\n\t}\r\n\r\n\tthis.to = function (properties, duration) {\r\n\r\n\t\tif (duration !== undefined) {\r\n\t\t\t_duration = duration;\r\n\t\t}\r\n\r\n\t\t_valuesEnd = properties;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.start = function (time) {\r\n\r\n\t\tTWEEN.add(this);\r\n\r\n\t\t_isPlaying = true;\r\n\r\n\t\t_onStartCallbackFired = false;\r\n\r\n\t\t_startTime = time !== undefined ? time : TWEEN.now();\r\n\t\t_startTime += _delayTime;\r\n\r\n\t\tfor (var property in _valuesEnd) {\r\n\r\n\t\t\t// Check if an Array was provided as property value\r\n\t\t\tif (_valuesEnd[property] instanceof Array) {\r\n\r\n\t\t\t\tif (_valuesEnd[property].length === 0) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Create a local copy of the Array with the start value at the front\r\n\t\t\t\t_valuesEnd[property] = [_object[property]].concat(_valuesEnd[property]);\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// If `to()` specifies a property that doesn't exist in the source object,\r\n\t\t\t// we should not set that property in the object\r\n\t\t\tif (_object[property] === undefined) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\t_valuesStart[property] = _object[property];\r\n\r\n\t\t\tif ((_valuesStart[property] instanceof Array) === false) {\r\n\t\t\t\t_valuesStart[property] *= 1.0; // Ensures we're using numbers, not strings\r\n\t\t\t}\r\n\r\n\t\t\t_valuesStartRepeat[property] = _valuesStart[property] || 0;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.stop = function () {\r\n\r\n\t\tif (!_isPlaying) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tTWEEN.remove(this);\r\n\t\t_isPlaying = false;\r\n\r\n\t\tif (_onStopCallback !== null) {\r\n\t\t\t_onStopCallback.call(_object, _object);\r\n\t\t}\r\n\r\n\t\tthis.stopChainedTweens();\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.end = function () {\r\n\r\n\t\tthis.update(_startTime + _duration);\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.stopChainedTweens = function () {\r\n\r\n\t\tfor (var i = 0, numChainedTweens = _chainedTweens.length; i < numChainedTweens; i++) {\r\n\t\t\t_chainedTweens[i].stop();\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.delay = function (amount) {\r\n\r\n\t\t_delayTime = amount;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.repeat = function (times) {\r\n\r\n\t\t_repeat = times;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.repeatDelay = function (amount) {\r\n\r\n\t\t_repeatDelayTime = amount;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.yoyo = function (yoyo) {\r\n\r\n\t\t_yoyo = yoyo;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\r\n\tthis.easing = function (easing) {\r\n\r\n\t\t_easingFunction = easing;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.interpolation = function (interpolation) {\r\n\r\n\t\t_interpolationFunction = interpolation;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.chain = function () {\r\n\r\n\t\t_chainedTweens = arguments;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.onStart = function (callback) {\r\n\r\n\t\t_onStartCallback = callback;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.onUpdate = function (callback) {\r\n\r\n\t\t_onUpdateCallback = callback;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.onComplete = function (callback) {\r\n\r\n\t\t_onCompleteCallback = callback;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.onStop = function (callback) {\r\n\r\n\t\t_onStopCallback = callback;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.update = function (time) {\r\n\r\n\t\tvar property;\r\n\t\tvar elapsed;\r\n\t\tvar value;\r\n\r\n\t\tif (time < _startTime) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tif (_onStartCallbackFired === false) {\r\n\r\n\t\t\tif (_onStartCallback !== null) {\r\n\t\t\t\t_onStartCallback.call(_object, _object);\r\n\t\t\t}\r\n\r\n\t\t\t_onStartCallbackFired = true;\r\n\t\t}\r\n\r\n\t\telapsed = (time - _startTime) / _duration;\r\n\t\telapsed = elapsed > 1 ? 1 : elapsed;\r\n\r\n\t\tvalue = _easingFunction(elapsed);\r\n\r\n\t\tfor (property in _valuesEnd) {\r\n\r\n\t\t\t// Don't update properties that do not exist in the source object\r\n\t\t\tif (_valuesStart[property] === undefined) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tvar start = _valuesStart[property] || 0;\r\n\t\t\tvar end = _valuesEnd[property];\r\n\r\n\t\t\tif (end instanceof Array) {\r\n\r\n\t\t\t\t_object[property] = _interpolationFunction(end, value);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// Parses relative end values with start as base (e.g.: +10, -3)\r\n\t\t\t\tif (typeof (end) === 'string') {\r\n\r\n\t\t\t\t\tif (end.charAt(0) === '+' || end.charAt(0) === '-') {\r\n\t\t\t\t\t\tend = start + parseFloat(end, 10);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tend = parseFloat(end, 10);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Protect against non numeric properties.\r\n\t\t\t\tif (typeof (end) === 'number') {\r\n\t\t\t\t\t_object[property] = start + (end - start) * value;\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif (_onUpdateCallback !== null) {\r\n\t\t\t_onUpdateCallback.call(_object, value);\r\n\t\t}\r\n\r\n\t\tif (elapsed === 1) {\r\n\r\n\t\t\tif (_repeat > 0) {\r\n\r\n\t\t\t\tif (isFinite(_repeat)) {\r\n\t\t\t\t\t_repeat--;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Reassign starting values, restart by making startTime = now\r\n\t\t\t\tfor (property in _valuesStartRepeat) {\r\n\r\n\t\t\t\t\tif (typeof (_valuesEnd[property]) === 'string') {\r\n\t\t\t\t\t\t_valuesStartRepeat[property] = _valuesStartRepeat[property] + parseFloat(_valuesEnd[property], 10);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (_yoyo) {\r\n\t\t\t\t\t\tvar tmp = _valuesStartRepeat[property];\r\n\r\n\t\t\t\t\t\t_valuesStartRepeat[property] = _valuesEnd[property];\r\n\t\t\t\t\t\t_valuesEnd[property] = tmp;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t_valuesStart[property] = _valuesStartRepeat[property];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (_yoyo) {\r\n\t\t\t\t\t_reversed = !_reversed;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (_repeatDelayTime !== undefined) {\r\n\t\t\t\t\t_startTime = time + _repeatDelayTime;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t_startTime = time + _delayTime;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif (_onCompleteCallback !== null) {\r\n\r\n\t\t\t\t\t_onCompleteCallback.call(_object, _object);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (var i = 0, numChainedTweens = _chainedTweens.length; i < numChainedTweens; i++) {\r\n\t\t\t\t\t// Make the chained tweens start exactly at the time they should,\r\n\t\t\t\t\t// even if the `update()` method was called way past the duration of the tween\r\n\t\t\t\t\t_chainedTweens[i].start(_startTime + _duration);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t};\r\n\r\n};\r\n\r\n\r\nTWEEN.Easing = {\r\n\r\n\tLinear: {\r\n\r\n\t\tNone: function (k) {\r\n\r\n\t\t\treturn k;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tQuadratic: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\treturn k * k;\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\treturn k * (2 - k);\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tif ((k *= 2) < 1) {\r\n\t\t\t\treturn 0.5 * k * k;\r\n\t\t\t}\r\n\r\n\t\t\treturn - 0.5 * (--k * (k - 2) - 1);\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tCubic: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\treturn k * k * k;\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\treturn --k * k * k + 1;\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tif ((k *= 2) < 1) {\r\n\t\t\t\treturn 0.5 * k * k * k;\r\n\t\t\t}\r\n\r\n\t\t\treturn 0.5 * ((k -= 2) * k * k + 2);\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tQuartic: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\treturn k * k * k * k;\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\treturn 1 - (--k * k * k * k);\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tif ((k *= 2) < 1) {\r\n\t\t\t\treturn 0.5 * k * k * k * k;\r\n\t\t\t}\r\n\r\n\t\t\treturn - 0.5 * ((k -= 2) * k * k * k - 2);\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tQuintic: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\treturn k * k * k * k * k;\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\treturn --k * k * k * k * k + 1;\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tif ((k *= 2) < 1) {\r\n\t\t\t\treturn 0.5 * k * k * k * k * k;\r\n\t\t\t}\r\n\r\n\t\t\treturn 0.5 * ((k -= 2) * k * k * k * k + 2);\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tSinusoidal: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\treturn 1 - Math.cos(k * Math.PI / 2);\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\treturn Math.sin(k * Math.PI / 2);\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\treturn 0.5 * (1 - Math.cos(Math.PI * k));\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tExponential: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\treturn k === 0 ? 0 : Math.pow(1024, k - 1);\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\treturn k === 1 ? 1 : 1 - Math.pow(2, - 10 * k);\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tif (k === 0) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\r\n\t\t\tif (k === 1) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\r\n\t\t\tif ((k *= 2) < 1) {\r\n\t\t\t\treturn 0.5 * Math.pow(1024, k - 1);\r\n\t\t\t}\r\n\r\n\t\t\treturn 0.5 * (- Math.pow(2, - 10 * (k - 1)) + 2);\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tCircular: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\treturn 1 - Math.sqrt(1 - k * k);\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\treturn Math.sqrt(1 - (--k * k));\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tif ((k *= 2) < 1) {\r\n\t\t\t\treturn - 0.5 * (Math.sqrt(1 - k * k) - 1);\r\n\t\t\t}\r\n\r\n\t\t\treturn 0.5 * (Math.sqrt(1 - (k -= 2) * k) + 1);\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tElastic: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\tif (k === 0) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\r\n\t\t\tif (k === 1) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\r\n\t\t\treturn -Math.pow(2, 10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI);\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\tif (k === 0) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\r\n\t\t\tif (k === 1) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\r\n\t\t\treturn Math.pow(2, -10 * k) * Math.sin((k - 0.1) * 5 * Math.PI) + 1;\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tif (k === 0) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\r\n\t\t\tif (k === 1) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\r\n\t\t\tk *= 2;\r\n\r\n\t\t\tif (k < 1) {\r\n\t\t\t\treturn -0.5 * Math.pow(2, 10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI);\r\n\t\t\t}\r\n\r\n\t\t\treturn 0.5 * Math.pow(2, -10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI) + 1;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tBack: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\tvar s = 1.70158;\r\n\r\n\t\t\treturn k * k * ((s + 1) * k - s);\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\tvar s = 1.70158;\r\n\r\n\t\t\treturn --k * k * ((s + 1) * k + s) + 1;\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tvar s = 1.70158 * 1.525;\r\n\r\n\t\t\tif ((k *= 2) < 1) {\r\n\t\t\t\treturn 0.5 * (k * k * ((s + 1) * k - s));\r\n\t\t\t}\r\n\r\n\t\t\treturn 0.5 * ((k -= 2) * k * ((s + 1) * k + s) + 2);\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tBounce: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\treturn 1 - TWEEN.Easing.Bounce.Out(1 - k);\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\tif (k < (1 / 2.75)) {\r\n\t\t\t\treturn 7.5625 * k * k;\r\n\t\t\t} else if (k < (2 / 2.75)) {\r\n\t\t\t\treturn 7.5625 * (k -= (1.5 / 2.75)) * k + 0.75;\r\n\t\t\t} else if (k < (2.5 / 2.75)) {\r\n\t\t\t\treturn 7.5625 * (k -= (2.25 / 2.75)) * k + 0.9375;\r\n\t\t\t} else {\r\n\t\t\t\treturn 7.5625 * (k -= (2.625 / 2.75)) * k + 0.984375;\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tif (k < 0.5) {\r\n\t\t\t\treturn TWEEN.Easing.Bounce.In(k * 2) * 0.5;\r\n\t\t\t}\r\n\r\n\t\t\treturn TWEEN.Easing.Bounce.Out(k * 2 - 1) * 0.5 + 0.5;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nTWEEN.Interpolation = {\r\n\r\n\tLinear: function (v, k) {\r\n\r\n\t\tvar m = v.length - 1;\r\n\t\tvar f = m * k;\r\n\t\tvar i = Math.floor(f);\r\n\t\tvar fn = TWEEN.Interpolation.Utils.Linear;\r\n\r\n\t\tif (k < 0) {\r\n\t\t\treturn fn(v[0], v[1], f);\r\n\t\t}\r\n\r\n\t\tif (k > 1) {\r\n\t\t\treturn fn(v[m], v[m - 1], m - f);\r\n\t\t}\r\n\r\n\t\treturn fn(v[i], v[i + 1 > m ? m : i + 1], f - i);\r\n\r\n\t},\r\n\r\n\tBezier: function (v, k) {\r\n\r\n\t\tvar b = 0;\r\n\t\tvar n = v.length - 1;\r\n\t\tvar pw = Math.pow;\r\n\t\tvar bn = TWEEN.Interpolation.Utils.Bernstein;\r\n\r\n\t\tfor (var i = 0; i <= n; i++) {\r\n\t\t\tb += pw(1 - k, n - i) * pw(k, i) * v[i] * bn(n, i);\r\n\t\t}\r\n\r\n\t\treturn b;\r\n\r\n\t},\r\n\r\n\tCatmullRom: function (v, k) {\r\n\r\n\t\tvar m = v.length - 1;\r\n\t\tvar f = m * k;\r\n\t\tvar i = Math.floor(f);\r\n\t\tvar fn = TWEEN.Interpolation.Utils.CatmullRom;\r\n\r\n\t\tif (v[0] === v[m]) {\r\n\r\n\t\t\tif (k < 0) {\r\n\t\t\t\ti = Math.floor(f = m * (1 + k));\r\n\t\t\t}\r\n\r\n\t\t\treturn fn(v[(i - 1 + m) % m], v[i], v[(i + 1) % m], v[(i + 2) % m], f - i);\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif (k < 0) {\r\n\t\t\t\treturn v[0] - (fn(v[0], v[0], v[1], v[1], -f) - v[0]);\r\n\t\t\t}\r\n\r\n\t\t\tif (k > 1) {\r\n\t\t\t\treturn v[m] - (fn(v[m], v[m], v[m - 1], v[m - 1], f - m) - v[m]);\r\n\t\t\t}\r\n\r\n\t\t\treturn fn(v[i ? i - 1 : 0], v[i], v[m < i + 1 ? m : i + 1], v[m < i + 2 ? m : i + 2], f - i);\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tUtils: {\r\n\r\n\t\tLinear: function (p0, p1, t) {\r\n\r\n\t\t\treturn (p1 - p0) * t + p0;\r\n\r\n\t\t},\r\n\r\n\t\tBernstein: function (n, i) {\r\n\r\n\t\t\tvar fc = TWEEN.Interpolation.Utils.Factorial;\r\n\r\n\t\t\treturn fc(n) / fc(i) / fc(n - i);\r\n\r\n\t\t},\r\n\r\n\t\tFactorial: (function () {\r\n\r\n\t\t\tvar a = [1];\r\n\r\n\t\t\treturn function (n) {\r\n\r\n\t\t\t\tvar s = 1;\r\n\r\n\t\t\t\tif (a[n]) {\r\n\t\t\t\t\treturn a[n];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (var i = n; i > 1; i--) {\r\n\t\t\t\t\ts *= i;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ta[n] = s;\r\n\t\t\t\treturn s;\r\n\r\n\t\t\t};\r\n\r\n\t\t})(),\r\n\r\n\t\tCatmullRom: function (p0, p1, p2, p3, t) {\r\n\r\n\t\t\tvar v0 = (p2 - p0) * 0.5;\r\n\t\t\tvar v1 = (p3 - p1) * 0.5;\r\n\t\t\tvar t2 = t * t;\r\n\t\t\tvar t3 = t * t2;\r\n\r\n\t\t\treturn (2 * p1 - 2 * p2 + v0 + v1) * t3 + (- 3 * p1 + 3 * p2 - 2 * v0 - v1) * t2 + v0 * t + p1;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n\r\n\r\n\r\n//Attach to the global Gamelab object\r\n\r\n/***************\r\n *\r\n * @memberOf Gamelab\r\n *\r\n * *****************/\r\n\r\nGamelab.TWEEN = TWEEN;\r\n\r\n\r\n/*\r\n\r\n// UMD (Universal Module Definition)\r\n(function (root) {\r\n\r\n    if (typeof define === 'function' && define.amd) {\r\n\r\n        // AMD\r\n        define([], function () {\r\n            return TWEEN;\r\n        });\r\n\r\n    } else if (typeof module !== 'undefined' && typeof exports === 'object') {\r\n\r\n        // Node.js\r\n        module.exports = TWEEN;\r\n\r\n    } else if (root !== undefined) {\r\n\r\n        // Global variable\r\n        root.TWEEN = TWEEN;\r\n\r\n    }\r\n\r\n})(this);\r\n\r\n*/\r\n;\n//Call Gamelab.FeatureInject::\n\nGamelab.FeatureInject();\n\n\n// UMD (Universal Module Definition)\n(function (root) {\n\n    if (typeof define === 'function' && define.amd) {\n\n        // AMD\n        define([], function () {\n            return Gamelab;\n        });\n\n    } else if (typeof module !== 'undefined' && typeof exports === 'object') {\n\n        // Node.js\n        module.exports = Gamelab;\n\n    } else if (root !== undefined) {\n\n        // Global variable\n        root.Gamelab = Gamelab;\n\n    }\n\n})(this);\n"]}