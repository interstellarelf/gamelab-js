{"version":3,"sources":["../../src/__concat/gamelab.three.js"],"names":["console","dev","tag","object","psuedoType","constructor","name","Gamelab","DEV","info","data_type","delay","f","duration","setTimeout","repeat","setInterval","Gamelab_Module","module","settings","DEBUG","gui_mode","recursionCount","errorLimit","errors","stopDraw","defSize","WIDTH","document","body","clientWidth","HEIGHT","clientHeight","getGameWindow","ix","game_windows","gs_renderables","gs_events","spriteTypes","systemSpriteTypes","__gameWindowList","all","all_objects","forEach","item","concat","drawables","init","testSquare","Sprite","objectDestroyed","obj","dead","x","gw","y","objects","getObjectById","id","length","interlog","message","div","isNaN","create_id","S4","Math","random","toString","substring","error","quit","Error","m","log","initializers","addInitializer","i","push","Collision","boxesCollide","pos1","size1","pos2","size2","spriteBoxesCollide","obj1","obj2","camPos","Vector","padding","paddingX","round","size","paddingY","left","position","right","top","bottom","spriteBoxesCollideTop","pixelsCollide","sourceSprite","targetSprite","hitBox","source","target","height","width","pixelMap","selected_animation","s","sourcePixel","sourceArea","relatedPixel","t","targetPixel","targetArea","_gameWindow","setGameWindow","gameWindow","ExtendEvents","extendedObject","extendedKey","extendor","extendorKey","evtLink","GSEventLink","parent","onRun","onComplete","assignAll","args","keys","__gamelabInstance","each","list","onResult","ready_callstack","ready","callback","reload","callReady","funx","call","InputSystem","__running","getArg","fallback","k","hasOwnProperty","normalArgs","a","normal","str","toLowerCase","replace","isNormalStringMatch","str1","str2","instance_type_pairs","objectList","constructor_name","type","getById","select","group","query","__inst","GamelabApi","get","post","contents","jstr","GSO","run_ext","complete_ext","caller","callkey","indexOf","exports","JSON","stringify","$Q","selector","Array","mainSelector","before","trim","msfChar","__targetClassName","output","cleanSelectorString","after","criterion","between","cparts","split","__targetGroup","__targetName","getParts","on","evt_key","selectorObject","controller_ix","boolTrigger","boolCall","boolEvent","BoolEvent","On","Call","evt_profile","cix","contains_any","button_mode","GamepadAdapter","item1","iy","item2","onUpdate","update","sprite","hasBoxCollision","condition","key","evt_parts","run","mykey","number","parseFloat","e","propkey","spr","complete","c1","test_str","start_pos","end_pos","contains","contains_all","cList","c2","test_selector_method","Q_TestStrings","test","Mouse","Position","Speed","setPosition","isIdle","speed","events","mousemove","mousepos","leftclick","rightclick","middleclick","wheelup","wheelDown","keymap","keyReplace","String","fromCharCode","extendKey","onFinish","down","extend","downCall","upCall","up","MOUSE","window","im","kmapItem","onkeydown","onkeyup","event","gs_key_string","keyCode","evt_object","canvases","querySelectorAll","getMousePos","c","pageX","pageY","clientX","scrollLeft","documentElement","clientY","scrollTop","offsetLeft","style","mouseMoving","pos","el","applyMouseMove","addEventListener","onmousedown","value","which","preventDefault","onmouseup","file_system","localizedSource","src","hostUrl","gs_folder_ix","loadJSON","filepath","readTextFile","file","rawFile","XMLHttpRequest","open","onreadystatechange","readyState","status","allText","responseText","send","loadLevel","jsonText","data","parse","$","sprites","xitem","yitem","iz","zitem","add","loadJSONLevel","lib","Screen","center","EventInterfaceMap","Animation","Motion","Shot","Terrain","Interactive","Global","check","instance","fkey","getOwnPropertyNames","ObjectFeatureMap","Elipse","Frame","Background","Line2d","Text","InputIFM","GamepadButtons","GamepadSticks","Keyboard","MouseMove","MouseButton","MouseWheel","LeapMotion","UIEditables","UIOption","hint","script","UIPrefab","MainSelect","FormEditables","UIPrefabMainSelect","getCustomPrefabMeta","UIObjectPrefabs","Bone","parent_id","origin","rotation","offset","Size","z","onPosition","Rotation","Origin","bind","BoneState","boneList","states","bone","Camera","Curves","linearNone","easeInQuadratic","easeOutQuadratic","easeInOutQuadratic","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuartic","easeOutQuartic","easeInOutQuartic","easeInQuintic","easeOutQuintic","easeInOutQuintic","inOutCurves","quadratic","cubic","quartic","quintic","linear","Smooth","InOut","Game","srcFile","GameWindow","container","HTMLElement","camera","THREE","PerspectiveCamera","innerWidth","innerHeight","scene","Scene","renderer","WebGLRenderer","setSize","appendChild","domElement","update_ext","onresize","isAbsoluteSize","onerror","clearTimeout","geometry","BoxGeometry","material","MeshBasicMaterial","color","cube","Mesh","canvas","__trackStat","def_update","graphic","bool_events","bool","$gamewindow","before_draw_ext","draw","after_draw_ext","boundCall","beforeDraw","afterDraw","w","h","options","optionsGuide","layer","window_offset","GSEvent","apply","splice","background","backgroundColor","$window","life","remove","time","requestAnimationFrame","animate","__stats","begin","__statsMS","__statsMB","isAtPlay","TWEEN","end","Stats","showPanel","dom","setAttribute","parentNode","marginLeft","Module","uri","load","__object","createElement","onload","construct","head","Rectangle","min","max","VectorBounds","VectorFrameBounds","termPoint","GeoMath","rotatePointsXY","angle","theta","PI","point","cos","sin","Renderable","GameImage","onCreate","I","__error","Script","Scriptable","siblings","url","MOD","Pos","halfX","halfY","Canvas","arc","SpatialPattern","unitSize","basicGridChunk","m1","m2","chunk","FromData","target_x","target_y","onLoad","Trigonometry","rotate_from_xy","cx","cy","radians","nx","ny","find_point_on_circle","radius","degrees","Trig","Curve_ToComplete","log_it","sub_tag","In","Out","Seamless","linkedCurves","Twix","Linear","None","Quadratic","Cubic","Quartic","Quintic","Sine","Cosine","Tangent","Exponential","LinkedCurves","TranceCurves","power","Power","TrigFunctions","SpecialFunctions","Sawtooth","Square","Triangle","Floor","Sign","core","XYFunctions","SigmaFunctions","GammaFunctions","r","copied","valid_check","undefined","v","abs","floor","ceil","dist","sub","sqrt","v1","v2","minFloat","maxFloat","mult","p1","p2","atan2","minimize","key1","key2","maximize","Vector3","Vector2","Vector2d","Vector2D","VectorMath","WebGL","querySelector","threejs","append","light","AmbientLight","__WebGL","ctx","render","WebGl","RGBAColor","g","b","ColorStrings","match","RE_RGB","RE_RGBA","parseInt","sumOfSquares","pow","tolerance","matches","total_diff","diff","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","map_orange","map_green","map_red","map_blue","map_darkgreen","map_yellow","map_aqua","map_grey","map_gray","map_darkgrey","map_darkgray","map_black","Colors","PixelMapColors","fromString","MouseMoveEvent","Callback","cb","MousePosEvent","MouseLeftClickEvent","MouseRightClickEvent","child_id","parent_key","child_key","InputEvent","btnix","button_ix","gpix","gamepad_ix","six","stickix","stick_ix","inputKey","keyboardKeys","Larva","arrayWrap","keyitem","KeyboardEvent","GamepadEvent","gps","gamepadKeys","CollisionEvent","callbackFunction","$collision","$obj","$sprite","$sib","onBool","boolFunction","Bool","Event","BoxCollisionEvent","framePos","image","fxn","p","frameSize","offscreen","OffscreenCanvasRendering","StoreOffscreen","toDataURL","grid","pixel","getImageData","vector","gridObject","altImage","colorMap","getColoredPixelGrid","testCtx","fullPixelMap","getFullPixelGrid","ControllerEventKeys","left_stick","right_stick","gamepads","__gamepads","intervals","controller_stack","__gamepadMaster","gamepad","index","buttons","axes","mainLoop","clearInterval","navigator","getGamepads","process","game_pad_index","game_pad","gp","stick_left","stick_right","extendFunc","f1","f2","fc","current_cb","parts","gpEvents","process_buttons","process_axes","axis1","axia2","pressed","clearance_1","gpc","bkey","GamepadEvents","Object","points","x_total","out_of_1","next_x","next_y","next_point","save","strokeStyle","beginPath","real_pos","getOffsetPos","moveTo","lineTo","stroke","restore","Line2D","Sound","sound","loop","val","volume","play","SoundList","sounds","Audio","THREE_EXT","defaults","DodecahedronGeometry","detail","SphereGeometry","widthSegments","heightSegments","depth","CylinderGeometry","radiusTop","radiusBottom","TorusGeometry","tube","radialSegments","tubularSegments","Three","preserveDrawingBuffer","alpha","loader","TextureLoader","texture","MeshPhongMaterial","map","__init","mesh","__ServerSideFile","file_upload","relpath","content","frameBounds","singleFrame","frames","clear","pixels","Uint8Array","gl","getContext","readPixels","RGBA","UNSIGNED_BYTE","selected_frame","ImageData","Uint8ClampedArray","Src","HTMLImageElement","visible","frameOffset","apply2DFrames","flipX","timer","seesaw_mode","reverse_frames","$f","parentBone","$frame","init_singleFrame","__isInit","FrameSize","FrameBounds","_hang","minVector","maxVector","termVector","millis","__frametype","Image","fcount","quitLoop","frames_reversed","slice","reverse","pop","sized_Object","getPreferredPropertyByKey","allDefined","canvasObject","ColoredPixelGrid","frameSizeDiv","frame","init_colorMap","engage","call_on_run","tween","Tween","easing","curve","Easing","to","call_on_complete","isComplete","start","continuous","continue","Anime3D","ImageUtils","loadTexture","texture_animator","TextureAnimator","PlaneGeometry","calc3DPointTo2DPoint","vectorOne","set","project","result","Object2D3D","arg1","arg2","screenSize2D","get2DPosition","updateMatrixWorld","setFromMatrixPosition","matrixWorld","get2DSize","widthHalf","context","heightHalf","box","Box3","setFromObject","posX","posY","ScreenSize","Animation3D","vertices","scale","animations","active","SingleFrame","apply_args","img","load_call","load_total","err","description","scripts","motions","particles","shots","init_ext","scrollFactor","noScroll","collision_bounds","acceleration","rot_speed","rot_accel","TweenMotion","GSProton","clone","Anime","anime","DRAWOFFSCREEN","onScreen","draw_current_frame","frameList","camera_pos","targetSize","realWidth","realHeight","realPosition","putImageData","draw_image_frame","flipY","fxlCopy","scaleFloat","fun","boundFun","framesize","__mapSize","mx","my","wth","htw","_obj","Scale","extendedFunc","ef","lineObject","curveKey","motionCurveOptions","line","__crtLineIx","pctFloat","ixChange","truthyPropsPerArray","alt_anime","grid1","selectedFramePixelMap","getCurrentPixelMap","grid2","scaleOf","colliderHighlights","unitMarker","hSprite","collider_highlightsOn","init_pixelCollision","init_colliderHighlights","gridPiece","anime_scale","real_gridPiece_pos","real_gridPiece_size","highlightSprite","hasPixelCollision","boxCollisionSettings","prep_key","animation","bullet","velocity","rot_offset","total","rot_disp","__playerInst","bx","by","bw","bh","shot","rotPlus","subsprite","alert","accel","assertSpeed","amt","prop","rate","target_Position","differential_SpeedMultiple","diff_min_y","diff_min_x","diff_max_y","diff_max_x","dimens","minkey","apart","ct","diffX","distX","overlap_x","diffY","distY","__inAir","overlap_y","collide_stop_x","groundMaxY","file_path","getJSON","decycle","FontSize","FontFamily","fsize","ffamily","fontSize","fontFamily","fillStyle","font","realPos","fillText","text","Appendage","Attachment","GravityForce","subjects","clasticObjects","topClastics","itemx","jumping","flying","accelY","itemy","Force","GForce","BoneSprite","bones","oncreate","Player","arguments","inputDevice","imageOrAnimation","rot_disp_per_unit","growth","curve_growth","curve_key","curve_size","collideables","source_objects","members","rows","cols","flip","fill","approxRows","approxCols","xBacksTotal","yBacksTotal","minX","maxX","minY","maxY","campos","cleanCheck","cancat","Effect","SpriteMove","timeLimit","degreesRotated","Jump","spriteMove","distance","Vault","forward","back","afterEffects","psuedoEffect","Attack","rpsLevel","powerLevel","pLevel","Projectile","object_id","motion_curve","highlighted","collide","numberShots","disp","half","setAnimation","stats","damage","lp","equals","colliders","collision_settings","CollisionSettings","Extendors","collideable","SpriteArray","moves","len","__spriteList","SpriteVerticalChain","extremity","np","SpriteCollider","FeatureSymbol","symbol","Symbol","FeatureInjectors","FeatureInject","GClassFeatures","featureSymbols","hasKey","hasSymbol","props","getProtoFuncs","prototype","CssFeatures","Color","min_color","max_color","Opacity","o","opacity","DataFunctions","Name","n","Description","d","Context","VectorFunctions","collision_callback","onCollide","Rot","Rotate","Transpose","Min","Minimum","Max","Maximum","minable","maxable","FlipX","middle","FlipY","curve_string","setTweenCurve","cps","s1","s2","easeType","curvesToArray","warn","string","obj_all","failed","property","warning","psuedoTypeCheck","psuedotype","throwing","getAllFuncs","filter","__proto__","truthOrDie","exitMessage","findError","propKeys","kill","typeArgsExtract","typeOrHalt","typeOrError","propKey","propValue","Logger","loopDuration","E","msg","halt","L","R","FilterUtils","HSVtoRGB","q","RGBtoHSV","getPixel","pix","clampPixel","haveNextGaussian","nextGaussian","gaussianRandom","triangle","mod","mixColors","rgb1","rgb2","linearInterpolate","bilinearInterpolate","nw","ne","sw","se","m0","r0","g0","b0","a0","r1","g1","b1","a1","r2","g2","b2","a2","r3","g3","b3","a3","tableFilter","inputData","table","convolveFilter","matrix","outputData","rows2","cols2","trace","row","ioffset","moffset","col","iPixel","transformFilter","transformInverse","out","j","srcX","srcY","xWeight","yWeight","rgba","BlurFilter","isDirAnimatable","defaultValues","amount","valueRanges","input","values","width4","qq","qqq","bigB","indexLast","ppixel","pppixel","ppppixel","BrightnessFilter","filterUtils","hsv","rgb","BumpFilter","CircleSmearFilter","density","mix","radius2","numShapes","sx","sy","mixedRGB","l","ContrastFilter","CrossSmearFilter","x1","y1","DiffusionFilter","sinTable","cosTable","transInverse","DitherFilter","levels","sum","direction","er","eg","eb","jx","factor","EdgeFilter","matrixH","matrixV","rh","gh","rv","gv","bv","EmbossFilter","elevation","bumpHeight","width45","pixelScale","bumpPixels","bumpMapWidth","bumpMapHeight","Nx","Ny","Nz","Lx","Ly","Lz","Nz2","NzLz","NdotL","shade","bumpIndex","s3","ExposureFilter","exposure","exp","GainFilter","gain","bias","GammaFilter","GrayscaleFilter","luma","HueFilter","InvertFilter","KaleidoscopeFilter","sides","centerX","centerY","iCenterX","iCenterY","dx","dy","LensDistortionFilter","refraction","x2","y2","rRefraction","z2","xAngle","acos","angle1","angle2","asin","yAngle","LineSmearFilter","sinAngle","cosAngle","x0","y0","incrE","incrNE","ddx","ddy","MaximumFilter","maxR","maxG","maxB","MedianFilter","rList","gList","bList","sortFunc","sort","MinimumFilter","minR","minG","minB","NoiseFilter","monochrome","OilFilter","range","rHistogram","gHistogram","bHistogram","rTotal","gTotal","bTotal","ro","go","bo","ri","gi","bi","OpacityFilter","PinchFilter","PixelationFilter","bPixel","PosterizeFilter","RGBAdjustFilter","SaturationFilter","RW","RG","RB","pR","pG","pB","SawtoothRippleFilter","xAmplitude","yAmplitude","xWavelength","yWavelength","fx","fy","SepiaFilter","SharpenFilter","SineRippleFilter","SolarizeFilter","SparkleFilter","rays","randomness","rayLengths","SquareSmearFilter","ThresholdFilter","threshold","brightness","colorVal","TriangleRippleFilter","TwirlFilter","VignetteFilter","gradient","globalCompositeOperation","createRadialGradient","addColorStop","fillRect","WaterRippleFilter","phase","wavelength","amplitude","distance2","JSManipulate","blur","bump","circlesmear","contrast","crosssmear","diffusion","dither","edge","emboss","gamma","grayscale","hue","invert","kaleidoscope","lensdistortion","linesmear","maximum","median","minimum","noise","oil","pinch","pixelate","posterize","rgbadjust","saturation","sawtoothripple","sepia","sharpen","sineripple","solarize","sparkle","squaresmear","triangleripple","twirl","vignette","waterripple","ImageFilters","GamelabCanvas","__levelMaker","draw_object","isStopped","canvasContext","fw","fh","deg","rad","translate","rotate","drawImage","psuedoImage","htmlImage","testCanvas","zIndex","paths","derez","path","nu","$ref","retrocycle","px","rez","eval","json_stringify","arg3","clean_object","json_parse","retro_object","mode","cssText","children","addPanel","panel","display","beginTime","performance","Date","now","prevTime","fpsPanel","Panel","msPanel","self","memory","memPanel","REVISION","usedJSHeapSize","jsHeapSizeLimit","setMode","fg","bg","Infinity","PR","devicePixelRatio","TEXT_X","TEXT_Y","GRAPH_X","GRAPH_Y","GRAPH_WIDTH","GRAPH_HEIGHT","textBaseline","globalAlpha","maxValue","_tweens","getAll","removeAll","preserve","_object","_valuesStart","_valuesEnd","_valuesStartRepeat","_duration","_repeat","_repeatDelayTime","_yoyo","_isPlaying","_reversed","_delayTime","_startTime","_easingFunction","_interpolationFunction","Interpolation","_chainedTweens","_onStartCallback","_onStartCallbackFired","_onUpdateCallback","_onCompleteCallback","_onStopCallback","field","properties","stop","stopChainedTweens","numChainedTweens","times","repeatDelay","yoyo","interpolation","chain","onStart","onStop","elapsed","charAt","isFinite","tmp","Sinusoidal","Circular","Elastic","Back","Bounce","fn","Utils","Bezier","pw","bn","Bernstein","CatmullRom","p0","Factorial","p3","v0","t2","t3","root","define","amd"],"mappings":"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","file":"gamelab.three.js","sourcesContent":["/**@author\r\n Jordan Blake\r\n * */\r\n\r\n/**@copyright\r\n Copyright 2018\r\n **/\r\n\r\n/**\r\n * Main module-object; references all Gamelab classes.\r\n * */\r\n\r\n\r\nconsole.dev = function(tag, object) {\r\n\r\n  var psuedoType = \"--unknown\";\r\n\r\n  switch (typeof object) {\r\n    case \"string\":\r\n    case \"number\":\r\n    case \"boolean\":\r\n    case \"null\":\r\n      psuedoType = typeof object;\r\n    default:\r\n      {\r\n        if (typeof object == 'object')\r\n          psuedoType = object.constructor.name;\r\n      }\r\n  }\r\n\r\n  if (Gamelab.DEV)\r\n    console.info('gamelab::', tag, {\r\n      data_type: psuedoType,\r\n      object: object\r\n    });\r\n\r\n\r\n};\r\n\r\n\r\nlet delay = function(f, duration) {\r\n  setTimeout(f, duration);\r\n}\r\n\r\n\r\nlet repeat = function(f, duration) {\r\n  setInterval(f, duration);\r\n}\r\n\r\n//Gamelab: the main module object:\r\nlet Gamelab_Module = function() {\r\n\r\n  var module = {\r\n\r\n    settings: {\r\n\r\n      DEBUG: false,\r\n\r\n      gui_mode: true,\r\n\r\n      recursionCount: 0,\r\n\r\n      errorLimit: 20\r\n    },\r\n\r\n    errors: 0,\r\n\r\n    stopDraw:false,\r\n\r\n    defSize() {\r\n      if (this.WIDTH == 0) {\r\n        this.WIDTH = document.body.clientWidth;\r\n      }\r\n\r\n      if (this.HEIGHT == 0) {\r\n        this.HEIGHT = document.body.clientHeight;\r\n      }\r\n\r\n    },\r\n\r\n    getGameWindow(ix = 0) {\r\n      return this.game_windows[0]\r\n    },\r\n\r\n    WIDTH: 0,\r\n\r\n    HEIGHT: 0,\r\n\r\n    game_windows: [],\r\n\r\n    gs_renderables: [],\r\n\r\n    gs_events: [],\r\n\r\n    spriteTypes: [],\r\n\r\n    systemSpriteTypes: ['player', 'enemy', 'background', 'interactive', 'terrain', 'weapon', 'subsprite'],\r\n\r\n    __gameWindowList: [],\r\n\r\n    all: function() {\r\n\r\n      var all_objects = [];\r\n\r\n      this.game_windows.forEach(function(item) {\r\n\r\n        all_objects = all_objects.concat(item.drawables);\r\n\r\n      });\r\n\r\n      console.info('Gamelab.all():', all_objects);\r\n\r\n      return all_objects;\r\n\r\n    },\r\n\r\n    init: function() {\r\n\r\n      this.testSquare = new Gamelab.Sprite();\r\n\r\n    },\r\n\r\n    objectDestroyed(obj) {\r\n      var dead = true;\r\n\r\n      for (var x in this.game_windows) {\r\n        let gw = this.game_windows[x];\r\n\r\n        for (var y in gw.objects) {\r\n          if (gw.objects[y] === obj)\r\n            dead = false;\r\n\r\n        }\r\n      }\r\n\r\n      return dead;\r\n\r\n    },\r\n\r\n    getObjectById(id) {\r\n\r\n      for (var x = 0; x < this.all_objects.length; x++) {\r\n        if (this.all_objects[x].id == id) {\r\n\r\n          return this.all_objects[x];\r\n\r\n        }\r\n      }\r\n    },\r\n\r\n    interlog: function(message, div) //recursive safe :: won't go crazy with recursive logs :: log message every x times this is called\r\n    {\r\n      this.recursionCount++;\r\n\r\n      if (!isNaN(div) && this.settings.recursionCount % div == 0) {\r\n        //   console.log('Interval Log:'+  message);\r\n      }\r\n    },\r\n\r\n\r\n    create_id: function() {\r\n      var S4 = function() {\r\n        return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\r\n      };\r\n      return (S4() + S4() + \"-\" + S4() + \"-\" + S4() + \"-\" + S4() + \"-\" + S4() + S4() + S4());\r\n    },\r\n\r\n\r\n    error: function(quit, message) {\r\n\r\n      if (quit) {\r\n        throw new Error(message);\r\n      } else {\r\n        console.error('E!' + message);\r\n      }\r\n    },\r\n\r\n    info: function(m) {\r\n\r\n      if (Gamelab.DEBUG) {\r\n        console.info('Info:' + m);\r\n      }\r\n    },\r\n\r\n\r\n    log: function(m) {\r\n\r\n      if (Gamelab.DEBUG) {\r\n        console.log('Gamelab:' + m);\r\n      }\r\n    },\r\n\r\n    initializers: [],\r\n\r\n    addInitializer: function(i) {\r\n\r\n      this.initializers.push(i);\r\n\r\n    },\r\n\r\n    Collision: {\r\n\r\n      boxesCollide(pos1, size1, pos2, size2) {\r\n\r\n        return pos1.x >= pos2.x - size1.x &&\r\n          pos1.x <= pos2.x + size2.x &&\r\n          pos1.y >= pos2.y - size1.y &&\r\n          pos1.y <= pos2.y + size2.y;\r\n      },\r\n\r\n      spriteBoxesCollide(obj1, obj2, gw) {\r\n        gw = gw || Gamelab.game_windows[0];\r\n\r\n        var camPos = new Gamelab.Vector(0, 0, 0);\r\n\r\n        obj1.padding = obj1.padding || new Gamelab.Vector(0, 0, 0);\r\n\r\n        var paddingX = Math.round(obj1.padding.x * obj1.size.x),\r\n\r\n          paddingY = Math.round(obj1.padding.y * obj1.size.y),\r\n          left = obj1.position.x + paddingX + camPos.x,\r\n\r\n          right = obj1.position.x + obj1.size.x - paddingX + camPos.x,\r\n\r\n          top = obj1.position.y + camPos.y + paddingY,\r\n          bottom = obj1.position.y + obj1.size.y - paddingY + camPos.y;\r\n\r\n        if (right > obj2.position.x && left < obj2.position.x + obj2.size.x &&\r\n          bottom > obj2.position.y && top < obj2.position.y + obj2.size.y) {\r\n\r\n          return true;\r\n\r\n        }\r\n\r\n      },\r\n\r\n      spriteBoxesCollideTop(obj1, obj2, gw) {\r\n        gw = gw || Gamelab.game_windows[0];\r\n\r\n        var camPos = new Gamelab.Vector(0, 0, 0);\r\n\r\n        obj1.padding = obj1.padding || new Gamelab.Vector(0, 0, 0);\r\n\r\n        var paddingX = Math.round(obj1.padding.x * obj1.size.x),\r\n\r\n          paddingY = Math.round(obj1.padding.y * obj1.size.y),\r\n          left = obj1.position.x + paddingX + camPos.x,\r\n\r\n          right = obj1.position.x + obj1.size.x - paddingX + camPos.x,\r\n\r\n          top = obj1.position.y + camPos.y + paddingY,\r\n          bottom = obj1.position.y + obj1.size.y - paddingY + camPos.y;\r\n\r\n        if (right > obj2.position.x && left < obj2.position.x + obj2.size.x &&\r\n          bottom > obj2.position.y && top < obj2.position.y + obj2.size.y\r\n        ) {\r\n\r\n          return true;\r\n\r\n        }\r\n\r\n      },\r\n\r\n      /*\r\n       *\r\n       *  ##Not known to be working -->> Below function\r\n       *\r\n       * */\r\n\r\n      pixelsCollide(sourceSprite, targetSprite, gw) {\r\n        gw = gw || Gamelab.game_windows[0];\r\n\r\n        var camPos = new Gamelab.Vector(0, 0, 0);\r\n\r\n        /* Box model detection, return true on collision */\r\n        function hitBox(source, target) {\r\n          /* Source and target objects contain x, y and width, height */\r\n          return !(\r\n            ((source.y + source.height) < (target.y)) ||\r\n            (source.y > (target.y + target.height)) ||\r\n            ((source.x + source.width) < target.x) ||\r\n            (source.x > (target.x + target.width))\r\n          );\r\n        }\r\n\r\n        var source = {\r\n\r\n            position: sourceSprite.position,\r\n\r\n            pixelMap: sourceSprite.selected_animation.pixelMap\r\n\r\n          },\r\n\r\n          target = {\r\n\r\n            position: targetSprite.position,\r\n\r\n            pixelMap: targetSprite.selected_animation.pixelMap\r\n\r\n          };\r\n\r\n        // Loop through all the pixels in the source image\r\n        for (var s = 0; s < source.pixelMap.length; s++) {\r\n          var sourcePixel = source.pixelMap[s];\r\n          // Add positioning offset\r\n          var sourceArea = {\r\n            x: sourcePixel.x + sourceSprite.position.x,\r\n            y: sourcePixel.y + sourceSprite.position.y,\r\n            width: 1,\r\n            height: 1\r\n          };\r\n\r\n          var relatedPixel;\r\n\r\n          // Loop through all the pixels in the target image\r\n          for (var t = 0; t < target.pixelMap.length; t++) {\r\n            var targetPixel = target.pixelMap[t];\r\n            // Add positioning offset\r\n            var targetArea = {\r\n              x: targetPixel.x + targetSprite.position.x,\r\n              y: targetPixel.y + targetSprite.position.y,\r\n              width: 1,\r\n              height: 1\r\n            };\r\n\r\n            /* Use the earlier aforementioned hitbox function */\r\n            if (hitBox(sourceArea, targetArea)) {\r\n              return true;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    },\r\n\r\n    _gameWindow: {},\r\n\r\n    setGameWindow: function(gameWindow) {\r\n      this._gameWindow = gameWindow;\r\n    },\r\n\r\n    ExtendEvents: function(extendedObject, extendedKey, extendor, extendorKey) {\r\n      var evtLink = new GSEventLink(extendedObject, extendedKey, extendor, extendorKey);\r\n\r\n      this.all_objects.push(new GSEventLink(extendedObject, extendedKey, extendor, extendorKey));\r\n\r\n      var parent = extendedObject;\r\n\r\n      // console.log(parent);\r\n\r\n      if (parent) {\r\n        console.log('Gamelab:EXTENDING EVENTS:' + extendedKey + \":\" + extendorKey);\r\n\r\n        if (parent.onRun) //Any extendable object has an onRun ... OR\r\n        {\r\n          parent.onRun(extendor, extendorKey);\r\n\r\n        }\r\n        if (parent.onComplete) //object has an onComplete\r\n        {\r\n          parent.onComplete(extendor, extendorKey);\r\n\r\n        }\r\n\r\n\r\n      }\r\n\r\n    },\r\n\r\n\r\n    assignAll: function(object, args, keys) {\r\n\r\n      __gamelabInstance.each(keys, function(ix, item) {\r\n\r\n        object[ix] = args[ix];\r\n\r\n      });\r\n\r\n    },\r\n\r\n\r\n    each: function(list, onResult, onComplete) {\r\n      for (var i in list) {\r\n        onResult(i, list[i]);\r\n      }\r\n\r\n      if (typeof(onComplete) === 'function') {\r\n        onComplete(false, list)\r\n      };\r\n\r\n    },\r\n\r\n    ready_callstack: [],\r\n\r\n    ready: function(callback) {\r\n\r\n      this.ready_callstack.push(callback);\r\n\r\n    },\r\n    reload: function() {\r\n\r\n      this.callReady();\r\n\r\n    },\r\n\r\n    callReady: function() {\r\n\r\n      var funx = this.ready_callstack;\r\n\r\n      var gameWindow = this.game_windows[0],\r\n        module = this;\r\n\r\n      //call every function in the ready_callstack\r\n\r\n      this.each(funx, function(ix, call) {\r\n\r\n        call(module, gameWindow);\r\n\r\n      });\r\n\r\n      this.InputSystem.init();\r\n\r\n      this.__running = true;\r\n\r\n    },\r\n\r\n    getArg: function(args, keys, fallback) {\r\n\r\n      if (typeof(keys) == 'string') {\r\n        keys = [keys]; //always array\r\n      }\r\n      for (var x = 0; x < keys.length; x++) {\r\n        var k = keys[x];\r\n\r\n        if (args && args.hasOwnProperty(k)) {\r\n          return args[k]; //return first argument match\r\n        }\r\n      }\r\n      return fallback;\r\n    },\r\n\r\n    normalArgs: function(args) {\r\n\r\n      var a = {};\r\n\r\n      function normal(str) {\r\n        return str.toLowerCase().replace('-', '').replace(' ', '').replace('_', '')\r\n      };\r\n\r\n      for (var x in args) {\r\n        a[normal(x)] = args[x];\r\n      }\r\n\r\n      return a;\r\n    },\r\n\r\n    isNormalStringMatch: function(str1, str2) {\r\n\r\n      return str1.toLowerCase().replace(' ', '') == str2.toLowerCase().replace(' ', '');\r\n\r\n    },\r\n\r\n    instance_type_pairs: function() {\r\n\r\n      //get an array of all instance/type pairs added to the library\r\n\r\n      //example : [ {constructor_name:Sprite, type:enemy_basic}, {constructor_name:Animation, type:enemy_attack}  ];\r\n\r\n      var objectList = [];\r\n\r\n      this.each(this.all_objects, function(ix, item) {\r\n\r\n        objectList.push({\r\n          constructor_name: item.constructor.name,\r\n          type: item.type\r\n        });\r\n\r\n      });\r\n\r\n      return objectList;\r\n\r\n    },\r\n\r\n    getById: function(id) {\r\n\r\n      for (var x in this.all_objects) {\r\n        if (this.all_objects[x].id == id) {\r\n          return this.all_objects[x];\r\n\r\n        }\r\n\r\n      }\r\n\r\n    },\r\n\r\n    select: function(constructor_name, name, group /*ignoring spaces and CAPS/CASE on type match*/ ) {\r\n\r\n      var query = [];\r\n\r\n      var __inst = this;\r\n\r\n      this.each(Gamelab.all(), function(ix, item) {\r\n\r\n        if (constructor_name == '*' || item.constructor.name == constructor_name) {\r\n\r\n          if (group == '*' || __inst.isNormalStringMatch(group, item.group)) {\r\n\r\n            if (name == '*' || __inst.isNormalStringMatch(name, item.name)) {\r\n\r\n              query.push(item);\r\n\r\n            }\r\n          }\r\n        }\r\n      });\r\n\r\n      return query;\r\n    }\r\n  }\r\n\r\n  return module;\r\n\r\n};\r\n\r\nlet GamelabApi = {\r\n  get: function() {\r\n\r\n\r\n  },\r\n\r\n  post: function(object) {\r\n    //TODO decycle the object before saving\r\n\r\n    if (!object.id) {\r\n      object.id = Gamelab.create_id();\r\n\r\n    }\r\n\r\n    var name = object.name,\r\n      type = object.constructor.name,\r\n      contents = jstr(object),\r\n      id = object.id;\r\n\r\n\r\n  }\r\n\r\n};\r\n\r\n\r\nclass GSO //Gamelab-Overrideable\r\n{\r\n  constructor(args = {}) {\r\n\r\n    this.run_ext = args.run_ext || [];\r\n\r\n    this.complete_ext = args.complete_ext || [];\r\n  }\r\n\r\n  /*****\r\n   * Overridable / Extendable functions\r\n   * -allows stacking of external object-function calls\r\n   ******/\r\n\r\n  onRun(caller, callkey) {\r\n    this.run_ext = this.run_ext || [];\r\n\r\n    if (this.run_ext.indexOf(caller[callkey]) == -1) {\r\n      this.run_ext.push({\r\n        caller: caller,\r\n        callkey: callkey\r\n      });\r\n    }\r\n  }\r\n\r\n  onComplete(caller, callkey) {\r\n    this.complete_ext = this.complete_ext || [];\r\n\r\n    if (this.complete_ext.indexOf(caller[callkey]) == -1) {\r\n      this.complete_ext.push({\r\n        caller: caller,\r\n        callkey: callkey\r\n      });\r\n    }\r\n  }\r\n\r\n  call_on_run() {\r\n    //call any function extension that is present\r\n    for (var x = 0; x < this.run_ext.length; x++) {\r\n      this.run_ext[x].caller[this.run_ext[x].callkey]();\r\n    }\r\n  }\r\n\r\n  call_on_complete() {\r\n    //call any function extension that is present\r\n    for (var x = 0; x < this.complete_ext.length; x++) {\r\n      this.complete_ext[x].caller[this.complete_ext[x].callkey]();\r\n    }\r\n  }\r\n\r\n}\r\n\r\nlet Gamelab = Gamelab_Module();\r\n\r\n\r\nGamelab.DEV = true;\r\n\r\n\r\nif (typeof module !== 'undefined' && module.exports) {\r\n\r\n  //This library is being instaniated via require() aka node.js require or similar library loader\r\n  module.exports = Gamelab;\r\n\r\n} else {\r\n\r\n\r\n}\r\n\r\n/***************\r\n * TODO : fix the above duplicate references, which exist now for backward compatibility with previouslyh authored code\r\n *  -apply find and replace accross the codebase\r\n * ****************/\r\n\r\n/********\r\n * jstr() : public function for stringifying objects and arrays (uses pretty print style)\r\n * *********/\r\n\r\nfunction jstr(obj) {\r\n\r\n  return JSON.stringify(obj);\r\n\r\n};\r\n\r\nGamelab.jstr = jstr;\r\n\r\n/**********\r\n * $Q : Selector Function\r\n *  -allows string-based-selection of game-objects.\r\n * **********/\r\n\r\nfunction $Q(selector) {\r\n\r\n  //declare events:\r\n\r\n  console.log(selector);\r\n\r\n  var query = [];\r\n\r\n  //handle selector / selection of objects:\r\n\r\n  if (typeof selector !== 'string') {\r\n\r\n    if (selector instanceof Array) {\r\n\r\n    } else {\r\n\r\n\r\n    }\r\n\r\n  } else {\r\n\r\n\r\n    if (selector && selector !== '*') {\r\n\r\n      var s = selector || '';\r\n\r\n      console.info('selector:' + s);\r\n\r\n\r\n      var mainSelector = $Q.before('[', s).trim(),\r\n        msfChar = mainSelector.substring(0, 1);\r\n\r\n      var __targetClassName = \"*\";\r\n\r\n      var output = [];\r\n\r\n      var cleanSelectorString = function(str) {\r\n        return str.replace(\",\", \"\");\r\n      };\r\n\r\n      switch (msfChar.toLowerCase()) {\r\n        case \".\":\r\n\r\n          console.info('Selecting by \".\" or class');\r\n\r\n          __targetClassName = cleanSelectorString($Q.after('.', mainSelector));\r\n\r\n          console.info('Target class is:' + __targetClassName);\r\n\r\n          break;\r\n\r\n        case \"*\":\r\n\r\n          console.info('Selecting by \"*\" or ANY object in the library instance');\r\n\r\n          __targetClassName = \"*\";\r\n\r\n          break;\r\n\r\n      }\r\n\r\n      var criterion = $Q.between('[', ']', s),\r\n        cparts = criterion.split('=');\r\n\r\n      var __targetGroup = \"*\",\r\n        __targetName = \"*\";\r\n\r\n      var getParts = function() {\r\n\r\n        if (cparts.length >= 2) {\r\n\r\n          switch (cparts[0].toLowerCase()) {\r\n\r\n            case \"name\":\r\n\r\n              //get all objects according to name=name\r\n\r\n              console.log('Q():Detected parts in selector:' + jstr(cparts));\r\n\r\n              __targetName = cleanSelectorString(cparts[1]);\r\n\r\n              break;\r\n\r\n            case \"group\":\r\n\r\n              console.log('Q():Detected parts in selector:' + jstr(cparts));\r\n\r\n              __targetGroup = cleanSelectorString(cparts[1]);\r\n\r\n              break;\r\n\r\n          }\r\n\r\n        }\r\n\r\n        if (cparts.length >= 4) {\r\n\r\n          cparts[2] = cparts[2].replace(\",\", \"\");\r\n\r\n          switch (cparts[2].toLowerCase()) {\r\n\r\n            case \"name\":\r\n\r\n              //get all objects according to name=name\r\n\r\n              console.log('Q():Detected parts in selector:' + jstr(cparts));\r\n\r\n              __targetName = cleanSelectorString(cparts[3]);\r\n\r\n              break;\r\n\r\n            case \"group\":\r\n\r\n              console.log('Q():Detected parts in selector:' + jstr(cparts));\r\n\r\n              __targetGroup = cleanSelectorString(cparts[3]);\r\n\r\n              break;\r\n\r\n          }\r\n\r\n        }\r\n\r\n      };\r\n\r\n      getParts(cparts);\r\n\r\n      query = Gamelab.select(__targetClassName, __targetName, __targetGroup);\r\n\r\n    } else if (selector == '*') {\r\n\r\n      query = Gamelab.all();\r\n\r\n    }\r\n\r\n  }\r\n\r\n\r\n  query.each = function(callback) {\r\n\r\n    var objects = [];\r\n\r\n    for (var x = 0; x < this.length; x++) {\r\n      if (typeof x == 'number') {\r\n\r\n        callback(x, this[x]);\r\n      }\r\n\r\n    }\r\n\r\n\r\n  };\r\n\r\n  query.on = function(evt_key, selectorObject, controller_ix, callback) //handle each event such as on('collide') OR on('stick_left_0') << first controller stick_left\r\n  {\r\n\r\n    if (typeof evt_key == 'function' && typeof selectorObject == 'function') {\r\n      //this is a special pattern of if(f() == true){ runFunction(); };\r\n\r\n      var boolTrigger = evt_key,\r\n        boolCall = selectorObject,\r\n\r\n        boolEvent = new Gamelab.BoolEvent().On(boolTrigger).Call(boolCall);\r\n\r\n    }\r\n\r\n\r\n    var criterion = $Q.between('[', ']', evt_key);\r\n\r\n    if (criterion.indexOf('===') >= 0) {\r\n      criterion = criterion.replace('===', '=');\r\n    }\r\n\r\n    if (criterion.indexOf('==') >= 0) {\r\n      criterion = criterion.replace('==', '=').replace('==', 0);\r\n    }\r\n\r\n    var cparts = criterion.split('=');\r\n\r\n    var __targetGroup = \"*\",\r\n      __targetName = \"*\";\r\n\r\n    if (evt_key.indexOf('[') >= 0) {\r\n      evt_key = $Q.before('[', evt_key).trim();\r\n\r\n    }\r\n\r\n\r\n    var padding = 0;\r\n\r\n    //if controller_ix is function, and callback not present, then controller_ix is the callback aka optional argument\r\n\r\n    if (controller_ix && typeof controller_ix == 'function' && !callback) {\r\n      callback = controller_ix;\r\n      controller_ix = 0;\r\n    }\r\n\r\n    //optional argument: if controller_ix is function, and callback not present, then callback is selectorObject\r\n\r\n    if (selectorObject && typeof selectorObject == 'function' && !callback) {\r\n\r\n      callback = selectorObject;\r\n\r\n      selectorObject = $Q('*');\r\n\r\n      controller_ix = 0;\r\n    };\r\n\r\n    var evt_profile = {};\r\n\r\n    //which controller?\r\n\r\n    evt_profile.cix = controller_ix;\r\n\r\n    //Need the control key: 'left_stick', 'button_0', etc..\r\n\r\n    evt_profile.evt_key = evt_key;\r\n\r\n    if ($Q.contains_any(['stick', 'button', 'click', 'key'], evt_profile.evt_key)) {\r\n\r\n      var button_mode = evt_profile.evt_key.indexOf('button') >= 0;\r\n\r\n      Gamelab.GamepadAdapter.on(evt_profile.evt_key, 0, function(x, y) {\r\n\r\n        callback(x, y);\r\n\r\n      });\r\n\r\n      console.info('detected input event key in:' + evt_profile.evt_key);\r\n\r\n      console.info('TODO: rig events');\r\n\r\n    }\r\n\r\n    //TODO: test collision events:\r\n    else if ($Q.contains_any(['collide', 'collision', 'hit', 'touch'], evt_profile.evt_key)) {\r\n\r\n      //   console.info('Rigging a collision event');\r\n\r\n      //   console.info('detected collision event key in:' + evt_profile.evt_key);\r\n\r\n      //  console.info('TODO: rig collision events');\r\n\r\n      this.each(function(ix, item1) {\r\n\r\n        // console.info('Collision Processing 1:' + item1.name);\r\n        //  console.info('Collision Processing 1:' + item1.type);\r\n\r\n        selectorObject.each(function(iy, item2) {\r\n\r\n          //    console.info('Collision Processing 2:' + item2.name);\r\n          //   console.info('Collision Processing 2:' + item2.type);\r\n\r\n          if (typeof(item1.onUpdate) == 'function') {\r\n\r\n            var update = function(sprite) {\r\n\r\n              console.log('Box collide::' + jstr([this, item2]));\r\n\r\n              if (this.hasBoxCollision(item2, padding)) {\r\n\r\n                callback(this, item2);\r\n\r\n              };\r\n\r\n            };\r\n\r\n            item1.onUpdate(update);\r\n\r\n          }\r\n\r\n\r\n        });\r\n\r\n      });\r\n\r\n\r\n    } else {\r\n      console.info('Rigging a property event');\r\n\r\n      //TODO: test property-watch events:\r\n\r\n      console.info('detected property threshhold event key in:' + evt_profile.evt_key);\r\n\r\n      console.info('TODO: rig property events');\r\n\r\n      var condition = \"_\",\r\n        key = criterion || evt_profile.evt_key;\r\n\r\n      if (key.indexOf('[') >= 0 || key.indexOf(']') >= 0) {\r\n        key = $Q.between('[', ']', key);\r\n\r\n      }\r\n\r\n      var evt_parts = [];\r\n\r\n      var run = function() {\r\n        console.error('Sprite property check was not set correctly');\r\n\r\n      };\r\n\r\n      if (key.indexOf('>=') >= 0) {\r\n        condition = \">=\";\r\n\r\n\r\n      } else if (key.indexOf('<=') >= 0) {\r\n        condition = \"<=\";\r\n      } else if (key.indexOf('>') >= 0) {\r\n        condition = \">\";\r\n      } else if (key.indexOf('<') >= 0) {\r\n        condition = \"<\";\r\n      } else if (key.indexOf('=') >= 0) {\r\n        condition = \"=\";\r\n      }\r\n\r\n      evt_parts = key.split(condition);\r\n\r\n      for (var x = 0; x < evt_parts.length; x++) {\r\n        evt_parts[x] = evt_parts[x].replace('=', '').replace('=', '').trim(); //remove any trailing equals and trim()\r\n\r\n      }\r\n\r\n      var mykey, number;\r\n\r\n      // alert(evt_parts[0]);\r\n\r\n      try {\r\n\r\n        mykey = evt_parts[0];\r\n\r\n        number = parseFloat(evt_parts[1]);\r\n\r\n      } catch (e) {\r\n        console.log(e);\r\n      }\r\n\r\n      console.info('Gamelab:Processing condition with:' + condition);\r\n\r\n      switch (condition) {\r\n\r\n        case \">=\":\r\n\r\n\r\n          run = function(obj, key) {\r\n            if (obj[key] >= number) {\r\n              callback();\r\n            }\r\n          };\r\n\r\n          break;\r\n\r\n        case \"<=\":\r\n\r\n          run = function(obj, key) {\r\n            if (obj[key] <= number) {\r\n              callback();\r\n            }\r\n          };\r\n\r\n          break;\r\n\r\n\r\n        case \">\":\r\n\r\n          run = function(obj, key) {\r\n            if (obj[key] > number) {\r\n              callback();\r\n            }\r\n          };\r\n\r\n          break;\r\n\r\n        case \"<\":\r\n\r\n          run = function(obj, key) {\r\n            if (obj[key] < number) {\r\n              callback();\r\n            }\r\n          };\r\n\r\n          break;\r\n\r\n        case \"=\":\r\n\r\n          run = function(obj, key) {\r\n            if (obj[key] == number) {\r\n              callback();\r\n            }\r\n          };\r\n\r\n          break;\r\n\r\n      }\r\n\r\n\r\n      /************\r\n       * Attach update to each member\r\n       *\r\n       * **************/\r\n\r\n      var keys = mykey.split('.'),\r\n        propkey = \"\";\r\n\r\n      this.each(function(ix, item) {\r\n\r\n        var object = {};\r\n\r\n        if (keys.length == 1) {\r\n          object = item;\r\n\r\n          propkey = mykey;\r\n\r\n        } else if (keys.length == 2) {\r\n          object = item[keys[0]];\r\n\r\n          propkey = keys[1];\r\n\r\n\r\n        } else if (keys.length == 3) {\r\n          object = item[keys[0]][keys[1]];\r\n\r\n          propkey = keys[2];\r\n\r\n        } else {\r\n          console.error(\":length of '.' notation out of range. We use max length of 3 or prop.prop.key.\");\r\n\r\n        }\r\n\r\n        if (typeof item.onUpdate == 'function') {\r\n\r\n\r\n          var spr = item;\r\n\r\n          item.onUpdate(function(sprite) {\r\n\r\n            run(object, propkey);\r\n\r\n          });\r\n\r\n        }\r\n\r\n      });\r\n\r\n    }\r\n\r\n  };\r\n\r\n\r\n  return query;\r\n\r\n}\r\n\r\n\r\n$Q.each = function(obj, callback, complete) {\r\n\r\n  for (var x in obj) {\r\n    callback(obj);\r\n\r\n  }\r\n\r\n  if (typeof(complete) == 'function') {\r\n    complete(obj);\r\n\r\n  }\r\n\r\n};\r\n\r\n\r\n$Q.before = function(c1, test_str) {\r\n  var start_pos = 0;\r\n  var end_pos = test_str.indexOf(c1, start_pos);\r\n  return test_str.substring(start_pos, end_pos);\r\n};\r\n\r\n\r\n$Q.contains = function(c1, test_str) {\r\n  return test_str.indexOf(c1) >= 0;\r\n};\r\n\r\n$Q.contains_all = function(cList, test_str) {\r\n  for (var x = 0; x < cList.length; x++) {\r\n    if (test_str.indexOf(cList[x]) < 0) {\r\n      return false;\r\n\r\n    }\r\n  }\r\n\r\n  return true;\r\n\r\n};\r\n\r\n$Q.contains_any = function(cList, test_str) {\r\n\r\n  for (var x = 0; x < cList.length; x++) {\r\n    if (test_str.indexOf(cList[x]) >= 0) {\r\n      return true;\r\n\r\n    }\r\n  }\r\n\r\n  return false;\r\n\r\n};\r\n\r\n$Q.after = function(c1, test_str) {\r\n  var start_pos = test_str.indexOf(c1) + 1;\r\n  var end_pos = test_str.length;\r\n  return test_str.substring(start_pos, end_pos);\r\n};\r\n\r\n$Q.between = function(c1, c2, test_str) {\r\n  var start_pos = test_str.indexOf(c1) + 1;\r\n  var end_pos = test_str.indexOf(c2, start_pos);\r\n  return test_str.substring(start_pos, end_pos)\r\n};\r\n\r\n\r\n/****************************************\r\n *  Developer's own test-function:\r\n *      -Q.test_selector_method():\r\n * ***************************************/\r\n\r\n$Q.test_selector_method = function() { //leftover method of hand-testing\r\n  var Q_TestStrings = ['*', '.Sprite', '*[group=\"enemy_type_0\"]', '.Sprite[group=\"enemy_type_0\"]'];\r\n\r\n  for (var x = 0; x < Q_TestStrings.length; x++) {\r\n    var test = Q_TestStrings[x];\r\n\r\n    console.info('testing:' + test);\r\n\r\n    $Q(test);\r\n  }\r\n\r\n  console.log('Testing stick left');\r\n\r\n  this.on('stick_left_0');\r\n\r\n  console.log('Testing button');\r\n\r\n  this.on('button_0');\r\n\r\n\r\n  console.log('Testing collide');\r\n\r\n  this.on('collide');\r\n\r\n\r\n  console.log('Testing button');\r\n\r\n  this.on('collide');\r\n\r\n  console.log('Testing prop');\r\n\r\n  this.on('health>=0');\r\n\r\n\r\n};\r\n\r\n\r\nGamelab.$Q = $Q;\r\n\r\nGamelab.query = $Q;\r\n\r\n\r\n/********************\r\n * Gamelab.InputSystem\r\n * Various Keyboard + mouse Input Events\r\n ********************/\r\n\r\nGamelab.InputSystem = {\r\n\r\n  //PC input events\r\n\r\n  Mouse: {\r\n    Position: {\r\n      x: 0,\r\n      y: 0\r\n    },\r\n    Speed: {\r\n      x: 0,\r\n      y: 0\r\n    },\r\n    setPosition(x, y) {\r\n\r\n      this.Speed.x = x - this.Position.x;\r\n\r\n      this.Speed.y = y - this.Position.y;\r\n\r\n      this.Position.x = x;\r\n\r\n      this.Position.y = y;\r\n\r\n    },\r\n    isIdle: function() {\r\n      return this.speed.x == 0 && this.speed.y == 0;\r\n    }\r\n  },\r\n\r\n  events: {\r\n\r\n    mousemove: [],\r\n    mousepos: [],\r\n    leftclick: [],\r\n    rightclick: [],\r\n    middleclick: [],\r\n    wheelup: [],\r\n    wheelDown: []\r\n  },\r\n\r\n  keymap: {},\r\n\r\n  keyReplace: function(str) {\r\n    return str.toLowerCase().replace('space', ' ').replace('left', String.fromCharCode(37)).replace('left', String.fromCharCode(37)).replace('up', String.fromCharCode(38)).replace('right', String.fromCharCode(39)).replace('down', String.fromCharCode(40));\r\n  },\r\n\r\n  extendKey: function(evt_key, callback, onFinish) {\r\n\r\n    evt_key = this.keyReplace(evt_key);\r\n\r\n    Gamelab.InputSystem.keymap[evt_key] = {\r\n\r\n      down: false,\r\n\r\n      callback: function() {\r\n        callback(evt_key);\r\n      }\r\n    };\r\n\r\n    return Gamelab.InputSystem.keymap[evt_key];\r\n\r\n  },\r\n\r\n  extend: function(evt_key, downCall, upCall, onFinish) {\r\n\r\n    evt_key = evt_key.toLowerCase();\r\n\r\n    //each event-group has object-type\r\n    Gamelab.InputSystem.events[evt_key] = Gamelab.InputSystem.events[evt_key] || [];\r\n\r\n    Gamelab.InputSystem.events[evt_key].push({\r\n\r\n      down: downCall,\r\n\r\n      up: upCall\r\n\r\n    });\r\n\r\n  },\r\n\r\n  init: function() {\r\n\r\n    var MOUSE = this.Mouse;\r\n\r\n    window.setInterval(function() {\r\n\r\n      Gamelab.each(Gamelab.InputSystem.keymap, function(im, kmapItem) {\r\n\r\n        if (kmapItem.down == true) {\r\n\r\n          kmapItem.callback();\r\n\r\n        }\r\n\r\n      });\r\n\r\n    }, 10);\r\n\r\n    document.onkeydown = document.onkeyup = function(e) {\r\n\r\n      e = e || event; // to deal with IE\r\n\r\n      var gs_key_string = 'key_' + String.fromCharCode(e.keyCode),\r\n\r\n        evt_object = Gamelab.InputSystem['keymap'][gs_key_string] || Gamelab.InputSystem['keymap'][gs_key_string.toLowerCase()];\r\n\r\n      if (evt_object) {\r\n        evt_object.down = e.type == 'keydown';\r\n\r\n      }\r\n\r\n    }\r\n\r\n    var canvases = document.querySelectorAll('canvas.gamewindow');\r\n\r\n\r\n    function getMousePos(e, c) {\r\n\r\n      var x;\r\n      var y;\r\n      if (e.pageX || e.pageY) {\r\n        x = e.pageX;\r\n        y = e.pageY;\r\n      } else {\r\n        x = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;\r\n        y = e.clientY + document.body.scrollTop + document.documentElement.scrollTop;\r\n      }\r\n      x -= c.offsetLeft;\r\n      y -= c.style.top;\r\n      return {\r\n        x: x,\r\n        y: y\r\n      };\r\n    }\r\n\r\n    let InputSystem = Gamelab.InputSystem;\r\n\r\n    function mouseMoving(event, c) {\r\n\r\n      var pos = getMousePos(event, c);\r\n\r\n      MOUSE.setPosition(pos.x, pos.y);\r\n\r\n      if (InputSystem.events['mousemove']) {\r\n        Gamelab.each(InputSystem.events['mousemove'], function(ix, el) {\r\n\r\n          el.down(pos.x, pos.y);\r\n\r\n        });\r\n      }\r\n\r\n    };\r\n\r\n    //Interval for mouse-idle time : run mouse move again with same position, no difference\r\n    setInterval(function() {\r\n\r\n      if (InputSystem.events['mousepos']) {\r\n\r\n        var pos = MOUSE.Position;\r\n\r\n        Gamelab.each(InputSystem.events['mousepos'], function(ix, el) {\r\n\r\n          el.down(pos.x, pos.y);\r\n\r\n        });\r\n      }\r\n\r\n    }, 10);\r\n\r\n\r\n    for (var x = 0; x < canvases.length; x++) {\r\n      var c = canvases[x];\r\n\r\n      function applyMouseMove(e) {\r\n        mouseMoving(e, c);\r\n      }\r\n\r\n      console.info('Gamelab-lib-code:main.js: InputSystem applying mousemove');\r\n\r\n      document.addEventListener(\"mousemove\", applyMouseMove);\r\n\r\n      c.onmousedown = function(e) {\r\n        //    alert(JSON.stringify(Gamelab.InputSystem, true, 2));\r\n\r\n        var value = e.which;\r\n        var pos = getMousePos(e, c);\r\n        var InputSystem = Gamelab.InputSystem;\r\n\r\n        e.preventDefault();\r\n\r\n        switch (e.which) {\r\n          case 1:\r\n\r\n            for (var x in InputSystem.events) {\r\n\r\n              if (InputSystem.events[x] instanceof Array && x == 'leftclick') {\r\n\r\n                Gamelab.each(InputSystem.events[x], function(ix, el) {\r\n\r\n                  el.down(pos.x, pos.y);\r\n                });\r\n              }\r\n            }\r\n\r\n            break;\r\n          case 2:\r\n            // alert('Middle Mouse button pressed.');\r\n\r\n            for (var x in Gamelab.InputSystem.events) {\r\n\r\n              if (InputSystem.events[x] instanceof Array && x == 'middleclick') {\r\n\r\n                Gamelab.each(InputSystem.events[x], function(ix, el) {\r\n\r\n                  el.down(pos.x, pos.y);\r\n                });\r\n              }\r\n            }\r\n            break;\r\n          case 3:\r\n            //  alert('Right Mouse button pressed.');\r\n\r\n\r\n            for (var x in Gamelab.InputSystem.events) {\r\n\r\n\r\n              if (InputSystem.events[x] instanceof Array && x == 'rightclick') {\r\n\r\n\r\n                Gamelab.each(InputSystem.events[x], function(ix, el) {\r\n\r\n                  el.down(pos.x, pos.y);\r\n                });\r\n\r\n                return false;\r\n              }\r\n\r\n\r\n            }\r\n\r\n            break;\r\n          default:\r\n\r\n            return 0;\r\n            //alert('You have a strange Mouse!');\r\n\r\n        }\r\n\r\n\r\n        e.preventDefault();\r\n        return 0;\r\n      };\r\n\r\n      c.onmouseup = function(e) {\r\n\r\n        //    alert(JSON.stringify(Gamelab.InputSystem, true, 2));\r\n\r\n        var value = e.which;\r\n        var pos = getMousePos(e, c);\r\n        var InputSystem = Gamelab.InputSystem;\r\n\r\n\r\n        e.preventDefault();\r\n\r\n        switch (e.which) {\r\n          case 1:\r\n\r\n            for (var x in InputSystem.events) {\r\n\r\n\r\n              if (InputSystem.events[x] instanceof Array && x == 'leftclick') {\r\n\r\n\r\n                Gamelab.each(InputSystem.events[x], function(ix, el) {\r\n\r\n                  el.up(pos.x, pos.y);\r\n                });\r\n              }\r\n\r\n\r\n            }\r\n\r\n            break;\r\n          case 2:\r\n            // alert('Middle Mouse button pressed.');\r\n\r\n\r\n            for (var x in Gamelab.InputSystem.events) {\r\n\r\n\r\n              if (InputSystem.events[x] instanceof Array && x == 'middleclick') {\r\n\r\n\r\n                Gamelab.each(InputSystem.events[x], function(ix, el) {\r\n\r\n                  el.up(pos.x, pos.y);\r\n                });\r\n              }\r\n\r\n\r\n            }\r\n            break;\r\n          case 3:\r\n            //  alert('Right Mouse button pressed.');\r\n\r\n\r\n            for (var x in Gamelab.InputSystem.events) {\r\n\r\n\r\n              if (InputSystem.events[x] instanceof Array && x == 'rightclick') {\r\n\r\n\r\n                Gamelab.each(InputSystem.events[x], function(ix, el) {\r\n\r\n                  el.up(pos.x, pos.y);\r\n                });\r\n\r\n\r\n                return false;\r\n\r\n              }\r\n\r\n\r\n            }\r\n\r\n            break;\r\n          default:\r\n\r\n            return 0;\r\n            //alert('You have a strange Mouse!');\r\n\r\n        }\r\n\r\n\r\n      };\r\n    }\r\n\r\n\r\n  }\r\n\r\n\r\n};\r\n\r\n//Override the existing window.onload function\r\n\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n\r\n  Gamelab.callReady();\r\n\r\n});\r\n\r\nGamelab.file_system = {\r\n\r\n  localizedSource: function(src, hostUrl) {\r\n\r\n    hostUrl = hostUrl || \"../\";\r\n\r\n    var gs_folder_ix = src.indexOf('assets/game');\r\n\r\n    return hostUrl + src.substring(gs_folder_ix, src.length);\r\n\r\n  },\r\n\r\n  loadJSON: function(filepath, callback) {\r\n\r\n    function readTextFile(file, callback) {\r\n      var rawFile = new XMLHttpRequest();\r\n      rawFile.open(\"GET\", file, false);\r\n      rawFile.onreadystatechange = function() {\r\n        if (rawFile.readyState === 4) {\r\n          if (rawFile.status === 200 || rawFile.status == 0) {\r\n            var allText = rawFile.responseText;\r\n            callback(JSON.stringify(allText));\r\n          }\r\n        }\r\n      }\r\n      rawFile.send(null);\r\n    };\r\n\r\n    readTextFile('file:///' + filepath, callback);\r\n\r\n  },\r\n\r\n  loadLevel: function(jsonText, gw, callback) {\r\n\r\n    var data = JSON.parse(jsonText);\r\n\r\n    if (typeof(gw) == 'function' || !gw) {\r\n      callback = gw || callback || function() {};\r\n\r\n      gw = Gamelab.game_windows[0];\r\n    }\r\n\r\n    $.each(data.sprites, function(ix, xitem) {\r\n\r\n      if (typeof(xitem.src) == 'string') {\r\n\r\n        xitem.src = Gamelab.file_system.localizedSource(xitem.src);\r\n      }\r\n\r\n      __gamelabInstance.each(xitem, function(iy, yitem) {\r\n\r\n        if (yitem.src) {\r\n\r\n          yitem.src = Gamelab.file_system.localizedSource(yitem.src);\r\n\r\n        }\r\n\r\n        __gamelabInstance.each(yitem, function(iz, zitem) {\r\n\r\n          if (zitem.src) {\r\n            zitem.src = Gamelab.file_system.localizedSource(zitem.src);\r\n\r\n          }\r\n\r\n\r\n        });\r\n\r\n\r\n      });\r\n\r\n      xitem = new Gamelab.Sprite(xitem);\r\n\r\n      gw.add(xitem);\r\n      //sprite.image = sprite.selected_animation.image;\r\n\r\n\r\n      if (ix >= data.sprites.length - 1) {\r\n\r\n        //last sprite is loaded //WHY DOESN't this work?\r\n\r\n        callback(false, data);\r\n      }\r\n\r\n    });\r\n\r\n  },\r\n\r\n  loadJSONLevel: function(filepath, gw, callback) {\r\n\r\n    if (typeof(gw) == 'function' || !gw) {\r\n      callback = gw || callback || function() {};\r\n\r\n      gw = Gamelab.game_windows[0];\r\n    }\r\n\r\n    this.loadJSON(filepath, function(data) {\r\n\r\n      //localize .src up to three levels of recursion (.src must be altered to refer locally)\r\n\r\n      $.each(data.sprites, function(ix, xitem) {\r\n\r\n        if (typeof(xitem.src) == 'string') {\r\n\r\n          xitem.src = Gamelab.file_system.localizedSource(xitem.src);\r\n        }\r\n\r\n        __gamelabInstance.each(xitem, function(iy, yitem) {\r\n\r\n          if (yitem.src) {\r\n\r\n            yitem.src = Gamelab.file_system.localizedSource(yitem.src);\r\n\r\n          }\r\n\r\n          __gamelabInstance.each(yitem, function(iz, zitem) {\r\n\r\n            if (zitem.src) {\r\n              zitem.src = Gamelab.file_system.localizedSource(zitem.src);\r\n\r\n            }\r\n\r\n\r\n          });\r\n\r\n\r\n        });\r\n\r\n        xitem = new Gamelab.Sprite(xitem);\r\n\r\n        gw.add(xitem);\r\n        //sprite.image = sprite.selected_animation.image;\r\n\r\n\r\n        if (ix >= data.sprites.length - 1) {\r\n\r\n          //last sprite is loaded //WHY DOESN't this work?\r\n\r\n          callback(false, data);\r\n        }\r\n\r\n\r\n      });\r\n\r\n\r\n    });\r\n\r\n  }\r\n\r\n\r\n};\r\n\r\n\r\nGamelab.ready(function(lib) {\r\n\r\n  Gamelab.log('Gamelab: library is ready');\r\n\r\n});\r\n\r\n\r\n/* Screen */\r\n\r\nlet Screen = {\r\n\r\n  size: function() {\r\n    return new Gamelab.Vector(Gamelab.WIDTH, Gamelab.HEIGHT);\r\n  },\r\n\r\n  center: function() {\r\n    return new Gamelab.Vector(Gamelab.WIDTH / 2, Gamelab.HEIGHT / 2).round();\r\n  }\r\n\r\n};\r\n;\r\n/**************************\r\n  EventInterfaceMap: StringKeys:\r\n\r\n    * (must implement without option)\r\n    @ (may implement optional)\r\n*****************************/\r\n\r\n\r\n\r\nlet EventInterfaceMap = {  //className / must have named functions whyen carrying Symbol of className\r\n\r\n  Sprite: ['@onUpdate', '@onDestroy'],\r\n\r\n  Animation: ['@onRun', '@onComplete', '*onCollide'],\r\n\r\n  Motion: ['@onCommit', '@onComplete', '*onCollide'],\r\n\r\n  Shot: ['@onShoot', '*onCollide', '*onCollide'],\r\n\r\n  Terrain: ['@onCollide'],\r\n\r\n  Interactive: ['@onCollide'],\r\n\r\n  Global: ['@onUpdate'],\r\n\r\n  check: function(instance) {\r\n    for (var x in this) {\r\n      if (x == 'check')\r\n        continue;\r\n      else {\r\n        if (this[x] instanceof Array) {\r\n          this[x].forEach(function(f) {\r\n            var fkey = f.replace('@', '');\r\n            if (!instance.getOwnPropertyNames.indexOf(fkey) >= 0)\r\n              throw new Error('Object must implement function by name of:' + fkey);\r\n\r\n          });\r\n        }\r\n      }\r\n    };\r\n  }\r\n}\r\n\r\n/**************************\r\n  ObjectFeatureInterfaceMap:\r\n      Indicates classNames, and what they must carry as functions\r\n*****************************/\r\n\r\nlet ObjectFeatureMap = { //className / must have named function properties when carrying Symbol of className\r\n\r\n  Sprite: ['@spatial', '@data'],\r\n\r\n  Elipse:['@spatial'],\r\n\r\n  Frame:['@spatial'],\r\n\r\n  Background: ['@spatial',  '@data'],\r\n\r\n  Animation: ['@anchored', '@framedriven', '@effectdriven', '@data'],\r\n\r\n  Line2d:['@spatial', '@pointarrayflippable', '@selftransposable',  '@data'],\r\n\r\n  Text:['@spatial', '@text', '@colored'],\r\n\r\n  Shot:['@spatial', '@data']\r\n\r\n};\r\n\r\nGamelab.ObjectFeatureMap = ObjectFeatureMap;\r\n\r\n\r\nlet InputIFM = {\r\n\r\n  GamepadButtons: ['@onButton'],\r\n\r\n  GamepadSticks: ['@onStick'],\r\n\r\n  Keyboard: ['@onKey'],\r\n\r\n  MouseMove: ['@onMouseMove'],\r\n\r\n  MouseButton: ['@onMouseButton'],\r\n\r\n  MouseWheel: ['@onMouseWheel'],\r\n\r\n  LeapMotion: ['@onLeapMotion']\r\n\r\n};\r\n\r\n\r\nlet UIEditables = {\r\n\r\n  Sprite: ['size', 'position', 'rotation'],\r\n\r\n  Animation: ['frameBounds', 'etc']\r\n\r\n};\r\n\r\n\r\nlet UIOption = function(name, hint, script) {\r\n\r\n  return {\r\n    name,\r\n    hint,\r\n    script\r\n  }\r\n\r\n};\r\n\r\n\r\n\r\nlet UIPrefab = {\r\n\r\n  MainSelect: {\r\n    Interactive: {\r\n\r\n      name: 'FourwayClasticRect',\r\n\r\n      hint: 'Object is collideable on four rectangular sides',\r\n\r\n      script: '#MY-SCRIPT-PATH'\r\n    }\r\n  },\r\n\r\n  FormEditables: {\r\n\r\n    Interactive: []\r\n  }\r\n};\r\n\r\n\r\n\r\nlet UIPrefabMainSelect = {\r\n\r\n  Background: ['Bound']\r\n\r\n};\r\n\r\n\r\nlet getCustomPrefabMeta = function() { //get name and file/data resources for each custom prefab\r\n\r\n};\r\n\r\n/**********************************\r\n\r\n  UIObjectSelectMap:\r\n\r\n    -Just the system default options\r\n\r\n*********************************/\r\n\r\nlet UIObjectPrefabs = {\r\n\r\n  Sprite: ['Side-Scroll-Player', 'Collider', 'Spaceship', 'Robot'],\r\n\r\n};\r\n;class Bone {\r\n\r\n  constructor(parent={}, size) {\r\n\r\n    this.size = size || parent.size;\r\n\r\n    if (typeof parent == 'Object' && parent.id)\r\n      this.parent_id = parent.id;\r\n\r\n    this.parent = parent;\r\n\r\n    this.origin = parent.origin || new Gamelab.Vector(0, 0);\r\n\r\n    this.rotation = parent.rotation || new Gamelab.Vector(0, 0);\r\n\r\n    this.offset = parent.offset || new Gamelab.Vector(0, 0);\r\n\r\n    this.size = size;\r\n\r\n    //every frame of the parent object gets same size::\r\n\r\n    if(parent.Size)\r\n    {\r\n        parent.Size(size.x, size.y, size.z);\r\n    }\r\n\r\n    this.onPosition(function(){\r\n\r\n      this.Rotation(this.rotation.x);\r\n\r\n    });\r\n\r\n  }\r\n\r\n  Offset(x, y)\r\n  {\r\n    this.offset = new Gamelab.Vector(x, y);\r\n    return this;\r\n  }\r\n\r\n  Origin(x, y, z){\r\n\r\n    this.origin = new Gamelab.Vector(x, y, z);\r\n    this.parent.Origin(x, y, z);\r\n    return this;\r\n  }\r\n\r\n  Size(x, y, z){\r\n\r\n    this.size = new Gamelab.Vector(x, y, z);\r\n    this.parent.Size(x, y, z);\r\n\r\n  }\r\n\r\n  Rotation(x, y, z)\r\n  {\r\n    this.rotation = new Gamelab.Vector(x, y, z);\r\n    this.parent.Rotation(this.rotation);\r\n    return this;\r\n  }\r\n\r\n  onPosition(callback){\r\n\r\n    callback = callback.bind(this);\r\n\r\n    this.parent.onRun(function(){\r\n\r\n        callback();\r\n\r\n    });\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\n\r\nclass BoneState {\r\n\r\n  constructor(boneList) {\r\n\r\n    var states = [];\r\n\r\n    boneList.forEach(function(bone) {\r\n\r\n      states.push({\r\n        bone:bone,\r\n        offset: new Gamelab.Vector(),\r\n        rotation: new Gamelab.Vector(),\r\n        size: new Gamelab.Vector(),\r\n      });\r\n\r\n    });\r\n\r\n  }\r\n\r\n}\r\nGamelab.BoneState = BoneState;\r\nGamelab.Bone = Bone;\r\n;(function() {\r\n  console.log('Camera class... creating');\r\n\r\n  /**\r\n   * Creates a new Camera\r\n\r\n   * @param {number} x=0 position-x\r\n   * @param {number} y=0 position-y\r\n   * @param {number} z=0 position-z\r\n   * @returns {Camera}\r\n   */\r\n\r\n\r\n  class Camera {\r\n    constructor(x, y, z) {\r\n      if (isNaN(x)) {\r\n        x = 0;\r\n      }\r\n\r\n      if (isNaN(y)) {\r\n        y = 0;\r\n      }\r\n\r\n      if (isNaN(z)) {\r\n        z = 0;\r\n      }\r\n\r\n         /**\r\n          *\r\n          * @property {Vector} position the Vector position of Camera, having numeric x, y, and z values\r\n          * @memberof Camera\r\n          **********/\r\n\r\n\r\n      this.position = new Gamelab.Vector(x, y, z);\r\n    }\r\n\r\n  }\r\n\r\n  Gamelab.Camera = Camera;\r\n\r\n})();\r\n;\n(function(){\n    console.log('Line() class... creating');\n\n    var Curves = { //ALL HAVE INPUT AND OUTPUT OF: 0-1.0\n    // no easing, no acceleration\n    linearNone: function (t) { return t },\n\n    // accelerating from zero velocity\n    easeInQuadratic: function (t) { return t*t },\n    // decelerating to zero velocity\n    easeOutQuadratic: function (t) { return t*(2-t) },\n    // acceleration until halfway, then deceleration\n    easeInOutQuadratic: function (t) { return t<.5 ? 2*t*t : -1+(4-2*t)*t },\n    // accelerating from zero velocity\n    easeInCubic: function (t) { return t*t*t },\n    // decelerating to zero velocity\n    easeOutCubic: function (t) { return (--t)*t*t+1 },\n    // acceleration until halfway, then deceleration\n    easeInOutCubic: function (t) { return t<.5 ? 4*t*t*t : (t-1)*(2*t-2)*(2*t-2)+1 },\n    // accelerating from zero velocity\n    easeInQuartic: function (t) { return t*t*t*t },\n    // decelerating to zero velocity\n    easeOutQuartic: function (t) { return 1-(--t)*t*t*t },\n    // acceleration until halfway, then deceleration\n    easeInOutQuartic: function (t) { return t<.5 ? 8*t*t*t*t : 1-8*(--t)*t*t*t },\n    // accelerating from zero velocity\n    easeInQuintic: function (t) { return t*t*t*t*t },\n    // decelerating to zero velocity\n    easeOutQuintic: function (t) { return 1+(--t)*t*t*t*t },\n    // acceleration until halfway, then deceleration\n    easeInOutQuintic: function (t) { return t<.5 ? 16*t*t*t*t*t : 1+16*(--t)*t*t*t*t }\n}\n\nGamelab.Curves = Curves;\n\nvar inOutCurves = {\n\n    quadratic: function (t) { return t<.5 ? 2*t*t : -1+(4-2*t)*t },\n\n    cubic: function (t) { return t<.5 ? 4*t*t*t : (t-1)*(2*t-2)*(2*t-2)+1 },\n\n    quartic: function (t) { return t<.5 ? 8*t*t*t*t : 1-8*(--t)*t*t*t },\n\n    quintic: function (t) { return t<.5 ? 16*t*t*t*t*t : 1+16*(--t)*t*t*t*t },\n\n    linear: function (t) { return t; } //provided for consistency / in case 'linear' is needed\n\n    };\n\n\nGamelab.Curves.Smooth = inOutCurves;\nGamelab.Curves.InOut = inOutCurves;\n\n\n})();\n;\nclass Game\n{\n    constructor(srcFile)\n    {\n\n    }\n}\n\nGamelab.Game = Game;\n\n;/**\r\n * Creates a new GameWindow\r\n * <iframe style='width:400px; height:450px; overflow:hidden;' src='../client/examples/js-class/GameWindow.html'> </iframe>\r\n * @param   {Object} canvas the canvas element for this gameWindow. --GameWindow's if not supplied, the constructor will create a full-screen canvas, if a canvas.\r\n * @param   {Array} drawables=[] a list of drawable objects to be drawn. --Drawables can also be added after constructor call.\r\n * @returns {GameWindow} a Gamelab.GameWindow object\r\n * */\r\n\r\nclass GameWindow {\r\n  constructor(container=false) {\r\n\r\n    this.container = container instanceof HTMLElement ?\r\n            container : document.body;\r\n\r\n    /**\r\n     * list of all drawables in the window.\r\n     *\r\n     * @property this.drawables\r\n     * @memberof GameWindow\r\n     **********/\r\n    this.drawables = [];\r\n\r\n    /**\r\n     * the camera of the GameWindow. --An instance of Gamelab.Camera\r\n     *\r\n     * @property this.camera\r\n     * @memberof GameWindow\r\n     **********/\r\n\r\n    Gamelab.camera = this.camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);\r\n\r\n    this.scene = new THREE.Scene();\r\n    this.renderer = new THREE.WebGLRenderer();\r\n    this.renderer.setSize(this.container.clientWidth, this.container.clientHeight);\r\n\r\n    this.container.appendChild(this.renderer.domElement );\r\n\r\n    var __inst = this;\r\n\r\n    this.Size(window.innerWidth, window.innerHeight);\r\n\r\n    this.update_ext = [];\r\n\r\n    window.onresize = function() {\r\n\r\n      if (__inst.isAbsoluteSize)\r\n        return;\r\n\r\n      __inst.Size(window.innerWidth, window.innerHeight);\r\n\r\n    };\r\n\r\n    Gamelab.game_windows.push(this);\r\n\r\n    window.onerror = function() {\r\n\r\n      Gamelab.errors += 1;\r\n\r\n      console.log('Canvas Error --');\r\n\r\n      if (Gamelab.errors > Gamelab.settings.errorLimit) {\r\n        Gamelab.stopDraw = true;\r\n\r\n        var call = call || window.setTimeout(function() {\r\n\r\n          if (call) {\r\n            window.clearTimeout(call);\r\n          }\r\n          console.log('%cDraw stopped at errorLimit:' + Gamelab.settings.errorLimit, 'color:darkorange;');\r\n\r\n        }, 200);\r\n\r\n      }\r\n\r\n    }\r\n\r\n\r\n  }\r\n\r\n  test(callback=function(){}) {\r\n    var geometry = new THREE.BoxGeometry(1, 1, 1);\r\n    var material = new THREE.MeshBasicMaterial({\r\n      color: 0x00ff00\r\n    });\r\n    var cube = new THREE.Mesh(geometry, material);\r\n    this.scene.add(cube);\r\n    this.camera.position.z = 5;\r\n    callback.bind(this).call();\r\n  }\r\n\r\n  /**\r\n   * returns the gameWindow.canvas property, an HTMLCanvasElement\r\n   *\r\n   * @function\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n  getCanvas() {\r\n    return this.canvas;\r\n  }\r\n\r\n\r\n  /**\r\n   * returns a vector(x, y) showing the center of the GameWindow\r\n   *\r\n   * @function\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n\r\n  center() {\r\n\r\n    return new Gamelab.Vector(Math.round(this.canvas.width / 2), Math.round(this.canvas.height / 2));\r\n\r\n  }\r\n\r\n\r\n  TrackStat() {\r\n\r\n    this.__trackStat = true;\r\n    return this;\r\n  }\r\n\r\n\r\n  /**\r\n   * adds an update to the GameWindow:: update to be called every 20 milliseconds\r\n   *\r\n   * @function\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n\r\n  onUpdate(f) {\r\n\r\n    this.update_ext.push(f);\r\n\r\n  }\r\n\r\n  /**\r\n   * the main update for the GameWindow:: called automatically after call of GameWindow.start() or GameWindow.animate()\r\n   *\r\n   * @function\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n  update() {\r\n\r\n    Gamelab.each(this.drawables, function(ix, item) {\r\n\r\n      if (item && typeof(item.def_update) == 'function') {\r\n\r\n        item.def_update(item);\r\n\r\n      }\r\n\r\n      if (item && typeof(item.update) == 'function') {\r\n        item.update(item);\r\n\r\n      }\r\n\r\n\r\n      if (item && ['SpriteArray', 'RobotixArray', 'RobotixVerticalChain'].indexOf(item.constructor.name) >= 0 &&\r\n        typeof item.each == 'function') {\r\n\r\n        item.each(function(ix, graphic) {\r\n\r\n          graphic.update(graphic);\r\n\r\n        });\r\n\r\n      }\r\n\r\n    });\r\n\r\n    Gamelab.each(this.bool_events, function(ix, item) {\r\n\r\n      if (item && item.bool()) {\r\n        item.callback();\r\n      }\r\n\r\n    });\r\n\r\n\r\n    for (var x in this.update_ext) {\r\n      this.update_ext[x]();\r\n    }\r\n  }\r\n\r\n  Renderer(){\r\n    return this.renderer;\r\n  }\r\n\r\n  draw() {\r\n\r\n    var $gamewindow = this;\r\n\r\n    if (this.before_draw_ext) {\r\n      this.before_draw_ext();\r\n    }\r\n\r\n    Gamelab.each(this.drawables, function(ix, item) {\r\n\r\n      if (typeof item.draw == 'function') {\r\n        item.draw($gamewindow, $gamewindow.camera);\r\n      }\r\n\r\n    });\r\n\r\n\r\n    if (this.after_draw_ext) {\r\n      this.after_draw_ext();\r\n    }\r\n\r\n  }\r\n\r\n\r\n  /**\r\n   * adds a call before the GameWindow draw()\r\n   *\r\n   * @function\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n  onBeforeDraw(f) {\r\n\r\n    var boundCall = f.bind(this);\r\n\r\n    if (!this.before_draw_ext)\r\n      this.before_draw_ext = function() {};\r\n\r\n    var beforeDraw = this.before_draw_ext.bind(this);\r\n\r\n    this.before_draw_ext = function() {\r\n      beforeDraw();\r\n      boundCall();\r\n    };\r\n\r\n  }\r\n\r\n  /**\r\n   * adds a call after the GameWindow draw()\r\n   *\r\n   * @function\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n\r\n  onAfterDraw(f) {\r\n\r\n    var boundCall = f.bind(this);\r\n\r\n    if (!this.after_draw_ext)\r\n      this.after_draw_ext = function() {};\r\n\r\n\r\n    var afterDraw = this.after_draw_ext.bind(this);\r\n\r\n    this.after_draw_ext = function() {\r\n      afterDraw();\r\n      boundCall();\r\n    };\r\n\r\n  }\r\n\r\n  /**\r\n   * sets the size of the GameWindow\r\n   *\r\n   * @function\r\n   * @param {integer} w the width of the GameWindow\r\n   * @param {integer} h the HEIGHT of the GameWindow\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n  Size() {\r\n\r\n    let w = this.container.clientWidth;\r\n    let h =this.container.clientHeight;\r\n\r\n    console.log('GAMEWINDOW::SIZE:' + jstr({x:w, y:h}));\r\n\r\n    this.renderer.setSize(w, h);\r\n\r\n    Gamelab.WIDTH = w;\r\n\r\n    Gamelab.HEIGHT = h;\r\n\r\n    this.size = new Gamelab.Vector(w, h);\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n  /**\r\n   * adds an object to the GameWindow\r\n   *\r\n   * @function\r\n   * @param {Object} obj the object to be added (Sprite)\r\n   * @param {Boolean} onBottom if true, adds to the bottom of layer-stack in GameWindow\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n  add(obj, options = {}) {\r\n\r\n    var optionsGuide = {\r\n      obj: 'The Object{} being added into play',\r\n      options: {\r\n        position: 'The Vector(x, y) offset to use when drawing the obj'\r\n      }\r\n    };\r\n\r\n    console.info('GameWindow.add() --2nd argument options is object of arguments >>>', optionsGuide);\r\n\r\n    var layer = options.layer || this.drawables.length - 1;\r\n\r\n    if (!(typeof layer == 'number' && layer >= 0))\r\n      layer = this.drawables.length;\r\n\r\n    var offset = new Gamelab.Vector(0, 0);\r\n\r\n    if (options.position)\r\n      offset = options.position;\r\n\r\n    obj.window_offset = offset;\r\n\r\n    //1: if Sprite(), Add object to the existing __gameWindow\r\n\r\n    var __inst = this;\r\n\r\n    if (obj instanceof Gamelab.Camera) {\r\n\r\n      this.camera = obj;\r\n\r\n    } else if (obj instanceof Gamelab.GSEvent) {\r\n\r\n      if (Gamelab.__running) {\r\n\r\n        return console.error('Events can only be added before Gamstack.animate() is called::aka before the main update / loop begins');\r\n      } else {\r\n\r\n        obj.apply();\r\n\r\n      }\r\n    } else {\r\n\r\n      this.drawables.splice(layer, 0, obj);\r\n\r\n    };\r\n\r\n    return obj;\r\n\r\n  }\r\n\r\n  /**\r\n   * set background-color of GameWindow\r\n   *\r\n   * @function\r\n   * @param {string} c the new background-color for GameWindow\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n  Background(c) {\r\n    this.canvas.style.background = c;\r\n\r\n    this.canvas.style.backgroundColor = c;\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n  /**\r\n   * removes an object from the GameWindow\r\n   *\r\n   * @function\r\n   * @param {Object} obj the object to be removed (Sprite)\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n  remove(obj) {\r\n\r\n    var ix = this.drawables.indexOf(obj);\r\n\r\n    if (ix >= 0) {\r\n      this.drawables.splice(ix, 1);\r\n    }\r\n  }\r\n\r\n\r\n  removeDeadObjects() {\r\n\r\n    var $window = this;\r\n\r\n    this.drawables.forEach(function(sprite) {\r\n\r\n      if (sprite.life <= 0) {\r\n        $window.remove(sprite);\r\n      }\r\n\r\n    });\r\n\r\n  }\r\n\r\n  /**\r\n   * begins the animation-loop of GameWindow.\r\n   *\r\n   * @function\r\n   * @param {number} time optional time parameter for usage with Tween\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n\r\n  animate(time) {\r\n\r\n    var __inst = this;\r\n\r\n    requestAnimationFrame(function() {\r\n\r\n      __inst.animate();\r\n\r\n    });\r\n\r\n\r\n    if (this.__stats) {\r\n      this.__stats.begin();\r\n      this.__statsMS.begin();\r\n      this.__statsMB.update();\r\n    }\r\n\r\n    Gamelab.isAtPlay = true;\r\n\r\n    if (window.TWEEN)\r\n      TWEEN.update(time);\r\n\r\n    __inst.update();\r\n\r\n    this.draw();\r\n\r\n    if (this.__stats) {\r\n      this.__stats.end();\r\n      this.__statsMS.end();\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * begins the animation-loop of GameWindow, with performance Stats shown on-screen\r\n   *\r\n   * @function\r\n   * @memberof GameWindow\r\n   **********/\r\n\r\n\r\n  start() {\r\n\r\n    if (typeof(Stats) == 'function') //Stats library exists\r\n    {\r\n      //basic stat animation\r\n      this.__stats = new Stats();\r\n      this.__stats.showPanel(0); // 0: fps, 1: ms, 2: mb, 3+: custom\r\n\r\n      this.__stats.dom.style.left = '10%';\r\n\r\n      this.__stats.dom.setAttribute('class', 'stat');\r\n\r\n      this.canvas.parentNode.appendChild(this.__stats.dom);\r\n\r\n      //basic stat animation\r\n      this.__statsMS = new Stats();\r\n      this.__statsMS.showPanel(1); // 0: fps, 1: ms, 2: mb, 3+: custom\r\n\r\n      this.__statsMS.dom.style.left = '10%';\r\n\r\n      this.__statsMS.dom.style.marginLeft = '90px';\r\n\r\n      this.__statsMS.dom.setAttribute('class', 'stat');\r\n\r\n      this.canvas.parentNode.appendChild(this.__statsMS.dom);\r\n\r\n      //basic stat animation\r\n      this.__statsMB = new Stats();\r\n      this.__statsMB.showPanel(2); // 0: fps, 1: ms, 2: mb, 3+: custom\r\n\r\n      this.__statsMB.dom.style.left = '10%';\r\n\r\n      this.__statsMB.dom.setAttribute('class', 'stat');\r\n\r\n      this.__statsMB.dom.style.marginLeft = '180px';\r\n\r\n      this.canvas.parentNode.appendChild(this.__statsMB.dom);\r\n    }\r\n\r\n    this.animate();\r\n  }\r\n}\r\n\r\nGamelab.GameWindow = GameWindow;\r\n;\r\n  /**\r\n   * Creates a new Module\r\n   * @param   {string} uri the uri that the .js file is located at\r\n    * @param   {Function} callback=function(){} The callback to call after the module is loaded\r\n   * @returns {Module} a Gamelab.Module object\r\n   * */\r\n\r\nconsole.info('Module class :: keep as public');\r\n\r\nclass Module{\r\n\r\n  constructor(uri, callback){\r\n\r\n    this.load(uri, callback);\r\n\r\n  }\r\n\r\n  load(uri, callback){\r\n\r\n    var __object = this;\r\n\r\n    callback = callback || function(){};\r\n\r\n    callback = callback.bind(this);\r\n\r\n    var script = document.createElement('SCRIPT');\r\n    script.src = uri;\r\n\r\n    //define onload fxn\r\n    script.onload = function(){\r\n\r\n      var construct = window.module.exports;\r\n      callback(construct);\r\n\r\n    };\r\n\r\n    //append to the document\r\n    document.head.appendChild(script);\r\n\r\n  }\r\n\r\n};\r\n\r\nGamelab.Module = Module;\r\n;\n\n/**\n * Creates an instance of Rectangle.\n * @param   {Gamelab.Vector} min the minimum vector point (x,y)\n * @param   {Gamelab.Vector} max the maximum vector point (x,y)\n *\n * @returns {Rectangle} a Rectangle object\n */\n\nclass Rectangle {\n\n    constructor(min, max) {\n\n        this.min = new Gamelab.Vector(min);\n        this.max = new Gamelab.Vector(max);\n\n    }\n    toLine()\n    {\n\n\n    }\n}\n;\n\n\n\nlet VectorBounds = Rectangle;\n\nGamelab.VectorBounds =VectorBounds;\n\nGamelab.Rectangle = Rectangle;\n\n/**\n * Takes the min and max vectors plus termPoint ('termination-point'), returns VectorFrameBounds\n *  *use this to define the bounds of an Animation object.\n * @param   {Vector} min the minimum vector point (x,y)\n * @param   {Vector} max the maximum vector point (x,y)\n * @param   {Vector=} termPoint the optional termination vector point (x,y) : defaults to the value of 'max'\n * -While a min and max Gamelab.Vector(x,y) will describe the grid-size of Animation frames,\n * the termPoint will indicate the last frame on-grid for this set of frames --Animation may stop early on the 'grid')\n * @returns {VectorFrameBounds} a VectorFrameBounds object\n */\n\nclass VectorFrameBounds extends Rectangle {\n\n    constructor(min, max, termPoint) {\n\n        super(min, max);\n\n        this.termPoint = termPoint || new Gamelab.Vector(this.max.x, this.max.y, this.max.z);\n\n    }\n\n\n}\n;\n\nGamelab.VectorFrameBounds = VectorFrameBounds;\n\n\n\n\nvar GeoMath = {\n\n        rotatePointsXY:function(x,y,angle) {\n\n            var theta = angle*Math.PI/180;\n\n            var point = {};\n            point.x = x * Math.cos(theta) - y * Math.sin(theta);\n            point.y = x * Math.sin(theta) + y * Math.cos(theta);\n\n            point.z = 0;\n\n            return point\n        }\n\n}\n\nGamelab.GeoMath = GeoMath;\n;\r\n\r\n/**\r\n * Renderable : consistent base-type for graphic-objects\r\n * @param   {Object} args the object of arguments\r\n * @returns {Renderable} a Gamelab.Renderable object.\r\n * */\r\n\r\nclass Renderable\r\n{\r\n    constructor(args={})\r\n    {\r\n      //  Gamelab.FeatureInject(this, args);\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * A game-image object based on HTMLImage element. Creates GameImage, attaches gameImage.domElement --an instance of HTMLImageElement\r\n * @param   {string} src the sourcePath of the image-file.\r\n * @returns {GameImage} a Gamelab.GameImage object.\r\n * */\r\n\r\nclass GameImage extends Renderable {\r\n\r\n    constructor(src={}, onCreate=function(){I('image: applied default arg to onCreate():');}) {\r\n\r\n        super(src);\r\n\r\n        if(typeof src == 'object') {\r\n\r\n          return src;\r\n\r\n        }\r\n\r\n\r\n                    console.dev('GameImage--', this);\r\n\r\n                                this.domElement = document.createElement('IMG');\r\n\r\n                                this.domElement.src = src;\r\n\r\n\r\n            this.domElement.onerror = function () {\r\n                this.__error = true;\r\n                console.dev('--image error');\r\n            };\r\n\r\n    }\r\n};\r\n\r\nGamelab.GameImage = GameImage;\r\n;\r\n\r\nconsole.info('Scriptable class :: keep as public');\r\nconsole.info('Script class :: keep as public');\r\n\r\n\r\nclass Script{\r\n\r\n  constructor(uri, callback){\r\n\r\n    this.src = uri || '';\r\n\r\n    if(uri && callback)\r\n    {\r\n    this.load(uri, callback);\r\n    }\r\n    else{\r\n      console.info('Created Script() without uri + callback --1st and 2nd arguments. To use object call script.load()');\r\n    }\r\n\r\n  }\r\n\r\n  load(uri, callback){\r\n\r\n    var __object = this;\r\n\r\n    callback = callback || function(){};\r\n\r\n    callback = callback.bind(this);\r\n\r\n    var script = document.createElement('SCRIPT');\r\n    script.src = uri;\r\n\r\n    //define onload fxn\r\n    script.onload = function(){\r\n\r\n      var construct = window.module.exports;\r\n      callback(construct);\r\n\r\n    };\r\n\r\n    //append to the document\r\n    document.head.appendChild(script);\r\n\r\n  }\r\n\r\n};\r\n\r\nGamelab.Script = Script;\r\n\r\n\r\nclass Scriptable{\r\n\r\n  constructor(object, siblings){\r\n\r\n    this.object = object;\r\n\r\n    this.siblings = siblings;\r\n\r\n  }\r\n\r\n  Object(object)\r\n  {\r\n    this.object = object;\r\n    return this;\r\n  }\r\n\r\n\r\n  load(url, callback){\r\n\r\n    var __object = this;\r\n\r\n    callback = callback || function(){};\r\n\r\n    callback = callback.bind(this);\r\n\r\n    var script = document.createElement('SCRIPT');\r\n    script.src = url;\r\n\r\n    //define onload fxn\r\n    script.onload = function(){\r\n\r\n      var construct = window.module.exports;\r\n\r\n      var MOD = construct(__object.object, __object.siblings);\r\n\r\n      callback.bind(__object).call(MOD, __object.object, __object.siblings);\r\n\r\n\r\n    };\r\n\r\n    //append to the document\r\n    document.head.appendChild(script);\r\n\r\n  }\r\n\r\n};\r\n\r\nGamelab.Scriptable = Scriptable;\r\n;\n\n\nclass Elipse{\n\n  constructor(pos, size){\n    this.position = new Gamelab.Vector(0, 0, 0);\n    this.size = new Gamelab.Vector(0, 0, 0);\n    this.rotation = new Gamelab.Vector(0, 0, 0);\n    this.Pos(pos);\n    this.Size(size);\n  }\n\n  draw(){\n              var halfX = (this.size.x / 2);\n              var halfY = (this.size.y / 2);\n              Gamelab.Canvas.arc(this.position, new Gamelab.Vector(halfX, halfY));\n  }\n\n}\n\nGamelab.Elipse = Elipse;\n;\r\n\r\n\r\n\r\nclass SpatialPattern {\r\n\r\n  constructor(src, unitSize){\r\n    this.objects= [];\r\n    this.basicGridChunk = new Gamelab.Sprite(src).Size(unitSize, unitSize);\r\n\r\n  }\r\n\r\n  StepFunction(call){\r\n    this.call = call || function(){};\r\n    return this;\r\n  }\r\n\r\n  add(sprite)\r\n  {\r\n    this.objects.push(sprite);\r\n\r\n  }\r\n\r\n  Min(m1, m2){\r\n    this.min = new Gamelab.Vector(m1, m2);\r\n    return this;\r\n  }\r\n  Max(m1, m2){\r\n    this.max = new Gamelab.Vector(m1, m2);\r\n    return this;\r\n  }\r\n\r\n  Fill(callback){\r\n\r\n    for(var x = this.min.x; x < this.max.x; x++)\r\n    {\r\n\r\n      for(var y = this.min.y; y < this.max.y; y++)\r\n      {\r\n\r\n       if(this.call(x, y))\r\n       {\r\n\r\n         var chunk = new Gamelab.Sprite().FromData(this.basicGridChunk);\r\n\r\n         chunk.target_x = x;\r\n         chunk.target_y = y;\r\n\r\n         chunk.onLoad(function(){\r\n\r\n          //  this.Size();\r\n\r\n          this.Position(this.target_x, this.target_y);\r\n\r\n         });\r\n\r\n          this.add(chunk);\r\n\r\n       }\r\n      }\r\n    }\r\n\r\n\r\n    callback(this.objects);\r\n\r\n  }\r\n\r\n}\r\n\r\n\r\nGamelab.SpatialPattern = SpatialPattern;\r\n;\r\n\r\nvar Trigonometry = {\r\n\r\n  rotate_from_xy:function(cx, cy, x, y, angle) {\r\n      var radians = (Math.PI / 180) * angle,\r\n          cos = Math.cos(radians),\r\n          sin = Math.sin(radians),\r\n          nx = (cos * (x - cx)) + (sin * (y - cy)) + cx,\r\n          ny = (cos * (y - cy)) - (sin * (x - cx)) + cy;\r\n      return new Gamelab.Vector(nx, ny);\r\n  },\r\n\r\n  find_point_on_circle:function(x, y, radius, degrees){\r\n\r\n  }\r\n};\r\n\r\n\r\nGamelab.Trig = Trigonometry;\r\nGamelab.Trigonometry = Trigonometry;\r\n;\r\n\r\n\r\n\r\nfunction Curve_ToComplete(tag){\r\n  var log_it = function(sub_tag){\r\n    return (function(){\r\n        console.info('Curve_ToComplete:' + tag + '.' + sub_tag);\r\n    })();\r\n  };\r\n  return {\r\n    In:log_it('In'),\r\n    Out:log_it('Out'),\r\n    Seamless:log_it('Seamless')\r\n  }\r\n};\r\n\r\n\r\n\r\n  var linkedCurves = {\r\n\r\n    quadratic: function(t) {\r\n      return t < .5 ? 2 * t * t : -1 + (4 - 2 * t) * t\r\n    },\r\n\r\n    cubic: function(t) {\r\n      return t < .5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1\r\n    },\r\n\r\n    quartic: function(t) {\r\n      return t < .5 ? 8 * t * t * t * t : 1 - 8 * (--t) * t * t * t\r\n    },\r\n\r\n    quintic: function(t) {\r\n      return t < .5 ? 16 * t * t * t * t * t : 1 + 16 * (--t) * t * t * t * t\r\n    },\r\n\r\n    linear: function(t) {\r\n      return t;\r\n    } //provided for consistency / in case 'linear' is needed\r\n\r\n  };\r\n\r\n\r\nlet Twix = {\r\n\r\n  Curves:{\r\n    //ALL HAVE INPUT AND OUTPUT OF: 0-1.0\r\n      // no easing, no acceleration\r\n      Linear: {\r\n        None: function(t) {\r\n          return t;\r\n        }\r\n      },\r\n\r\n      Quadratic: {\r\n        In: function(t) {\r\n          return t * t;\r\n        },\r\n        Out: function(t) {\r\n          return t * (2 - t);\r\n        },\r\n        Seamless: function(t) {\r\n          return t < .5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\r\n        }\r\n      },\r\n\r\n      Cubic: {\r\n        In: function(t) {\r\n          return t * t * t;\r\n        },\r\n        Out: function(t) {\r\n          return (--t) * t * t + 1;\r\n        },\r\n        Seamless: function(t) {\r\n          return t < .5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\r\n        }\r\n      },\r\n\r\n      Quartic: {\r\n        In: function(t) { return t * t * t * t; },\r\n        Out: function(t) { return 1 - (--t) * t * t * t; },\r\n        Seamless: function(t) { return t < .5 ? 8 * t * t * t * t : 1 - 8 * (--t) * t * t * t; }\r\n      },\r\n\r\n      Quintic: {\r\n        In: function(t) { return t * t * t * t * t; },\r\n        Out: function(t) { return 1 + (--t) * t * t * t * t; },\r\n        Seamless: function(t) { return t < .5 ? 16 * t * t * t * t * t : 1 + 16 * (--t) * t * t * t * t; }\r\n      },\r\n\r\n      Sine:Curve_ToComplete('Sine'),\r\n\r\n      Cosine:Curve_ToComplete('Cosine'),\r\n\r\n      Tangent:Curve_ToComplete('Tangent'),\r\n\r\n      Exponential:Curve_ToComplete('Exponential'),\r\n\r\n\r\n  },\r\n\r\n  LinkedCurves:linkedCurves\r\n\r\n};\r\n\r\n\r\n\r\nconst TranceCurves = {};\r\n\r\nTranceCurves.Exponential = (value, power, min, max) => {\r\n\r\n};\r\n\r\nTranceCurves.Power = (value, power, min, max) => {\r\n\r\n};\r\n\r\n\r\nconst TrigFunctions = {};\r\n\r\nTrigFunctions.Sine = {};\r\n\r\nTrigFunctions.Cosine = {};\r\n\r\nTrigFunctions.Tangent = {};\r\n\r\n\r\nconst SpecialFunctions = {};\r\n\r\nSpecialFunctions.Sawtooth = (t) => { return t <= 1.0 ? t : 0; };\r\n\r\nSpecialFunctions.Square = () => {};\r\n\r\nSpecialFunctions.Triangle = () => {};\r\n\r\nSpecialFunctions.Floor = () => {};\r\n\r\nSpecialFunctions.Sign = () => {};\r\n\r\nGamelab.core = Gamelab.core || {};\r\n\r\nGamelab.core.XYFunctions = {};\r\n\r\nGamelab.core.XYFunctions.SpecialFunctions = SpecialFunctions;\r\n\r\n\r\n\r\nconst SigmaFunctions = {};\r\n\r\nconst GammaFunctions = {};\r\n;(function() {\r\n  console.log('Vector class... creating');\r\n\r\n  /**\r\n   * Creates a Vector object with x, y, and --optional z.\r\n   * @param   {number} x the x coordinate\r\n   * @param   {number} y the y coordinate\r\n   * @param   {number} z the optional z coordinate\r\n   * @param   {number} r the optional r value\r\n   * @returns {Vector} a Vector object\r\n   */\r\n\r\n\r\n  class Vector {\r\n    constructor(x, y, z, r) {\r\n\r\n      var copied = false;\r\n\r\n      if (typeof(x) == 'object' && x.hasOwnProperty('x') && x.hasOwnProperty('y')) //optionally pass vector3\r\n      {\r\n        this.x = x.x;\r\n        this.y = x.y;\r\n        this.z = x.z || 0;\r\n\r\n        if (this.z == null) {\r\n          this.z = 0;\r\n        }\r\n\r\n        this.valid_check();\r\n\r\n        copied = true;\r\n      }\r\n\r\n      if (z == null) {\r\n        z = 0;\r\n      }\r\n\r\n      if (!copied) {\r\n\r\n        this.x = x;\r\n        this.y = y;\r\n        this.z = z;\r\n        this.r = r;\r\n\r\n        this.valid_check();\r\n\r\n      }\r\n    }\r\n\r\n    valid_check() {\r\n      if (this.x == undefined) {\r\n        this.x = 0;\r\n      }\r\n      if (this.y == undefined) {\r\n        this.y = 0;\r\n      }\r\n      if (this.z == undefined) {\r\n        this.z = 0;\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Subtracts another Vector from this vector and returns a vector for the resulting difference.\r\n     *\r\n     * @function\r\n     * @param {Vector} v the vector to be subtracted from this vector\r\n     * @memberof Vector\r\n     **********/\r\n\r\n    sub(v) {\r\n      if (typeof(v) == 'number') {\r\n        v = {\r\n          x: v,\r\n          y: v,\r\n          z: v\r\n        };\r\n      };\r\n\r\n      return new Gamelab.Vector(this.x - v.x, this.y - v.y, this.z - v.z);\r\n\r\n    }\r\n\r\n    /**\r\n     * Adds another Vector to this vector and returns a vector for the resulting sum.\r\n     *\r\n     * @function\r\n     * @param {Vector} v the vector to be added to this vector\r\n     * @memberof Vector\r\n     **********/\r\n\r\n    add(v) {\r\n      if (typeof(v) == 'number') {\r\n        v = {\r\n          x: v,\r\n          y: v,\r\n          z: v\r\n        };\r\n      };\r\n\r\n      return new Gamelab.Vector(this.x + v.x, this.y + v.y, this.z + v.z);\r\n\r\n    }\r\n\r\n    /**\r\n     * Multiplies another Vector by this vector and returns a vector for the resulting product.\r\n     *\r\n     * @function\r\n     * @param {Vector} v the vector that this vector will by muliplied by\r\n     * @memberof Vector\r\n     **********/\r\n\r\n    mult(v) {\r\n      if (typeof(v) == 'number') {\r\n        v = {\r\n          x: v,\r\n          y: v,\r\n          z: v\r\n        };\r\n      };\r\n\r\n      return new Gamelab.Vector(this.x * v.x, this.y * v.y, this.z * v.z);\r\n\r\n    }\r\n\r\n    /**\r\n     * Gets vector of absolute values.\r\n     *\r\n     * @function\r\n     * @param {Vector} v the absolute vector\r\n     * @memberof Vector\r\n     **********/\r\n\r\n    abs() {\r\n\r\n      return new Gamelab.Vector(Math.abs(this.x), Math.abs(this.y), Math.abs(this.z));\r\n\r\n    }\r\n\r\n    /**\r\n     * Divides another Vector by this vector and returns a vector for the resulting quotient.\r\n     *\r\n     * @function\r\n     * @param {Vector} v the vector for this vector to be divided by\r\n     * @memberof Vector\r\n     **********/\r\n\r\n    div(v) {\r\n      if (typeof(v) == 'number') {\r\n        v = {\r\n          x: v,\r\n          y: v,\r\n          z: v\r\n        };\r\n      };\r\n\r\n      return new Gamelab.Vector(this.x / v.x, this.y / v.y, this.z / v.z);\r\n    }\r\n\r\n    /**\r\n     * Rounds this vector to the nearest set of whole numbers and returns the result.\r\n     *\r\n     * @function\r\n     * @memberof Vector\r\n     * @returns {Vector} a Gamelab.Vector object\r\n     **********/\r\n\r\n    round() {\r\n      return new Gamelab.Vector(Math.round(this.x), Math.round(this.y), Math.round(this.z));\r\n\r\n    }\r\n\r\n    /**\r\n     * Floors this vector to the nearest set of whole numbers and returns the result (subtractive-only, an x of 1.7 becomes 1)\r\n     *\r\n     * @function\r\n     * @memberof Vector\r\n     * @returns {Vector} a Gamelab.Vector object\r\n     **********/\r\n\r\n    floor() {\r\n      return new Gamelab.Vector(Math.floor(this.x), Math.floor(this.y), Math.floor(this.z));\r\n\r\n    }\r\n\r\n    /**\r\n     * Ceils this vector to the nearest set of whole numbers  and returns the result (additive-only, an x of 1.2 becomes 2)\r\n     *\r\n     * @function\r\n     * @memberof Vector\r\n     * @returns {Vector} a Gamelab.Vector object\r\n     **********/\r\n\r\n    ceil() {\r\n      return new Gamelab.Vector(Math.ceil(this.x), Math.ceil(this.y), Math.ceil(this.z));\r\n\r\n    }\r\n\r\n    /**\r\n     * Creates new vector, with the negated x,y,z values (-x-y-z), returns the resulting vector\r\n     *\r\n     * @function\r\n     * @memberof Vector\r\n     * @returns {Vector} a Gamelab.Vector object\r\n     **********/\r\n\r\n    neg() {\r\n      return new Gamelab.Vector(-this.x, -this.y, -this.z);\r\n    }\r\n\r\n    /**\r\n     * An equals-test for vectors. Returns true OR false.\r\n     *\r\n     * @function\r\n     * @memberof Vector\r\n     * @returns {boolean} a true OR false value\r\n     **********/\r\n\r\n    equals(v) {\r\n\r\n      return this.x == v.x && this.y == v.y && this.z == v.z;\r\n    }\r\n\r\n    /**\r\n     * Gets  the specific distance between this and the argument-vector. --applies to x and y of two vectors. Returns a single number.\r\n     *\r\n     * @function\r\n     * @memberof Vector\r\n     * @returns {number} the specific distance between this and the argument-vector\r\n     **********/\r\n\r\n    trig_distance_xy(v) {\r\n\r\n      var dist = this.sub(v);\r\n\r\n      return Math.sqrt(dist.x * dist.x + dist.y * dist.y);\r\n\r\n    }\r\n\r\n\r\n    is_between(v1, v2) {\r\n      //TODO : overlap vectors return boolean\r\n\r\n      return this.x >= v1.x && this.x <= v2.x &&\r\n        this.y >= v1.y && this.y <= v2.y &&\r\n        this.z >= v1.z && this.z <= v2.z;\r\n\r\n\r\n    }\r\n\r\n    /**\r\n     * Returns a vector-multiple: the original-size, multiplied by a random between the minFloat and maxFloat arguments.\r\n     *\r\n     * @function\r\n     * @memberof Vector\r\n     * @returns {Vector} the resulting vector.\r\n     **********/\r\n\r\n    randomize(minFloat, maxFloat) {\r\n\r\n      var random = (Math.random() * (maxFloat - minFloat) + minFloat) * 1000 / 1000;\r\n\r\n      return this.mult(random);\r\n\r\n    }\r\n\r\n    /**\r\n     * Returns a speed vector, based on rotation.\r\n     *\r\n     * @function\r\n     * @param {number} rotation in degrees, 0-360\r\n     * @param {number} speed the level of speed to apply, default being 1\r\n     * @returns {Vector}\r\n     * @memberof Vector\r\n     **********/\r\n\r\n    rotationalSpeedPoint(rotation, speed) {\r\n      var r = rotation;\r\n\r\n      if (isNaN(speed)) {\r\n        speed = 1;\r\n      }\r\n\r\n      if (typeof(rotation) == 'object' && rotation.x) {\r\n        r = rotation.x;\r\n      }\r\n\r\n      return new Gamelab.Vector(Math.cos((r) * 3.14 / 180) * speed, Math.sin((r) * 3.14 / 180) * speed);\r\n\r\n    }\r\n\r\n    /**\r\n     * Returns the right-handed angle of degrees between two two position-vectors.\r\n\r\n     * @memberof Vector\r\n     * @function\r\n     * @param {Vector} p1 the 1st vector-argument\r\n     * @param {Vector} p2 the 2nd vector-argument\r\n     * @returns {number} the resulting angle in degrees.\r\n     **********/\r\n\r\n    angleBetween(p1, p2) {\r\n\r\n      return Math.atan2(p2.y - p1.y, p2.x - p1.x) * 180 / Math.PI;\r\n    }\r\n\r\n    //apply minimum value to all values\r\n    min2d() {\r\n\r\n      function minimize(object, key1, key2) {\r\n        if (object[key1] < object[key2])\r\n          object[key2] = object[key1];\r\n\r\n        if (object[key2] < object[key1])\r\n          object[key1] = object[key2];\r\n      };\r\n\r\n      minimize(this, 'x', 'y');\r\n\r\n      return this;\r\n    }\r\n\r\n\r\n    //apply maximum value to all values\r\n    max2d() {\r\n\r\n      function maximize(object, key1, key2) {\r\n        if (object[key1] > object[key2])\r\n          object[key2] = object[key1];\r\n\r\n        if (object[key2] > object[key1])\r\n          object[key1] = object[key2];\r\n      };\r\n\r\n      maximize(this, 'x', 'y');\r\n\r\n      return this;\r\n    }\r\n\r\n  };\r\n\r\n  let Vector3 = Vector,\r\n    Pos = Vector,\r\n    Size = Vector,\r\n    Position = Vector,\r\n    Vector2 = Vector,\r\n    Rotation = Vector;\r\n\r\n  Gamelab.Vector = Vector;\r\n\r\n  //synonymous w/ Vector::\r\n  Gamelab.Vector2d = Vector;\r\n  Gamelab.Vector2D = Vector;\r\n  Gamelab.Rotation = Vector;\r\n  Gamelab.Pos = Vector;\r\n  Gamelab.Position = Vector;\r\n  Gamelab.Size = Vector;\r\n\r\n  //The above are a list of synonymous expressions for Vector. All of these do the same thing in this library (store and manipulate x,y,z values)\r\n\r\n  var VectorMath = {\r\n\r\n    rotatePointsXY(x, y, angle) {\r\n\r\n      var theta = angle * Math.PI / 180;\r\n\r\n      var point = {};\r\n      point.x = x * Math.cos(theta) - y * Math.sin(theta);\r\n      point.y = x * Math.sin(theta) + y * Math.cos(theta);\r\n\r\n      point.z = 0;\r\n\r\n      return new Gamelab.Vector(point);\r\n    }\r\n\r\n  }\r\n\r\n  Gamelab.VectorMath = VectorMath;\r\n\r\n})();\r\n;/**\r\n * Creates a new WebGl --an experimental class for 3D-objects via THREE.js --requires THREE.js be included\r\n * @param   {Object} canvas the canvas element.\r\n * @param   {Object} drawables the drawable objects to be drawn.\r\n * @returns {WebGL} a 2d/3d game-window object\r\n * */\r\n\r\nclass WebGL {\r\n  constructor(canvas = false, drawables = []) {\r\n\r\n    if (!THREE) {\r\n      return console.error('THREE.js required in window');\r\n    }\r\n\r\n\r\n    document.body.style.position = \"absolute\";\r\n\r\n    document.body.style.width = \"100%\";\r\n\r\n    document.body.style.height = \"100%\";\r\n\r\n\r\n    var camera = new THREE.PerspectiveCamera();\r\n\r\n    var container = document.querySelector('#threejs-window');\r\n\r\n    this.renderer = new THREE.WebGLRenderer();\r\n\r\n    this.camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000); //was 1000 last arg\r\n\r\n    this.scene = new THREE.Scene();\r\n\r\n    this.renderer.setSize(container.clientWidth, container.clientHeight);\r\n\r\n    Gamelab.threejs = {};\r\n\r\n    Gamelab.threejs.renderer = this.renderer;\r\n\r\n    Gamelab.threejs.camera = this.camera;\r\n\r\n    Gamelab.threejs.scene = this.scene;\r\n\r\n    container.append(this.renderer.domElement);\r\n\r\n\r\n    this.scene.add(this.camera);\r\n\r\n    this.light = new THREE.AmbientLight(0x404040); // soft white light\r\n    this.scene.add(this.light);\r\n\r\n    this.drawables = drawables;\r\n\r\n    this.bool_events = Gamelab.bool_events || [];\r\n\r\n    this.canvas = this.renderer.domElement;\r\n\r\n    this.camera.target = false;\r\n\r\n    var __inst = this;\r\n\r\n    this.update_ext = [];\r\n\r\n\r\n    window.onerror = function() {\r\n\r\n      Gamelab.errors += 1;\r\n\r\n      console.log('Canvas Error --');\r\n\r\n      if (Gamelab.errors > Gamelab.settings.errorLimit) {\r\n        Gamelab.stopDraw = true;\r\n\r\n        var call = call || window.setTimeout(function() {\r\n\r\n          if (call) {\r\n            window.clearTimeout(call);\r\n          }\r\n          console.log('%cDraw stopped at errorLimit:' + Gamelab.settings.errorLimit, 'color:darkorange;');\r\n\r\n        }, 200);\r\n\r\n      }\r\n\r\n    }\r\n\r\n\r\n  }\r\n\r\n\r\n  /**\r\n   * returns the webGL.canvas property, an HTMLCanvasElement\r\n   *\r\n   * @function\r\n   * @memberof WebGL\r\n   **********/\r\n\r\n  getCanvas() {\r\n    return this.canvas;\r\n  }\r\n\r\n\r\n  /**\r\n   * returns a vector(x, y) of the center of the WebGL\r\n   *\r\n   * @function\r\n   * @memberof WebGL\r\n   **********/\r\n\r\n\r\n  center() {\r\n\r\n    return new Gamelab.Vector(Math.round(this.canvas.width / 2), Math.round(this.canvas.height / 2));\r\n\r\n  }\r\n\r\n\r\n\r\n  getCanvas() {\r\n    return this.canvas;\r\n  }\r\n\r\n\r\n  /**\r\n   * adds an update to the WebGL:: update to be called every 20 milliseconds\r\n   *\r\n   * @function\r\n   * @memberof WebGL\r\n   **********/\r\n\r\n\r\n  onUpdate(f) {\r\n\r\n    this.update_ext.push(f);\r\n\r\n  }\r\n\r\n  /**\r\n   * the main update for the WebGL:: called automatically after call of WebGL.start() or WebGL.animate()\r\n   *\r\n   * @function\r\n   * @memberof WebGL\r\n   **********/\r\n\r\n  update() {\r\n\r\n    Gamelab.each(this.drawables, function(ix, item) {\r\n\r\n      if (item && typeof(item.def_update) == 'function') {\r\n\r\n        item.def_update(item);\r\n\r\n      }\r\n\r\n      if (item && typeof(item.update) == 'function') {\r\n        item.update(item);\r\n\r\n      }\r\n\r\n\r\n      if (item && ['SpriteArray', 'RobotixArray', 'RobotixVerticalChain'].indexOf(item.constructor.name) >= 0 &&\r\n        typeof item.each == 'function') {\r\n\r\n        item.each(function(ix, graphic) {\r\n\r\n          graphic.update(graphic);\r\n\r\n        });\r\n\r\n      }\r\n\r\n    });\r\n\r\n    Gamelab.each(this.bool_events, function(ix, item) {\r\n\r\n      if (item && item.bool()) {\r\n        item.callback();\r\n      }\r\n\r\n    });\r\n\r\n\r\n    for (var x in this.update_ext) {\r\n      this.update_ext[x]();\r\n    }\r\n  }\r\n\r\n  draw() {\r\n\r\n    var __WebGL = this;\r\n\r\n    if (this.before_draw_ext) {\r\n      this.before_draw_ext();\r\n    }\r\n\r\n    Gamelab.each(this.drawables, function(ix, item) {\r\n\r\n      if (typeof item.draw == 'function') {\r\n        item.draw(__WebGL.ctx, __WebGL.camera);\r\n      }\r\n\r\n    });\r\n\r\n\r\n    if (this.after_draw_ext) {\r\n      this.after_draw_ext();\r\n    }\r\n\r\n  }\r\n\r\n\r\n  /**\r\n   * adds a call before the WebGL draw()\r\n   *\r\n   * @function\r\n   * @memberof WebGL\r\n   **********/\r\n\r\n  onBeforeDraw(f) {\r\n\r\n    var boundCall = f.bind(this);\r\n\r\n    if (!this.before_draw_ext)\r\n      this.before_draw_ext = function() {};\r\n\r\n    var beforeDraw = this.before_draw_ext.bind(this);\r\n\r\n    this.before_draw_ext = function() {\r\n      beforeDraw();\r\n      boundCall();\r\n    };\r\n\r\n  }\r\n\r\n  /**\r\n   * adds a call after the WebGL draw()\r\n   *\r\n   * @function\r\n   * @memberof WebGL\r\n   **********/\r\n\r\n\r\n  onAfterDraw(f) {\r\n\r\n    var boundCall = f.bind(this);\r\n\r\n    if (!this.after_draw_ext)\r\n      this.after_draw_ext = function() {};\r\n\r\n\r\n    var afterDraw = this.after_draw_ext.bind(this);\r\n\r\n    this.after_draw_ext = function() {\r\n      afterDraw();\r\n      boundCall();\r\n    };\r\n\r\n  }\r\n\r\n  /**\r\n   * sets the size of the WebGL\r\n   *\r\n   * @function\r\n   * @param {integer} w the width of the WebGL\r\n   * @param {integer} h the HEIGHT of the WebGL\r\n   * @memberof WebGL\r\n   **********/\r\n\r\n  Size(w, h, isAbsoluteSize) { //call with no args to fill to browser-window-size;\r\n\r\n    w = w || this.canvas.parentNode.clientWidth;\r\n\r\n    h = h || this.canvas.parentNode.clientHeight;\r\n\r\n    var c = this.canvas;\r\n\r\n    if (c) {\r\n      c.setAttribute('width', w)\r\n    };\r\n\r\n    if (c) {\r\n      c.setAttribute('height', h)\r\n    };\r\n\r\n    Gamelab.WIDTH = w;\r\n\r\n    Gamelab.HEIGHT = h;\r\n\r\n    this.canvas.width = w;\r\n\r\n    this.canvas.height = h;\r\n\r\n    this.size = new Gamelab.Vector(w, h);\r\n\r\n    this.isAbsoluteSize = isAbsoluteSize || false;\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n  /**\r\n   * adds an object to the WebGL\r\n   *\r\n   * @function\r\n   * @param {Object} obj the object to be added (Sprite)\r\n   * @param {Boolean} onBottom if true, adds to the bottom of layer-stack in WebGL\r\n   * @memberof WebGL\r\n   **********/\r\n\r\n  add(obj, options = {}) {\r\n\r\n    var optionsGuide = {\r\n      obj: 'The Object{} being added into play',\r\n      options: {\r\n        position: 'The Vector(x, y) offset to use when drawing the obj'\r\n      }\r\n    };\r\n\r\n    console.info('WebGL.add() --2nd argument options is object of arguments >>>', optionsGuide);\r\n\r\n    var layer = options.layer || this.drawables.length - 1;\r\n\r\n    if (!(typeof layer == 'number' && layer >= 0))\r\n      layer = this.drawables.length;\r\n\r\n    var offset = new Gamelab.Vector(0, 0);\r\n\r\n    if (options.position)\r\n      offset = options.position;\r\n\r\n    obj.window_offset = offset;\r\n\r\n    //1: if Sprite(), Add object to the existing __WebGL\r\n\r\n    var __inst = this;\r\n\r\n    if (obj instanceof Gamelab.Camera) {\r\n\r\n      this.camera = obj;\r\n\r\n    } else if (obj instanceof Gamelab.GSEvent) {\r\n\r\n      if (Gamelab.__running) {\r\n\r\n        return console.error('Events can only be added before Gamstack.animate() is called::aka before the main update / loop begins');\r\n      } else {\r\n\r\n        obj.apply();\r\n\r\n      }\r\n    } else {\r\n\r\n      this.drawables.splice(layer, 0, obj);\r\n\r\n    };\r\n\r\n    return obj;\r\n\r\n  }\r\n\r\n  /**\r\n   * set background-color of WebGL\r\n   *\r\n   * @function\r\n   * @param {string} c the new background-color for WebGL\r\n   * @memberof WebGL\r\n   **********/\r\n\r\n  Background(c) {\r\n    this.canvas.style.background = c;\r\n\r\n    this.canvas.style.backgroundColor = c;\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n  /**\r\n   * removes an object from the WebGL\r\n   *\r\n   * @function\r\n   * @param {Object} obj the object to be removed (Sprite)\r\n   * @memberof WebGL\r\n   **********/\r\n\r\n  remove(obj) {\r\n\r\n    var ix = this.drawables.indexOf(obj);\r\n\r\n    if (ix >= 0) {\r\n      this.drawables.splice(ix, 1);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * begins the animation-loop of WebGL.\r\n   *\r\n   * @function\r\n   * @param {number} time optional time parameter for usage with Tween\r\n   * @memberof WebGL\r\n   **********/\r\n\r\n\r\n  animate(time) {\r\n\r\n    var __inst = this;\r\n\r\n    requestAnimationFrame(function() {\r\n\r\n      __inst.animate();\r\n\r\n    });\r\n\r\n\r\n    if (Gamelab.__stats) {\r\n      Gamelab.__stats.begin();\r\n      Gamelab.__statsMS.begin();\r\n      Gamelab.__statsMB.update();\r\n    }\r\n\r\n    Gamelab.isAtPlay = true;\r\n\r\n    if (window.TWEEN)\r\n      TWEEN.update(time);\r\n\r\n    console.log('Rendering');\r\n    this.renderer.render(this.scene, this.camera);\r\n\r\n\r\n    if (Gamelab.__stats) {\r\n      Gamelab.__stats.end();\r\n      Gamelab.__statsMS.end();\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * begins the animation-loop of WebGL, with performance Stats shown on-screen\r\n   *\r\n   * @function\r\n   * @memberof WebGL\r\n   **********/\r\n\r\n\r\n  start() {\r\n\r\n    if (typeof(Stats) == 'function') //Stats library exists\r\n    {\r\n      //basic stat animation\r\n      Gamelab.__stats = new Stats();\r\n      Gamelab.__stats.showPanel(0); // 0: fps, 1: ms, 2: mb, 3+: custom\r\n\r\n      Gamelab.__stats.dom.style.left = '10%';\r\n\r\n      Gamelab.__stats.dom.setAttribute('class', 'stat');\r\n\r\n      this.canvas.parentNode.appendChild(Gamelab.__stats.dom);\r\n\r\n      //basic stat animation\r\n      Gamelab.__statsMS = new Stats();\r\n      Gamelab.__statsMS.showPanel(1); // 0: fps, 1: ms, 2: mb, 3+: custom\r\n\r\n      Gamelab.__statsMS.dom.style.left = '10%';\r\n\r\n      Gamelab.__statsMS.dom.style.marginLeft = '90px';\r\n\r\n      Gamelab.__statsMS.dom.setAttribute('class', 'stat');\r\n\r\n      this.canvas.parentNode.appendChild(Gamelab.__statsMS.dom);\r\n\r\n      //basic stat animation\r\n      Gamelab.__statsMB = new Stats();\r\n      Gamelab.__statsMB.showPanel(2); // 0: fps, 1: ms, 2: mb, 3+: custom\r\n\r\n      Gamelab.__statsMB.dom.style.left = '10%';\r\n\r\n      Gamelab.__statsMB.dom.setAttribute('class', 'stat');\r\n\r\n      Gamelab.__statsMB.dom.style.marginLeft = '180px';\r\n\r\n      this.canvas.parentNode.appendChild(Gamelab.__statsMB.dom);\r\n    }\r\n\r\n    this.animate();\r\n  }\r\n}\r\n\r\nGamelab.WebGL = WebGL;\r\n\r\nGamelab.WebGl = WebGL;\r\n;class RGBAColor {\r\n  constructor(r=0, g=0, b=0, a=0) {\r\n    this.r = r;\r\n    this.g = g;\r\n    this.b = b;\r\n    this.a = a;\r\n  }\r\n\r\n  fromString(str){\r\n\r\n    str = str.replace(/^\\s*#|\\s*$/g, '');\r\n    str = str.toLowerCase();\r\n    if (ColorStrings[str]) str = ColorStrings[str];\r\n\r\n    var match;\r\n\r\n    // RGB(A)\r\n    if ((match = str.match(RE_RGB) || str.match(RE_RGBA))) {\r\n\r\n\r\n          console.log('Processing Match::' + jstr(match));\r\n\r\n\r\n        return new Gamelab.RGBAColor(\r\n            parseInt(match[1], 10),\r\n            parseInt(match[2], 10),\r\n            parseInt(match[3], 10),\r\n            parseFloat(match.length === 4 ? 1 : match[4])\r\n        );\r\n    }\r\n\r\n\r\n  }\r\n\r\n  fromData(data)\r\n  {\r\n    return new Gamelab.RGBAColor(\r\n        parseInt(data[0], 10),\r\n        parseInt(data[1], 10),\r\n        parseInt(data[2], 10),\r\n        parseFloat(data.length === 3 ? 1 : data[3])\r\n    );\r\n\r\n  }\r\n\r\n  distance(color){\r\n\r\n    var sumOfSquares = 0;\r\n\r\n    sumOfSquares += Math.pow(this.r - color.r, 2);\r\n    sumOfSquares += Math.pow(this.g - color.g, 2);\r\n    sumOfSquares += Math.pow(this.b - color.b, 2);\r\n\r\n    return Math.sqrt(sumOfSquares);\r\n  }\r\n\r\n  match_by_tolerance(color, tolerance) {\r\n\r\n    var matches = {\r\n      r:color.r,\r\n      g:color.g,\r\n      b:color.b\r\n    };\r\n\r\n    var total_diff = 0;\r\n\r\n    for(var x in matches)\r\n    {\r\n      var diff =  Math.abs(color[x] - this[x]);\r\n\r\n      console.log('COLOR-DIFF: --1::' + jstr(this) + ':: --2::' + jstr(color));\r\n\r\n      total_diff += diff;\r\n    }\r\n\r\n    return total_diff <= tolerance;\r\n\r\n  }\r\n\r\n};\r\n\r\n\r\nGamelab.RGBAColor = RGBAColor;\r\n\r\n\r\nvar ColorStrings = {\r\n    aliceblue: 'rgb(240, 248, 255)',\r\n    antiquewhite: 'rgb(250, 235, 215)',\r\n    aqua: 'rgb(0, 255, 255)',\r\n    aquamarine: 'rgb(127, 255, 212)',\r\n    azure: 'rgb(240, 255, 255)',\r\n    beige: 'rgb(245, 245, 220)',\r\n    bisque: 'rgb(255, 228, 196)',\r\n    black: 'rgb(0, 0, 0)',\r\n    blanchedalmond: 'rgb(255, 235, 205)',\r\n    blue: 'rgb(0, 0, 255)',\r\n    blueviolet: 'rgb(138, 43, 226)',\r\n    brown: 'rgb(165, 42, 42)',\r\n    burlywood: 'rgb(222, 184, 135)',\r\n    cadetblue: 'rgb(95, 158, 160)',\r\n    chartreuse: 'rgb(127, 255, 0)',\r\n    chocolate: 'rgb(210, 105, 30)',\r\n    coral: 'rgb(255, 127, 80)',\r\n    cornflowerblue: 'rgb(100, 149, 237)',\r\n    cornsilk: 'rgb(255, 248, 220)',\r\n    crimson: 'rgb(220, 20, 60)',\r\n    cyan: 'rgb(0, 255, 255)',\r\n    darkblue: 'rgb(0, 0, 139)',\r\n    darkcyan: 'rgb(0, 139, 139)',\r\n    darkgoldenrod: 'rgb(184, 134, 11)',\r\n    darkgray: 'rgb(169, 169, 169)',\r\n    darkgreen: 'rgb(0, 100, 0)',\r\n    darkgrey: 'rgb(169, 169, 169)',\r\n    darkkhaki: 'rgb(189, 183, 107)',\r\n    darkmagenta: 'rgb(139, 0, 139)',\r\n    darkolivegreen: 'rgb(85, 107, 47)',\r\n    darkorange: 'rgb(255, 140, 0)',\r\n    darkorchid: 'rgb(153, 50, 204)',\r\n    darkred: 'rgb(139, 0, 0)',\r\n    darksalmon: 'rgb(233, 150, 122)',\r\n    darkseagreen: 'rgb(143, 188, 143)',\r\n    darkslateblue: 'rgb(72, 61, 139)',\r\n    darkslategray: 'rgb(47, 79, 79)',\r\n    darkslategrey: 'rgb(47, 79, 79)',\r\n    darkturquoise: 'rgb(0, 206, 209)',\r\n    darkviolet: 'rgb(148, 0, 211)',\r\n    deeppink: 'rgb(255, 20, 147)',\r\n    deepskyblue: 'rgb(0, 191, 255)',\r\n    dimgray: 'rgb(105, 105, 105)',\r\n    dimgrey: 'rgb(105, 105, 105)',\r\n    dodgerblue: 'rgb(30, 144, 255)',\r\n    firebrick: 'rgb(178, 34, 34)',\r\n    floralwhite: 'rgb(255, 250, 240)',\r\n    forestgreen: 'rgb(34, 139, 34)',\r\n    fuchsia: 'rgb(255, 0, 255)',\r\n    gainsboro: 'rgb(220, 220, 220)',\r\n    ghostwhite: 'rgb(248, 248, 255)',\r\n    gold: 'rgb(255, 215, 0)',\r\n    goldenrod: 'rgb(218, 165, 32)',\r\n    gray: 'rgb(128, 128, 128)',\r\n    green: 'rgb(0, 128, 0)',\r\n    greenyellow: 'rgb(173, 255, 47)',\r\n    grey: 'rgb(128, 128, 128)',\r\n    honeydew: 'rgb(240, 255, 240)',\r\n    hotpink: 'rgb(255, 105, 180)',\r\n    indianred: 'rgb(205, 92, 92)',\r\n    indigo: 'rgb(75, 0, 130)',\r\n    ivory: 'rgb(255, 255, 240)',\r\n    khaki: 'rgb(240, 230, 140)',\r\n    lavender: 'rgb(230, 230, 250)',\r\n    lavenderblush: 'rgb(255, 240, 245)',\r\n    lawngreen: 'rgb(124, 252, 0)',\r\n    lemonchiffon: 'rgb(255, 250, 205)',\r\n    lightblue: 'rgb(173, 216, 230)',\r\n    lightcoral: 'rgb(240, 128, 128)',\r\n    lightcyan: 'rgb(224, 255, 255)',\r\n    lightgoldenrodyellow: 'rgb(250, 250, 210)',\r\n    lightgray: 'rgb(211, 211, 211)',\r\n    lightgreen: 'rgb(144, 238, 144)',\r\n    lightgrey: 'rgb(211, 211, 211)',\r\n    lightpink: 'rgb(255, 182, 193)',\r\n    lightsalmon: 'rgb(255, 160, 122)',\r\n    lightseagreen: 'rgb(32, 178, 170)',\r\n    lightskyblue: 'rgb(135, 206, 250)',\r\n    lightslategray: 'rgb(119, 136, 153)',\r\n    lightslategrey: 'rgb(119, 136, 153)',\r\n    lightsteelblue: 'rgb(176, 196, 222)',\r\n    lightyellow: 'rgb(255, 255, 224)',\r\n    lime: 'rgb(0, 255, 0)',\r\n    limegreen: 'rgb(50, 205, 50)',\r\n    linen: 'rgb(250, 240, 230)',\r\n    magenta: 'rgb(255, 0, 255)',\r\n    maroon: 'rgb(128, 0, 0)',\r\n    mediumaquamarine: 'rgb(102, 205, 170)',\r\n    mediumblue: 'rgb(0, 0, 205)',\r\n    mediumorchid: 'rgb(186, 85, 211)',\r\n    mediumpurple: 'rgb(147, 112, 219)',\r\n    mediumseagreen: 'rgb(60, 179, 113)',\r\n    mediumslateblue: 'rgb(123, 104, 238)',\r\n    mediumspringgreen: 'rgb(0, 250, 154)',\r\n    mediumturquoise: 'rgb(72, 209, 204)',\r\n    mediumvioletred: 'rgb(199, 21, 133)',\r\n    midnightblue: 'rgb(25, 25, 112)',\r\n    mintcream: 'rgb(245, 255, 250)',\r\n    mistyrose: 'rgb(255, 228, 225)',\r\n    moccasin: 'rgb(255, 228, 181)',\r\n    navajowhite: 'rgb(255, 222, 173)',\r\n    navy: 'rgb(0, 0, 128)',\r\n    oldlace: 'rgb(253, 245, 230)',\r\n    olive: 'rgb(128, 128, 0)',\r\n    olivedrab: 'rgb(107, 142, 35)',\r\n    orange: 'rgb(255, 165, 0)',\r\n    orangered: 'rgb(255, 69, 0)',\r\n    orchid: 'rgb(218, 112, 214)',\r\n    palegoldenrod: 'rgb(238, 232, 170)',\r\n    palegreen: 'rgb(152, 251, 152)',\r\n    paleturquoise: 'rgb(175, 238, 238)',\r\n    palevioletred: 'rgb(219, 112, 147)',\r\n    papayawhip: 'rgb(255, 239, 213)',\r\n    peachpuff: 'rgb(255, 218, 185)',\r\n    peru: 'rgb(205, 133, 63)',\r\n    pink: 'rgb(255, 192, 203)',\r\n    plum: 'rgb(221, 160, 221)',\r\n    powderblue: 'rgb(176, 224, 230)',\r\n    purple: 'rgb(128, 0, 128)',\r\n    red: 'rgb(255, 0, 0)',\r\n    rosybrown: 'rgb(188, 143, 143)',\r\n    royalblue: 'rgb(65, 105, 225)',\r\n    saddlebrown: 'rgb(139, 69, 19)',\r\n    salmon: 'rgb(250, 128, 114)',\r\n    sandybrown: 'rgb(244, 164, 96)',\r\n    seagreen: 'rgb(46, 139, 87)',\r\n    seashell: 'rgb(255, 245, 238)',\r\n    sienna: 'rgb(160, 82, 45)',\r\n    silver: 'rgb(192, 192, 192)',\r\n    skyblue: 'rgb(135, 206, 235)',\r\n    slateblue: 'rgb(106, 90, 205)',\r\n    slategray: 'rgb(112, 128, 144)',\r\n    slategrey: 'rgb(112, 128, 144)',\r\n    snow: 'rgb(255, 250, 250)',\r\n    springgreen: 'rgb(0, 255, 127)',\r\n    steelblue: 'rgb(70, 130, 180)',\r\n    tan: 'rgb(210, 180, 140)',\r\n    teal: 'rgb(0, 128, 128)',\r\n    thistle: 'rgb(216, 191, 216)',\r\n    tomato: 'rgb(255, 99, 71)',\r\n    turquoise: 'rgb(64, 224, 208)',\r\n    violet: 'rgb(238, 130, 238)',\r\n    wheat: 'rgb(245, 222, 179)',\r\n    white: 'rgb(255, 255, 255)',\r\n    whitesmoke: 'rgb(245, 245, 245)',\r\n    yellow: 'rgb(255, 255, 0)',\r\n    yellowgreen: 'rgb(154, 205, 50)',\r\n\r\n\r\n\r\n      map_orange: 'rgb(255, 106, 0)',\r\n\r\n        map_green: 'rgb(76, 255, 0)',\r\n\r\n        map_red: 'rgb(255, 0, 0)',\r\n\r\n\r\n        map_blue: 'rgb(0, 38, 255)',\r\n\r\n        map_darkgreen: 'rgb(38, 127, 0)',\r\n\r\n        map_yellow: 'rgb(255, 216, 0)',\r\n\r\n        map_aqua: 'rgb(0, 255, 255)',\r\n\r\n        map_grey: 'rgb(128, 128, 128)',\r\n\r\n        map_gray: 'rgb(128, 128, 128)',\r\n\r\n        map_darkgrey: 'rgb(64, 64, 64)',\r\n\r\n        map_darkgray: 'rgb(64, 64, 64)',\r\n\r\n          map_black: 'rgb(0, 0, 0)',\r\n\r\n};\r\n\r\n\r\nvar RE_RGB = /^rgb\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)$/;\r\n\r\nGamelab.Colors = {};\r\n\r\nGamelab.PixelMapColors = {};\r\n\r\n\r\nfor(var x in ColorStrings)\r\n{\r\n  if(ColorStrings.hasOwnProperty(x))\r\n  {\r\n      Gamelab.Colors[x] = new Gamelab.RGBAColor().fromString(x);\r\n  }\r\n}\r\n;(function() {\r\n  console.log('GSEvent class... creating');\r\n\r\n  class GSEvent {\r\n\r\n    constructor(args = {}) {\r\n\r\n      //  Gamelab.Modifiers.informable(this, args);\r\n\r\n    }\r\n  }\r\n\r\n  class MouseMoveEvent {\r\n    constructor(callback) {\r\n      callback = callback || function(x, y) {};\r\n\r\n      this.Callback(callback);\r\n    }\r\n    Callback(cb) {\r\n      Gamelab.InputSystem.extend('mousemove', function(x, y) {\r\n\r\n        cb(x, y);\r\n\r\n      });\r\n    }\r\n  };\r\n\r\n  Gamelab.MouseMoveEvent = MouseMoveEvent;\r\n\r\n  class MousePosEvent {\r\n    constructor(callback) {\r\n      callback = callback || function(x, y) {};\r\n\r\n      this.Callback(callback);\r\n    }\r\n    Callback(cb) {\r\n      Gamelab.InputSystem.extend('mousepos', function(x, y) {\r\n\r\n        cb(x, y);\r\n\r\n      });\r\n    }\r\n  };\r\n\r\n  Gamelab.MousePosEvent = MousePosEvent;\r\n\r\n  class MouseLeftClickEvent {\r\n    constructor(callback) {\r\n      callback = callback || function(x, y) {};\r\n\r\n      this.Callback(callback);\r\n    }\r\n    Callback(cb) {\r\n\r\n      Gamelab.InputSystem.extend('leftclick', function(x, y) {\r\n\r\n        cb(x, y);\r\n\r\n      });\r\n    }\r\n  };\r\n\r\n  Gamelab.MouseLeftClickEvent = MouseLeftClickEvent;\r\n\r\n  class MouseRightClickEvent {\r\n    constructor(callback) {\r\n      callback = callback || function(x, y) {};\r\n\r\n      this.Callback(callback);\r\n    }\r\n    Callback(cb) {\r\n\r\n      Gamelab.InputSystem.extend('rightclick', function(x, y) {\r\n\r\n        cb(x, y);\r\n\r\n      });\r\n    }\r\n  };\r\n\r\n  Gamelab.MouseRightClickEvent = MouseRightClickEvent;\r\n\r\n  function GSEventLink(extendedObject, extendedKey, extendor, extendorKey) {\r\n    this.parent_id = extendedObject.id,\r\n\r\n      this.child_id = extendor.id,\r\n\r\n      this.parent_key = extendedKey,\r\n\r\n      this.child_key = extendorKey;\r\n  };\r\n\r\n  /**\r\n   * Creates an instance of InputEvent\r\n   * <info-bit> Gamelab.InputEvent runs a callback function when a specified input is triggered</info-bit>\r\n   *\r\n   * <tip is=\"p\">Instead of calling\r\n   *\r\n   * @param   {Object} args object of arguments\r\n   * @param   {number} args.btnix the index of controller-button to be applied\r\n   * @param   {number} args.gpix the index of pc-gamepad --the 1st gamepad will have index 0\r\n   * @param   {number} args.stickix the controller-stick-index to be applied\r\n   * @param   {Array} args.keys array of strings for keys to be applied\r\n   * @param   {Function} args.callback the function to call when InputEvent is triggered\r\n   * @returns {Gamelab.InputEvent} a Gamelab.InputEvent object\r\n   */\r\n\r\n\r\n  class InputEvent extends GSEvent {\r\n    constructor(args) {\r\n      super(args);\r\n\r\n      var btnix = args.btnix || args.button_ix || false,\r\n\r\n        gpix = args.gpix || args.gamepad_ix || 0,\r\n\r\n        callback = args.callback || function() {\r\n\r\n\r\n        };\r\n\r\n      var six = args.stickix || args.six || args.stick_ix || false;\r\n\r\n      var inputKey = six !== false ? 'stick_' + six : btnix !== false ? 'button_' + btnix : false;\r\n\r\n      //Keys:\r\n\r\n      var keyboardKeys = Larva.arrayWrap(args.keys || []);\r\n\r\n      //Run the Q() function\r\n\r\n      if (keyboardKeys instanceof Array) {\r\n\r\n        Gamelab.each(keyboardKeys, function(ix, keyitem) {\r\n\r\n          Gamelab.InputSystem.extendKey('key_' + keyitem.toLowerCase(), function() {\r\n\r\n            callback(keyitem.toLowerCase());\r\n\r\n          });\r\n        });\r\n      }\r\n\r\n      if (inputKey && gpix >= 0) {\r\n\r\n        Gamelab.GamepadAdapter.on(inputKey, gpix, function(x, y) {\r\n\r\n          callback(x, y);\r\n\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n\r\n  /**\r\n   *\r\n   * @extends InputEvent\r\n   *\r\n   * Creates an instance of KeyboardEvent\r\n   * <info-bit> Gamelab.KeyboardEvent runs a callback function when keyboard-keys are pressed</info-bit>\r\n   * @param   {Array | string} keys the Array of keys or single string-key for this event\r\n   * @param   {Function} callback the callback-function to be called when this event is triggered\r\n\r\n   * @returns {Gamelab.KeyboardEvent}\r\n   */\r\n\r\n  class KeyboardEvent extends InputEvent {\r\n    constructor(keys = keys instanceof Array ? keys : [keys], callback = function() {}) {\r\n\r\n      super({});\r\n\r\n      this.keys = keys;\r\n\r\n      this.callback = callback;\r\n\r\n    }\r\n\r\n    init() {\r\n      var keyboardKeys = this.keys;\r\n\r\n      var __inst = this;\r\n\r\n      if (keyboardKeys instanceof Array) {\r\n\r\n        Gamelab.each(keyboardKeys, function(ix, keyitem) {\r\n\r\n          Gamelab.InputSystem.extendKey('key_' + keyitem.toLowerCase(), function() {\r\n\r\n            __inst.callback(keyitem.toLowerCase());\r\n\r\n          });\r\n        });\r\n      }\r\n    }\r\n\r\n    Keys(keys = []) {\r\n      this.keys = Larva.arrayWrap(keys)\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    Call(callback = function() {}) {\r\n      this.callback = callback;\r\n\r\n      this.init();\r\n\r\n      return this;\r\n    }\r\n  };\r\n\r\n  /**\r\n   *\r\n   * @extends InputEvent\r\n   *\r\n   * Creates an instance of GamepadEvent\r\n   * <info-bit> Gamelab.GamepadEvent runs a callback function when any specified gamepad-buttons or gamepad-sticks are pressed</info-bit>\r\n   * @param   {Array | string} gamepadKeys the Array of gamepadKeys or single string-key, representing gamepad-buttons or gamepad-sticks for this event\r\n   * @param   {Function} callback the callback-function to be called when this event is triggered\r\n\r\n   * @returns {Gamelab.GamepadEvent}\r\n   */\r\n\r\n  class GamepadEvent extends InputEvent {\r\n    constructor(keys = [], callback = function() {}) {\r\n\r\n      super({});\r\n\r\n      this.keys = keys;\r\n\r\n      this.callback = callback;\r\n\r\n    }\r\n\r\n    Gamepads(gps = []) {\r\n      this.gps = gps = Larva.arrayWrap(gps || []);\r\n\r\n      return this;\r\n    }\r\n\r\n    init() {\r\n      var gamepadKeys = Larva.arrayWrap(this.keys || []);\r\n\r\n      var __inst = this;\r\n\r\n      Gamelab.GamepadAdapter.on(gamepadKeys, this.gps, function(x, y) {\r\n\r\n        __inst.callback(x, y);\r\n\r\n      });\r\n    }\r\n\r\n    Keys(keys = []) {\r\n      this.keys = Larva.arrayWrap(keys);\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    Call(callback = function() {}) {\r\n      this.callback = callback;\r\n\r\n      this.init();\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n  };\r\n\r\n  class CollisionEvent extends GSEvent {\r\n    constructor(args = {}) {\r\n      super(args);\r\n\r\n    }\r\n\r\n    /**\r\n     * applies objects and siblings to be compared for the CollisionEvent instance\r\n     * @memberof CollisionEvent\r\n     * @param   {Array} objects the main-objects for collision processing\r\n     * @param   {Array} siblings the comparable-objects for collision processing\r\n     * @returns {CollisionEvent} the current instance of CollisionEvent, reference to 'this' keyword\r\n     */\r\n\r\n    OnCollision(objects, siblings) {\r\n\r\n      this.objects = Larva.arrayWrap(objects || this.objects || []);\r\n\r\n      this.siblings = Larva.arrayWrap(siblings || this.siblings || []);\r\n\r\n      return this;\r\n    }\r\n\r\n    /**\r\n     * applies a callback to be called whenever the onBool function returns true\r\n     * @memberof CollisionEvent\r\n     * @param   {callbackFunction} callbackFunction the function to be called --replaces the value of collisionEvent.callback\r\n\r\n     * @returns {CollisionEvent} the current instance of CollisionEvent, reference to 'this' keyword\r\n     */\r\n\r\n    Call(callbackFunction) {\r\n\r\n      this.callback = callbackFunction || this.callback || function() {};\r\n\r\n      let $collision = this;\r\n\r\n      this.objects.forEach(function($obj){\r\n\r\n        $obj.onUpdate(function(){\r\n\r\n          var $sprite = this;\r\n\r\n          $collision.siblings.forEach(function($sib){\r\n            if($sprite.hasBoxCollision($sib))\r\n            {\r\n              $collision.callback($sprite, $sib);\r\n            }\r\n          });\r\n        });\r\n      });\r\n\r\n\r\n      return this;\r\n\r\n    }\r\n  };\r\n\r\n  /**\r\n   * returns BoolEvent --allows code to run whenever a conditional-function returns true\r\n   * @param   {onBool} onBool the function to be tested each update\r\n   * @param   {call} call the function to be called when onBool returns true;\r\n\r\n   * @returns {BoolEvent} a Gamelab.BoolEvent object\r\n   */\r\n\r\n\r\n  class BoolEvent extends GSEvent {\r\n    constructor(onBool, callback) {\r\n\r\n      super({});\r\n\r\n      this.bool = onBool || function() {\r\n        console.info('CustomBoolEvent():needs .on function(){}. --Add this as 1st argument or via chainable On() function returning bool argument');\r\n      }\r\n      /*Defaults to false to avoid broken code*/\r\n\r\n      this.callback = callback || function() {\r\n        console.info('CustomBoolEvent():needs .callback function(){} --Add this as 2nd argument or via chainable Call() function');\r\n      };\r\n\r\n      Gamelab.gs_events.push(this);\r\n\r\n    }\r\n\r\n    /**\r\n     * applies a boolFunction to be tested for true each update\r\n     * @param   {boolFunction} boolFunction the function to be tested each update --replaces the value of boolEvent.onBool\r\n\r\n     * @returns {BoolEvent} the current instance of BoolEvent, reference to 'this' keyword\r\n     */\r\n\r\n    On(boolFunction) {\r\n\r\n      this.bool = boolFunction;\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * applies a callback to be called whenever the onBool function returns true\r\n     * @memberof BoolEvent\r\n     * @param   {callbackFunction} callbackFunction the function to be called --replaces the value of boolEvent.callback\r\n\r\n     * @returns {BoolEvent} the current instance of BoolEvent, reference to 'this' keyword\r\n     */\r\n\r\n    Call(callbackFunction) {\r\n\r\n      this.callback = callbackFunction || this.callback || function() {};\r\n\r\n      return this;\r\n\r\n    }\r\n  };\r\n\r\n  BoolEvent.Bool = BoolEvent.On;\r\n\r\n  Gamelab.GSEvent = GSEvent;\r\n\r\n  Gamelab.Event = GSEvent;\r\n\r\n  Gamelab.GSEventLink = GSEventLink;\r\n\r\n  Gamelab.InputEvent = InputEvent;\r\n\r\n  Gamelab.GamepadEvent = GamepadEvent;\r\n\r\n  Gamelab.KeyboardEvent = KeyboardEvent;\r\n\r\n  Gamelab.CollisionEvent = CollisionEvent;\r\n\r\n  Gamelab.BoxCollisionEvent = CollisionEvent;\r\n\r\n  Gamelab.BoolEvent = BoolEvent;\r\n\r\n})();\r\n;(function () {\n    console.log('Frame class... creating');\n\n    /**\n     * Creates an instance of Frame\n     *\n     * <info-bit>Gamelab.Frame is called automatically by Gamelab.Sprite and Gamelab.Animation.\n     * Gamelab.Frame does not take arguments.\n     * It is instantiated, then initilized with chainable function-calls.</info-bit>\n     *\n     * @returns {Frame}\n     *\n     * @example\n     *\n     * var selected_frame = new Gamelab.Frame().Image(gameImage).Size(frameSizeVector);\n     */\n\n\n    class Frame {\n        constructor() {\n            var __inst = this;\n            this.framePos = new Gamelab.Vector(0, 0);\n            this.origin = new Gamelab.Vector(0, 0);\n        }\n\n        Image(src) {\n            this.image = new Gamelab.GameImage(src);\n            return this;\n        }\n\n        onLoad(fxn){\n\n          fxn = fxn || function(){};\n          fxn = fxn.bind(this);\n          this.image.domElement.onload = function(){\n            fxn();\n          };\n\n        }\n\n        Origin(x, y, z)\n        {\n          this.origin = new Gamelab.Vector(x, y, z);\n          return this;\n        }\n\n        Rotation(x, y, z)\n        {\n          this.rotation = new Gamelab.Vector(x, y, z);\n          return this;\n        }\n\n        FramePos(p) {\n            this.position = new Gamelab.Vector(p, p, p);\n\n            this.framePos = new Gamelab.Vector(p, p, p);\n\n            return this;\n        }\n\n        FrameSize(x, y, z)\n        {\n          this.frameSize = new Gamelab.Vector(x, y, z);\n          return this;\n        }\n\n        StoreOffscreen(){\n\n          this.offscreen = new Gamelab.OffscreenCanvasRendering(this.image);\n\n                      for(var x in this.offscreen)\n                      {\n                        if(x == 'ctx' || x == 'canvas')\n                        this[x] = this.offscreen[x];\n                      }\n\n\n          return this;\n\n        }\n\n        getURL(){\n          this.StoreOffscreen();\n          return this.offscreen.canvas.toDataURL();\n        }\n\n        getColoredPixelGrid(unitSize=5) {\n\n            var grid = [];\n\n            let min = this.framePos, max = this.framePos.add(this.frameSize);\n\n            for (var x = min.x; x <= max.x; x += unitSize) {\n                for (var y = min.y; y <= max.y; y += unitSize) {\n                    // Fetch pixel at current position\n                    var pixel = this.ctx.getImageData(x, y, 1, 1);\n                    // Check that opacity is above zero\n                    if (pixel.data[3] != 0) {\n\n                        var vector = new Gamelab.Vector(x, y),\n\n                            gridObject = {\n\n                                position: vector,\n\n                                size: new Gamelab.Vector(unitSize, unitSize),\n\n                                pixel:pixel\n\n                            };\n\n                        grid.push(gridObject);\n                    }\n                }\n            }\n\n            return grid;\n        }\n\n        getFullPixelGrid(unitSize=5) {\n\n            var grid = [];\n\n            let min = this.framePos, max = this.framePos.add(this.frameSize);\n\n            for (var x = min.x; x <= max.x; x += unitSize) {\n                for (var y = min.y; y <= max.y; y += unitSize) {\n                    // Fetch pixel at current position\n                    var pixel = this.ctx.getImageData(x, y, 1, 1);\n                    // Check that opacity is above zero\n\n\n                        var vector = new Gamelab.Vector(x, y),\n\n                            gridObject = {\n\n                                position: vector,\n\n                                size: new Gamelab.Vector(unitSize, unitSize),\n\n                                pixel:pixel\n\n                            };\n\n                        grid.push(gridObject);\n                }\n            }\n\n            return grid;\n        }\n\n\n        /**\n         * Creates and returns a ColorMap for this animation, allowing opacity-based pixel-collision.\n         *\n         * @function\n         * @param {number} unitDimen a Colormap grid-unit-size --A larger unitDimen decreases accuracy, and results in faster-processing.\n         * @memberof Animation\n         **********/\n\n        createColorMap(size, altImage) {\n\n            if (!(altImage || this.image && this.image.domElement))\n                return this;\n\n            this.StoreOffscreen();\n\n            this.colorMap = this.getColoredPixelGrid(size, this.testCtx);\n\n            return this.colorMap;\n        }\n\n\n\n        createFullPixelMap(size, altImage) {\n\n            if (!(altImage || this.image && this.image.domElement))\n                return this;\n\n            this.StoreOffscreen();\n\n            this.fullPixelMap = this.getFullPixelGrid(size, this.testCtx);\n\n            return this.fullPixelMap;\n        }\n\n    }\n\n    Gamelab.Frame = Frame;\n\n})();\n;/**\n * @ignore\n * */\n\nclass ControllerEventKeys {\n    constructor() {\n        return {\n\n            left_stick: false,\n\n            right_stick: false,\n\n            0: false,\n\n            1: false,\n\n            2: false,\n\n            3: false,\n\n            4: false,\n\n            5: false,\n\n            6: false,\n\n            7: false,\n\n            8: false,\n\n            9: false,\n\n            10: false,\n\n            11: false,\n\n            12: false,\n\n            13: false,\n\n            14: false,\n\n            15: false,\n\n            16: false,\n\n            17: false,\n\n            18: false,\n\n            19: false\n\n        }\n\n    }\n\n}\n\nGamelab.ControllerEventKeys = ControllerEventKeys;\n\n\n/**\n * Creates an instance of GamepadAdapter: --instead use the existing: Gamelab.GamepadAdapter, a working instance of this class.\n * -supports game-controller input for web-games\n * -accesses live gamepad input from the HTML5 Gamepad Api\n * @returns {GamepadAdapter} an instance of GamepadAdapter\n * */\n\nGamelab.gamepads = Gamelab.gamepads || [];\n\nclass GamepadAdapter {\n\n    constructor() {\n\n        this.__gamepads = [];\n\n        this.intervals = [];\n\n        let controller_stack = this;\n\n        let __gamepadMaster = this;\n\n        this.events = [];\n\n        window.addEventListener(\"gamepadconnected\", function (e) {\n            console.log(\"Gamepad connected at index %d: %s. %d buttons, %d axes.\",\n                e.gamepad.index, e.gamepad.id,\n                e.gamepad.buttons.length, e.gamepad.axes.length);\n\n            if (__gamepadMaster.mainLoop) {\n                window.clearInterval(__gamepadMaster.mainLoop);\n            }\n\n            __gamepadMaster.mainLoop = window.setInterval(function () {\n\n                var gps = navigator.getGamepads();\n\n                __gamepadMaster.gps = gps;\n\n                for (var x = 0; x < gps.length; x++) {\n\n                    var events = __gamepadMaster.__gamepads[x] ? __gamepadMaster.__gamepads[x] : {};\n\n                    __gamepadMaster.process(__gamepadMaster.gps[x], events);\n\n                }\n\n            }, 20);\n\n\n        });\n\n\n    }\n\n    gamepads() {\n\n        return navigator.getGamepads();\n\n    }\n\n    disconnect_all() {\n\n        for (var x = 0; x < this.intervals.length; x++) {\n\n            window.clearInterval(this.intervals[x]);\n\n        }\n    }\n\n    disconnect_by_index(game_pad_index) {\n\n        window.clearInterval(this.intervals[game_pad_index]);\n\n    }\n\n    hasAnyPad() {\n        return \"getGamepads\" in navigator;\n\n    }\n\n    Event(key, game_pad, callback) {\n        return {\n\n            key: key, game_pad: game_pad, callback: callback\n\n        }\n\n    }\n\n    GamepadEvents(args) {\n\n        var gp = {};\n\n        gp.stick_left = args.stick_left || function (x, y) {\n\n            //  console.log('Def call');\n\n        }\n\n        gp.stick_right = args.stick_right || function (x, y) {\n\n        }\n\n        gp.buttons = [];\n\n        gp.extendFunc = function (f1, f2) {\n\n            var fc = f2;\n\n            return function (x, y) {\n\n                f2(x, y);\n\n                f1(x, y);\n\n            }\n\n        };\n\n        gp.on = function (key, callback) {\n\n            if (this[key] && key !== \"on\") {\n\n                var current_cb = typeof(this[key]) == 'function' ? this[key] : function (x, y) {\n                };\n\n                this[key] = this.extendFunc(callback, current_cb);\n\n\n            }\n\n            else if (key.indexOf('button') >= 0 && key.indexOf('_') >= 0) {\n                var parts = key.split('_');\n\n                var number;\n\n                try {\n\n                    number = parseInt(parts[1]);\n\n\n                    var current_cb = typeof(this['buttons'][number]) == 'function' ? this['buttons'][number] : function (x, y) {\n                    };\n\n                    this['buttons'][number] = this.extendFunc(callback, current_cb);\n\n                }\n                catch (e) {\n                    console.error('could not parse \"on\" event with ' + key);\n\n                }\n\n            }\n\n\n        }\n\n        gp.constructor = {name: \"GamepadEvents\"};\n\n        this.__gamepads.push(gp);\n\n        Gamelab.gamepads = this.__gamepads;\n\n        return gp;\n\n    }\n\n    getGamepads() {\n        return Gamelab.gamepads;\n\n    }\n\n    process(gp, gpEvents) {\n\n        this.process_buttons(gp, gpEvents);\n\n        this.process_axes(gp, gpEvents);\n\n    }\n\n    process_axes(gp, events) {\n\n        if (!gp || !gp['axes']) {\n\n            return false;\n\n        }\n\n\n        for (var i = 0; i < gp.axes.length; i += 2) {\n\n            var axis1 = gp.axes[i], axia2 = gp.axes[i + 1];\n\n            var ix = (Math.ceil(i / 2) + 1), x = gp.axes[i], y = gp.axes[i + 1];\n\n            if (ix == 1 && events.stick_left) {\n                events.stick_left(x, y);\n\n            }\n\n            if (ix == 2 && events.stick_right) {\n                events.stick_right(x, y);\n\n            }\n\n            if (this.events && this.events['stick_' + i] && typeof(this.events['stick_' + i].callback) == 'function') {\n                this.events['stick_' + i].callback();\n\n            }\n        }\n\n    }\n\n\n    process_buttons(gp, events) {\n\n        if (!gp || !gp['buttons']) {\n            return false;\n\n        }\n\n        for (var i = 0; i < gp.buttons.length; i++) {\n\n            if (!events.buttons)\n                break;\n\n            else if (events.buttons.length > i && typeof(events.buttons[i]) == 'function') {\n                events.buttons[i](gp.buttons[i].pressed);\n            }\n            else if (events.buttons.length > i && typeof(events.buttons[i]) == 'object' && typeof(events.buttons[i].update) == 'function') {\n                events.buttons[i].update(events.buttons[i].pressed);\n\n            }\n            var clearance_1 = this.events && this.events[i], gpc, bkey = \"button_\" + i;\n\n            if (clearance_1) {\n                gpc = this.events[bkey] && !isNaN(this.events[bkey].game_pad) ? this.gamepads[this.events[bkey].game_pad] : this.events[bkey].game_pad;\n            }\n            ;\n\n            if (clearance_1 && gpc && typeof(this.events[bkey].callback) == 'function') {\n                //call the callback\n                this.events[i].callback();\n\n            }\n\n        }\n    }\n\n\n    on(key, gpix, callback) {\n\n        var keys = Larva.arrayWrap(key || []), gps = Larva.arrayWrap(gpix || []);;\n\n        for(var x in keys)\n        {\n            for(var y in gps)\n            {\n                if (gps[y] >= this.__gamepads.length) {\n\n                    this.__gamepads.push(this.GamepadEvents({}));\n\n                }\n\n                this.__gamepads[y].on(keys[x], callback);\n\n            }\n        }\n    }\n}\n\n/**********\n * NOTE: here we bind the instance, and NOT the instantiator.\n *\n * *********/\n\nif (!Gamelab.GamepadAdapter) {\n\n    Gamelab.GamepadAdapter = new GamepadAdapter();\n\n    // __gameInstance.gamepads.push(gamepad);\n\n}\n;class Line2d extends Scriptable {\r\n\r\n  constructor() {\r\n    super();\r\n    this.Object(this);\r\n    this.points = [];\r\n    this.position = new Gamelab.Vector(0, 0);\r\n    this.size = new Gamelab.Vector(0, 0);\r\n    this.index = 0;\r\n    this.call = function() {};\r\n  }\r\n\r\n  StepFunction(call) {\r\n    this.call = call;\r\n    return this;\r\n  }\r\n\r\n  next() {\r\n    this.index += 1;\r\n    return this.points[this.index % this.points.length];\r\n  }\r\n\r\n  Color(c) {\r\n    this.color = c;\r\n    return this;\r\n  }\r\n\r\n  Fill() {\r\n\r\n    for (var x = 1; x <= this.size.x; x++) {\r\n\r\n          var x_total = this.size.x;\r\n\r\n          var out_of_1 = x / x_total;\r\n\r\n          var next_x = this.position.x + x;\r\n\r\n          console.log('using x portion::' + out_of_1);\r\n\r\n          var next_y = this.position.y + (this.size.y * this.call(out_of_1, 1.0)),\r\n            next_point = new Gamelab.Vector(next_x, next_y);\r\n          this.points.push(next_point);\r\n\r\n      }\r\n\r\n    return this;\r\n  }\r\n\r\n  getOffsetPos(pos){\r\n    var offset = this.window_offset || new Gamelab.Vector(0, 0);\r\n    return pos.add(offset);\r\n  }\r\n\r\n  draw(ctx, camera) {\r\n\r\n    ctx = ctx || Gamelab.game_windows[0].ctx;\r\n    camera = camera || Gamelab.game_windows[0].camera;\r\n\r\n    var points = this.points;\r\n\r\n    ctx.save();\r\n    ctx.strokeStyle = this.color;\r\n\r\n    ctx.beginPath();\r\n    if (points instanceof Array) {\r\n      for (var x = 0; x < points.length; x++) {\r\n        var p = points[x];\r\n\r\n        var position = p.position || p;\r\n\r\n        var real_pos = this.getOffsetPos(position);\r\n\r\n        if (real_pos.hasOwnProperty('x') && real_pos.hasOwnProperty('y')) {\r\n          if (x == 0)\r\n            ctx.moveTo(real_pos.x, real_pos.y)\r\n          else {\r\n            ctx.lineTo(real_pos.x, real_pos.y);\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    ctx.stroke();\r\n    ctx.restore();\r\n\r\n  }\r\n\r\n}\r\n\r\nGamelab.Line2d = Line2d;\r\n\r\nGamelab.Line2D = Line2d;\r\n;\n/**\n * Creates a Sound instance. Implements HTML5-Audio object\n * --DevTODO : complete docs for the Sound class\n *\n * @param   {string} src the source-path of the targeted sound-file\n * @returns {Sound} instance of Gamelab.Sound\n * */\n\nclass Sound {\n\n    constructor(src, data) {\n\n        if (typeof(src) == 'object') {\n\n            this.sound = document.createElement('audio');\n\n            this.sound.src = src.src;\n\n            this.src = src.src;\n        }\n\n        else if (typeof(src) == 'string') {\n\n            this.sound = document.createElement('audio');\n\n            this.sound.src = src;\n\n            this.src = src;\n\n        }\n\n        if(typeof(data)=='object') {\n            for (var x in data) {\n                if (x !== 'sound') {\n                    this[x] = data[x];\n\n                }\n            }\n        }\n\n        this.onLoad = this.onLoad || function () {\n            };\n\n        if (typeof(this.onLoad) == 'function') {\n\n            this.onLoad(this.sound);\n\n        }\n\n    }\n\n    Loop(loop)\n    {\n        this.sound.loop = loop || true;\n\n        return this;\n\n    }\n\n    loop(loop) //same as Loop()\n    {\n        this.sound.loop = loop || true;\n\n        return this;\n\n    }\n\n\n    Volume(val)\n    {\n\n        this.sound.volume = val;\n\n        return this;\n\n    }\n\n\n    volume(val) //same as Volume()\n    {\n\n        this.sound.volume = val;\n\n        return this;\n\n    }\n\n    Play() {\n        if (typeof(this.sound) == 'object' && typeof(this.sound.play) == 'function') {\n\n            this.sound.play();\n\n        }\n\n        return this;\n\n    }\n\n    play() { //same as Play()\n        if (typeof(this.sound) == 'object' && typeof(this.sound.play) == 'function') {\n\n            this.sound.play();\n        }\n        return this;\n    }\n\n}\n\n\nclass SoundList{\n\n    constructor(list)\n    {\n        this.cix = 1;\n\n        this.sounds = [];\n\n        if(list instanceof Array)\n        {\n            for(var x in list)\n            {\n                if(list[x].src)\n                {\n                    this.sounds.push(new Sound(list[x].src, list[x]));\n\n                }\n                else if(typeof(list[x]) == 'string')\n                {\n                    this.sounds.push(new Sound(list[x]));\n\n                }\n            }\n        }\n    }\n\n    add(src, name)\n    {\n        if(typeof(src) == 'object' && src.src)\n        {\n            this.sounds.push(new Sound(src.src, src));\n\n        }\n        else if(typeof(src) == 'string')\n        {\n            var data = {};\n\n            if(name)\n            {\n                data.name = name;\n            }\n\n            this.sounds.push(new Sound(list[x], data));\n\n        }\n\n    }\n\n    Volume(v)\n    {\n        for(var x = 0; x < this.sounds.length;x++)\n        {\n            this.sounds[x].volume(v);\n\n        }\n\n        return this;\n    }\n\n    volume(v)\n    {\n        for(var x = 0; x < this.sounds.length;x++)\n        {\n            this.sounds[x].volume(v);\n\n        }\n\n        return this;\n    }\n\n\n    PlayNext()\n    {\n        this.sounds[this.cix % this.sounds.length].play();\n\n        this.cix += 1;\n\n    }\n\n    Play()\n    {\n\n        this.sounds[this.cix % this.sounds.length].play();\n\n        this.cix += 1;\n\n\n    }\n\n    playNext() //same as PlayNext()\n    {\n        this.sounds[this.cix % this.sounds.length].play();\n\n        this.cix += 1;\n\n    }\n\n    play() //same as Play()\n    {\n\n        this.sounds[this.cix % this.sounds.length].play();\n\n        this.cix += 1;\n\n\n    }\n\n}\n\nGamelab.Sound = Sound;\n\nGamelab.SoundList = SoundList;\n\n\n\n\nclass Audio {\n\n  constructor(){\n\n\n  }\n\n}\n\nGamelab.Audio = Audio;\n;\nvar THREE_EXT = {\n\n    defaults:{\n\n        DodecahedronGeometry:{radius:1, detail:0},\n\n        SphereGeometry:{radius:5, widthSegments:32, heightSegments:32},\n\n        BoxGeometry:{\n\n            width:20,\n\n            height:20,\n\n            depth:20\n\n        },\n\n        CylinderGeometry:{radiusTop:5, radiusBottom:5, height:20, heightSegments:32},\n\n        TorusGeometry:{radius:10, tube:3, radialSegments:16, tubularSegments:100 }\n    }\n\n}\n\nclass Three //dependency: THREE.js\n{\n    constructor(args={})\n    {\n\n       if(!THREE) //THREE.js library must be loaded\n       {\n           return console.error('ThreeJSObject():Library: Three.js is required for this object.');\n\n       }\n\n        this.scene =  new THREE.Scene();\n\n       if(args.geometry instanceof String && THREE[args.geometry])\n       {\n           this.geometry = new THREE[args.geometry]();\n       }\n       else {\n\n           this.geometry = args.geometry || new THREE.TorusGeometry(50, 10, 16, 100);\n       }\n\n        this.scene.add( new THREE.AmbientLight( 0xffffff, 1.0  ) );\n\n\n        this.renderer = Gamelab.renderer || new THREE.WebGLRenderer({\n                preserveDrawingBuffer: true,\n                alpha:true\n            });\n\n        this.renderer.setSize(1000, 1000);\n\n        this.camera = new THREE.PerspectiveCamera(70, 1, 1, 1000);\n\n        this.camera.position.z = 1000 / 8;\n\n        var __inst = this;\n\n        var src = args.src || \"../assets/game/image/tiles/perlin_3.png\";\n\n        __inst.loader = new THREE.TextureLoader();\n\n        __inst.loader.load( src, function ( texture ) {\n\n            __inst.material = args.material || new THREE.MeshPhongMaterial({\n                    map: texture\n                });\n\n            if(!__inst.__init) {\n\n                __inst.mesh = new THREE.Mesh(__inst.geometry, __inst.material);\n\n                __inst.scene.add(__inst.mesh);\n\n                __inst.__init = true;\n\n            }\n\n            //__inst.mesh.size.set(__inst.size);\n\n            __inst.renderer.render(__inst.scene, __inst.camera);\n\n            __ServerSideFile.file_upload('test.png', __inst.renderer.domElement.toDataURL('image/png'), function(relpath, content){\n\n                relpath = relpath.replace('client/', '../');\n\n                __inst.selected_animation = new Animation({src:relpath, frameSize:new Vector(1000, 1000), frameBounds:new VectorFrameBounds(new Vector(0, 0, 0), new Vector(0, 0, 0),new Vector(0, 0, 0))}).singleFrame();\n\n                __inst.selected_animation.image.domElement.onload = function()\n                {\n\n                    __inst.setSize(new Vector(__inst.selected_animation.image.domElement.width, __inst.selected_animation.image.domElement.height));\n\n                    __inst.selected_animation.animate();\n\n\n                    console.log(jstr(__inst.selected_animation.frames));\n\n                };\n\n            });\n\n\n\n        } );\n\n\n\n\n    }\n\n    three_update()\n    {\n        console.log('THREE --GS-Object UPDATE');\n\n        this.mesh.rotation.y += 0.05;\n\n        this.renderer.clear();\n\n        this.renderer.setSize(this.size.x, this.size.y);\n\n        var pixels = new Uint8Array(this.size.x * this.size.y * 4);\n\n        this.renderer.render(this.scene, this.camera);\n\n        var gl = this.renderer.getContext();\n\n        gl.readPixels( 0, 0, this.size.x, this.size.y, gl.RGBA, gl.UNSIGNED_BYTE, pixels );\n\n        this.selected_animation.selected_frame = {image:{}};\n\n        this.selected_animation.selected_frame.image.data = new ImageData(new Uint8ClampedArray(pixels), this.size.x, this.size.y);\n\n    }\n    applyAnimativeState()\n    {\n\n\n    }\n}\n;(function() {\r\n  console.log('Animation class... creating');\r\n\r\n  /**\r\n   *\r\n   * Creates an instance of Animation with one or more Frames.\r\n   *\r\n   * <iframe style='width:400px; height:450px; overflow:hidden;' src='../client/examples/js-class/Animation.html'> </iframe>\r\n   *\r\n   * @param   {string=} [src] the src-image-path for this Animation\r\n   * @returns {Animation} an Animation object\r\n   *\r\n   * @example\r\n   *\r\n   * //constructor call: Creates a single-frame Animation from src\r\n   * var singleFrameAnime = new Animation('directory/myFile.png');\r\n   *\r\n   * @example\r\n   * //constructor call with chainable function-calls: Creates multi-frame Animation from src, then sets properties with chainable-function-calls.\r\n   * var multiFrameAnime = new Gamelab.Animation('../images/characters/full/spaceman1.png') //constructor is called\r\n   * .FrameSize(130, 130)\r\n   * .FrameBounds(new Gamelab.Vector(9, 0), new Gamelab.Vector(23, 0), new Gamelab.Vector(23, 0))\r\n   * .Seesaw() //The Animation will play back-and-forth repeatedly (cycle through frames forwards, then backwards and so on.\r\n   * .Duration(900); //Animation lasts 900 millis OR just under 1 second\r\n   *\r\n   *  @design\r\n   *\r\n   * //single-responsibility : to define a list of frames, then progress that list of frames with a 'selected_frame' property\r\n   * var singleFrameAnime = new Animation('directory/myFile.png');\r\n   */\r\n\r\n  class Animation {\r\n\r\n    constructor(src = {}) {\r\n\r\n      var args = typeof(src) == 'object' ? src : {};\r\n\r\n      //Gamelab.Modifiers.informable(this, args);\r\n\r\n      if (typeof src == 'string') {\r\n        this.Src(src, args.frameBounds);\r\n      } else if (args instanceof Gamelab.GameImage) {\r\n        console.log('Animation(): args are an instance of GameImage');\r\n\r\n        this.image = args;\r\n      } else if (args instanceof HTMLImageElement) {\r\n        console.log('Animation(): args was an instance of HTMLImageElement');\r\n\r\n        this.image = new Gamelab.GameImage(args);\r\n      } else if (args instanceof Gamelab.Animation) {\r\n\r\n        this.image = args.image;\r\n\r\n      } else if (typeof(args) == 'object' && args.src) {\r\n        this.src = args.src;\r\n        this.image = new Gamelab.GameImage(args.src);\r\n      }\r\n\r\n\r\n      this.visible = args.visible || false;\r\n\r\n\r\n      /**\r\n       * @property {Vector} frameSize the frameSize of the Animation\r\n       * @memberof Animation\r\n       **********/\r\n\r\n      this.frameSize = this.frameSize || new Gamelab.Vector(args.frameSize || new Gamelab.Vector(0, 0));\r\n\r\n\r\n      if (args.frameBounds && args.frameBounds.min && args.frameBounds.max) {\r\n\r\n        /**\r\n         * @property {VectorFrameBounds} frameBounds the frameBounds of the Animation, has three Vectors\r\n         * @memberof Animation\r\n         **********/\r\n\r\n        this.frameBounds = new Gamelab.VectorFrameBounds(args.frameBounds.min, args.frameBounds.max, args.frameBounds.termPoint);\r\n\r\n      } else {\r\n\r\n        this.frameBounds = new Gamelab.VectorFrameBounds(new Gamelab.Vector(0, 0, 0), new Gamelab.Vector(0, 0, 0), new Gamelab.Vector(0, 0, 0));\r\n\r\n      }\r\n\r\n\r\n      this.origin = new Gamelab.Vector(0, 0, 0);\r\n\r\n      this.frameOffset = this.getArg(args, 'frameOffset', new Gamelab.Vector(0, 0, 0));\r\n\r\n      this.apply2DFrames();\r\n\r\n      this.flipX = this.getArg(args, 'flipX', false);\r\n\r\n      this.cix = 0;\r\n\r\n      /**\r\n       * @property {Frame} selected_frame the selected_frame of the Animation, a Gamelab.Frame\r\n       * @memberof Animation\r\n       **********/\r\n\r\n      this.selected_frame = this.frames[0] || false;\r\n\r\n      this.timer = 0;\r\n\r\n      this.duration = args.duration || 2000;\r\n\r\n      this.seesaw_mode = args.seesaw_mode || false;\r\n\r\n      this.reverse_frames = args.reverse_frames || false;\r\n\r\n      this.run_ext = args.run_ext || [];\r\n\r\n      this.complete_ext = args.complete_ext || [];\r\n\r\n\r\n      // this.colorMap = this.createColorMap(5);\r\n\r\n    }\r\n\r\n\r\n\r\n    Origin(x, y, z) {\r\n\r\n      this.origin = new Gamelab.Vector(x, y, z);\r\n\r\n      this.frames.forEach(function($f) {\r\n\r\n        $f.origin = new Gamelab.Vector(x, y, z);\r\n\r\n      });\r\n\r\n      if(this.selected_frame)\r\n      {\r\n        this.selected_frame.origin = new Gamelab.Vector(x, y, z);\r\n      }\r\n\r\n      return this;\r\n    }\r\n\r\n    Position(x, y, z) {\r\n      this.position = new Gamelab.Vector(x, y, z);\r\n\r\n      this.frames.forEach(function($f) {\r\n\r\n        $f.position = new Gamelab.Vector(x, y, z);\r\n\r\n      });\r\n\r\n      return this;\r\n    }\r\n\r\n    Size(x, y){\r\n\r\n      this.size = new Gamelab.Vector(x, y);\r\n\r\n      return this;\r\n    }\r\n\r\n    Bone(b) {\r\n      this.bone = b;\r\n      return this;\r\n    }\r\n\r\n    ParentBone(b) {\r\n      this.parentBone = b;\r\n      return this;\r\n    }\r\n\r\n    Rotation(x, y, z) {\r\n\r\n      this.rotation = new Gamelab.Vector(x, y, z);\r\n\r\n      this.frames.forEach(function($frame) {\r\n\r\n        $frame.Rotation(x, y, z);\r\n\r\n      });\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    Src(src, options = {}) {\r\n\r\n      if (typeof src == 'string') {\r\n\r\n        console.log('setting GameImage with string:' + src);\r\n        this.src = src;\r\n        this.image = new Gamelab.GameImage(src);\r\n\r\n      } else if (src instanceof GameImage) {\r\n        console.log('Animation(): args are an instance of GameImage');\r\n\r\n        this.image = src;\r\n      } else if (src instanceof HTMLImageElement) {\r\n        console.log('Animation(): args was an instance of HTMLImageElement');\r\n\r\n        this.image = new Gamelab.GameImage(src);\r\n      }\r\n\r\n      if (!options.frameBounds)\r\n        this.init_singleFrame();\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    Size(x, y, z) {\r\n\r\n      this.size = new Gamelab.Vector(x, y, z);\r\n\r\n      this.frames.forEach(function(f) {\r\n\r\n        f.size = new Gamelab.Vector(x, y, z);\r\n\r\n      });\r\n\r\n      return this;\r\n    }\r\n\r\n    Image(src) {\r\n\r\n      if (typeof(src) == 'string') {\r\n\r\n        console.log('setting GameImage with string:' + src);\r\n        this.src = src;\r\n        this.image = new Gamelab.GameImage(src);\r\n\r\n      } else if (src instanceof Gamelab.GameImage) {\r\n        console.log('Animation(): args are an instance of GameImage');\r\n\r\n        this.image = src;\r\n      } else if (src instanceof HTMLImageElement) {\r\n        console.log('Animation(): args was an instance of HTMLImageElement');\r\n\r\n        this.image = new Gamelab.GameImage(src);\r\n      }\r\n\r\n      this.init_singleFrame();\r\n\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * sets this Animation to a single-frame-animation, from existing image\r\n     * @function\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    init_singleFrame() {\r\n\r\n      var __inst = this;\r\n\r\n      this.image.domElement.onload = function() {\r\n        if (!__inst.__isInit)\r\n          __inst.FrameSize(__inst.image.domElement.width, __inst.image.domElement.height)\r\n          .FrameBounds(new Gamelab.Vector(0, 0), new Gamelab.Vector(0, 0));\r\n\r\n        __inst.run();\r\n\r\n      };\r\n\r\n      Gamelab.log('Animation():set single-frame animation');\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    /*****\r\n     * Overridable / Extendable functions\r\n     * -allows stacking of external object-function calls\r\n     ******/\r\n\r\n\r\n    /**\r\n     * Provides a function to be called whenever this Animation starts. Function should run every time the Animation reaches frame-index 0\r\n     *\r\n     * @function\r\n     * @params {Function} call the function to be called on start\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    onRun(call) {\r\n\r\n      if (this.run_ext.indexOf(call) == -1) {\r\n        this.run_ext.push(call.bind(this));\r\n      }\r\n    }\r\n\r\n\r\n    /**\r\n     * Provides a function to be called whenever this Animation completes. Function should run every time the Animation reaches it's last frame-index.\r\n     *\r\n     * @function\r\n     * @params {Function} call the function to be called on complete\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    onComplete(call) {\r\n\r\n      if (this.complete_ext.indexOf(call) == -1) {\r\n        this.complete_ext.push(call.bind(this));\r\n      }\r\n    }\r\n\r\n    call_on_run() {\r\n      //call any function extension that is present\r\n      for (var x = 0; x < this.run_ext.length; x++) {\r\n        this.run_ext[x](this);\r\n      }\r\n    }\r\n\r\n    call_on_complete() {\r\n      //call any function extension that is present\r\n      for (var x = 0; x < this.complete_ext.length; x++) {\r\n        this.complete_ext[x](this);\r\n      }\r\n    }\r\n\r\n\r\n    Visible(v) {\r\n      this.visible = v;\r\n      return this;\r\n    }\r\n\r\n\r\n    FrameSize(w, h) {\r\n      this.frameSize = new Gamelab.Vector(w, h);\r\n\r\n      this.__isInit = true;\r\n\r\n      this.run();\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    Hang() {\r\n\r\n      this._hang = true;\r\n      return this;\r\n\r\n    }\r\n\r\n    FrameBounds(minVector, maxVector, termVector) {\r\n      this.frameBounds = new Gamelab.VectorFrameBounds(minVector, maxVector, termVector);\r\n\r\n      this.__isInit = true;\r\n\r\n      this.run();\r\n\r\n      return this;\r\n    }\r\n\r\n    FrameOffset(x, y) {\r\n      this.frameOffset = new Gamelab.Vector(x, y);\r\n      return this;\r\n    }\r\n\r\n    Seesaw() {\r\n      if (!this.seesaw_mode) {\r\n        this.seesaw_mode = true;\r\n      }\r\n\r\n      return this;\r\n    }\r\n\r\n    Duration(millis) {\r\n      this.duration = millis;\r\n\r\n      return this;\r\n    }\r\n\r\n    /**\r\n     * Reverses all frames of the animation. Frames are then expected to run backwards.\r\n     *\r\n     * @function\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    ReverseFrames() {\r\n\r\n      this.reverse_frames = true;\r\n      return this;\r\n    }\r\n\r\n    /**\r\n     * Declares the animation a a single frame / full-image.\r\n     *\r\n     * @function\r\n     * @param {Vector} frameSize optional size param\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    SingleFrame() {\r\n\r\n      this.__frametype = 'single';\r\n\r\n      this.frameSize = new Gamelab.Vector(this.image.domElement.width, this.image.domElement.height);\r\n\r\n      this.frameBounds = false;\r\n\r\n      this.selected_frame = new Gamelab.Frame().Image(this.image).FrameSize(this.frameSize).Size(this.frameSize);\r\n\r\n      this.frames = [];\r\n\r\n      this.frames[0] = this.selected_frame;\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    getArg(args, key, fallback) {\r\n\r\n      if (args.hasOwnProperty(key)) {\r\n\r\n        return args[key];\r\n\r\n      } else {\r\n        return fallback;\r\n\r\n      }\r\n    }\r\n\r\n    init() {\r\n\r\n\r\n      this.apply2DFrames();\r\n      return this;\r\n    }\r\n\r\n\r\n    apply2DFrames() {\r\n\r\n      console.log('Running apply2DFrames(): --' + this.name);\r\n\r\n      this.frames = [];\r\n\r\n      if (!this.size) {\r\n        this.Size(this.frameSize.x, this.frameSize.y);\r\n      }\r\n\r\n\r\n      var fcount = 0;\r\n\r\n      var quitLoop = false;\r\n\r\n      for (let y = this.frameBounds.min.y; y <= this.frameBounds.max.y; y++) {\r\n\r\n        for (let x = this.frameBounds.min.x; x <= this.frameBounds.max.x; x++) {\r\n\r\n          let framePos = {\r\n            x: x * this.frameSize.x + this.frameOffset.x,\r\n            y: y * this.frameSize.y + this.frameOffset.y\r\n          };\r\n\r\n          var f = new Gamelab.Frame().Image(this.image).FrameSize(this.frameSize).Origin(this.origin).Size(this.size || this.frameSize).Position(this.position || framePos);\r\n\r\n\r\n          this.frames.push(f);\r\n\r\n          if (x >= this.frameBounds.termPoint.x && y >= this.frameBounds.termPoint.y) {\r\n\r\n            quitLoop = true;\r\n\r\n            break;\r\n          }\r\n\r\n          fcount += 1;\r\n\r\n          if (quitLoop)\r\n            break;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      this.frames[0] = this.selected_frame = this.frames[0] || new Gamelab.Frame().Image(this.image).FrameSize(this.frameSize).Size(this.frameSize);\r\n\r\n      if (this.seesaw_mode) {\r\n\r\n        // console.log('Animation: applying seesaw');\r\n\r\n        var frames_reversed = this.frames.slice().reverse();\r\n\r\n        this.frames.pop();\r\n\r\n        this.frames = this.frames.concat(frames_reversed);\r\n\r\n      }\r\n      if (this.reverse_frames) {\r\n        this.frames.reverse();\r\n      }\r\n    }\r\n\r\n    scaleOf(sized_Object) {\r\n\r\n      var s = Larva.getPreferredPropertyByKey(sized_Object, 'size', 'argument had nested size variable. Using this instead.');\r\n\r\n      return s.div(this.frameSize);\r\n\r\n    }\r\n\r\n    init_colorMap() {\r\n      Larva.info('init_colorMap()');\r\n\r\n      if (!Larva.allDefined([this.image, this.image.domElement]))\r\n        return [];\r\n\r\n      this.canvasObject = this.canvasObject || new Gamelab.OffscreenCanvasRendering(this.image);\r\n\r\n      this.colorMap = this.colorMap || this.ColoredPixelGrid();\r\n\r\n      return this.colorMap;\r\n    }\r\n\r\n\r\n    ColoredPixelGrid() {\r\n\r\n      I('ColoredPixelGrid()');\r\n\r\n      var image = this.image.domElement,\r\n\r\n        ctx = this.canvasObject.ctx,\r\n\r\n        grid = [],\r\n\r\n        frameSizeDiv = this.selected_frame.frameSize.div(12).round();\r\n\r\n      for (var x = 0; x <= image.width; x += frameSizeDiv.x) {\r\n        for (var y = 0; y <= image.height; y += frameSizeDiv.y) {\r\n          // Fetch pixel at current position\r\n          var pixel = ctx.getImageData(x, y, 1, 1);\r\n          // Check that opacity is above zero\r\n          if (pixel.data[3] != 0) {\r\n\r\n            var vector = new Gamelab.Vector(x, y),\r\n\r\n              gridObject = {\r\n\r\n                position: vector,\r\n\r\n                size: frameSizeDiv\r\n              };\r\n\r\n            grid.push(gridObject);\r\n          }\r\n        }\r\n      }\r\n\r\n      return grid;\r\n    }\r\n\r\n\r\n    /**\r\n     * Returns the existing ColorMap for this animation.\r\n     *\r\n     * @function\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    getCurrentPixelMap() {\r\n\r\n      Larva.info('getCurrentPixelMap()');\r\n\r\n      var map = [];\r\n\r\n      var frame = this.selected_frame;\r\n\r\n      let __inst = this;\r\n\r\n      this.colorMap = this.init_colorMap();\r\n\r\n      for (var x in this.colorMap) {\r\n        var c = this.colorMap[x];\r\n\r\n        if (Gamelab.Collision.boxesCollide(frame.framePos, frame.frameSize, c.position, c.size)) {\r\n\r\n          map.push(c);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      return map;\r\n\r\n    }\r\n\r\n    /**\r\n     * Sets the frame to a specific array-index.\r\n     *\r\n     * @function\r\n     * @param {number} ix the frame-index to apply.\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    setFrame(ix) {\r\n      this.selected_frame = this.frames[ix];\r\n    }\r\n\r\n    update() {\r\n\r\n      if (this._hang && this.cix >= this.frames.length - 1) {\r\n        this.cix = this.frames.length - 1\r\n      }\r\n\r\n      this.selected_frame = this.frames[Math.round(this.cix) % this.frames.length];\r\n    }\r\n\r\n    reset() {\r\n\r\n      this.apply2DFrames();\r\n\r\n      this.cix = 0;\r\n    }\r\n\r\n    /**\r\n     * Applies a continuous animation. Use this in parent-sprite's update if continuous animation is required.\r\n     * Also works as a single call at any time during game-update.\r\n     *\r\n     * @function\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    run() {\r\n\r\n\r\n      if (this.__frametype == 'single') {\r\n        return 0;\r\n      }\r\n\r\n      //update once:\r\n      this.update();\r\n\r\n      if (this.cix == 0) {\r\n\r\n        this.engage();\r\n\r\n      }\r\n    }\r\n\r\n    /**\r\n     * animate():: same as run()\r\n     *\r\n     * @function\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    animate() {\r\n\r\n\r\n      if (this.__frametype == 'single') {\r\n        return 0;\r\n      }\r\n\r\n      //update once:\r\n      this.update();\r\n\r\n      if (this.cix == 0) {\r\n\r\n        this.engage();\r\n\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Engages, or updates the animation for a one full frame-cycle.\r\n     *\r\n     * @function\r\n     * @param {number} duration the number of milliseconds the animation should take.\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    engage(duration) {\r\n\r\n      this.call_on_run();\r\n\r\n      duration = duration || this.duration || this.frames.length * 20;\r\n\r\n      if (this.__frametype == 'single') {\r\n        return 0;\r\n      }\r\n\r\n\r\n      let __inst = this;\r\n\r\n      //we have a target\r\n      this.tween = new TWEEN.Tween(this)\r\n        .easing(__inst.curve || TWEEN.Easing.Linear.None)\r\n\r\n        .to({\r\n          cix: __inst.frames.length - 1\r\n        }, duration)\r\n        .onUpdate(function() {\r\n          //console.log(objects[0].position.x,objects[0].position.y);\r\n\r\n          //   __inst.cix = Math.ceil(__inst.cix);\r\n\r\n          __inst.update();\r\n\r\n        })\r\n        .onComplete(function() {\r\n          //console.log(objects[0].position.x, objects[0].position.y);\r\n\r\n          __inst.cix = 0;\r\n\r\n          __inst.call_on_complete();\r\n\r\n          __inst.isComplete = true;\r\n\r\n        });\r\n\r\n\r\n      if (this.cix == 0)\r\n        this.tween.start();\r\n\r\n      if (this.cix >= this.frames.length && !this._hang) {\r\n        this.cix = 0;\r\n      }\r\n\r\n\r\n    }\r\n  };\r\n\r\n  /** @memberof Gamelab */\r\n\r\n  Gamelab.Animation = Animation;\r\n\r\n  Gamelab.Animation.continuous = Gamelab.Animation.run; //'continuous is an alternate reference to 'run'.'\r\n\r\n  Gamelab.Animation.continue = Gamelab.Animation.run; //'continue is an alternate reference to 'run'.'\r\n\r\n  Gamelab.Animation.animate = Gamelab.Animation.run; //'animate is an alternate reference to 'run'.'\r\n\r\n})();\r\n;(function() {\r\n  console.log('Animation class... creating');\r\n\r\n  /**\r\n   *\r\n   * Creates an instance of Animation with one or more Frames.\r\n   *\r\n   * <iframe style='width:400px; height:450px; overflow:hidden;' src='../client/examples/js-class/Animation.html'> </iframe>\r\n   *\r\n   * @param   {string=} [src] the src-image-path for this Animation\r\n   * @returns {Animation} an Animation object\r\n   *\r\n   * @example\r\n   *\r\n   * //constructor call: Creates a single-frame Animation from src\r\n   * var singleFrameAnime = new Animation('directory/myFile.png');\r\n   *\r\n   * @example\r\n   * //constructor call with chainable function-calls: Creates multi-frame Animation from src, then sets properties with chainable-function-calls.\r\n   * var multiFrameAnime = new Gamelab.Animation('../images/characters/full/spaceman1.png') //constructor is called\r\n   * .FrameSize(130, 130)\r\n   * .FrameBounds(new Gamelab.Vector(9, 0), new Gamelab.Vector(23, 0), new Gamelab.Vector(23, 0))\r\n   * .Seesaw() //The Animation will play back-and-forth repeatedly (cycle through frames forwards, then backwards and so on.\r\n   * .Duration(900); //Animation lasts 900 millis OR just under 1 second\r\n   *\r\n   *  @design\r\n   *\r\n   * //single-responsibility : to define a list of frames, then progress that list of frames with a 'selected_frame' property\r\n   * var singleFrameAnime = new Animation('directory/myFile.png');\r\n   */\r\n\r\n  class Anime3D {\r\n\r\n    constructor(onCreate=function(){}) {\r\n\r\n      var args = typeof(onCreate) == 'object' ? onCreate : {};\r\n\r\n      //Gamelab.Modifiers.informable(this, args);\r\n\r\n      /**\r\n       * @property {Vector} frameSize the frameSize of the Animation\r\n       * @memberof Animation\r\n       **********/\r\n\r\n      this.frameSize = this.frameSize || new Gamelab.Vector(args.frameSize || new Gamelab.Vector(0, 0));\r\n\r\n\r\n      if (args.frameBounds && args.frameBounds.min && args.frameBounds.max) {\r\n        /**\r\n         * @property {VectorFrameBounds} frameBounds the frameBounds of the Animation, has three Vectors\r\n         * @memberof Animation\r\n         **********/\r\n        this.frameBounds = new Gamelab.VectorFrameBounds(args.frameBounds.min, args.frameBounds.max, args.frameBounds.termPoint);\r\n\r\n      } else {\r\n\r\n        this.frameBounds = new Gamelab.VectorFrameBounds(new Gamelab.Vector(0, 0, 0), new Gamelab.Vector(0, 0, 0), new Gamelab.Vector(0, 0, 0));\r\n\r\n      }\r\n\r\n\r\n      this.origin = new Gamelab.Vector(0, 0, 0);\r\n\r\n      this.frameOffset = this.getArg(args, 'frameOffset', new Gamelab.Vector(0, 0, 0));\r\n\r\n      this.apply2DFrames();\r\n\r\n      this.flipX = this.getArg(args, 'flipX', false);\r\n\r\n      this.cix = 0;\r\n\r\n      /**\r\n       * @property {Frame} selected_frame the selected_frame of the Animation, a Gamelab.Frame\r\n       * @memberof Animation\r\n       **********/\r\n\r\n      this.selected_frame = this.frames[0] || false;\r\n\r\n      this.timer = 0;\r\n\r\n      this.duration = args.duration || 2000;\r\n\r\n      this.seesaw_mode = args.seesaw_mode || false;\r\n\r\n      this.reverse_frames = args.reverse_frames || false;\r\n\r\n      this.run_ext = args.run_ext || [];\r\n\r\n      this.complete_ext = args.complete_ext || [];\r\n\r\n      this.visible = args.visible || false;\r\n\r\n    if(typeof onCreate == 'function')\r\n      onCreate.bind(this).call();\r\n    }\r\n\r\n           Texture(src, x, y, w, h)\r\n          {\r\n            this.texture = this.texture || THREE.ImageUtils.loadTexture(src);\r\n            this.texture_animator = this.texture_animator || new TextureAnimator( this.texture, x, y, w, h);\r\n            this.material = this.material || new THREE.MeshBasicMaterial({map: this.texture});\r\n            this.geometry = new THREE.PlaneGeometry(w, h, 1, 1);\r\n            this.mesh = this.mesh || new THREE.Mesh(this.geometry, this.material);\r\n            return this;\r\n          }\r\n\r\n\r\n    Origin(x, y, z) {\r\n\r\n      this.origin = new Gamelab.Vector(x, y, z);\r\n\r\n      this.frames.forEach(function($f) {\r\n\r\n        $f.origin = new Gamelab.Vector(x, y, z);\r\n\r\n      });\r\n\r\n      if(this.selected_frame)\r\n      {\r\n        this.selected_frame.origin = new Gamelab.Vector(x, y, z);\r\n      }\r\n\r\n      return this;\r\n    }\r\n\r\n    Position(x, y, z) {\r\n      this.position = new Gamelab.Vector(x, y, z);\r\n\r\n      this.frames.forEach(function($f) {\r\n\r\n        $f.position = new Gamelab.Vector(x, y, z);\r\n\r\n      });\r\n\r\n      return this;\r\n    }\r\n\r\n    Size(x, y){\r\n\r\n      this.size = new Gamelab.Vector(x, y);\r\n\r\n      return this;\r\n    }\r\n\r\n    Bone(b) {\r\n      this.bone = b;\r\n      return this;\r\n    }\r\n\r\n    ParentBone(b) {\r\n      this.parentBone = b;\r\n      return this;\r\n    }\r\n\r\n    Rotation(x, y, z) {\r\n\r\n      this.rotation = new Gamelab.Vector(x, y, z);\r\n\r\n      this.frames.forEach(function($frame) {\r\n\r\n        $frame.Rotation(x, y, z);\r\n\r\n      });\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    Src(src, options = {}) {\r\n\r\n      if (typeof src == 'string') {\r\n\r\n        console.log('setting GameImage with string:' + src);\r\n        this.src = src;\r\n        this.image = new Gamelab.GameImage(src);\r\n\r\n      } else if (src instanceof GameImage) {\r\n        console.log('Animation(): args are an instance of GameImage');\r\n\r\n        this.image = src;\r\n      } else if (src instanceof HTMLImageElement) {\r\n        console.log('Animation(): args was an instance of HTMLImageElement');\r\n\r\n        this.image = new Gamelab.GameImage(src);\r\n      }\r\n\r\n      if (!options.frameBounds)\r\n        this.init_singleFrame();\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    Size(x, y, z) {\r\n\r\n      this.size = new Gamelab.Vector(x, y, z);\r\n\r\n      this.frames.forEach(function(f) {\r\n\r\n        f.size = new Gamelab.Vector(x, y, z);\r\n\r\n      });\r\n\r\n      return this;\r\n    }\r\n\r\n    Image(src) {\r\n\r\n      if (typeof(src) == 'string') {\r\n\r\n        console.log('setting GameImage with string:' + src);\r\n        this.src = src;\r\n        this.image = new Gamelab.GameImage(src);\r\n\r\n      } else if (src instanceof Gamelab.GameImage) {\r\n        console.log('Animation(): args are an instance of GameImage');\r\n\r\n        this.image = src;\r\n      } else if (src instanceof HTMLImageElement) {\r\n        console.log('Animation(): args was an instance of HTMLImageElement');\r\n\r\n        this.image = new Gamelab.GameImage(src);\r\n      }\r\n\r\n      this.init_singleFrame();\r\n\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * sets this Animation to a single-frame-animation, from existing image\r\n     * @function\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    init_singleFrame() {\r\n\r\n      var __inst = this;\r\n\r\n      this.image.domElement.onload = function() {\r\n        if (!__inst.__isInit)\r\n          __inst.FrameSize(__inst.image.domElement.width, __inst.image.domElement.height)\r\n          .FrameBounds(new Gamelab.Vector(0, 0), new Gamelab.Vector(0, 0));\r\n\r\n        __inst.run();\r\n\r\n      };\r\n\r\n      Gamelab.log('Animation():set single-frame animation');\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    /*****\r\n     * Overridable / Extendable functions\r\n     * -allows stacking of external object-function calls\r\n     ******/\r\n\r\n\r\n    /**\r\n     * Provides a function to be called whenever this Animation starts. Function should run every time the Animation reaches frame-index 0\r\n     *\r\n     * @function\r\n     * @params {Function} call the function to be called on start\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    onRun(call) {\r\n\r\n      if (this.run_ext.indexOf(call) == -1) {\r\n        this.run_ext.push(call.bind(this));\r\n      }\r\n    }\r\n\r\n\r\n    /**\r\n     * Provides a function to be called whenever this Animation completes. Function should run every time the Animation reaches it's last frame-index.\r\n     *\r\n     * @function\r\n     * @params {Function} call the function to be called on complete\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    onComplete(call) {\r\n\r\n      if (this.complete_ext.indexOf(call) == -1) {\r\n        this.complete_ext.push(call.bind(this));\r\n      }\r\n    }\r\n\r\n    call_on_run() {\r\n      //call any function extension that is present\r\n      for (var x = 0; x < this.run_ext.length; x++) {\r\n        this.run_ext[x](this);\r\n      }\r\n    }\r\n\r\n    call_on_complete() {\r\n      //call any function extension that is present\r\n      for (var x = 0; x < this.complete_ext.length; x++) {\r\n        this.complete_ext[x](this);\r\n      }\r\n    }\r\n\r\n\r\n    Visible(v) {\r\n      this.visible = v;\r\n      return this;\r\n    }\r\n\r\n\r\n    FrameSize(w, h) {\r\n      this.frameSize = new Gamelab.Vector(w, h);\r\n\r\n      this.__isInit = true;\r\n\r\n      this.run();\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    Hang() {\r\n\r\n      this._hang = true;\r\n      return this;\r\n\r\n    }\r\n\r\n    FrameBounds(minVector, maxVector, termVector) {\r\n      this.frameBounds = new Gamelab.VectorFrameBounds(minVector, maxVector, termVector);\r\n\r\n      this.__isInit = true;\r\n\r\n      this.run();\r\n\r\n      return this;\r\n    }\r\n\r\n    FrameOffset(x, y) {\r\n      this.frameOffset = new Gamelab.Vector(x, y);\r\n      return this;\r\n    }\r\n\r\n    Seesaw() {\r\n      if (!this.seesaw_mode) {\r\n        this.seesaw_mode = true;\r\n      }\r\n\r\n      return this;\r\n    }\r\n\r\n    Duration(millis) {\r\n      this.duration = millis;\r\n\r\n      return this;\r\n    }\r\n\r\n    /**\r\n     * Reverses all frames of the animation. Frames are then expected to run backwards.\r\n     *\r\n     * @function\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    ReverseFrames() {\r\n\r\n      this.reverse_frames = true;\r\n      return this;\r\n    }\r\n\r\n    /**\r\n     * Declares the animation a a single frame / full-image.\r\n     *\r\n     * @function\r\n     * @param {Vector} frameSize optional size param\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    SingleFrame() {\r\n\r\n      this.__frametype = 'single';\r\n\r\n      this.frameSize = new Gamelab.Vector(this.image.domElement.width, this.image.domElement.height);\r\n\r\n      this.frameBounds = false;\r\n\r\n      this.selected_frame = new Gamelab.Frame().Image(this.image).FrameSize(this.frameSize).Size(this.frameSize);\r\n\r\n      this.frames = [];\r\n\r\n      this.frames[0] = this.selected_frame;\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    getArg(args, key, fallback) {\r\n\r\n      if (args.hasOwnProperty(key)) {\r\n\r\n        return args[key];\r\n\r\n      } else {\r\n        return fallback;\r\n\r\n      }\r\n    }\r\n\r\n    init() {\r\n\r\n\r\n      this.apply2DFrames();\r\n      return this;\r\n    }\r\n\r\n\r\n    apply2DFrames() {\r\n\r\n      console.log('Running apply2DFrames(): --' + this.name);\r\n\r\n      this.frames = [];\r\n\r\n      if (!this.size) {\r\n        this.Size(this.frameSize.x, this.frameSize.y);\r\n      }\r\n\r\n\r\n      var fcount = 0;\r\n\r\n      var quitLoop = false;\r\n\r\n      for (let y = this.frameBounds.min.y; y <= this.frameBounds.max.y; y++) {\r\n\r\n        for (let x = this.frameBounds.min.x; x <= this.frameBounds.max.x; x++) {\r\n\r\n          let framePos = {\r\n            x: x * this.frameSize.x + this.frameOffset.x,\r\n            y: y * this.frameSize.y + this.frameOffset.y\r\n          };\r\n\r\n          var f = new Gamelab.Frame().Image(this.image).FrameSize(this.frameSize).Origin(this.origin).Size(this.size || this.frameSize).Position(this.position || framePos);\r\n\r\n\r\n          this.frames.push(f);\r\n\r\n          if (x >= this.frameBounds.termPoint.x && y >= this.frameBounds.termPoint.y) {\r\n\r\n            quitLoop = true;\r\n\r\n            break;\r\n          }\r\n\r\n          fcount += 1;\r\n\r\n          if (quitLoop)\r\n            break;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      this.frames[0] = this.selected_frame = this.frames[0] || new Gamelab.Frame().Image(this.image).FrameSize(this.frameSize).Size(this.frameSize);\r\n\r\n      if (this.seesaw_mode) {\r\n\r\n        // console.log('Animation: applying seesaw');\r\n\r\n        var frames_reversed = this.frames.slice().reverse();\r\n\r\n        this.frames.pop();\r\n\r\n        this.frames = this.frames.concat(frames_reversed);\r\n\r\n      }\r\n      if (this.reverse_frames) {\r\n        this.frames.reverse();\r\n      }\r\n    }\r\n\r\n    scaleOf(sized_Object) {\r\n\r\n      var s = Larva.getPreferredPropertyByKey(sized_Object, 'size', 'argument had nested size variable. Using this instead.');\r\n\r\n      return s.div(this.frameSize);\r\n\r\n    }\r\n\r\n    init_colorMap() {\r\n      Larva.info('init_colorMap()');\r\n\r\n      if (!Larva.allDefined([this.image, this.image.domElement]))\r\n        return [];\r\n\r\n      this.canvasObject = this.canvasObject || new Gamelab.OffscreenCanvasRendering(this.image);\r\n\r\n      this.colorMap = this.colorMap || this.ColoredPixelGrid();\r\n\r\n      return this.colorMap;\r\n    }\r\n\r\n\r\n    ColoredPixelGrid() {\r\n\r\n      I('ColoredPixelGrid()');\r\n\r\n      var image = this.image.domElement,\r\n\r\n        ctx = this.canvasObject.ctx,\r\n\r\n        grid = [],\r\n\r\n        frameSizeDiv = this.selected_frame.frameSize.div(12).round();\r\n\r\n      for (var x = 0; x <= image.width; x += frameSizeDiv.x) {\r\n        for (var y = 0; y <= image.height; y += frameSizeDiv.y) {\r\n          // Fetch pixel at current position\r\n          var pixel = ctx.getImageData(x, y, 1, 1);\r\n          // Check that opacity is above zero\r\n          if (pixel.data[3] != 0) {\r\n\r\n            var vector = new Gamelab.Vector(x, y),\r\n\r\n              gridObject = {\r\n\r\n                position: vector,\r\n\r\n                size: frameSizeDiv\r\n              };\r\n\r\n            grid.push(gridObject);\r\n          }\r\n        }\r\n      }\r\n\r\n      return grid;\r\n    }\r\n\r\n\r\n    /**\r\n     * Returns the existing ColorMap for this animation.\r\n     *\r\n     * @function\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    getCurrentPixelMap() {\r\n\r\n      Larva.info('getCurrentPixelMap()');\r\n\r\n      var map = [];\r\n\r\n      var frame = this.selected_frame;\r\n\r\n      let __inst = this;\r\n\r\n      this.colorMap = this.init_colorMap();\r\n\r\n      for (var x in this.colorMap) {\r\n        var c = this.colorMap[x];\r\n\r\n        if (Gamelab.Collision.boxesCollide(frame.framePos, frame.frameSize, c.position, c.size)) {\r\n\r\n          map.push(c);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      return map;\r\n\r\n    }\r\n\r\n    /**\r\n     * Sets the frame to a specific array-index.\r\n     *\r\n     * @function\r\n     * @param {number} ix the frame-index to apply.\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    setFrame(ix) {\r\n      this.selected_frame = this.frames[ix];\r\n    }\r\n\r\n    update() {\r\n\r\n      if (this._hang && this.cix >= this.frames.length - 1) {\r\n        this.cix = this.frames.length - 1\r\n      }\r\n\r\n      this.selected_frame = this.frames[Math.round(this.cix) % this.frames.length];\r\n    }\r\n\r\n    reset() {\r\n\r\n      this.apply2DFrames();\r\n\r\n      this.cix = 0;\r\n    }\r\n\r\n    /**\r\n     * Applies a continuous animation. Use this in parent-sprite's update if continuous animation is required.\r\n     * Also works as a single call at any time during game-update.\r\n     *\r\n     * @function\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    run() {\r\n\r\n\r\n      if (this.__frametype == 'single') {\r\n        return 0;\r\n      }\r\n\r\n      this.apply2DFrames();\r\n\r\n      //update once:\r\n      this.update();\r\n\r\n      if (this.cix == 0) {\r\n\r\n        this.engage();\r\n\r\n      }\r\n    }\r\n\r\n    /**\r\n     * animate():: same as run()\r\n     *\r\n     * @function\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    animate() {\r\n\r\n\r\n      if (this.__frametype == 'single') {\r\n        return 0;\r\n      }\r\n\r\n      this.apply2DFrames();\r\n\r\n      //update once:\r\n      this.update();\r\n\r\n      if (this.cix == 0) {\r\n\r\n        this.engage();\r\n\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Engages, or updates the animation for a one full frame-cycle.\r\n     *\r\n     * @function\r\n     * @param {number} duration the number of milliseconds the animation should take.\r\n     * @memberof Animation\r\n     **********/\r\n\r\n    engage(duration) {\r\n\r\n      this.call_on_run();\r\n\r\n      duration = duration || this.duration || this.frames.length * 20;\r\n\r\n      if (this.__frametype == 'single') {\r\n        return 0;\r\n      }\r\n\r\n\r\n      let __inst = this;\r\n\r\n      //we have a target\r\n      this.tween = new TWEEN.Tween(this)\r\n        .easing(__inst.curve || TWEEN.Easing.Linear.None)\r\n\r\n        .to({\r\n          cix: __inst.frames.length - 1\r\n        }, duration)\r\n        .onUpdate(function() {\r\n          //console.log(objects[0].position.x,objects[0].position.y);\r\n\r\n          //   __inst.cix = Math.ceil(__inst.cix);\r\n\r\n          __inst.update();\r\n\r\n        })\r\n        .onComplete(function() {\r\n          //console.log(objects[0].position.x, objects[0].position.y);\r\n\r\n          __inst.cix = 0;\r\n\r\n          __inst.call_on_complete();\r\n\r\n          __inst.isComplete = true;\r\n\r\n        });\r\n\r\n\r\n      if (this.cix == 0)\r\n        this.tween.start();\r\n\r\n      if (this.cix >= this.frames.length && !this._hang) {\r\n        this.cix = 0;\r\n      }\r\n\r\n\r\n    }\r\n  };\r\n\r\n  /** @memberof Gamelab */\r\n\r\n  Gamelab.Animation = Animation;\r\n\r\n  Gamelab.Animation.continuous = Gamelab.Animation.run; //'continuous is an alternate reference to 'run'.'\r\n\r\n  Gamelab.Animation.continue = Gamelab.Animation.run; //'continue is an alternate reference to 'run'.'\r\n\r\n  Gamelab.Animation.animate = Gamelab.Animation.run; //'animate is an alternate reference to 'run'.'\r\n\r\n})();\r\n;\r\n\r\n\r\nfunction calc3DPointTo2DPoint(vectorOne) {\r\n\r\n  var vector = new THREE.Vector3();\r\n\r\n  vector.set(vectorOne.x, vectorOne.y, vectorOne.z);\r\n\r\n  vector.project(Gamelab.threejs.camera);\r\n\r\n  var result = new Object();\r\n  result.x = Math.round(vector.x * (renderer.domElement.width / 2));\r\n  result.y = Math.round(vector.y * (renderer.domElement.height / 2));\r\n\r\n  return result;\r\n\r\n}\r\n\r\nGamelab.Object2D3D = function(arg1, arg2){\r\n\r\n    this.screenSize2D = function(){\r\n      var renderer = Gamelab.threejs.renderer;\r\n      return {x:renderer.domElement.width, y:renderer.domElement.height}\r\n    };\r\n\r\n    this.mesh = new THREE.Mesh(arg1, arg2);\r\n\r\n    this.mesh.get2DPosition = function() {\r\n\r\n      var renderer = Gamelab.threejs.renderer,\r\n        camera = Gamelab.threejs.camera;\r\n\r\n        var scene = Gamelab.threejs.scene;\r\n\r\n      scene.updateMatrixWorld(true);\r\n      this.position.setFromMatrixPosition(this.matrixWorld );\r\n\r\n      var vector = calc3DPointTo2DPoint(this.position);\r\n\r\n      return vector;\r\n\r\n    };\r\n\r\n    this.mesh.get2DSize = function(){\r\n\r\n      var renderer = Gamelab.threejs.renderer,\r\n        camera = Gamelab.threejs.camera;\r\n\r\n        var scene = Gamelab.threejs.scene;\r\n\r\n      var widthHalf = 0.5 * renderer.context.canvas.width;\r\n      var heightHalf = 0.5 * renderer.context.canvas.height;\r\n\r\n      scene.updateMatrixWorld();\r\n\r\n      var box = new THREE.Box3().setFromObject(this);\r\n\r\n      var vector = calc3DPointTo2DPoint(box.min);\r\n\r\n      return vector;\r\n\r\n    };\r\n\r\n    this.mesh.getImageData = function(){\r\n\r\n      var canvas = Gamelab.threejs.renderer.domElement;\r\n\r\n              var renderer = Gamelab.threejs.renderer,\r\n                camera = Gamelab.threejs.camera;\r\n\r\n                var scene = Gamelab.threejs.scene;\r\n\r\n              renderer.render(scene, camera);\r\n\r\n      var position = this.get2DPosition(),\r\n        size = this.get2DSize();\r\n\r\n      var gl = canvas.getContext('webgl');\r\n\r\n      console.log(size);\r\n\r\n      console.log(position);\r\n\r\n      size.x = Math.abs(size.x);\r\n\r\n      size.y = Math.abs(size.y);\r\n\r\n      var posX = position.x,\r\n      posY =position.y;\r\n\r\n      var ScreenSize = THREE.screenSize2D();\r\n\r\n      var pixels = new Uint8Array(size.x * 2 * size.y * 2 * 4);\r\n      gl.readPixels((ScreenSize.x / 2) - size.x, (ScreenSize.y / 2) - size.y, size.x * 2, size.y * 2, gl.RGBA, gl.UNSIGNED_BYTE, pixels);\r\n\r\n      return pixels;\r\n\r\n    };\r\n\r\n\r\n\r\n    return this.mesh;\r\n\r\n};\r\n\r\n\r\n\r\nclass Animation3D{\r\n\r\n\r\n  constructor(){\r\n\r\n\r\n  }\r\n}\r\n\r\n\r\nGamelab.Animation3D = Animation3D;\r\n;\nclass Mesh\n{\n    constructor(vertices, position)\n    {\n    this.vertices = vertices;\n    this.position = position;\n    }\n}\n\n\nGamelab.Mesh = Mesh;\n;;/**\r\n * Creates a new Sprite.\r\n *\r\n * <info-bit>Gamelab.Sprite is a container for 2D Animations.\r\n * -apply Sprite class to create a 2D game-object.\r\n *\r\n * Sprites hold reference to their-own Animations and Sounds.</info-bit>\r\n * <iframe style='width:400px; height:450px; overflow:hidden;' src='../client/examples/js-class/Sprite.html'> </iframe>\r\n\r\n * @param   {string} src the srcPath for the image of the Sprite\r\n * @param   {number} scale=1.0 the scale to be applied to size of each animation-frame\r\n *\r\n * @returns {Sprite} a Gamelab.Sprite object\r\n *\r\n *\r\n *\r\n */\r\n\r\nclass Sprite extends Scriptable {\r\n  constructor(src = {}, scale = 1.0) {\r\n    super();\r\n    this.Object(this);\r\n\r\n    var args = typeof src == 'object' ? src : {};\r\n    if (args instanceof Gamelab.Animation) //instantiate from animation\r\n    {\r\n      console.dev('args was Gamelab.Animation', args);\r\n      args = {\r\n        selected_animation: args,\r\n        image: args.image,\r\n        size: new Gamelab.Vector(args.frameSize)\r\n      };\r\n    }\r\n\r\n    this.animations = [];\r\n\r\n    //create size property\r\n    this.size = new Gamelab.Vector(0, 0);\r\n    this.active = true; //defaults to active or visible\r\n\r\n\r\n    //apply image from string 'src'\r\n\r\n    if (typeof src == 'string') {\r\n      this.src = src;\r\n      this.selected_animation = new Gamelab.Animation(src);\r\n      this.image = this.selected_animation.image;\r\n      this.SingleFrame();\r\n    }\r\n\r\n    if (typeof(scale) == 'number') //image plus 'scale' argument\r\n    {\r\n      this.scale = scale || 1.0;\r\n    }\r\n\r\n    //apply remaining args\r\n    this.apply_args(args);\r\n\r\n    if (!this.selected_animation)\r\n      this.SingleFrame();\r\n  }\r\n\r\n  static_image_load(img) {\r\n\r\n    this.size = new Gamelab.Vector(img.width * this.scale, img.height * this.scale).round();\r\n\r\n  }\r\n\r\n  /**\r\n   * runs a function for the onload event of this sprite's image\r\n   *\r\n   * @function\r\n   * @param {Function} f the function to be called on load\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  onLoad(f) {\r\n\r\n    var img = this.image.domElement,\r\n\r\n      load = img.onload;\r\n\r\n    f = f || function() {};\r\n\r\n    f.bind(this);\r\n\r\n    this.load_call = f;\r\n\r\n    var $sprite = this;\r\n\r\n    img.onload = function() {\r\n\r\n      $sprite.load_total += 1;\r\n\r\n      load.bind($sprite).call($sprite);\r\n\r\n      //  $sprite.static_image_load(img);\r\n\r\n      $sprite.load_call($sprite);\r\n\r\n    };\r\n\r\n    img.onerror = function(err) {\r\n\r\n      $sprite.load_call(false, $sprite);\r\n\r\n    };\r\n\r\n    return this;\r\n  }\r\n\r\n  /**********\r\n   * @ignore\r\n   **********/\r\n\r\n  apply_args(args = {}) {\r\n\r\n    this.FromData(args, true); //Using a FUNCTIONAL COPY --heavy to process\r\n\r\n    if (args.image instanceof Gamelab.GameImage && !this.image) {\r\n      this.image = args.image;\r\n    }\r\n\r\n    this.name = args.name || \"__blankName\";\r\n\r\n    this.life = args.life || 999999999999;\r\n\r\n    this.description = args.description || \"__spriteDesc\";\r\n\r\n    /**\r\n     * @property {String} id the unique identifier of the Sprite --called automatically on constructor.\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n    this.id = this.create_id();\r\n\r\n\r\n    /**\r\n     * @property {Array} animations the array of animations attached to the Sprite\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n    this.animations = Gamelab.getArg(args, 'animations', []);\r\n\r\n    /**\r\n     * @property {Array} scripts the array of scripts attached to the Sprite\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n    this.scripts = Gamelab.getArg(args, 'scripts', []);\r\n\r\n    this.motions = Gamelab.getArg(args, 'motions', []);\r\n\r\n    this.particles = Gamelab.getArg(args, 'particles', []);\r\n\r\n    this.shots = Gamelab.getArg(args, 'shots', []);\r\n\r\n    this.sounds = Gamelab.getArg(args, 'sounds', []);\r\n\r\n    this.init_ext = Gamelab.getArg(args, 'init_ext', []);\r\n\r\n    this.group = Gamelab.getArg(args, 'group', 'one');\r\n\r\n    this.scrollFactor = args.scrollFactor || 1.0;\r\n\r\n    this.noScroll = args.noScroll || false;\r\n\r\n    if (this.noScroll) {\r\n      this.scrollFactor = 0;\r\n    }\r\n\r\n\r\n    /**\r\n     * @property {Vector} speed the speed of the Sprite\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n    this.speed = new Gamelab.Vector(Gamelab.getArg(args, 'speed', new Gamelab.Vector(0, 0)));\r\n\r\n    /**\r\n     * @property {Vector} size the vector-size of the Sprite\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n    this.size = new Gamelab.Vector(Gamelab.getArg(args, 'size', new Gamelab.Vector(0, 0)));\r\n\r\n\r\n\r\n    /**\r\n     * @property {Vector} position the position of the Sprite\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n    this.position = new Gamelab.Vector(Gamelab.getArg(args, 'position', new Gamelab.Vector(0, 0, 0)));\r\n\r\n    this.collision_bounds = Gamelab.getArg(args, 'collision_bounds', new Gamelab.VectorBounds(new Gamelab.Vector(0, 0, 0), new Gamelab.Vector(0, 0, 0)));\r\n\r\n\r\n    /**\r\n     *\r\n     *\r\n     * @property {Vector} rotation the rotation of the Sprite\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n    this.rotation = new Gamelab.Vector(Gamelab.getArg(args, 'rotation', new Gamelab.Vector(0, 0, 0)));\r\n\r\n\r\n    /**\r\n     * @property {number} scale the scale of the Sprite, controls draw-size\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n    this.scale = args.scale || 1.0;\r\n\r\n    this.acceleration = Gamelab.getArg(args, 'acceleration', new Gamelab.Vector(0, 0, 0));\r\n\r\n    this.rot_speed = new Gamelab.Vector(Gamelab.getArg(args, 'rot_speed', new Gamelab.Vector(0, 0)));\r\n\r\n    this.rot_accel = new Gamelab.Vector(Gamelab.getArg(args, 'rot_accel', new Gamelab.Vector(0, 0)));\r\n\r\n    this.padding = Gamelab.getArg(args, 'padding', new Gamelab.Vector(0, 0, 0));\r\n\r\n\r\n    var __inst = this;\r\n\r\n    //Apply / instantiate Sound(), Gamelab.Motion(), and Gamelab.Animation() args...\r\n\r\n\r\n    Gamelab.each(this.shots, function(ix, item) {\r\n\r\n      __inst.shots[ix] = new Gamelab.Shot(item);\r\n\r\n    });\r\n\r\n    Gamelab.each(this.sounds, function(ix, item) {\r\n\r\n      __inst.sounds[ix] = new Gamelab.Sound(item);\r\n\r\n    });\r\n\r\n    Gamelab.each(this.motions, function(ix, item) {\r\n\r\n      __inst.motions[ix] = new Gamelab.TweenMotion(item);\r\n\r\n    });\r\n\r\n    Gamelab.each(this.animations, function(ix, item) {\r\n\r\n      __inst.animations[ix] = new Gamelab.Animation(item);\r\n\r\n    });\r\n\r\n    Gamelab.each(this.particles, function(ix, item) {\r\n\r\n      __inst.particles[ix] = new Gamelab.GSProton(item);\r\n\r\n    });\r\n\r\n    //Apply initializers:\r\n\r\n    Gamelab.each(this.init_ext, function(ix, item) {\r\n\r\n      __inst.addInitializer(item);\r\n\r\n    });\r\n\r\n    if (!this.selected_animation && args.selected_animation) {\r\n\r\n      console.dev('applying animation:' + jstr(args.selected_animation));\r\n\r\n      this.selected_animation = new Gamelab.Animation(args.selected_animation);\r\n\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * Clones a sprite from existing data\r\n   *\r\n   * @function\r\n   * @param {Object} object the data to be cloned\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n   Clone(sprite){\r\n     console.log('using Clone() function');\r\n\r\n     var clone = new Gamelab.Sprite(sprite.src);\r\n\r\n     clone.Anime(new Gamelab.Animation(sprite.anime));\r\n\r\n     clone.apply_args(sprite);\r\n\r\n     return clone;\r\n   }\r\n\r\n   draw(gameWindow, camera) {\r\n\r\n     var sprite = this;\r\n\r\n     camera = camera || Gamelab.game_windows[0].camera || {\r\n       position: new Gamelab.Vector(0, 0, 0)\r\n     };\r\n\r\n     if (sprite.active && (this.DRAWOFFSCREEN || sprite.onScreen(Gamelab.WIDTH, Gamelab.HEIGHT))) {\r\n       this.draw_current_frame(ctx, camera);\r\n     }\r\n   }\r\n\r\n   draw_current_frame(ctx, camera){\r\n\r\n     var sprite = this;\r\n\r\n     var frame = false, frameList = [];\r\n\r\n     if (sprite.active) {\r\n\r\n       if(sprite.selected_animation instanceof Array && sprite.selected_animation.length >= 1)\r\n       {\r\n         sprite.selected_animation.forEach(function(anime){\r\n\r\n            frameList.push(anime.selected_frame);\r\n\r\n         });\r\n       }\r\n\r\n       if (sprite.selected_animation instanceof Object && sprite.selected_animation.hasOwnProperty('selected_frame')) {\r\n\r\n         frame = sprite.selected_animation.selected_frame;\r\n\r\n       } else {\r\n\r\n\r\n\r\n\r\n       }\r\n\r\n       var p = sprite.position;\r\n\r\n       var camera_pos = camera.position || {\r\n         x: 0,\r\n         y: 0,\r\n         z: 0\r\n       };\r\n\r\n       if (!sprite.hasOwnProperty('scrollFactor')) {\r\n         sprite.scrollFactor = 1.0;\r\n       }\r\n\r\n       var x = p.x,\r\n         y = p.y,\r\n         scrollFactor = sprite.scrollFactor >= -1.0 && sprite.scrollFactor <= 1.0 ? sprite.scrollFactor : 1.0;\r\n\r\n       if (sprite.noScroll) {\r\n         scrollFactor = 0;\r\n       }\r\n\r\n\r\n       x -= camera_pos.x * scrollFactor || 0;\r\n       y -= camera_pos.y * scrollFactor || 0;\r\n       //optional animation : gameSize\r\n\r\n       var targetSize = sprite.size || sprite.selected_animation.size;\r\n\r\n       var realWidth = targetSize.x;\r\n       var realHeight = targetSize.y;\r\n\r\n\r\n       var origin = sprite.origin || new Gamelab.Vector(realWidth / 2, realHeight / 2);\r\n\r\n       //optional animation : offset\r\n\r\n       if (sprite.selected_animation && sprite.selected_animation.hasOwnProperty('offset')) {\r\n         x += sprite.selected_animation.offset.x;\r\n\r\n         y += sprite.selected_animation.offset.y;\r\n\r\n       }\r\n\r\n\r\n       var rotation;\r\n\r\n       if (typeof(sprite.rotation) == 'object') {\r\n\r\n         rotation = sprite.rotation.x;\r\n\r\n\r\n       } else {\r\n         rotation = sprite.rotation;\r\n\r\n       }\r\n\r\n       var frame = sprite.selected_animation.selected_frame;\r\n\r\n       sprite.realPosition = new Gamelab.Vector(x, y);\r\n\r\n       if (frame && frame.image && frame.image.data) {\r\n\r\n         ctx.putImageData(frame.image.data, x, y, 0, 0, sprite.size.x, sprite.size.y);\r\n\r\n       } else {\r\n\r\n         if(frameList.length >= 1)\r\n         {\r\n\r\n            frameList.forEach(function(frame){\r\n\r\n              var realWidth = frame.size.x;\r\n              var realHeight = frame.size.y;\r\n\r\n              var x = frame.position.x, y = frame.position.y;\r\n\r\n\r\n\r\n              if(frame.rotation && frame.rotation.x)\r\n              {\r\n                rotation = frame.rotation.x;\r\n              }\r\n\r\n              if(frame.origin)\r\n              {\r\n                origin = frame.origin;\r\n                  console.log('drawing with origin:' + origin.x + ':' + origin.y);\r\n              }\r\n\r\n              if(frame && frame.image)\r\n              Gamelab.Canvas.draw_image_frame(frame.image.domElement, frame.framePos, frame.frameSize, new Gamelab.Vector2D(Math.round(x + (realWidth / 2)), Math.round(y + (realHeight / 2))), new Gamelab.Vector2D(realWidth, realHeight), rotation % 360, ctx, sprite.flipX, sprite.flipY, origin);\r\n\r\n            });\r\n\r\n         }\r\n         else{\r\n\r\n                    if (frame.image.domElement instanceof HTMLImageElement) {\r\n\r\n                      Gamelab.Canvas.draw_image_frame(frame.image.domElement, frame.framePos, frame.frameSize, new Gamelab.Vector2D(Math.round(x + (realWidth / 2)), Math.round(y + (realHeight / 2))), new Gamelab.Vector2D(realWidth, realHeight), rotation % 360, ctx, sprite.flipX, sprite.flipY, origin);\r\n\r\n                    }\r\n\r\n         }\r\n\r\n       }\r\n     }\r\n\r\n   }\r\n\r\n\r\n  /**\r\n   * adds an animation to the sprites\r\n   *\r\n   * @function\r\n   * @param {Object} object the animation to be added\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n\r\n  Add(object) {\r\n\r\n    if (object instanceof Gamelab.Animation) {\r\n      this.animations.add(object);\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  get animation() {\r\n    return this.selected_animation;\r\n  }\r\n\r\n  get anime() {\r\n    return this.selected_animation;\r\n  }\r\n\r\n  Anime(anime) {\r\n    if(anime)\r\n    this.selected_animation = anime;\r\n    return this;\r\n  }\r\n\r\n\r\n    Animation(anime) {\r\n      if(anime)\r\n      this.selected_animation = anime;\r\n      return this;\r\n    }\r\n\r\n\r\n  FromData(data = {}, fxlCopy = false) {\r\n    for (var x in data) {\r\n      if (fxlCopy || typeof(data[x]) !== 'function')\r\n        this[x] = data[x];\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  FromSourceImage(src) {\r\n    return new this.constructor(src);\r\n  }\r\n\r\n  /**************************************************************\r\n   * scales the sprite.size property according to image-size.\r\n   * @param {number} scaleFloat a 0-1+ value\r\n   *\r\n   * @function\r\n   * @memberof Sprite\r\n   **************************************************************/\r\n\r\n  Scale(scaleFloat) {\r\n\r\n    this.scale = scaleFloat;\r\n\r\n    this.size = new Gamelab.Vector(this.image.domElement.width * scaleFloat, this.image.domElement.height * scaleFloat);\r\n\r\n    return this;\r\n  }\r\n\r\n  /**************************************************************\r\n   * applies a float value arg to Sprite.scrollFactor\r\n   * @param {number} s a 0-1+ value\r\n   *\r\n   * @function\r\n   * @memberof Sprite\r\n   **************************************************************/\r\n\r\n\r\n  ScrollFactor(s) {\r\n    this.scrollFactor = s;\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n\r\n  engage(obj) //engages an object having an engage function\r\n  {\r\n\r\n    obj.parent = this;\r\n\r\n    if (obj.engage) {\r\n      obj.engage();\r\n\r\n    }\r\n\r\n  }\r\n\r\n\r\n  /**\r\n   * pass argument v to the sprite.life property.\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {number} v number of render-updates that this Sprite will last. --update occurs 60+ times per second, or less, depending on performance\r\n   * @returns {Sprite} the sprite object --enables chainable function calls\r\n   **********/\r\n\r\n  Life(v) {\r\n\r\n    this.life = v;\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n\r\n  /**\r\n   * initializes sprites. triggers all functions previously passed to the addInitializer function.\r\n   * Use this function when a sprite, instantiated from json-data, carries initializers.\r\n   * --This feature is built for the purpose of data-persistence. --sprites from json-file may carry behaviors onto the scene.\r\n   *\r\n   * @function\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  init() {\r\n\r\n\r\n  }\r\n\r\n  /**\r\n   * extends the init function.\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {function} fun the function to be passed into the init function of the sprite\r\n   **********/\r\n\r\n  addInitializer(fun) {\r\n\r\n    let boundFun = fun.bind(this)\r\n\r\n    if (this.init_ext.indexOf(boundFun) < 0) {\r\n\r\n      this.init_ext.push(boundFun)\r\n    };\r\n\r\n  }\r\n\r\n  /*****************************\r\n   * Getters\r\n   ***************************/\r\n\r\n  /**\r\n   * returns the 'id' property of the sprite\r\n   * @function\r\n   * @memberof Sprite\r\n   * @returns {string}\r\n   **********/\r\n\r\n  get_id() {\r\n    return this.id;\r\n  }\r\n\r\n  /**********\r\n   * @ignore\r\n   **********/\r\n\r\n  to_map_object(size, framesize) {\r\n\r\n    this.__mapSize = new Gamelab.Vector(size || this.size);\r\n\r\n    this.frameSize = new Gamelab.Vector(framesize || this.size);\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n  /*****************************\r\n   * Setters and Creators\r\n   ***************************/\r\n\r\n  /**\r\n   * creates a unique string id property for the sprite.\r\n   * @function\r\n   * @memberof Sprite\r\n   * @returns {string}\r\n   **********/\r\n\r\n  create_id() {\r\n\r\n    return Gamelab.create_id();\r\n\r\n  }\r\n\r\n  /**\r\n   * returns a maximum scaled size, according to max dimensions of width and height\r\n   * @param {number} mx the maximum size.x for the returned size\r\n   * @param {number} my the maximum size.y for the returned size\r\n   * @function\r\n   * @memberof Sprite\r\n   * @returns {Vector} a vector of x,y,z? values\r\n   **********/\r\n\r\n  getSizeByMax(mx, my) {\r\n\r\n    var size = new Gamelab.Vector(this.size);\r\n\r\n    var wth = size.y / size.x;\r\n\r\n    var htw = size.x / size.y;\r\n\r\n    if (size.x > mx) {\r\n      size.x = mx;\r\n\r\n      size.y = size.x * wth;\r\n\r\n    }\r\n\r\n    if (size.y > my) {\r\n      size.y = my;\r\n\r\n      size.x = size.y * htw;\r\n\r\n    }\r\n\r\n    return size;\r\n\r\n  }\r\n\r\n  /*****************************\r\n   *  assert the existence of a speed{} property\r\n   *  sprite.speed (vector) is created if not existing in sprite\r\n   *  @memberof Sprite\r\n   ***************************/\r\n\r\n  assertSpeed() {\r\n    if (!this.speed) {\r\n      this.speed = new Gamelab.Vector(0, 0, 0);\r\n    }\r\n\r\n  }\r\n\r\n\r\n\r\n  /**\r\n   * set the 'selected_animation' property to a single-frame-animation\r\n   * @function\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  SingleFrame() {\r\n\r\n    if (!this.image || !this.image.domElement) {\r\n      return this;\r\n    }\r\n\r\n    var __inst = this,\r\n      load = this.image.domElement.onload || function() {};\r\n\r\n    if (this.size && this.size.x !== 0 && this.size.y !== 0)\r\n      return;\r\n\r\n    var _obj = this;\r\n\r\n    this.image.domElement.onload = function() {\r\n\r\n      load(false, __inst);\r\n\r\n      if (_obj.size && _obj.size.x !== 0 && _obj.size.y !== 0)\r\n        {\r\n\r\n        }\r\n        else{\r\n            __inst.size = new Gamelab.Vector(__inst.image.domElement.width, __inst.image.domElement.height);\r\n            __inst.selected_animation = new Gamelab.Animation(__inst.image).FrameSize(__inst.size);\r\n            __inst.Scale(__inst.scale || 1.0);\r\n        }\r\n\r\n    };\r\n\r\n    Gamelab.log('set single-frame animation');\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n\r\n    /**\r\n     * set the 'life' property to a specified integer\r\n     * @function\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n  LifeSpan(value) {\r\n    this.life = value;\r\n  }\r\n\r\n    /**\r\n     * set the 'life' property to a specified integer\r\n     * @function\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n  Life(value) //same as LifeSpan\r\n  {\r\n    this.life = value;\r\n  }\r\n\r\n  /**\r\n   * tells if sprite has been taken out of game\r\n   * @function\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  isDead(gw) {\r\n\r\n    gw = gw || Gamelab.game_windows[0];\r\n\r\n    return this.hasOwnProperty('life') && this.life <= 0;\r\n  }\r\n\r\n  /**\r\n   * sets life to 0, then ending the sprite\r\n   * @function\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  die(gw) {\r\n\r\n    this.life = 0;\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n  /**\r\n   * indicates if any portion of the sprite is within screen bounds --uses Gamelab.WIDTH, Gamelab.HEIGHT OR any w,h arguments passed to this method\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {number} w optional screen-width argument, defaults to Gamelab.WIDTH\r\n   * @param {number} h optional screen-height argument, defaults to Gamelab.HEIGHT\r\n   * @returns {boolean} a true or false value to show if any part of the sprite is on-screen\r\n   **********/\r\n\r\n  onScreen(w, h, gw) {\r\n\r\n    w = w || Gamelab.WIDTH;\r\n\r\n    h = h || Gamelab.HEIGHT;\r\n\r\n    gw = gw || Gamelab.game_windows[0];\r\n\r\n    var camera = gw.camera || Gamelab.camera || {\r\n        position: new Gamelab.Vector(0, 0, 0)\r\n      },\r\n      scrollFactor = this.noScroll ? 0 : this.scrollFactor;\r\n\r\n      var sprite = this,\r\n\r\n      p = sprite.position,\r\n\r\n      camera_pos = camera.position || {\r\n        x: 0,\r\n        y: 0,\r\n        z: 0\r\n      };\r\n\r\n      if (!sprite.hasOwnProperty('scrollFactor')) {\r\n        sprite.scrollFactor = 1.0;\r\n      }\r\n\r\n      var x = p.x,\r\n        y = p.y,\r\n        scrollFactor = sprite.scrollFactor >= -1.0 && sprite.scrollFactor <= 1.0 ? sprite.scrollFactor : 1.0;\r\n\r\n      if (sprite.noScroll) {\r\n        scrollFactor = 0;\r\n      }\r\n\r\n      x -= camera_pos.x * scrollFactor || 0;\r\n      y -= camera_pos.y * scrollFactor || 0;\r\n\r\n    return x + sprite.size.x > -1000 - w && x < w + 1000 &&\r\n      y + sprite.size.y > 0 - 1000 - h && y < h + 1000;\r\n\r\n  }\r\n\r\n  /*****************************\r\n   * Updates\r\n   ***************************/\r\n\r\n  /*****************************\r\n   * update()\r\n   * -starts empty:: is applied recursively by Gamelab.js as the main sprite-update\r\n   ***************************/\r\n\r\n  /**\r\n   * the main update for the sprite --applied recursively by GameWindow after gameWindow.start is called\r\n   * @function\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  update(sprite) {}\r\n\r\n  /*****************************\r\n   * def_update()\r\n   * -applies speed and other default factors of movement\r\n   * -is used by Quick2d.js as the system def_update (default update)\r\n   ***************************/\r\n\r\n  /**\r\n   * Automatically updates various speed and rotational properties for the Sprite()\r\n   * @function\r\n   * @memberof Sprite\r\n   *\r\n   * @example\r\n   * // applies a constant speed property --speed is Vector(x, y)\r\n   * mySprite.rot_speed = new Gamelab.Vector(3);\r\n   * //def_update() will run automatically with the gamelab update. The above sprite will rotate at a constant speed of 3.\r\n   * @example\r\n   * // how to reset to nothing:: if automatic speed updates are undesired, replace the def_update() function with a 'do nothing' function.\r\n   * mySprite.def_update = function()\r\n   *                      {\r\n   *                     //do nothing\r\n   *                     };\r\n   **********/\r\n\r\n\r\n  def_update(sprite) {\r\n\r\n    if (this.hasOwnProperty('life') && !isNaN(this.life)) {\r\n\r\n      this.life -= 1;\r\n\r\n    };\r\n\r\n    for (var x in this.speed) {\r\n\r\n      if (this.speed[x] > 0 || this.speed[x] < 0) {\r\n\r\n        this.position[x] += this.speed[x];\r\n\r\n      }\r\n\r\n    }\r\n\r\n    for (var x in this.acceleration) {\r\n\r\n      if (this.acceleration[x] > 0 || this.acceleration[x] < 0) {\r\n\r\n        this.speed[x] += this.acceleration[x];\r\n\r\n      }\r\n\r\n    }\r\n\r\n    for (var x in this.rot_speed) {\r\n\r\n      if (this.rot_speed[x] > 0 || this.rot_speed[x] < 0) {\r\n\r\n        this.rotation[x] += this.rot_speed[x];\r\n\r\n      }\r\n\r\n\r\n    }\r\n\r\n    for (var x in this.rot_accel) {\r\n\r\n\r\n      if (this.rot_accel[x] > 0 || this.rot_accel[x] < 0) {\r\n\r\n        this.rot_speed[x] += this.rot_accel[x];\r\n\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * extends an existing function, and is applied by Gamelab in addInitializer();\r\n   * @ignore\r\n   * -REMOVED FROM DOCS : SYSTEM USE ONLY\r\n   **********/\r\n\r\n  extendFunc(fun, extendedFunc) {\r\n\r\n    console.log('extending func');\r\n\r\n    var ef = extendedFunc;\r\n\r\n    var __inst = this;\r\n\r\n    return function() {\r\n\r\n      ef(__inst);\r\n\r\n      //any new function comes after\r\n\r\n      fun(__inst);\r\n\r\n    }.bind(this);\r\n\r\n  }\r\n\r\n\r\n  /*****************************\r\n   *  onUpdate(fun)\r\n   * -args: 1 function(sprite){ } //the self-instance/sprite is passed into the function()\r\n   * -overrides and maintains existing code for update(){} function\r\n   ***************************/\r\n\r\n\r\n  /**\r\n   * extends the update of this sprite with a new function to be called during the update\r\n   * --repeated calls will extend, (not replace) the update --Allows multiple extensions of the update\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {function} fun the function to be appended to sprite.update\r\n   *\r\n   *  * @example\r\n   * // extend the behavior of your sprite\r\n   * mySprite.onUpdate(function(spr)\r\n   *\r\n   *                    console.log('extended update'); //runs automatically whenever sprite.update runs\r\n   *\r\n   *                   });\r\n   *\r\n   **********/\r\n\r\n\r\n  onUpdate(fun) {\r\n\r\n    var id = this.create_id();\r\n\r\n    fun = fun.bind(this);\r\n\r\n    let update = this.update.bind(this);\r\n\r\n    let __inst = this;\r\n\r\n    this.update = function(__inst) {\r\n\r\n      update(__inst);\r\n\r\n      fun(__inst);\r\n\r\n    };\r\n  }\r\n\r\n  /*****************************\r\n   *  travelLineTwoWay()\r\n   *  -sprite travels line: any Line() or object with property of line\r\n   ***************************/\r\n\r\n  /********************************************************************************\r\n   * sprite travels on a line in a back-and-forth motion --to the end of the line, and back.\r\n   * #Dev-todo:MORE ON THIS\r\n   * @function\r\n   * @memberof Sprite\r\n   *********************************************************************************/\r\n\r\n  travelLineTwoWay(lineObject, speed, curveKey, offset) {\r\n\r\n    speed = speed || 1;\r\n\r\n    var motionCurveOptions = [\"linear\", \"quadratic\", \"cubic\"];\r\n\r\n    curveKey = curveKey || \"linear\";\r\n\r\n    var line = lineObject;\r\n\r\n    if (lineObject.line) {\r\n      line = lineObject.line;\r\n    }\r\n\r\n    this.__crtLineIx = this.__crtLineIx || 0;\r\n\r\n    var __inst = this,\r\n\r\n      pctFloat = __inst.__crtLineIx % ((line.points.length - 1) / 2) / ((line.points.length - 1) / 2);\r\n\r\n    if (__inst.__crtLineIx >= ((line.points.length - 1) / 2)) {\r\n      pctFloat = 1.0 - pctFloat;\r\n\r\n    }\r\n\r\n    var ixChange = Gamelab.Curves.InOut[curveKey](pctFloat) * speed * 0.5;\r\n\r\n    if (curveKey == 'linear') {\r\n      ixChange = speed;\r\n    }\r\n\r\n    ixChange = Math.ceil(ixChange);\r\n\r\n    if (ixChange < 1) {\r\n      ixChange = 1;\r\n    }\r\n\r\n    __inst.position = new Gamelab.Vector(line.points[__inst.__crtLineIx]);\r\n\r\n    //console.log(ixChange);\r\n\r\n    __inst.__crtLineIx += ixChange;\r\n\r\n    if (__inst.__crtLineIx >= line.points.length) {\r\n\r\n      line.points = line.points.reverse();\r\n      __inst.__crtLineIx = 0;\r\n    }\r\n\r\n    if (offset instanceof Gamelab.Vector) {\r\n      this.position = this.position.add(offset);\r\n    }\r\n  }\r\n\r\n\r\n  /*****************************\r\n   *  travelLineOnLoop()\r\n   *  -sprite travels line: any Line() or object with property of line\r\n   ***************************/\r\n\r\n  /**\r\n   * the sprite travels one line in a looping motion --useful for traveling Square, Circle, or other enclosed Lines.\r\n   * #Dev-todo:MORE ON THIS\r\n   * @function\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  travelLineOnLoop(lineObject, speed, curveKey, offset) {\r\n\r\n    speed = speed || 1;\r\n\r\n    var motionCurveOptions = [\"linear\", \"quadratic\", \"cubic\"];\r\n\r\n    curveKey = curveKey || \"linear\";\r\n\r\n    var line = lineObject;\r\n\r\n    if (lineObject.line) {\r\n      line = lineObject.line;\r\n    }\r\n\r\n    this.__crtLineIx = this.__crtLineIx || 0;\r\n\r\n    var __inst = this,\r\n\r\n      pctFloat = __inst.__crtLineIx % ((line.points.length - 1) / 2) / ((line.points.length - 1) / 2);\r\n\r\n    if (__inst.__crtLineIx >= ((line.points.length - 1) / 2)) {\r\n      pctFloat = 1.0 - pctFloat;\r\n\r\n    }\r\n\r\n    var ixChange = Gamelab.Curves.InOut[curveKey](pctFloat) * speed * 0.5;\r\n\r\n    if (curveKey == 'linear') {\r\n      ixChange = speed;\r\n    }\r\n\r\n    ixChange = Math.ceil(ixChange);\r\n\r\n    if (ixChange < 1) {\r\n      ixChange = 1;\r\n    }\r\n\r\n    __inst.position = new Gamelab.Vector(line.points[__inst.__crtLineIx]);\r\n\r\n    // console.log(ixChange);\r\n\r\n    __inst.__crtLineIx += ixChange;\r\n\r\n    if (__inst.__crtLineIx >= line.points.length) {\r\n      __inst.__crtLineIx = 0;\r\n    }\r\n\r\n    if (offset instanceof Gamelab.Vector) {\r\n      this.position = this.position.add(offset);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * returns a true || false value for immediate color-collision --non-transparent-pixels --between colored-pixels of this sprite and the sprite argument\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Sprite} spr the sprite object to be collided\r\n   * @returns {boolean} a true or false value to show if collision is happening\r\n   **********/\r\n\r\n  hasPixelCollision(sprite) {\r\n\r\n    if (!Larva.truthyPropsPerArray([this, sprite], 'selected_animation'))\r\n      return;\r\n\r\n    if (!Larva.truthyPropsPerArray([this.selected_animation, sprite.selected_animation], 'getCurrentPixelMap'))\r\n      return;\r\n\r\n    let anime = this.selected_animation,\r\n      alt_anime = sprite.selected_animation;\r\n\r\n    var grid1 = anime.selectedFramePixelMap = this.selected_animation.getCurrentPixelMap(),\r\n\r\n      grid2 = alt_anime.selectedFramePixelMap = alt_anime.getCurrentPixelMap();\r\n\r\n    for (var x in grid1) {\r\n      for (var y in grid2) {\r\n        if (Gamelab.Collision.boxesCollide(grid1[x].position, grid1[x].size, grid2[y].position, grid2[y].size)) {\r\n          return true;\r\n\r\n        }\r\n\r\n      }\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  init_pixelCollision() {\r\n    let anime = this.selected_animation;\r\n\r\n    this.selectedFramePixelMap = anime.getCurrentPixelMap(anime.scaleOf(this.size));\r\n    this.colliderHighlights = this.colliderHighlights || [];\r\n  }\r\n\r\n  init_colliderHighlights(unitMarker) {\r\n    while (this.colliderHighlights.length < 100) {\r\n      var sprite = new Gamelab.Sprite(unitMarker);\r\n      this.colliderHighlights.push(sprite);\r\n      Gamelab.game_windows[0].add(sprite);\r\n    }\r\n  }\r\n\r\n  pixelGridOff() {\r\n\r\n\r\n  }\r\n\r\n  set_colliderHighlights(hSprite, on) {\r\n    this.collider_highlightsOn = on || false;\r\n\r\n    this.init_pixelCollision();\r\n\r\n    this.init_colliderHighlights(hSprite);\r\n\r\n    let anime = this.selected_animation;\r\n\r\n    for (var x in this.colliderHighlights) {\r\n      this.colliderHighlights[x].active = false;\r\n    }\r\n\r\n    if (hSprite && this.collider_highlightsOn)\r\n      for (var x in this.selectedFramePixelMap) {\r\n        if (!this.colliderHighlights[x]) {\r\n          continue;\r\n        }\r\n\r\n        let gridPiece = this.selectedFramePixelMap[x];\r\n\r\n        let anime_scale = anime.scaleOf(this.size),\r\n          real_gridPiece_pos = gridPiece.position.mult(anime_scale),\r\n          real_gridPiece_size = gridPiece.size.mult(anime_scale);\r\n\r\n        this.colliderHighlights[x].Pos(this.position.add(new Gamelab.Vector(real_gridPiece_pos.x, real_gridPiece_pos.y).sub(anime.selected_frame.framePos.mult(anime_scale))));\r\n\r\n        this.colliderHighlights[x].Size(real_gridPiece_size);\r\n\r\n        this.colliderHighlights[x].active = true;\r\n      };\r\n\r\n  }\r\n\r\n  onPixelCollision(sprite, callback, highlightSprite) {\r\n\r\n    let anime = this.selected_animation;\r\n\r\n    this.onUpdate(function() {\r\n\r\n      var anime = this.selected_animation;\r\n\r\n      if (this.hasPixelCollision(sprite)) {\r\n\r\n        if (!this.colliderHighlights) {\r\n\r\n\r\n        } else\r\n          for (var x in colliderHighlights) {\r\n            gameWindow.remove(colliderHighlights[x]);\r\n          };\r\n\r\n        callback(this, sprite);\r\n\r\n      };\r\n\r\n    });\r\n  }\r\n\r\n\r\n  /**\r\n   * returns a true || false value for immediate box-collision --between this sprite and the sprite argument\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Sprite} sprite the alternate Sprite for collision detection\r\n   * @returns {boolean} a true or false value to show if collision is happening\r\n   **********/\r\n\r\n  hasBoxCollision(sprite) {\r\n\r\n    return Gamelab.Collision.spriteBoxesCollide(this, sprite);\r\n\r\n  }\r\n\r\n  onBoxCollision(sprite, callback) {\r\n    this.onUpdate(function() {\r\n\r\n      if (this.hasBoxCollision(sprite, this.boxCollisionSettings.padding)) {\r\n\r\n        callback(this, sprite);\r\n\r\n      };\r\n    });\r\n  }\r\n\r\n  /*****************************\r\n   *  shoot(sprite)\r\n   *  -fire a shot from the sprite:: as in a firing gun or spaceship\r\n   *  -takes options{} for number of shots anglePerShot etc...\r\n   *  -TODO: complete and test this code\r\n   ***************************/\r\n\r\n\r\n  /**\r\n   * fire a Shot, or bullet-Sprite from the Sprite\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Object} options an object of arguments\r\n   * @param {Gamelab.Animation} animation the animation to fire from the Sprite\r\n   * @param {number} speed the speed of the shot that is projected\r\n   * @param {Gamelab.Vector} position the initial position of the shot: defaults to current Sprite position\r\n   * @param {Gamelab.Vector} size the Vector size of the shot\r\n   * @param {Gamelab.Vector} rot_offset the rotational offset to apply: controls direction of the shot\r\n   **********/\r\n\r\n  shoot(options, gw) {\r\n    //character shoots an animation\r\n\r\n    gw = gw || Gamelab.game_windows[0];\r\n\r\n    this.prep_key = 'shoot';\r\n\r\n    let animation = options.bullet || options.animation || options.anime || new Gamelab.Animation();\r\n\r\n    let speed = options.speed || options.velocity || 1;\r\n\r\n\r\n    let size = options.size || new Gamelab.Vector(10, 10, 0);\r\n\r\n    let position = new Gamelab.Vector(options.position) || new Gamelab.Vector(this.position);\r\n\r\n\r\n    let rot_offset = options.rot_offset || options.rotation || 0;\r\n\r\n    let total = options.total || 1;\r\n\r\n    let rot_disp = options.rot_disp || 0; //the full rotational-dispersion of the bullets\r\n\r\n    let life = options.life || 900;\r\n\r\n    var shots = [];\r\n\r\n    for (var x = 0; x < total; x++) {\r\n\r\n      var __playerInst = this;\r\n\r\n      if (Gamelab.isAtPlay) {\r\n\r\n        var bx = position.x,\r\n          by = position.y,\r\n          bw = size.x,\r\n          bh = size.y;\r\n\r\n        var shot = new Gamelab.Sprite().FromData({\r\n\r\n          active: true,\r\n\r\n          position: new Gamelab.Vector(position),\r\n\r\n          size: new Gamelab.Vector(size),\r\n\r\n          speed: speed,\r\n\r\n          image: animation.image,\r\n\r\n          rotation: new Gamelab.Vector(0, 0, 0),\r\n\r\n          flipX: false,\r\n\r\n          life: options.life,\r\n\r\n          noScroll:true\r\n\r\n        });\r\n\r\n\r\n        shot.Animation(animation);\r\n\r\n        rot_offset = new Gamelab.Vector(rot_offset, 0, 0);\r\n\r\n        shot.position.x = bx, shot.position.y = by;\r\n\r\n        //Danger On this line: annoying math --dispersing rotation of bullets by rot_disp\r\n\r\n        var div = rot_disp / total;\r\n\r\n        var rotPlus = div * x + div / 2 - rot_disp / 2;\r\n\r\n        shot.rotation.x = rot_offset.x + rotPlus;\r\n\r\n        //  shot.origin = new Gamelab.Vector(position);\r\n\r\n        shot.speed = new Gamelab.Vector(Math.cos((shot.rotation.x) * 3.14 / 180) * speed, Math.sin((shot.rotation.x) * 3.14 / 180) * speed);\r\n\r\n        shots.push(shot);\r\n\r\n        shot.onUpdate(function(spr) {\r\n          // console.log('update:rotation:' + shot.rotation.x);\r\n\r\n\r\n        });\r\n\r\n        gw.add(shot);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return shots;\r\n\r\n  }\r\n\r\n  /**\r\n   * create a sub-sprite belonging to the current sprite\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Object} options an object of arguments\r\n   * @param {Animation} animation the animation to fire from the Sprite\r\n   * @param {number} speed the speed of the shot that is projected\r\n   * @param {Vector} position the initial position of the shot: defaults to current Sprite position\r\n   * @param {Vector} size the Vector size of the shot\r\n   * @param {Vector} offset the positional offset to apply\r\n   * @returns {Sprite} a Gamelab.Sprite object\r\n   **********/\r\n\r\n  subsprite(options, gw) {\r\n\r\n    gw = gw || Gamelab.game_windows[0];\r\n\r\n    let animation = options.animation || new Gamelab.Animation();\r\n\r\n    let position = options.position || new Gamelab.Vector(this.position);\r\n\r\n    let offset = options.offset || new Gamelab.Vector(0, 0, 0);\r\n\r\n    let size = new Gamelab.Vector(options.size || this.size);\r\n\r\n    if (Gamelab.isAtPlay) {\r\n\r\n      var subsprite = gw.add(new Gamelab.Sprite().FromData({\r\n\r\n        active: true,\r\n\r\n        position: position,\r\n\r\n        size: size,\r\n\r\n        offset: offset,\r\n\r\n        image: animation.image,\r\n\r\n        rotation: new Gamelab.Vector(0, 0, 0),\r\n\r\n        flipX: false,\r\n\r\n        scrollFactor: this.scrollFactor,\r\n\r\n        noScroll: this.noScroll\r\n\r\n      }));\r\n\r\n\r\n      subsprite.Animation(animation);\r\n\r\n      return subsprite;\r\n\r\n    } else {\r\n      alert('No subsprite when not at play');\r\n\r\n    }\r\n\r\n  }\r\n\r\n\r\n  /**\r\n   * switch to the next frame on sprite.selected_animation\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Animation} animation the optional animation to switch to before animate is called, defaults to the existing sprite.selected_animation\r\n   **********/\r\n\r\n  animate(animation) {\r\n\r\n    if (Gamelab.isAtPlay) {\r\n\r\n      if (animation) {\r\n        this.Animation(animation)\r\n      }\r\n\r\n      this.selected_animation.run();\r\n\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * run a function when the sprite.selected_animation is complete\r\n   *\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Function} fun the function to call when the animation is complete\r\n   *\r\n   **********/\r\n\r\n  onAnimationComplete(fun) {\r\n\r\n    this.selected_animation.onComplete(fun);\r\n\r\n  }\r\n\r\n  /*****************************\r\n   *  accelY\r\n   *  -accelerate on Y-Axis with 'accel' and 'max' (speed) arguments\r\n   *  -example-use: gravitation of sprite || up / down movement\r\n   ***************************/\r\n\r\n  /**\r\n   * accelerate speed on the y-axis\r\n   *\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {number} accel the increment of acceleration\r\n   * @param {number} max the maximum for speed\r\n   *\r\n   **********/\r\n\r\n  accelY(accel, max) {\r\n\r\n    accel = Math.abs(accel);\r\n\r\n    if (typeof(max) == 'number') {\r\n      max = {\r\n        y: max\r\n      };\r\n\r\n    }\r\n\r\n    this.assertSpeed();\r\n\r\n    let diff = max.y - this.speed.y;\r\n\r\n    if (diff > 0) {\r\n      this.speed.y += Math.abs(diff) >= accel ? accel : diff;\r\n\r\n    };\r\n\r\n    if (diff < 0) {\r\n      this.speed.y -= Math.abs(diff) >= accel ? accel : diff;\r\n\r\n    };\r\n\r\n  }\r\n\r\n  /*****************************\r\n   *  accelX\r\n   *  -accelerate on x-Axis\r\n   *  -example-use: running of sprite || left / right movement\r\n   ***************************/\r\n\r\n\r\n  /**\r\n   * accelerate speed on the x-Axis\r\n   *\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {number} accel the increment of acceleration\r\n   * @param {number} max the maximum for speed\r\n   *\r\n   **********/\r\n\r\n\r\n  accelX(accel, max) {\r\n\r\n    accel = Math.abs(accel);\r\n\r\n    if (typeof(max) == 'number') {\r\n      max = {\r\n        x: max\r\n      };\r\n\r\n    }\r\n\r\n    this.assertSpeed();\r\n\r\n    let diff = max.x - this.speed.x;\r\n\r\n    if (diff > 0) {\r\n      this.speed.x += Math.abs(diff) >= accel ? accel : diff;\r\n\r\n    };\r\n\r\n    if (diff < 0) {\r\n      this.speed.x -= Math.abs(diff) >= accel ? accel : diff;\r\n\r\n    };\r\n\r\n  }\r\n\r\n\r\n  /*****************************\r\n   *  accel\r\n   *  -accelerate any acceleration -key\r\n   ***************************/\r\n\r\n\r\n  /**\r\n   * decelerate speed on the x-Axis, toward zero\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {number} amt the increment of deceleration, negatives ignored\r\n   *\r\n   **********/\r\n\r\n  decelY(amt) {\r\n\r\n    amt = Math.abs(amt);\r\n\r\n    if (Math.abs(this.speed.y) <= amt) {\r\n      this.speed.y = 0;\r\n\r\n    } else if (this.speed.y > amt) {\r\n\r\n      this.speed.y -= amt;\r\n    } else if (this.speed.y < amt * -1) {\r\n\r\n      this.speed.y += amt;\r\n    }\r\n\r\n  }\r\n\r\n  /*****************************\r\n   *  decelX\r\n   *  -decelerate on the X axis\r\n   *  -args: 1 float:amt\r\n   ***************************/\r\n\r\n\r\n  /**\r\n   * decelerate speed on the x-Axis, toward zero\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {number} amt the increment of deceleration, negatives ignored\r\n   *\r\n   **********/\r\n\r\n  decelX(amt) {\r\n\r\n    amt = Math.abs(amt);\r\n\r\n\r\n    if (this.speed.x > amt) {\r\n\r\n      this.speed.x -= amt;\r\n    } else if (this.speed.x < amt * -1) {\r\n\r\n      this.speed.x += amt;\r\n    }\r\n\r\n    if (Math.abs(this.speed.x) <= amt) {\r\n\r\n      this.speed.x = 0;\r\n\r\n    }\r\n\r\n  }\r\n\r\n\r\n  /**\r\n   * accelerate toward a max value on any object-property\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Object} prop The object to control\r\n   * @param {string} key the target property-key for object argument\r\n   * @param {number} accel the additive increase to the property on each call\r\n   * @param {number} max the max value to accelerate towards\r\n   **********/\r\n\r\n  accel(object, key, accel, max) {\r\n\r\n    var prop = object;\r\n\r\n    accel = Math.abs(accel);\r\n\r\n    if (typeof(max) == 'number') {\r\n      max = {\r\n        x: max\r\n      };\r\n\r\n    }\r\n\r\n    let speed = prop[key];\r\n\r\n    // this.assertSpeed();\r\n\r\n    let diff = max.x - prop[key];\r\n\r\n    if (diff > 0) {\r\n      prop[key] += Math.abs(diff) >= accel ? accel : diff;\r\n\r\n    };\r\n\r\n    if (diff < 0) {\r\n      prop[key] -= Math.abs(diff) >= accel ? accel : diff;\r\n\r\n    };\r\n\r\n  }\r\n\r\n\r\n  /*****************************\r\n   *  decel\r\n   *  -deceleration -key\r\n   ***************************/\r\n\r\n  /**\r\n   * decelerate toward a max value on any object-property\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Object} prop the object to control\r\n   * @param {string} key the property-key for targeted property of prop argument\r\n   *\r\n   * @param {number} decel the increment of deceleration\r\n   *\r\n   * @param {number} max the max value to decelerate towards\r\n   *\r\n   *\r\n   **********/\r\n\r\n  decel(prop, key, rate) {\r\n\r\n    if (typeof(rate) == 'object') {\r\n\r\n      rate = rate.rate;\r\n\r\n    }\r\n\r\n    rate = Math.abs(rate);\r\n\r\n    if (Math.abs(prop[key]) <= rate) {\r\n      prop[key] = 0;\r\n    } else if (prop[key] > 0) {\r\n      prop[key] -= rate;\r\n\r\n    } else if (prop[key] < 0) {\r\n      prop[key] += rate;\r\n\r\n    } else {\r\n\r\n      prop[key] = 0;\r\n\r\n    }\r\n  }\r\n\r\n\r\n  seekPosition(target_Position, differential_SpeedMultiple) {\r\n    var target = {};\r\n\r\n    //always positive:\r\n    differential_SpeedMultiple = Math.abs(differential_SpeedMultiple);\r\n\r\n    if (target_Position.hasOwnProperty('position')) {\r\n      console.log('1st argument had its own position property. Using this property now:');\r\n      target = target_Position.position;\r\n    } else {\r\n      target = target_Position;\r\n    }\r\n\r\n    let diff = this.position.sub(target).mult(-1);\r\n\r\n    this.speed = diff.mult(differential_SpeedMultiple);\r\n  }\r\n\r\n  /*****************************\r\n   *  decelY\r\n   *  -decelerate on the Y axis\r\n   *  -args: 1 float:amt\r\n   ***************************/\r\n\r\n\r\n  /**\r\n   * A generic 'smooth motion', adds to position.x and position.y with smooth acceleration and deceleration\r\n   * --uses quadratic-easing of the TWEEN.js library\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {number} x The x to be added to Sprite().positon.x over the course of the SmoothMotion --use negative for subtractive motion\r\n   * @param {number} y The y to be added to Sprite().positon.y over the course of the SmoothMotion- -use negative for subtractive motion\r\n   * @param {number} duration the amount of time taken to complete this motion\r\n   *\r\n   **********/\r\n\r\n  SmoothMotion(x, y, duration) {\r\n    if (typeof(x) == 'object') //argument coercion: x is a vector, y is duration\r\n    {\r\n      duration = y;\r\n      y = x.y;\r\n      x = x.x;\r\n    }\r\n\r\n    x = x + this.position.x;\r\n\r\n    y = y + this.position.y;\r\n\r\n    if (!TWEEN instanceof Object) {\r\n      return console.error('TWEEN.js required for SmoothMotion();');\r\n    }\r\n\r\n    var t = new TWEEN.Tween(this.position)\r\n      .easing(TWEEN.Easing.Quadratic.InOut)\r\n\r\n      .to(new Gamelab.Vector(x, y), duration)\r\n      .onUpdate(function() {\r\n        //console.log(objects[0].position.x,objects[0].position.y);\r\n\r\n\r\n      })\r\n      .onComplete(function() {\r\n        //console.log(objects[0].position.x, objects[0].position.y);\r\n\r\n\r\n      });\r\n\r\n    t.start();\r\n\r\n  }\r\n\r\n  /**\r\n   * A generic 'smooth rotate', adds to rotation.x with smooth acceleration and deceleration\r\n   * --uses quadratic-easing of the TWEEN.js library\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {number} r The numeric value to be added to Sprite().rotation.x over the course of the SmoothRotate --use negative for subtractive rotation\r\n   * @param {number} duration the amount of time taken to complete this rotation\r\n   **********/\r\n\r\n  SmoothRotate(r, duration) {\r\n\r\n    if (!TWEEN instanceof Object) {\r\n      return console.error('TWEEN.js required for SmoothRotate();');\r\n    }\r\n\r\n    r = r + this.rotation.x;\r\n\r\n    var t = new TWEEN.Tween(this.rotation)\r\n      .easing(TWEEN.Easing.Quadratic.InOut)\r\n\r\n      .to(new Gamelab.Vector(r), duration)\r\n      .onUpdate(function() {\r\n        //console.log(objects[0].position.x,objects[0].position.y);\r\n\r\n\r\n      })\r\n      .onComplete(function() {\r\n        //console.log(objects[0].position.x, objects[0].position.y);\r\n\r\n\r\n      });\r\n    t.start();\r\n\r\n  }\r\n\r\n\r\n  /**\r\n   * get the vector-position at the center of the sprite, based on its current position and size\r\n   * @function\r\n   * @memberof Sprite\r\n   *\r\n   * @returns (Vector) a vector-position pinpointing the current-center of the sprite\r\n   *\r\n   **********/\r\n\r\n  center() {\r\n\r\n    return new Gamelab.Vector(this.position.x + this.size.x / 2, this.position.y + this.size.y / 2, 0);\r\n\r\n  }\r\n\r\n\r\n  /*****************************\r\n   *  System Use / Collision\r\n   ***************************/\r\n\r\n\r\n  /*****************************\r\n   * @ignore\r\n   ***************************/\r\n\r\n  shortest_stop(item, callback) {\r\n\r\n    var diff_min_y = item.min ? item.min.y : Math.abs(item.position.y - this.position.y + this.size.y);\r\n\r\n    var diff_min_x = item.min ? item.min.x : Math.abs(item.position.x - this.position.x + this.size.x);\r\n\r\n    var diff_max_y = item.max ? item.max.y : Math.abs(item.position.y + item.size.y - this.position.y);\r\n\r\n    var diff_max_x = item.max ? item.max.x : Math.abs(item.position.x + item.size.x - this.position.y);\r\n\r\n    var dimens = {\r\n      top: diff_min_y,\r\n      left: diff_min_x,\r\n      bottom: diff_max_y,\r\n      right: diff_max_x\r\n    };\r\n\r\n    var minkey = \"\",\r\n      min = 10000000;\r\n\r\n    for (var x in dimens) {\r\n      if (dimens[x] < min) {\r\n        min = dimens[x];\r\n        minkey = x; // a key of top left bottom or right\r\n\r\n      }\r\n    }\r\n\r\n    callback(minkey);\r\n\r\n  }\r\n\r\n\r\n  /*************\r\n   * #BE CAREFUL\r\n   * -with this function :: change sensitive / tricky / 4 way collision\r\n   * *************/\r\n\r\n\r\n  /**\r\n   * determine if sprite overlaps on x-axis with another sprite\r\n   *\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Sprite} item the Sprite to compare with\r\n   * @param {number} padding the 0-1.0 float value of padding to use on self when testing overlap\r\n   * @returns {boolean} a true || false var showing if overlap has occured\r\n   *\r\n   **********/\r\n\r\n  overlap_x(item, padding) {\r\n    if (!padding) {\r\n      padding = 0;\r\n    }\r\n\r\n    var paddingX = Math.round(padding * this.size.x),\r\n\r\n      paddingY = Math.round(padding * this.size.y),\r\n      left = this.position.x + paddingX,\r\n      right = this.position.x + this.size.x - paddingX,\r\n\r\n      top = this.position.y + paddingY,\r\n      bottom = this.position.y + this.size.y - paddingY;\r\n\r\n    return right > item.position.x && left < item.position.x + item.size.x;\r\n\r\n\r\n  }\r\n\r\n  /*************\r\n   * #BE CAREFUL\r\n   * -with this function :: change sensitive / tricky / 4 way collision\r\n   * *************/\r\n\r\n\r\n  /**\r\n   * determine if sprite overlaps on y-axis with another sprite\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Sprite} item the Sprite to compare with\r\n   * @param {number} padding the 0-1.0 float value of padding to use on self when testing overlap\r\n   * @returns {boolean} a true || false var showing if overlap has occured\r\n   *\r\n   **********/\r\n\r\n  overlap_y(item, padding) {\r\n    if (!padding) {\r\n      padding = 0;\r\n    }\r\n\r\n    var paddingX = Math.round(padding * this.size.x),\r\n\r\n      paddingY = Math.round(padding * this.size.y),\r\n      left = this.position.x + paddingX,\r\n      right = this.position.x + this.size.x - paddingX,\r\n\r\n      top = this.position.y + paddingY,\r\n      bottom = this.position.y + this.size.y - paddingY;\r\n\r\n    return bottom > item.position.y && top < item.position.y + item.size.y;\r\n\r\n  }\r\n\r\n\r\n  /*************\r\n   * #BE CAREFUL\r\n   * -with this function :: change sensitive / tricky / 4 way collision\r\n   * *************/\r\n\r\n\r\n  /**\r\n   * stop collision on x-axis with another sprite\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Sprite} item the Sprite with which to collide-stop on the x-axis\r\n   **********/\r\n\r\n  collide_stop_x(item) {\r\n\r\n    var apart = false;\r\n\r\n    var ct = 10000;\r\n\r\n    while (!apart && ct > 0) {\r\n\r\n      ct--;\r\n\r\n      var diffX = this.center().sub(item.center()).x;\r\n\r\n      var distX = Math.abs(this.size.x / 2 + item.size.x / 2 - Math.round(this.size.x * this.padding.x));\r\n\r\n      if (Math.abs(diffX) < distX) {\r\n\r\n        this.position.x -= diffX > 0 ? -1 : 1;\r\n\r\n\r\n      } else {\r\n\r\n        this.speed.x = 0;\r\n\r\n        apart = true;\r\n\r\n\r\n      }\r\n\r\n\r\n    }\r\n\r\n\r\n  }\r\n\r\n\r\n  /*************\r\n   * #BE CAREFUL\r\n   * -with this function :: change sensitive / tricky / 4 way collision\r\n   * *************/\r\n\r\n\r\n  /**\r\n   * Trigger a fourway collision-stop between this and another Sprite ::\r\n   * objects will behave clastically and resist passing through one-another\r\n   *\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Sprite} item the Sprite to collide with\r\n   *\r\n   **********/\r\n\r\n  collide_stop(item) {\r\n\r\n    if (this.id == item.id) {\r\n      return false;\r\n\r\n    }\r\n\r\n    this.speed = this.speed || new Gamelab.Vector(0, 0, 0);\r\n\r\n    this.padding = this.padding || new Gamelab.Vector(0, 0, 0);\r\n\r\n    // this.position = this.position.sub(this.speed);\r\n\r\n    if (this.hasBoxCollision(item)) {\r\n\r\n      var diff = this.center().sub(item.center());\r\n\r\n      if (this.overlap_x(item, this.padding.x + 0.1) && Math.abs(diff.x) < Math.abs(diff.y)) {\r\n\r\n        var apart = false;\r\n\r\n        var ct = 10000;\r\n\r\n        while (!apart && ct > 0) {\r\n\r\n          ct--;\r\n\r\n          var diffY = this.center().sub(item.center()).y;\r\n\r\n          var distY = Math.abs(this.size.y / 2 + item.size.y / 2 - Math.round(this.size.y * this.padding.y));\r\n\r\n          if (Math.abs(diffY) < distY) {\r\n\r\n            this.position.y -= diffY > 0 ? -1 : diffY < 0 ? 1 : 0;\r\n\r\n            this.position.y = Math.round(this.position.y);\r\n\r\n          } else {\r\n\r\n            if (diffY <= 0) {\r\n              this.__inAir = false;\r\n            };\r\n\r\n            this.speed.y = 0;\r\n\r\n            return apart = true;\r\n\r\n\r\n          }\r\n\r\n\r\n        }\r\n\r\n\r\n      }\r\n\r\n\r\n      if (this.overlap_y(item, this.padding.y) && Math.abs(diff.y) < Math.abs(diff.x)) {\r\n\r\n        this.collide_stop_x(item);\r\n\r\n      }\r\n\r\n\r\n    }\r\n\r\n\r\n  }\r\n\r\n  /**\r\n   * collide-stop only from the top (of the sprite passed as argument) ::\r\n   *\r\n   * @function\r\n   * @memberof Sprite\r\n   * @param {Sprite} item the Sprite to collide with\r\n   *\r\n   **********/\r\n\r\n  collide_stop_top(item, callback) {\r\n\r\n\r\n    if (this.id == item.id) {\r\n      return false;\r\n\r\n    }\r\n\r\n    if (this.overlap_x(item, this.padding.x + 0.1)) {\r\n\r\n      console.log('OVERLAP_X');\r\n\r\n      var paddingY = this.padding.y * this.size.y;\r\n\r\n      if (this.position.y + this.size.y - paddingY <= item.position.y) {\r\n\r\n        this.groundMaxY = item.position.y - this.size.y + paddingY;\r\n\r\n      }\r\n\r\n\r\n    }\r\n\r\n  }\r\n\r\n\r\n  /**\r\n   * restore a sprite from existing json-data --applies to data-persistence\r\n   *\r\n   * @function\r\n   * @memberof Sprite\r\n   *\r\n   * @returns (Sprite)\r\n   **********/\r\n\r\n  restoreFrom(data) {\r\n    data.image = new GameImage(data.src || data.image.src);\r\n\r\n    return new Gamelab.Sprite(data);\r\n\r\n  }\r\n\r\n\r\n  /*****************************\r\n   * @ignore\r\n   * #IN-TESTING\r\n   *  fromFile(file_path)\r\n   *  -TODO : complete this function based on code to load Sprite() from file, located in the spritemaker.html file\r\n   *  -TODO: test this function\r\n   ***************************/\r\n\r\n  fromFile(file_path) {\r\n\r\n    if (typeof file_path == 'string') {\r\n\r\n      var __inst = this;\r\n\r\n      $.getJSON(file_path, function(data) {\r\n\r\n        __inst = new Gamelab.Sprite(data);\r\n\r\n      });\r\n    }\r\n  }\r\n\r\n  /*****************************\r\n   * return a decycled json-string for the sprite --without circular references\r\n   * @returns {string} a json string\r\n   ***************************/\r\n\r\n  toJSONString() {\r\n    return jstr(JSON.decycle(this));\r\n  }\r\n\r\n};\r\n\r\nGamelab.Sprite = Sprite;\r\n;\r\n\r\nclass Text {\r\n\r\n  constructor(value){\r\n    this.Text(value);\r\n\r\n    this.FontSize(15);\r\n    this.FontFamily('Arial');\r\n\r\n    this.color = 'white';\r\n\r\n    this.position = new Gamelab.Vector(0, 0);\r\n  }\r\n\r\n  Font(fsize, ffamily){\r\n    this.FontSize(fsize);\r\n    this.FontFamily(ffamily)\r\n    return this;\r\n  }\r\n\r\n  FontSize(value){\r\n    if(typeof value !== 'string')\r\n    value = value + '';\r\n\r\n    value = value.replace('px', '') + 'px';\r\n\r\n    this.fontSize = value;\r\n    return this;\r\n  }\r\n  FontFamily(value)\r\n  {\r\n    this.fontFamily = value;\r\n    return this;\r\n  }\r\n\r\n\r\n    getOffsetPos(pos){\r\n      var offset = this.window_offset || new Gamelab.Vector(0, 0);\r\n      return pos.add(offset);\r\n    }\r\n\r\n  draw(ctx, camera){\r\n\r\n    var x = this.position.x + camera.position.x,\r\n     y = this.position.y + camera.position.y;\r\n\r\n     if(ctx.save)\r\n     {\r\n    ctx.save();\r\n    }\r\n    \r\n    ctx.fillStyle = this.color;\r\n\r\n    ctx.font = this.fontSize + ' ' + this.fontFamily;\r\n\r\n    var pos = new Gamelab.Vector(x, y),\r\n    realPos = this.getOffsetPos(pos);\r\n\r\n    ctx.fillText(this.text, realPos.x, realPos.y);\r\n\r\n    ctx.restore();\r\n\r\n  }\r\n}\r\n\r\n\r\nGamelab.Text = Text;\r\n;/****************************\r\n * Robotix\r\n ***************************/\r\n\r\n//Appendage:: one stack of objects which behave as single appendage:\r\n//--a chain of links or an arm or leg made of separate parts\r\nclass Appendage {\r\n\r\n  constructor() {\r\n\r\n  }\r\n\r\n}\r\n\r\n//Single part which exists along with its parent object\r\nclass Attachment {\r\n  constructor(){\r\n\r\n\r\n  }\r\n}\r\n;/**\n * Creates a GravityForce instance.\n *\n *@param   {Object} args the object of arguments\n * @param   {string} args.name optional\n * @param   {string} args.description optional\n * @param   {Array} args.subjects the subjects to be pulled by the GravityForce\n * @param   {Array} args.clasticObjects any clastic object or array-of-objects that should have collision-stop behavior with subjects\n * @param   {Vector} args.max the max speed of the gravity-force, similar to concept of 'terminal velocity'\n * @param   {number} args.accel the increment of acceleration for each update called, while subjects are falling\n *\n * @returns {GravityForce} a GravityForce object\n */\n\n(function () {\n    console.log('Force class... creating');\n\n    class GravityForce {\n        constructor(args = {}) {\n            this.name = args.name || \"\";\n\n            this.description = args.description || \"\";\n\n            this.subjects = args.subjects || [];\n\n            this.clasticObjects = args.clasticObjects || [];\n\n            this.topClastics = args.topClastics || [];\n\n            this.max = args.max || new Vector3(3, 3, 3);\n            this.accel = args.accel || new Vector3(1.3, 1.3, 1.3);\n\n\n            for (var x in this.clasticObjects) {\n                if (!this.clasticObjects[x] instanceof Gamelab.Sprite) {\n                    this.clasticObjects[x] = Gamelab.getById(this.clasticObjects[x].id);\n                }\n\n            }\n\n\n            for (var x in this.topClastics) {\n                if (!this.topClastics[x] instanceof Gamelab.Sprite) {\n                    this.topClastics[x] = Gamelab.getById(this.topClastics[x].id);\n                }\n\n            }\n\n\n            for (var x in this.subjects) {\n                if (!this.subjects[x] instanceof Gamelab.Sprite) {\n                    this.subjects[x] = Gamelab.getById(this.subjects[x].id);\n                }\n\n            }\n\n        }\n\n        getArg(args, key, fallback) {\n\n            if (args.hasOwnProperty(key)) {\n                return args[key];\n            }\n            else {\n                return fallback;\n\n            }\n        }\n\n\n        /**\n         * Updates position for all objects effected by this instance.\n         * @memberof GravityForce\n         */\n\n        update() {\n\n            var subjects = this.subjects;\n\n            var clasticObjects = this.clasticObjects;\n\n            var topClastics = this.topClastics;\n\n            var accel = this.accel || {};\n\n            var max = this.max || {};\n\n            Gamelab.each(subjects, function (ix, itemx) {\n\n                if(!itemx.jumping && !itemx.flying)\n                itemx.accelY(accel, max);\n\n                itemx.__inAir = true;\n\n\n                if (itemx.position.y >= itemx.groundMaxY) {\n\n\n                    itemx.position.y = itemx.groundMaxY;\n\n                }\n\n                itemx.groundMaxY = 3000000; //some crazy number you'll never reach in-game\n\n                Gamelab.each(topClastics, function (iy, itemy) {\n\n                //    itemx.collide_stop_top(itemy);\n\n                });\n\n            });\n        }\n    };\n\n    let Force = GravityForce;\n\n    Gamelab.Force = Force;\n\n    Gamelab.GForce = Force;\n\n    Gamelab.GravityForce = GravityForce;\n\n})();\n;;/**\r\n * Creates a new BoneSprite.\r\n *\r\n * <info-bit>Gamelab.BoneSprite is a container for 2D Animations.\r\n * -apply Sprite class to create a 2D game-object.\r\n *\r\n * BoneSprites are a group of moving animations.</info-bit>\r\n * <iframe style='width:400px; height:450px; overflow:hidden;' src='../client/examples/js-class/Sprite.html'> </iframe>\r\n\r\n * @param   {string} src the srcPath for the image of the Sprite\r\n * @param   {number} scale=1.0 the scale to be applied to size of each animation-frame\r\n *\r\n * @returns {Sprite} a Gamelab.BoneSprite object\r\n */\r\n\r\nclass BoneSprite extends Sprite {\r\n  constructor(src = {}, scale = 1.0) {\r\n    super(src, scale);\r\n    this.bones = [];\r\n  }\r\n  addBone(oncreate){\r\n    var bone = new Bone(this, this.size);\r\n    oncreate.bind(bone).call();\r\n  }\r\n  draw_current_frame(ctx, camera){\r\n\r\n    var sprite = this;\r\n    var frameList = [];\r\n    if (sprite.active) {\r\n\r\n      if(sprite.selected_animation instanceof Array && sprite.selected_animation.length >= 1)\r\n      {\r\n        sprite.selected_animation.forEach(function(anime){\r\n\r\n           frameList.push(anime.selected_frame);\r\n\r\n        });\r\n      }\r\n\r\n      var origin = sprite.origin || new Gamelab.Vector(0, 0);\r\n      var rotation = sprite.rotation.x;\r\n\r\n              if(frameList.length >= 1)\r\n              {\r\n\r\n                 frameList.forEach(function(frame){\r\n\r\n                   var realWidth = frame.size.x;\r\n                   var realHeight = frame.size.y;\r\n\r\n                   var x = frame.position.x, y = frame.position.y;\r\n\r\n                   if(frame.rotation && frame.rotation.x)\r\n                   {\r\n                     rotation = frame.rotation.x;\r\n                   }\r\n\r\n                   if(frame.origin)\r\n                   {\r\n                     origin = frame.origin;\r\n                       console.log('drawing with origin:' + origin.x + ':' + origin.y);\r\n                   }\r\n\r\n                   if(frame && frame.image)\r\n                   Gamelab.Canvas.draw_image_frame(frame.image.domElement, frame.framePos, frame.frameSize, new Gamelab.Vector2D(Math.round(x + (realWidth / 2)), Math.round(y + (realHeight / 2))), new Gamelab.Vector2D(realWidth, realHeight), rotation % 360, ctx, sprite.flipX, sprite.flipY, origin);\r\n\r\n                 });\r\n\r\n              }\r\n\r\n      }\r\n\r\n  }\r\n};\r\n\r\nGamelab.BoneSprite = BoneSprite;\r\n;;class Player extends Sprite\r\n{\r\n  constructor()\r\n  {\r\n      super(...arguments);\r\n  }\r\n\r\n  OnInput(inputDevice, arg1, arg2, callback)\r\n  {\r\n    console.info('Player.OnInput: Feature not implemented');\r\n  }\r\n\r\n}\r\n\r\n\r\nGamelab.Player = Player;\r\n;\n\n\n/**\n * Creates an instance of Shot.\n * <info-bit>Shot object fires a moving-animation from a sprite </info-bit>\n *\n * @param   {string} name the name of this Shot\n * @param   {GameImage | Animation} imageOrAnimation the GameImage or Animation to apply for this Shot\n * @returns {Shot} a Gamelab.Shot object\n */\n\nclass Shot\n{\n    constructor(name, imageOrAnimation)\n    {\n        this.name = name || 'No-Name';\n\n        if(imageOrAnimation instanceof Gamelab.GameImage)\n        {\n            this.anime = new Animation(imageOrAnimation);\n        }\n        else if(imageOrAnimation instanceof Gamelab.Animation)\n        {\n            this.anime = imageOrAnimation;\n\n        }\n\n        this.rotation = 0;\n\n        this.rot_disp = 0;\n\n\n        var args = name instanceof Object ? name : {};\n\n        //is name / first arg an entire instance of shot?\n\n        this.init(args);\n\n    }\n\n    init(args)\n    {\n        if(args instanceof Object) {\n\n            for (var x in args) {\n\n                this[x] = args[x];\n\n                if(args[x] instanceof Object && args[x].hasOwnProperty('x'))//process as Vector\n                {\n                    this[x] = new Vector(args[x]);\n                }\n\n            }\n\n        }\n    }\n\n    Image(image)\n    {\n\n        this.anime = new Animation(image);\n\n    }\n\n    Animation(anime)\n    {\n        this.anime = anime;\n        return this;\n    }\n\n    Total(total, rot_disp_per_unit)\n    {\n\n        this.total =total;\n\n        this.rot_disp = rot_disp_per_unit;\n\n        return this;\n\n    }\n\n    WaveGrowth(growth)\n    {\n        if(growth > 0)\n            this.curve_growth = growth;\n    }\n\n    CurveMode(key, size, growth)\n    {\n        this.curve = Gamelab.Curves.InOut[key.toLowerCase()];\n\n        this.curve_key = key.toLowerCase();\n\n        this.curve_size = size;\n\n        if(growth > 0)\n        this.curve_growth = growth;\n\n        if(typeof(this.curve_size)=='number')\n            this.curve_size = new Gamelab.Vector(this.curve_size, this.curve_size);\n\n        return this;\n\n    }\n\n    RotDisp( rot_disp)\n    {\n        this.rot_disp = rot_disp;\n\n        return this;\n    }\n\n    Velocity(v)\n    {\n        this.velocity = v;\n\n        return this;\n    }\n\n\n    onCollide(collideables, callback)\n    {\n\n\n    }\n\n}\n\n\nGamelab.Shot = Shot;\n;class Background extends Gamelab.Sprite {\n\n    constructor(arg1={}, arg2={}) {\n\n        super(arg1, arg2);\n\n        let args = typeof(arg1) == 'object' ? arg1 : {};\n\n        this.type = args.type || \"parallax\" || \"basic\" || false;\n\n        this.source_objects = args.objects || args.source_objects || [];\n\n        this.members = [];\n\n        this.rows = args.rows || 1;//The Y number of repititions\n\n        this.cols = args.cols || 1; //The X number of repetitions of the images\n\n        this.flip = args.flip || false;\n\n        this.fill = args.fill || false;\n\n        this.flip = args.flip || false;\n\n    }\n\n    Flip(value)\n    {\n        if(value == undefined)\n        {\n            this.flip = true;\n        }\n        else if (value == true || value == false) {\n            this.flip = value;\n\n        }\n\n        return this;\n    }\n\n    Rows(r)\n    {\n        this.rows = r;\n        return this;\n    }\n\n    Cols(c)\n    {\n        this.cols = c;\n        return this;\n    }\n\n    Fill(approxRows, approxCols, gw)\n    {\n\n\n        approxRows = approxRows || this.rows || 1;\n\n        approxCols = approxCols || this.cols || 1;\n\n        this.members.push(new Background(this)); //\"This\" or base image is always applied\n\n        for(var x = 0; x < this.source_objects.length; x++)\n        {\n            this.members.push(new Background(this.source_objects[x]));//src strings OR Sprites()\n        }\n\n        gw = gw || Gamelab.game_windows[0];\n\n        var w= gw.canvas.width, h = gw.canvas.height,\n            xBacksTotal = Math.floor(approxRows / 2), yBacksTotal =  Math.floor(approxCols / 2);\n\n        var __inst = this;\n\n        //create first row:\n\n        for(var y = -yBacksTotal; y <= yBacksTotal + 1; y++)\n        {\n            console.log('adding background:' + y);\n\n\n            for(var x = -xBacksTotal; x <= xBacksTotal + 1; x++)\n            {\n\n                this.members.push(new Background(this));\n\n                var b = this.members[this.members.length - 1];\n\n                b.setSize(this.size);\n\n                var __inst = this;\n\n\n                b.position.x = x * this.size.x;\n\n                b.position.y = y * this.size.y;\n\n\n\n                b.minX = -xBacksTotal * b.size.x + b.size.x;\n\n                b.maxX = (xBacksTotal + 1) * b.size.x ;\n\n                b.minY = -yBacksTotal * b.size.y + b.size.y;\n\n                b.maxY = yBacksTotal * b.size.y ;\n\n\n                if(x % 2 == 0)\n                {\n                    b.flipX = true;\n\n                }\n\n                if(y % 2 == 0)\n                {\n                    b.flipY = true;\n\n                }\n\n\n\n                b.onUpdate(function(spr){\n\n                    spr.campos = gw.camera.position;\n\n                    var cx = spr.campos.x - (spr.campos.x  % spr.size.x), cy = spr.campos.y - ( spr.campos.y % spr.size.y );\n\n                    if(spr.position.x - cx < spr.minX)\n                    {\n\n                        spr.position.x = spr.maxX + cx;\n\n                    }\n\n                    if(spr.position.x - cx > spr.maxX)\n                    {\n\n                        spr.position.x = spr.minX + cx;\n\n                    }\n\n                    if(spr.position.y - cy < spr.minY)\n                    {\n\n                        spr.position.y = spr.maxY + cy;\n\n                    }\n\n                    if(spr.position.y - cy > spr.maxY)\n                    {\n\n                        spr.position.y = spr.minY + cy;\n\n                    }\n\n                });\n\n                gw.add(b); //add to window\n\n            }\n\n        }\n\n        return this;\n    }\n\n    add(object)\n    {\n        var cleanCheck = object instanceof Gamelab.Sprite || object instanceof Array && object[0] instanceof Gamelab.Sprite; //is Sprite\n\n        if(!cleanCheck)\n        {\n            return console.error('Must have: valid contents (Gamelab.Sprite OR [] of Gamelab.Sprite())');\n        }\n\n        if(object instanceof Array)\n        {\n            this.source_objects.cancat(object)\n        }\n        else\n        {\n            this.source_objects.push(object);\n        }\n\n        return this;\n    }\n\n}\n\nGamelab.Background = Background;;\r\n//Author: Jordan E. Blake\r\n\r\n\r\nclass Effect {\r\n  constructor() {\r\n\r\n\r\n  }\r\n\r\n  isAnimation() {\r\n\r\n\r\n  }\r\n\r\n  isParticleEffect() {\r\n\r\n\r\n  }\r\n\r\n  isSoundEffect() {\r\n\r\n\r\n  }\r\n\r\n  commit() {\r\n\r\n\r\n  }\r\n\r\n}\r\n\r\nclass SpriteMove {\r\n  constructor(args = {}) {\r\n    this.line = 100;\r\n\r\n    this.timeLimit = 350;\r\n\r\n    this.degreesRotated = 90;\r\n  }\r\n\r\n\r\n  setAnimation() {\r\n\r\n\r\n  }\r\n\r\n\r\n\r\n  setAnimationForward() //set the basic animation OR 'forward anime'\r\n  {\r\n\r\n\r\n  }\r\n\r\n  setAnimationBackard() //set the backward animation OR 'backward-anime'\r\n  {\r\n\r\n\r\n  }\r\n\r\n\r\n  setLineBack() //set the 'backward movement', should the Sprite need to return from the move\r\n  {\r\n\r\n\r\n  }\r\n\r\n\r\n  setLine() //set the basic line OR 'forward movement'\r\n  {\r\n\r\n\r\n\r\n  }\r\n\r\n\r\n  setLineForward() //set the basic line OR 'forward movement'\r\n  {\r\n\r\n\r\n  }\r\n\r\n  setLineBack() //set the 'backward movement', should the Sprite need to return from the move\r\n  {\r\n\r\n\r\n  }\r\n\r\n  setImmediateEffects() //Effects triggered when the SpriteMove starts\r\n  {\r\n\r\n  }\r\n\r\n  setAfterEffects() //Effects triggered when the SpriteMove completes\r\n  {\r\n\r\n  }\r\n\r\n\r\n  commit() {\r\n\r\n\r\n\r\n  }\r\n\r\n  then() {\r\n\r\n\r\n  }\r\n}\r\n\r\nclass Jump {\r\n  constructor(spriteMove) {\r\n\r\n  }\r\n\r\n  setAnimation() {\r\n\r\n\r\n  }\r\n\r\n  setTimeLimit() {\r\n\r\n\r\n  }\r\n\r\n  setUpward(distance, duration) {\r\n\r\n\r\n  }\r\n\r\n  setDownward(distance, duration) {\r\n\r\n\r\n  }\r\n\r\n  commit() {\r\n\r\n\r\n\r\n  }\r\n}\r\n\r\nclass Vault {\r\n  constructor(forward, back, afterEffects) {\r\n\r\n\r\n  }\r\n\r\n  commit() {\r\n\r\n\r\n  }\r\n\r\n\r\n  setForwardMove(line, curve, duration) {\r\n\r\n\r\n  }\r\n\r\n\r\n  setBackwardMove(line, curve, duration) {\r\n\r\n\r\n  }\r\n\r\n\r\n  onForwardDone(psuedoEffect) {\r\n\r\n\r\n  }\r\n  onBackwardDone(psuedoEffect) {\r\n\r\n\r\n  }\r\n}\r\n\r\n\r\nclass Attack {\r\n  constructor(spriteMove, rpsLevel, powerLevel, afterEffects) {\r\n\r\n\r\n  }\r\n\r\n  commit() {\r\n\r\n\r\n  }\r\n\r\n  setAfterEffects(afterEffects) {\r\n\r\n\r\n\r\n  }\r\n\r\n  setRpsLevel(rpsLevel) {\r\n\r\n\r\n  }\r\n\r\n  setPowerLevel(pLevel) {\r\n\r\n\r\n  }\r\n\r\n}\r\n;/**\n * Takes an object of arguments and returns Projectile() object. Projectile fires a shot from the parent sprite, with specified offset, rotation, motion_curve, line_curve\n\n * @param   {Object} args object of arguments\n * @param   {string} args.name optional\n * @param   {string} args.description optional\n * @param   {string} args.distance the distance before dissappearance\n * @param   {TWEEN.Easing.'objectGroup'.'objectMember'} args.motion_curve the TWEEN.Easing function to be applied for motion/speed (Example: TWEEN.Easing.Quadratic.InOut)\n *\n *  * @param   {TWEEN.Easing.'objectGroup'.'objectMember'} args.line_curve the TWEEN.Easing function to be applied for line (Example: TWEEN.Easing.Quadratic.InOut)\n *\n * @returns {Projectile} a Projectile object\n */\n\nclass Projectile {\n\n    constructor(args = {}) {\n\n        this.getArg = $Q.getArg;\n\n        for (var x in args) {\n            this[x] = args[x];\n\n        }\n\n        this.name = args.name || \"__\";\n\n        this.description = args.description || \"__\";\n\n        this.animation = Gamelab.getArg(args, 'animation', new Animation());\n\n        this.parent_id = args.parent_id || args.object_id || \"__blank\"; //The parent object\n\n        this.name = Gamelab.getArg(args, 'name', \"__\");\n\n        this.size = false;\n\n        if(args.size)\n        {\n            this.size = new Vector(args.size);\n        }\n        else if(this.animation && this.animation.frameSize)\n        {\n           this.size =  new Vector(this.animation.frameSize);\n\n        }\n        else\n        {\n            console.info('Projectile():using default size.');\n            this.size = new Vector(20, 20, 20);\n        }\n\n        this.origin = args.origin || new Vector(0, 0, 0);\n\n        this.rotation = args.rotation || 0;\n\n        this.line.Rotation(this.rotation);\n\n        this.description = Gamelab.getArg(args, 'description', false);\n\n        this.duration = Gamelab.getArg(args, 'duration', 500);\n\n        this.delay = Gamelab.getArg(args, 'delay', 0);\n\n        this.position = Gamelab.getArg(args, 'position', new Vector(0, 0, 0));\n\n        this.motion_curve = Gamelab.getArg(args, 'motion_curve', TWEEN.Easing.Linear.None);\n\n        this.highlighted = false;\n\n        this.sprites = [];\n\n        this.run_ext = args.run_ext || [];\n\n    }\n\n    /**\n     * specify a function to be called when Motion is complete\n     *\n     * @function\n     * @memberof Projectile\n     * @param {Function} fun the function to be called when complete\n     *\n     **********/\n\n    onComplete(fun) {\n        this.complete = fun;\n\n    }\n\n    onCollide(fun) {\n        this.collide = fun;\n\n    }\n\n    setAnimation(anime) {\n\n        this.animation = anime;\n\n        return this;\n\n    }\n\n    setMotionCurve(c) {\n\n        this.motion_curve = c;\n\n        return this;\n\n    }\n\n    kill_one() {\n\n        var spr = this.sprites[this.sprites.length - 1];\n\n        Gamelab.remove(spr);\n\n    }\n\n    onRun(caller, callkey) {\n\n        this.run_ext = this.run_ext || [];\n\n        this.run_ext.push({caller: caller, callkey: callkey});\n\n    }\n\n    shoot_basic(position, size, rot_offset, speed, numberShots, disp){\n\n        var __playerInst = this;\n\n        var bx = position.x, by = position.y, bw = size.x, bh = size.y;\n\n        var half = numberShots / 2;\n\n        for(var x = half * -1; x <= half; x++) {\n            var shot = Gamelab.add(new Sprite({\n\n                active: true,\n\n                position: position,\n\n                size: size,\n\n                speed: speed,\n\n                image: animation.image,\n\n                rotation: new Vector3(0, 0, 0),\n\n                flipX: false\n\n            }));\n\n            shot.setAnimation(animation);\n\n            rot_offset = new Vector(rot_offset + (x * disp), 0, 0);\n\n            shot.position.x = bx, shot.position.y = by;\n            shot.rotation.x = 0 + rot_offset.x;\n\n            shot.stats = {\n\n                damage: 1\n\n            };\n\n            if (!options.line) {\n\n                shot.onUpdate(function () {\n\n                    shot.position.x += Math.cos((shot.rotation.x) * 3.14 / 180) * speed;\n\n                    shot.position.y += Math.sin((shot.rotation.x) * 3.14 / 180) * speed;\n\n                });\n\n\n            }\n\n\n        }\n\n    }\n\n\n    fire(origin, rotation) {\n\n        for (var x = 0; x < this.run_ext.length; x++) {\n\n            this.run_ext[x].caller[this.run_ext[x].callkey]();\n\n        }\n\n\n        this.line.origin = origin;\n\n        this.line.rotation = rotation;\n\n        console.log('FIRING FROM:' + jstr(origin));\n\n        var sprite = new Sprite({image: this.animation.image});\n\n        sprite.setAnimation(this.animation);\n\n        sprite.setSize(this.size);\n\n        sprite.position = new Vector(0, 0, 0);\n\n        var __inst = this;\n\n        __inst.line.fill();\n\n        var lp = this.line.points;\n\n        sprite.position = new Vector(lp[0]);\n\n        sprite.onUpdate(function (sprite) {\n\n            for (var x = 0; x < lp.length; x++) {\n\n                if (sprite.position.equals(lp[x]) && x < lp.length - 1) {\n\n                    sprite.position = new Vector(lp[x + 1]);\n\n                    break;\n                }\n\n                if (x == lp.length - 1) {\n                    Gamelab.remove(sprite);\n\n                }\n\n            }\n\n        });\n\n        Gamelab.add(sprite);\n\n        this.sprites.push(sprite);\n\n    }\n\n}\n\n\nGamelab.Projectile = Projectile;;\n\n\n(function(){\n    console.log('Terrain class... creating');\n\nclass Terrain extends Gamelab.Sprite\n{\n    constructor(args={})\n    {\n        super(args); //init as Gamelab.Sprite()\n\n        this.collideables = args.collideables || args.colliders || [];\n\n    }\n\n    Collideables(c)\n    {\n        this.collideables = c || [];\n\n        if(!this.collideables instanceof Array)\n        {\n            return console.error('Must pass array for \"c\" argument');\n\n        }\n\n        return this;\n    }\n    onCollide(callback) // Gamelab.Terrain instance should have an onCollide() function\n    {\n\n      this.collideables.forEach(function(sprite){\n\n        if(sprite.onUpdate)\n        {\n\n          sprite.onUpdate(function(){\n\n            \n\n          });\n\n        }\n\n      });\n\n    }\n\n}\n\n\n    Gamelab.Terrain= Terrain;\n\n})();\n;\n\n\n(function(){\n    console.log('Interactive class... creating');\n\n    class Interactive extends Gamelab.Sprite {\n        constructor(args = {}) {\n            super(args); //init as Gamelab.Sprite()\n\n            this.collision_settings = new Gamelab.CollisionSettings(args);\n\n            this.collideables = args.collideables || [];\n\n            Gamelab.Extendors.collideable(this, args); //overwrites the onCollide():\n\n        }\n\n        Collideables(c)\n        {\n            this.collideables = c || [];\n\n            if(!this.collideables instanceof Array)\n            {\n                return console.error('Must pass array for \"c\" argument');\n\n            }\n\n            return this;\n        }\n\n        onCollide() // Gamelab.Interactive instance should have an onCollide() function\n        {\n\n        }\n\n    }\n\n\nGamelab.Interactive = Interactive;\n\n\n})();;class SpriteArray {\r\n\r\n  constructor() {\r\n\r\n    this.sprites = [];\r\n\r\n    this.update = [];\r\n\r\n    this.moves = {};\r\n\r\n    this.load = function() {};\r\n\r\n    this.update = function() {};\r\n\r\n  }\r\n\r\n  each(f) {\r\n\r\n    var ix = 0;\r\n\r\n    this.sprites.forEach(function(spr) {\r\n\r\n      f(ix, spr);\r\n\r\n      ix += 1;\r\n\r\n    });\r\n\r\n  }\r\n\r\n  add(sprite) {\r\n    this.sprites.push(sprite);\r\n    return this;\r\n  }\r\n\r\n\r\n  /**\r\n   * runs a function when the sprite's image has loaded\r\n   *\r\n   * @function\r\n   * @params {Function} f the function to be called on load\r\n   * @memberof Sprite\r\n   **********/\r\n\r\n  onLoadSprites(f) {\r\n\r\n    var sprites = this.sprites,\r\n      len = this.sprites.length,\r\n      ix = 0;\r\n\r\n    var __spriteList = this;\r\n\r\n    __spriteList.load = f.bind(this);\r\n\r\n    sprites.forEach(function(spr) {\r\n\r\n      spr.onLoad(function() {\r\n\r\n        ix += 1;\r\n\r\n        if (ix == len) {\r\n          __spriteList.load(__spriteList.sprites);\r\n        }\r\n\r\n      });\r\n\r\n    });\r\n\r\n  }\r\n\r\n}\r\n\r\nGamelab.SpriteArray = SpriteArray;\r\n\r\n\r\nclass SpriteVerticalChain extends SpriteArray {\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  add(sprite) {\r\n\r\n    sprite.parent = this.sprites.length >= 1 ? this.sprites[this.sprites.length - 1] : false;\r\n\r\n    sprite.onUpdate(function() {\r\n\r\n      this.origin = this.origin || new Gamelab.Vector(this.size.x / 2, 0);\r\n\r\n      if (this.parent) {\r\n\r\n\r\n        this.offset = this.offset || new Gamelab.Vector(0, 0);\r\n\r\n\r\n        var extremity = new Gamelab.Vector(0, this.parent.size.y);\r\n\r\n        var p = this.parent.position.add(this.parent.origin);\r\n\r\n        //  p = p.sub(this.origin);\r\n\r\n        //  p = p.add(parent.origin);\r\n\r\n        var np = new Gamelab.Vector(Gamelab.GeoMath.rotatePointsXY(extremity.x, extremity.y, this.parent.rotation.x));\r\n\r\n        this.position = p.add(np).add(this.offset);\r\n\r\n      }\r\n\r\n\r\n    });\r\n\r\n    this.sprites.push(sprite);\r\n\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\nGamelab.SpriteVerticalChain = SpriteVerticalChain;\r\n;\r\n\r\n\r\nclass SpriteCollider {\r\n\r\n    constructor(){\r\n\r\n    }\r\n\r\n    PixelUnit(){\r\n\r\n    }\r\n\r\n    Box(){\r\n\r\n    }\r\n\r\n    Eliptical(){\r\n\r\n    }\r\n\r\n    TestMode(){\r\n\r\n      \r\n    }\r\n\r\n}\r\n;class FeatureSymbol {\r\n  constructor(key) {\r\n    this.key = key || \"@NONE\";\r\n    this.symbol = Symbol(key);\r\n  }\r\n}\r\n\r\nGamelab.FeatureSymbol = FeatureSymbol;\r\n\r\nGamelab.FeatureInjectors = Gamelab.FeatureInjectors || {};\r\n\r\nGamelab.FeatureInject = function(constructor, args) {\r\n\r\n  //console.log('Gamelab.FeatureInject()');\r\n\r\n  var GClassFeatures = {};\r\n\r\n\r\n  for (var y in Gamelab.ObjectFeatureMap) {\r\n\r\n    if (Gamelab[y] && typeof Gamelab[y] == 'function') {\r\n\r\n      var constructor = Gamelab[y];\r\n\r\n      GClassFeatures[y] = {};\r\n\r\n      //  console.log('Feature Symbol-key:' + Gamelab.ObjectFeatureMap[x][y]);\r\n\r\n      GClassFeatures[y].featureSymbols = GClassFeatures[y].featureSymbols || [];\r\n\r\n      for (var z in Gamelab.ObjectFeatureMap[y]) {\r\n\r\n        GClassFeatures[y].featureSymbols.push(new Gamelab.FeatureSymbol(Gamelab.ObjectFeatureMap[y][z]));\r\n\r\n        GClassFeatures[y].featureSymbols.hasKey = function(key) {\r\n\r\n          for (var x = 0; x < this.length; x++) {\r\n            if (typeof this[x].key !== 'string')\r\n              continue;\r\n\r\n            if (this[x].key.indexOf('@') == -1)\r\n              console.error('feature-keys must contain @');\r\n\r\n            //  console.log('eval key:' + this[x].key.split('@')[1]);\r\n\r\n            if (this[x].key.split('@')[1] == key)\r\n              return true;\r\n          }\r\n\r\n          return false;\r\n        };\r\n\r\n        GClassFeatures[y].featureSymbols.hasSymbol = function(symbol) {\r\n          for (var x in this) {\r\n            if (this[x].symbol == symbol)\r\n              return true;\r\n          }\r\n\r\n          return false;\r\n        };\r\n\r\n        //  console.info('adding feature-symbol:' + Gamelab.ObjectFeatureMap[x][y]);\r\n      }\r\n    } else {\r\n      console.error('Gamelab.ObjectFeatureMap: member by name of ' + x + ' does not exist as member of Gamelab');\r\n    }\r\n  }\r\n\r\n\r\n  console.info('FEATURES:', GClassFeatures);\r\n\r\n\r\n  for (var x in Gamelab.FeatureInjectors) {\r\n\r\n    //  console.log(Gamelab.FeatureInjectors[x]);\r\n\r\n    var props = Larva.getProtoFuncs(Gamelab.FeatureInjectors[x]);\r\n\r\n    for (var y = 0; y < props.length; y++) {\r\n\r\n      console.log(x + \":\" + props[y]);\r\n\r\n      for (var z in GClassFeatures)\r\n        if (GClassFeatures[z] && GClassFeatures[z].featureSymbols.hasKey(props[y])) {\r\n\r\n\r\n          Gamelab.FeatureInjectors[x][props[y]](Gamelab[z].prototype, args);\r\n\r\n        }\r\n    }\r\n  }\r\n\r\n};\r\n\r\n\r\nclass CssFeatures {\r\n\r\n  colored(obj){\r\n    obj.Color = function(c)\r\n    {\r\n      this.color = c;\r\n      return this;\r\n    }\r\n  }\r\n\r\n  color_transition(min_color, max_color){\r\n    this.min_color = min_color;\r\n    this.max_color = max_color;\r\n    return this;\r\n  }\r\n\r\n  text(obj){\r\n    obj.Text = function(value)\r\n    {\r\n      this.text = value;\r\n      return this;\r\n    }\r\n  }\r\n\r\n  opaque(obj){\r\n    obj.Opacity = function(o){\r\n      this.opacity = o;\r\n      return this;\r\n    }\r\n  }\r\n};\r\n\r\n\r\nclass DataFunctions {\r\n\r\n  data(obj){\r\n\r\n    obj.Name = function(n) {\r\n      this.name = n;\r\n      return this;\r\n    };\r\n\r\n    obj.Description = function(d){\r\n      this.description = d;\r\n      return this;\r\n    };\r\n\r\n    obj.Context = function(c) {\r\n      this.context = c;\r\n      return this;\r\n    };\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n/***************************\r\nGeometryFeatures:\r\n  A functional dependency injector\r\n  injects properties and functions according to Symbols\r\n**************************/\r\nclass VectorFunctions {\r\n  constructor() {\r\n\r\n    this.name = 'VectorFunctionals';\r\n\r\n  }\r\n\r\n  collideable(obj) {\r\n    obj.collision_callback = function() {};\r\n    obj.onCollide = args.onCollide || function(collideables, callback) {\r\n      if (typeof(collideables) == 'function') {\r\n        callback = collideables;\r\n      }\r\n      this.collision_callback = callback || function() {};\r\n    };\r\n  }\r\n\r\n  spatial(obj) {\r\n\r\n    obj.Size = function(x, y, z) {\r\n\r\n      if (typeof(x) == 'object')\r\n        this.size = new Gamelab.Vector(x);\r\n\r\n      else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n        this.size = new Gamelab.Vector(x, y, z);\r\n\r\n      else //use x accross the vector\r\n        this.size = new Gamelab.Vector(x, x, x);\r\n\r\n      return this;\r\n    };\r\n\r\n    obj.Pos = function(x, y, z) {\r\n\r\n      if (typeof(x) == 'object')\r\n        this.position = new Gamelab.Vector(x);\r\n\r\n      else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n        this.position = new Gamelab.Vector(x, y, z);\r\n\r\n      else //use x accross the vector\r\n        this.position = new Gamelab.Vector(x, x, x);\r\n\r\n      return this;\r\n    };\r\n\r\n    obj.Rot = function(x, y, z) {\r\n\r\n      if (typeof(x) == 'object')\r\n        this.rotation = new Gamelab.Vector(x);\r\n\r\n      else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n        this.rotation = new Gamelab.Vector(x, y, z);\r\n\r\n      else //use x accross the vector\r\n        this.rotation = new Gamelab.Vector(x, x, x);\r\n\r\n      return this;\r\n    };\r\n\r\n    obj.Position = obj.Pos;\r\n\r\n    obj.Rotate = obj.Rot;\r\n\r\n    obj.Rotation = obj.Rot;\r\n\r\n  }\r\n\r\n  posable(obj) {\r\n\r\n    obj.Pos = function(x, y, z) {\r\n\r\n      if (typeof(x) == 'object')\r\n        this.position = new Gamelab.Vector(x);\r\n\r\n      else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n        this.position = new Gamelab.Vector(x, y, z);\r\n\r\n      else //use x accross the vector\r\n        this.position = new Gamelab.Vector(x, x, x);\r\n\r\n      return this;\r\n    };\r\n\r\n    obj.Position = obj.Pos;\r\n\r\n  }\r\n\r\n  sizeable(obj) {\r\n\r\n    obj.Size = function(x, y, z) {\r\n\r\n      if (typeof(x) == 'object')\r\n        this.size = new Gamelab.Vector(x);\r\n\r\n      else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n        this.size = new Gamelab.Vector(x, y, z);\r\n\r\n      else //use x accross the vector\r\n        this.size = new Gamelab.Vector(x, x, x);\r\n\r\n      return this;\r\n    };\r\n\r\n    obj.Position = obj.Pos;\r\n\r\n  }\r\n\r\n  rotable(obj) {\r\n    obj.Rot = function(x, y, z) {\r\n\r\n      if (typeof(x) == 'object')\r\n        this.rotation = new Gamelab.Vector(x);\r\n\r\n      else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n        this.rotation = new Gamelab.Vector(x, y, z);\r\n\r\n      else //use x accross the vector\r\n        this.rotation = new Gamelab.Vector(x, x, x);\r\n\r\n      if (typeof this.Transpose == 'function') {\r\n        this.Transpose();\r\n      }\r\n\r\n      return this;\r\n    };\r\n\r\n    obj.Rotate = obj.Rot;\r\n\r\n    obj.Rotation = obj.Rot;\r\n\r\n  }\r\n\r\n  minable(obj) {\r\n    obj.Min = function(x, y, z) {\r\n\r\n      if (typeof(x) == 'object')\r\n        this.min = new Gamelab.Vector(x);\r\n\r\n      else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n        this.min = new Gamelab.Vector(x, y, z);\r\n\r\n      else //use x accross the vector\r\n        this.min = new Gamelab.Vector(x, x, x);\r\n\r\n      return this;\r\n    };\r\n\r\n    obj.Minimum = obj.Min;\r\n\r\n  }\r\n\r\n  maxable(obj) {\r\n    obj.Max = function(x, y, z) {\r\n\r\n      if (typeof(x) == 'object')\r\n        this.max = new Gamelab.Vector(x);\r\n\r\n      else if (!isNaN(x) && !isNaN(y)) //has minimum of numeric x and y\r\n        this.max = new Gamelab.Vector(x, y, z);\r\n\r\n      else //use x accross the vector\r\n        this.max = new Gamelab.Vector(x, x, x);\r\n\r\n      return this;\r\n    };\r\n\r\n    obj.Maximum = obj.Max;\r\n\r\n  }\r\n\r\n  boundable(obj) {\r\n    this.minable(obj);\r\n\r\n    this.maxable(obj);\r\n  }\r\n\r\n  selftransposable(obj) {\r\n    //apply the transposition\r\n    obj.Transpose = function(rotation, position) {\r\n\r\n      this.rotation = new Gamelab.Vector(rotation || this.rotation);\r\n\r\n      this.position = new Gamelab.Vector(position || this.position);\r\n\r\n      //TODO: Modify this trig function and its call below to an optional 3D rotation\r\n\r\n      for (var x = 0; x < this.points.length; x++) {\r\n\r\n        var p = this.points[x];\r\n\r\n        var np = Gamelab.Trig.rotate_from_xy(0, 0, p.x, p.y, this.rotation.x);\r\n\r\n        this.points[x] = this.position.add(np);\r\n\r\n      }\r\n      return this;\r\n    };\r\n\r\n  }\r\n\r\n  pointarrayflippable(obj) {\r\n    //apply the transposition\r\n    obj.FlipX = function() {\r\n\r\n      var middle = Math.floor(this.points.length / 2); //account for FlipX with length of --odd number\r\n\r\n      var x, y;\r\n\r\n      for (x = this.points.length - 1, y = 0; x > middle, y < middle; x--, y++) {\r\n\r\n        var p1 = this.points[x],\r\n          p2 = this.points[y];\r\n\r\n        [p1.x, p2.x] = [p2.x, p1.x];\r\n\r\n      }\r\n\r\n      return this;\r\n    };\r\n\r\n\r\n    //apply the transposition\r\n    obj.FlipY = function() {\r\n\r\n      var middle = Math.floor(this.points.length / 2); //account for FlipX with length of --odd number\r\n\r\n      var x, y;\r\n\r\n      for (x = this.points.length - 1, y = 0; x > middle, y < middle; x--, y++) {\r\n\r\n        var p1 = this.points[x],\r\n          p2 = this.points[y];\r\n\r\n        [p1.y, p2.y] = [p2.y, p1.y];\r\n\r\n      }\r\n\r\n      return this;\r\n    };\r\n\r\n  }\r\n\r\n  informable(obj, args) {\r\n    obj.name = Gamelab.getArg(args, 'name', \"__ObjectName\");\r\n\r\n    obj.description = Gamelab.getArg(args, 'description', false);\r\n\r\n    obj.group = Gamelab.getArg(args, 'group', 'one');\r\n  }\r\n\r\n  tweenable(obj) {\r\n\r\n    obj.curve_string = obj.curve_string || \"linearNone\";\r\n\r\n    obj.setTweenCurve = function(c) {\r\n\r\n      c = c || \"linear_none\";\r\n\r\n      var cps = c.split('_');\r\n\r\n      //alert(cps);\r\n\r\n      var s1 = cps[0].toLowerCase(),\r\n        s2 = cps[1].toLowerCase();\r\n\r\n      var curve = TWEEN.Easing.Linear.None;\r\n\r\n      obj.curve_string = 'linear_none'\r\n\r\n      Gamelab.each(TWEEN.Easing, function(ix, easing) {\r\n\r\n        Gamelab.each(TWEEN.Easing[ix], function(iy, easeType) {\r\n\r\n          if (ix == s1 && iy == s2) {\r\n\r\n            // alert('setting curve');\r\n\r\n            curve = TWEEN.Easing[ix][iy];\r\n\r\n            obj.curve_string = ix + '_' + iy;\r\n\r\n          }\r\n\r\n        });\r\n\r\n      });\r\n\r\n      obj.curve = curve;\r\n\r\n      return curve;\r\n\r\n    };\r\n\r\n    obj.curvesToArray = function() {\r\n\r\n      var c = [];\r\n\r\n      Gamelab.each(TWEEN.Easing, function(ix, easing) {\r\n\r\n        Gamelab.each(easing, function(iy, easeType) {\r\n\r\n          if (['in', 'out', 'inout', 'none'].indexOf(iy.toLowerCase()) >= 0) {\r\n\r\n            c.push(ix + \"_\" + iy);\r\n\r\n          }\r\n\r\n        });\r\n\r\n      });\r\n\r\n      return c;\r\n\r\n    }\r\n  }\r\n\r\n};\r\n\r\nGamelab.FeatureInjectors.CssFeatures = new CssFeatures();\r\n\r\nGamelab.FeatureInjectors.VectorFunctions = new VectorFunctions();\r\n\r\nGamelab.FeatureInjectors.DataFunctions = new DataFunctions();\r\n;let Larva = {\r\n\r\n  DEV:false,\r\n\r\n  //Display message in console\r\n  info: function(arg1, arg2) {\r\n\r\n    if(!this.DEV)\r\n    return;\r\n\r\n    console.info(arg1, arg2);\r\n\r\n  },\r\n\r\n  log:function(arg1, arg2){\r\n\r\n    if(!this.DEV)\r\n    return;\r\n\r\n      console.log(arg1, arg2);\r\n\r\n  },\r\n\r\n  /* ERRORS always show */\r\n  error:function(arg1, arg2){\r\n\r\n    if(!this.DEV)\r\n    return;\r\n\r\n      console.error(arg1, arg2);\r\n\r\n  },\r\n\r\n\r\n  warn:function(arg1, arg2){\r\n\r\n    if(!this.DEV)\r\n    return;\r\n\r\n      console.error(arg1, arg2);\r\n\r\n  },\r\n\r\n  //obj is number or becomes fallback\r\n  number: function(number, fallback = 0) {\r\n\r\n    number = typeof(number) == 'number' ? number : fallback;\r\n\r\n  },\r\n\r\n  //obj is string or becomes fallback\r\n  string: function(string, fallback) {\r\n\r\n    string = typeof(string) == 'string' ? string : fallback;\r\n\r\n  },\r\n\r\n  //obj is Array or becomes wrapped in [] as [obj]\r\n  arrayWrap: function(obj) {\r\n    if (obj instanceof Array)\r\n      return obj;\r\n    else\r\n      return [obj];\r\n  },\r\n\r\n  //obj or array-of-objects are ALL truthy (return=true) or not (return=false)\r\n  allDefined: function(obj_all) {\r\n\r\n    var list = this.arrayWrap(obj_all);\r\n\r\n    var failed = false;\r\n\r\n    for (var x in list) {\r\n      if (!list[x]) {\r\n        failed = true;\r\n        console.error('Failed to define @ Larva.Define()');\r\n      }\r\n    };\r\n\r\n    return !failed;\r\n  },\r\n\r\n  //getPreferredPropertyByKey(): uses the property[key] if present, if not returns same property passed in\r\n  getPreferredPropertyByKey:function(property, key, warning){\r\n\r\n    if(property.hasOwnProperty(key))\r\n    {\r\n      this.warn(warning);\r\n      return property[key];\r\n    }\r\n\r\n    else {\r\n      return property;\r\n    }\r\n  },\r\n\r\n  //obj's are all of type or return false\r\n  psuedoTypeCheck: function(obj, psuedotype = [], throwing = false) //obj is type or is encapsulated into type\r\n  {\r\n    var list = this.arrayWrap(obj);\r\n\r\n    for (var x in list) {\r\n      if (typeof(list[x]) !== psuedotype && !(list[x] instanceof psuedotype)) {\r\n        if (!throwing)\r\n          return console.error(error);\r\n        else\r\n          throw new console.error(error);\r\n      }\r\n    }\r\n\r\n    return true;\r\n  },\r\n\r\n  getAllFuncs: function(obj) {\r\n\r\n    return Object.getOwnPropertyNames(obj).filter(function (p) {\r\n        return typeof obj[p] === 'function';\r\n    });\r\n\r\n  },\r\n\r\n  getProtoFuncs: function(obj) {\r\n\r\n    return Object.getOwnPropertyNames(obj.__proto__).filter(function (p) {\r\n        return typeof obj[p] === 'function';\r\n    });\r\n\r\n  },\r\n\r\n  truthOrDie:function(list, exitMessage) //All members of Array are truthy or the program exits with Error()\r\n  {\r\n    function findError(obj, error) {\r\n      return obj || new Error(error)\r\n    };\r\n\r\n    for (var x in list) {\r\n\r\n        let e = findError(list[x], exitMessage);\r\n\r\n        if (e instanceof Error) {\r\n            console.Error(e);\r\n        }\r\n      };\r\n  },\r\n\r\n  truthyPropsPerArray: function(obj, propKeys, kill) {\r\n\r\n    var list = this.arrayWrap(obj),\r\n      keys = this.arrayWrap(propKeys);\r\n\r\n    let error = \"The required truthy property has non-truthy value.\";\r\n\r\n    function findError(obj, prop) {\r\n      return obj[prop] || new Error(error)\r\n    };\r\n\r\n    var failed = false;\r\n\r\n    for (var x in list) {\r\n      for (var y in keys) {\r\n        let e = findError(list[x], keys[y]);\r\n        if (e instanceof Error) {\r\n          failed = true;\r\n          if (kill)\r\n            throw e;\r\n          else\r\n            console.error(e);\r\n        }\r\n      }\r\n    }\r\n\r\n    return !failed;\r\n  },\r\n\r\n  typeArgsExtract: function(obj, type) //obj is type or is each-converted into type\r\n  {\r\n    if (obj instanceof type) {\r\n      return obj;\r\n    } else {\r\n      obj = [obj];\r\n    }\r\n    return obj;\r\n  },\r\n\r\n  typeOrHalt: function(obj, type) //obj is type or error is thrown\r\n  {\r\n    if (obj instanceof type) {\r\n      return obj;\r\n    } else {\r\n      throw new Error('object not of required type');\r\n      console.info(obj);\r\n      console.info(type + \"?\");\r\n    }\r\n    return obj;\r\n  },\r\n\r\n  typeOrError: function(obj, type) //obj is type or error is logged, execution continues\r\n  {\r\n    if (obj instanceof type) {\r\n      return obj;\r\n    } else {\r\n      console.log(new Error('object not of required type'));\r\n      console.info(obj);\r\n      console.info(type + \"?\");\r\n    }\r\n    return obj;\r\n  },\r\n\r\n  check:function(object, propKey, propValue)\r\n  {\r\n    if(!object[propKey])\r\n    {\r\n       object[propKey] = propValue;\r\n    }\r\n  }\r\n};\r\n;let Logger = {\r\n\r\n        options: {\r\n\r\n            error: true,\r\n\r\n            info: true,\r\n\r\n            warning: true\r\n\r\n        },\r\n\r\n        log: function (message) {\r\n\r\n\r\n        },\r\n\r\n        interlog: function (message, loopDuration) {\r\n\r\n\r\n        },\r\n\r\n        info: function (message) {\r\n\r\n\r\n        },\r\n\r\n        warning: function (message) {\r\n\r\n\r\n        },\r\n\r\n        error: function (message) {\r\n\r\n\r\n        }\r\n    }\r\n;\r\n\r\n\r\nlet E = function(msg, halt){ //basic Error\r\n    console.error(msg);\r\n};\r\n\r\nlet L = function(str1, str2){\r\n    console.log(str1, str2);\r\n};\r\n\r\nlet I = function(str1, str2){\r\n    console.info(str1, str2);\r\n};\r\n\r\nlet R = function(obj, callback){\r\n    for(var x in obj)\r\n    {\r\n        callback(obj[x]);\r\n    }\r\n\r\n  };\r\n;/*\n=========================================================================\n   JSManipulate v1.0 (2011-08-01)\n\nJavascript image filter & effect library\n\nDeveloped by Joel Besada (http://www.joelb.me)\nDemo page: http://www.joelb.me/jsmanipulate\n\nMIT LICENSED (http://www.opensource.org/licenses/mit-license.php)\nCopyright (c) 2011, Joel Besada\n=========================================================================\n*/\n\n\n/**\n * Contains common filter functions.\n */\nfunction FilterUtils(){\n\tthis.HSVtoRGB = function (h, s, v){\n\t\tvar r, g, b;\n\t\tvar i = Math.floor(h * 6);\n\t\tvar f = h * 6 - i;\n\t\tvar p = v * (1 - s);\n\t\tvar q = v * (1 - f * s);\n\t\tvar t = v * (1 - (1 - f) * s);\n\t\tswitch(i % 6){\n\t\t\tcase 0: r = v; g = t; b = p; break;\n\t\t\tcase 1: r = q; g = v; b = p; break;\n\t\t\tcase 2: r = p; g = v; b = t; break;\n\t\t\tcase 3: r = p; g = q; b = v; break;\n\t\t\tcase 4: r = t; g = p; b = v; break;\n\t\t\tcase 5: r = v; g = p; b = q; break;\n\t\t\tdefault: break;\n\t\t}\n\t\treturn [r * 255, g * 255, b * 255];\n\t};\n\tthis.RGBtoHSV = function (r, g, b){\n\t\tr = r/255; g = g/255; b = b/255;\n\t\tvar max = Math.max(r, g, b);\n\t\tvar min = Math.min(r, g, b);\n\t\tvar h, s, v = max;\n\t\tvar d = max - min;\n\t\ts = max === 0 ? 0 : d / max;\n\t\tif(max === min){\n\t\t\th = 0;\n\t\t}else{\n\t\t\tswitch(max){\n\t\t\t\tcase r: h = (g - b) / d + (g < b ? 6 : 0); break;\n\t\t\t\tcase g: h = (b - r) / d + 2; break;\n\t\t\t\tcase b: h = (r - g) / d + 4; break;\n\t\t\t\tdefault: break;\n\t\t\t}\n\t\t\th /= 6;\n\t\t}\n\t\treturn [h, s, v];\n\t};\n\tthis.getPixel = function (pixels,x,y,width,height){\n\t\tvar pix = (y*width + x)*4;\n\t\tif (x < 0 || x >= width || y < 0 || y >= height) {\n\t\t\treturn [pixels[((this.clampPixel(y, 0, height-1) * width) + this.clampPixel(x, 0, width-1))*4],\n\t\t\tpixels[((this.clampPixel(y, 0, height-1) * width) + this.clampPixel(x, 0, width-1))*4 + 1],\n\t\t\tpixels[((this.clampPixel(y, 0, height-1) * width) + this.clampPixel(x, 0, width-1))*4 + 2],\n\t\t\tpixels[((this.clampPixel(y, 0, height-1) * width) + this.clampPixel(x, 0, width-1))*4 + 3]];\n\t\t}\n\t\treturn [pixels[pix],pixels[pix+1],pixels[pix+2],pixels[pix+3]];\n\t};\n\tvar haveNextGaussian = false;\n\tvar nextGaussian;\n\tthis.gaussianRandom = function(){\n\t\tif(haveNextGaussian){\n\t\t\thaveNextGaussian = false;\n\t\t\treturn nextGaussian;\n\t\t} else {\n\t\t\tvar v1, v2, s;\n\t\t\tdo {\n\t\t\t\tv1 = 2 * Math.random() - 1;\n\t\t\t\tv2 = 2 * Math.random() - 1;\n\t\t\t\ts = v1 * v1 + v2 * v2;\n\t\t\t} while (s >= 1 || s === 0);\n\t\t\tvar mult = Math.sqrt(-2 * Math.log(s)/s);\n\t\t\tnextGaussian = v2 * mult;\n\t\t\thaveNextGaussian = true;\n\t\t\treturn v1 * mult;\n\t\t}\n\t};\n\tthis.clampPixel = function (x,a,b){\n\t\treturn (x < a) ? a : (x > b) ? b : x;\n\t};\n\tthis.triangle = function(x){\n\t\tvar r = this.mod(x, 1);\n\t\treturn 2*(r < 0.5 ? r : 1-r);\n\t};\n\tthis.mod = function(a,b){\n\t\tvar n = parseInt(a/b,10);\n\t\ta -= n*b;\n\t\tif(a < 0){\n\t\t\treturn a + b;\n\t\t}\n\t\treturn a;\n\t};\n\tthis.mixColors = function(t, rgb1, rgb2){\n\t\tvar r = this.linearInterpolate(t,rgb1[0],rgb2[0]);\n\t\tvar g = this.linearInterpolate(t,rgb1[1],rgb2[1]);\n\t\tvar b = this.linearInterpolate(t,rgb1[2],rgb2[2]);\n\t\tvar a = this.linearInterpolate(t,rgb1[3],rgb2[3]);\n\t\treturn [r,g,b,a];\n\t};\n\n\tthis.linearInterpolate = function(t,a,b){\n\t\treturn a + t * (b-a);\n\t};\n\tthis.bilinearInterpolate = function (x,y,nw,ne,sw,se){\n\t\tvar m0, m1;\n\t\tvar r0 = nw[0]; var g0 = nw[1]; var b0 = nw[2]; var a0 = nw[3];\n\t\tvar r1 = ne[0]; var g1 = ne[1]; var b1 = ne[2]; var a1 = ne[3];\n\t\tvar r2 = sw[0]; var g2 = sw[1]; var b2 = sw[2]; var a2 = sw[3];\n\t\tvar r3 = se[0]; var g3 = se[1]; var b3 = se[2]; var a3 = se[3];\n\t\tvar cx = 1.0 - x; var cy = 1.0 - y;\n\n\t\tm0 = cx * a0 + x * a1;\n\t\tm1 = cx * a2 + x * a3;\n\t\tvar a = cy * m0 + y * m1;\n\n\t\tm0 = cx * r0 + x * r1;\n\t\tm1 = cx * r2 + x * r3;\n\t\tvar r = cy * m0 + y * m1;\n\n\t\tm0 = cx * g0 + x * g1;\n\t\tm1 = cx * g2 + x * g3;\n\t\tvar g = cy * m0 + y * m1;\n\n\t\tm0 = cx * b0 + x * b1;\n\t\tm1 = cx * b2 + x * b3;\n\t\tvar b =cy * m0 + y * m1;\n\t\treturn [r,g,b,a];\n\t};\n\tthis.tableFilter = function (inputData, table, width, height){\n\t\tfor (var y = 0; y < height; y++) {\n\t\t\tfor (var x = 0; x < width; x++) {\n\t\t\t\tvar pixel = (y*width + x)*4;\n\t\t\t\tfor(var i = 0; i < 3; i++){\n\t\t\t\t\tinputData[pixel+i] = table[inputData[pixel+i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\tthis.convolveFilter = function(inputData, matrix, width, height){\n\t\tvar outputData = [];\n\t\tvar rows, cols;\n\t\trows = cols = Math.sqrt(matrix.length);\n\t\tvar rows2 = parseInt(rows/2,10);\n\t\tvar cols2 = parseInt(cols/2,10);\n\t\tvar trace = true;\n\t\tfor(var y = 0; y < height; y++){\n\t\t\tfor (var x = 0; x < width; x++){\n\t\t\t\tvar pixel = (y*width + x)*4;\n\t\t\t\tvar r = 0, g = 0, b = 0;\n\t\t\t\tfor(var row = -rows2; row <= rows2; row++){\n\t\t\t\t\tvar iy = y+row;\n\t\t\t\t\tvar ioffset;\n\t\t\t\t\tif (0 <= iy && iy < height) {\n\t\t\t\t\t\tioffset = iy*width;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tioffset = y*width;\n\t\t\t\t\t}\n\t\t\t\t\tvar moffset = cols*(row+rows2)+cols2;\n\t\t\t\t\tfor (var col = -cols2; col <= cols2; col++) {\n\t\t\t\t\t\tvar f = matrix[moffset+col];\n\t\t\t\t\t\tif (f !== 0) {\n\t\t\t\t\t\t\tvar ix = x+col;\n\t\t\t\t\t\t\tif (!(0 <= ix && ix < width)) {\n\t\t\t\t\t\t\t\tix = x;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar iPixel = (ioffset+ix)*4;\n\t\t\t\t\t\t\tr += f * inputData[iPixel];\n\t\t\t\t\t\t\tg += f * inputData[iPixel+1];\n\t\t\t\t\t\t\tb += f * inputData[iPixel+2];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\toutputData[pixel] = parseInt(r+0.5,10);\n\t\t\t\toutputData[pixel+1] = parseInt(g+0.5,10);\n\t\t\t\toutputData[pixel+2] = parseInt(b+0.5,10);\n\t\t\t\toutputData[pixel+3] = inputData[pixel+3];\n\t\t\t}\n\t\t}\n\t\tfor(var k = 0; k < outputData.length; k++){\n\t\t\tinputData[k] = outputData[k];\n\t\t}\n\t};\n\tthis.transformFilter = function(inputData, transformInverse, width, height){\n\t\tvar out = [];\n\t\tvar outputData = [];\n\t\tfor(var j = 0; j < inputData.length; j++){\n\t\t\toutputData[j] = inputData[j];\n\t\t}\n\t\tfor(var y = 0; y < height; y++){\n\t\t\tfor (var x = 0; x < width; x++){\n\t\t\t\tvar pixel = (y*width + x)*4;\n\t\t\t\ttransformInverse.apply(this,[x,y,out]);\n\t\t\t\tvar srcX = Math.floor(out[0]);\n\t\t\t\tvar srcY = Math.floor(out[1]);\n\t\t\t\tvar xWeight = out[0]-srcX;\n\t\t\t\tvar yWeight = out[1]-srcY;\n\t\t\t\tvar nw,ne,sw,se;\n\t\t\t\tif(srcX >= 0 && srcX < width-1 && srcY >= 0 && srcY < height-1){\n\t\t\t\t\tvar i = (width*srcY + srcX)*4;\n\t\t\t\t\tnw = [inputData[i],inputData[i+1],inputData[i+2],inputData[i+3]];\n\t\t\t\t\tne = [inputData[i+4],inputData[i+5],inputData[i+6],inputData[i+7]];\n\t\t\t\t\tsw = [inputData[i+width*4],inputData[i+width*4+1],inputData[i+width*4+2],inputData[i+width*4+3]];\n\t\t\t\t\tse = [inputData[i+(width + 1)*4],inputData[i+(width + 1)*4+1],inputData[i+(width + 1)*4+2],inputData[i+(width + 1)*4+3]];\n\t\t\t\t} else {\n\t\t\t\t\tnw = this.getPixel( inputData, srcX, srcY, width, height );\n\t\t\t\t\tne = this.getPixel( inputData, srcX+1, srcY, width, height );\n\t\t\t\t\tsw = this.getPixel( inputData, srcX, srcY+1, width, height );\n\t\t\t\t\tse = this.getPixel( inputData, srcX+1, srcY+1, width, height );\n\t\t\t\t}\n\t\t\t\tvar rgba = this.bilinearInterpolate(xWeight,yWeight,nw,ne,sw,se);\n\t\t\t\toutputData[pixel] = rgba[0];\n\t\t\t\toutputData[pixel + 1] = rgba[1];\n\t\t\t\toutputData[pixel + 2] = rgba[2];\n\t\t\t\toutputData[pixel + 3] = rgba[3];\n\t\t\t}\n\t\t}\n\t\tfor(var k = 0; k < outputData.length; k++){\n\t\t\tinputData[k] = outputData[k];\n\t\t}\n\t};\n}\n/**\n * Blurs the image with Gaussian blur.\n */\nfunction BlurFilter(){\n\tthis.name = \"Blur\";\n\tthis.isDirAnimatable = false;\n\tthis.defaultValues = {\n\t\tamount : 3\n\t};\n\tthis.valueRanges = {\n\t\tamount : {min:0, max:10}\n\t};\n\tthis.filter = function(input,values){\n\t\tvar width = input.width;\n\t\tvar width4 = width << 2;\n\t\tvar height = input.height;\n\t\tvar inputData = input.data;\n\t\tvar q;\n\t\tvar amount = values.amount;\n\t\tif (amount < 0.0) {\n\t\t\tamount = 0.0;\n\t\t}\n\t\tif (amount >= 2.5) {\n\t\t\tq = 0.98711 * amount - 0.96330;\n\t\t} else if (amount >= 0.5) {\n\t\t\tq = 3.97156 - 4.14554 * Math.sqrt(1.0 - 0.26891 * amount);\n\t\t} else {\n\t\t\tq = 2 * amount * (3.97156 - 4.14554 * Math.sqrt(1.0 - 0.26891 * 0.5));\n\t\t}\n\t\tvar qq = q * q;\n\t\tvar qqq = qq * q;\n\t\tvar b0 = 1.57825 + (2.44413 * q) + (1.4281 * qq ) + (0.422205 * qqq);\n\t\tvar b1 = ((2.44413 * q) + (2.85619 * qq) + (1.26661 * qqq)) / b0;\n\t\tvar b2 = (-((1.4281 * qq) + (1.26661 * qqq))) / b0;\n\t\tvar b3 = (0.422205 * qqq) / b0;\n\t\tvar bigB = 1.0 - (b1 + b2 + b3);\n\t\tvar c = 0;\n\t\tvar index;\n\t\tvar indexLast;\n\t\tvar pixel;\n\t\tvar ppixel;\n\t\tvar pppixel;\n\t\tvar ppppixel;\n\t\tfor (c = 0; c < 3; c++) {\n\t\t\tfor (var y = 0; y < height; y++) {\n\t\t\t\tindex = y * width4 + c;\n\t\t\t\tindexLast = y * width4 + ((width - 1) << 2) + c;\n\t\t\t\tpixel = inputData[index];\n\t\t\t\tppixel = pixel;\n\t\t\t\tpppixel = ppixel;\n\t\t\t\tppppixel = pppixel;\n\t\t\t\tfor (; index <= indexLast; index += 4) {\n\t\t\t\t\tpixel = bigB * inputData[index] + b1 * ppixel + b2 * pppixel + b3 * ppppixel;\n\t\t\t\t\tinputData[index] = pixel;\n\t\t\t\t\tppppixel = pppixel;\n\t\t\t\t\tpppixel = ppixel;\n\t\t\t\t\tppixel = pixel;\n\t\t\t\t}\n\t\t\t\tindex = y * width4 + ((width - 1) << 2) + c;\n\t\t\t\tindexLast = y * width4 + c;\n\t\t\t\tpixel = inputData[index];\n\t\t\t\tppixel = pixel;\n\t\t\t\tpppixel = ppixel;\n\t\t\t\tppppixel = pppixel;\n\t\t\t\tfor (; index >= indexLast; index -= 4) {\n\t\t\t\t\tpixel = bigB * inputData[index] + b1 * ppixel + b2 * pppixel + b3 * ppppixel;\n\t\t\t\t\tinputData[index] = pixel;\n\t\t\t\t\tppppixel = pppixel;\n\t\t\t\t\tpppixel = ppixel;\n\t\t\t\t\tppixel = pixel;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (c = 0; c < 3; c++) {\n\t\t\tfor (var x = 0; x < width; x++) {\n\t\t\t\tindex = (x << 2) + c;\n\t\t\t\tindexLast = (height - 1) * width4 + (x << 2) + c;\n\t\t\t\tpixel = inputData[index];\n\t\t\t\tppixel = pixel;\n\t\t\t\tpppixel = ppixel;\n\t\t\t\tppppixel = pppixel;\n\t\t\t\tfor (; index <= indexLast; index += width4) {\n\t\t\t\t\tpixel = bigB * inputData[index] + b1 * ppixel + b2 * pppixel + b3 * ppppixel;\n\t\t\t\t\tinputData[index] = pixel;\n\t\t\t\t\tppppixel = pppixel;\n\t\t\t\t\tpppixel = ppixel;\n\t\t\t\t\tppixel = pixel;\n\t\t\t\t}\n\t\t\t\tindex = (height - 1) * width4 + (x << 2) + c;\n\t\t\t\tindexLast = (x << 2) + c;\n\t\t\t\tpixel = inputData[index];\n\t\t\t\tppixel = pixel;\n\t\t\t\tpppixel = ppixel;\n\t\t\t\tppppixel = pppixel;\n\t\t\t\tfor (; index >= indexLast; index -= width4) {\n\t\t\t\t\tpixel = bigB * inputData[index] + b1 * ppixel + b2 * pppixel + b3 * ppppixel;\n\t\t\t\t\tinputData[index] = pixel;\n\t\t\t\t\tppppixel = pppixel;\n\t\t\t\t\tpppixel = ppixel;\n\t\t\t\t\tppixel = pixel;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n}\n/**\n * Adjusts the brightness of the image by going over to HSV values.\n * Negative values decrease brightness while positive values increase brightness.\n */\nfunction BrightnessFilter(){\n\tthis.name = \"Brightness\";\n\tthis.isDirAnimatable = true;\n\tthis.defaultValues = {\n\t\tamount : 0.0\n\t};\n\tthis.valueRanges = {\n\t\tamount : {min:-1.0, max:1.0}\n\t};\n\tvar filterUtils = new FilterUtils();\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar amount = (values.amount === undefined) ? this.defaultValues.amount : values.amount;\n\t\tfor (var y = 0; y < height; y++) {\n\t\t\tfor (var x = 0; x < width; x++) {\n\t\t\t\tvar pixel = (y*width + x)*4;\n\t\t\t\tvar hsv = filterUtils.RGBtoHSV(inputData[pixel],inputData[pixel+1],inputData[pixel+2]);\n\t\t\t\thsv[2] += amount;\n\t\t\t\tif(hsv[2] < 0){\n\t\t\t\t\thsv[2] = 0;\n\t\t\t\t} else if (hsv[2] > 1){\n\t\t\t\t\thsv[2] = 1;\n\t\t\t\t}\n\t\t\t\tvar rgb = filterUtils.HSVtoRGB(hsv[0],hsv[1],hsv[2]);\n\t\t\t\tfor(var i = 0; i < 3; i++){\n\t\t\t\t\tinputData[pixel+i] = rgb[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n}\n/**\n * Embosses the edges of the image.\n * This filter takes no parameters but can be applied several times for\n * further effect.\n */\nfunction BumpFilter(){\n\tthis.name = \"Bump\";\n\tthis.isDirAnimatable = true;\n\tthis.defaultValues = {\n\t};\n\tthis.valueRanges = {\n\t};\n\tvar filterUtils = new FilterUtils();\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tvar matrix = [-1,-1, 0,\n\t\t\t\t\t  -1, 1, 1,\n\t\t\t\t\t   0, 1, 1];\n\t\tfilterUtils.convolveFilter(inputData,matrix,width,height);\n\t};\n}\n/**\n * Smears out the image with circular shapes to create a painting style effect.\n * The mix values sets the intensity of the effect.\n * NOTE: This filter can be very slow, especially at higher densities/sizes. Use with caution.\n */\nfunction CircleSmearFilter(){\n\tthis.name = \"Circle Smear\";\n\tthis.isDirAnimatable = false;\n\tthis.defaultValues = {\n\t\tsize : 4,\n\t\tdensity : 0.5,\n\t\tmix : 0.5\n\t};\n\tthis.valueRanges = {\n\t\tsize : {min:1, max:10},\n\t\tdensity : {min:0.0, max:1.0},\n\t\tmix : {min:0.0, max:1.0}\n\t};\n\n\tvar filterUtils = new FilterUtils();\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tvar outputData = [];\n\t\t for(var j = 0; j < inputData.length; j++){\n\t\t\toutputData[j] = inputData[j];\n\t\t}\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar size = (values.size === undefined) ? this.defaultValues.size : values.size;\n\t\tif(size < 1){ size = 1;}\n\t\tsize = parseInt(size,10);\n\t\tvar density = (values.density === undefined) ? this.defaultValues.density : values.density;\n\t\tvar mix = (values.mix === undefined) ? this.defaultValues.mix : values.mix;\n\t\tvar radius = size+1;\n\t\tvar radius2 = radius*radius;\n\t\tvar numShapes = parseInt(2*density/30*width*height / 2,10);\n\t\tfor(var i = 0; i < numShapes; i++){\n\t\t\tvar sx = (Math.random()*Math.pow(2,32) & 0x7fffffff) % width;\n\t\t\tvar sy = (Math.random()*Math.pow(2,32) & 0x7fffffff) % height;\n\t\t\tvar rgb2 = [inputData[(sy*width+sx)*4],inputData[(sy*width+sx)*4+1],inputData[(sy*width+sx)*4+2],inputData[(sy*width+sx)*4+3]];\n\t\t\tfor(var x = sx - radius; x < sx + radius + 1; x++){\n\t\t\t\tfor(var y = sy - radius; y < sy + radius + 1; y++){\n\t\t\t\t\tvar f = (x - sx) * (x - sx) + (y - sy) * (y - sy);\n\t\t\t\t\tif (x >= 0 && x < width && y >= 0 && y < height && f <= radius2) {\n\t\t\t\t\t\tvar rgb1 = [outputData[(y*width+x)*4],outputData[(y*width+x)*4+1],outputData[(y*width+x)*4+2],outputData[(y*width+x)*4+3]];\n\t\t\t\t\t\tvar mixedRGB = filterUtils.mixColors(mix,rgb1,rgb2);\n\t\t\t\t\t\tfor(var k = 0; k < 3; k++){\n\t\t\t\t\t\t\toutputData[(y*width+x)*4+k] = mixedRGB[k];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(var l = 0; l < outputData.length; l++){\n\t\t\tinputData[l] = outputData[l];\n\t\t}\n\t};\n}\n/**\n * Adjusts the contrast of the image.\n */\nfunction ContrastFilter(){\n\tthis.name = \"Contrast\";\n\tthis.isDirAnimatable = true;\n\tthis.defaultValues = {\n\t\tamount : 1.0\n\t};\n\tthis.valueRanges = {\n\t\tamount : {min:0.0, max:2.0}\n\t};\n\tif(!FilterUtils){\n\t\t\tif(console){\n\t\t\t\tconsole.error(\"Unable to find filterutils.js, please include this file! (Required by \" + this.name + \" filter)\");\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\tvar filterUtils = new FilterUtils();\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar amount = (values.amount === undefined) ? this.defaultValues.amount : values.amount;\n\t\tif(amount < 0){\n\t\t\tamount = 0.0;\n\t\t}\n\t\tvar table = [];\n\n\t\tfor(var i = 0; i < 256; i++){\n\t\t\ttable[i] = parseInt(255 * (((i/255)-0.5)*amount+0.5),10);\n\t\t}\n\t\tfilterUtils.tableFilter(inputData,table,width,height);\n\t};\n}\n/**\n * Smears out the image with cross shapes to create a painting style effect.\n * The mix values sets the intensity of the effect.\n */\nfunction CrossSmearFilter(){\n\tthis.name = \"Cross Smear\";\n\tthis.isDirAnimatable = false;\n\tthis.defaultValues = {\n\t\tdistance : 8,\n\t\tdensity : 0.5,\n\t\tmix : 0.5\n\t};\n\tthis.valueRanges = {\n\t\tdistance : {min:0, max:30},\n\t\tdensity : {min:0.0, max:1.0},\n\t\tmix : {min:0.0, max:1.0}\n\t};\n\n\tvar filterUtils = new FilterUtils();\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tvar outputData = [];\n\t\t for(var j = 0; j < inputData.length; j++){\n\t\t\toutputData[j] = inputData[j];\n\t\t}\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar distance = (values.distance === undefined) ? this.defaultValues.distance : values.distance;\n\t\tif(distance < 0){ distance = 0;}\n\t\tdistance = parseInt(distance,10);\n\t\tvar density = (values.density === undefined) ? this.defaultValues.density : values.density;\n\t\tvar mix = (values.mix === undefined) ? this.defaultValues.mix : values.mix;\n\t\tvar numShapes = parseInt(2*density*width * height / (distance + 1),10);\n\t\tfor(var i = 0; i < numShapes; i++){\n\t\t\tvar x = (Math.random()*Math.pow(2,32) & 0x7fffffff) % width;\n\t\t\tvar y = (Math.random()*Math.pow(2,32) & 0x7fffffff) % height;\n\t\t\tvar length = (Math.random()*Math.pow(2,32)) % distance + 1;\n\t\t\tvar rgb2 = [inputData[(y*width+x)*4],inputData[(y*width+x)*4+1],inputData[(y*width+x)*4+2],inputData[(y*width+x)*4+3]];\n\t\t\tvar rgb1;\n\t\t\tvar mixedRGB;\n\t\t\tvar k;\n\t\t\tfor (var x1 = x-length; x1 < x+length+1; x1++) {\n\t\t\t\tif(x1 >= 0 && x1 < width){\n\t\t\t\t\trgb1 = [outputData[(y*width+x1)*4],outputData[(y*width+x1)*4+1],outputData[(y*width+x1)*4+2],outputData[(y*width+x1)*4+3]];\n\t\t\t\t\tmixedRGB = filterUtils.mixColors(mix,rgb1,rgb2);\n\t\t\t\t\tfor(k = 0; k < 3; k++){\n\t\t\t\t\t\toutputData[(y*width+x1)*4+k] = mixedRGB[k];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tfor (var y1 = y-length; y1 < y+length+1; y1++) {\n\t\t\t\tif(y1 >= 0 && y1 < height){\n\t\t\t\t\trgb1 = [outputData[(y1*width+x)*4],outputData[(y1*width+x)*4+1],outputData[(y1*width+x)*4+2],outputData[(y1*width+x)*4+3]];\n\t\t\t\t\tmixedRGB = filterUtils.mixColors(mix,rgb1,rgb2);\n\t\t\t\t\tfor(k = 0; k < 3; k++){\n\t\t\t\t\t\toutputData[(y1*width+x)*4+k] = mixedRGB[k];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\tfor(var l = 0; l < outputData.length; l++){\n\t\t\tinputData[l] = outputData[l];\n\t\t}\n\t};\n}\n/**\n * Diffuses the image creating a frosted glass effect.\n */\nfunction DiffusionFilter(){\n\tthis.name = \"Diffusion\";\n\tthis.isDirAnimatable = false;\n\tthis.defaultValues = {\n\t\tscale: 4\n\t};\n\tthis.valueRanges = {\n\t\tscale: {min: 1, max: 100}\n\t};\n\n\tvar filterUtils = new FilterUtils();\n\tthis.filter = function (input, values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar scale = (values.scale === undefined) ? this.defaultValues.scale : values.scale;\n\t\tvar out = [];\n\t\tvar outputData = [];\n\t\tvar sinTable = [];\n\t\tvar cosTable = [];\n\t\tfor(var i = 0; i < 256; i++){\n\t\t\tvar angle = Math.PI*2*i/256;\n\t\t\tsinTable[i] = scale*Math.sin(angle);\n\t\t\tcosTable[i] = scale*Math.cos(angle);\n\t\t}\n\t\ttransInverse = function (x,y,out){\n\t\t\tvar angle = parseInt(Math.random() * 255,10);\n\t\t\tvar distance = Math.random();\n\t\t\tout[0] = x + distance * sinTable[angle];\n\t\t\tout[1] = y + distance * cosTable[angle];\n\t\t};\n\t\tfilterUtils.transformFilter(inputData,transInverse,width,height);\n  };\n}\n/**\n * Dithers the image to the specified number of colors. Setting color to false\n * grayscales the image.\n */\nfunction DitherFilter(){\n\tthis.name = \"Dither\";\n\tthis.isDirAnimatable = false;\n\tthis.defaultValues = {\n\t\tlevels : 3,\n\t\tcolor : true\n\t};\n\tthis.valueRanges = {\n\t\tlevels : {min:2, max:30},\n\t\tcolor : {min:false, max:true}\n\t};\n\n\tvar filterUtils = new FilterUtils();\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tvar outputData = [];\n\t\tvar i, j;\n\t\tfor (j=0; j < inputData.length; j++) {\n\t\t\toutputData[j] = 0;\n\t\t}\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar levels = (values.levels === undefined) ? this.defaultValues.levels : values.levels;\n\t\tvar color = (values.color === undefined) ? this.defaultValues.color : values.color;\n\t\tif(levels <= 1){\n\t\t\tlevels = 1;\n\t\t}\n\t\tvar matrix = [0,0,0,\n\t\t\t\t\t  0,0,7,\n\t\t\t\t\t  3,5,1];\n\t\tvar sum = 7+3+5+1;\n\t\tvar index = 0;\n\t\tvar map = [];\n\n\t\tfor (i=0; i < levels; i++) {\n\t\t\tmap[i] = parseInt(255* i / (levels-1),10);\n\t\t}\n\t\tvar div = [];\n\t\tfor (i=0; i < 256; i++) {\n\t\t\tdiv[i] = parseInt(levels*i / 256,10);\n\t\t}\n\t  \tfor (var y = 0; y < height; y++) {\n\t\t\tvar reverse = ((y & 1) == 1);\n\t\t\tvar direction;\n\t\t\tif(reverse){\n\t\t\t\tindex = (y*width+width-1)*4;\n\t\t\t\tdirection = -1;\n\t\t\t} else {\n\t\t\t\tindex = y*width*4;\n\t\t\t\tdirection = 1;\n\t\t\t}\n\t\t\tfor (var x = 0; x < width; x++) {\n\t\t\t\tvar r1 = inputData[index]; var g1 = inputData[index+1]; var b1 = inputData[index+2];\n\t\t\t\tif(!color){\n\t\t\t\t\tr1 = g1 = b1 = parseInt((r1+g1+b1) / 3,10);\n\t\t\t\t}\n\t\t\t\tvar r2 = map[div[r1]];var g2 = map[div[g1]];var b2 = map[div[b1]];\n\n\t\t\t\toutputData[index] = r2; outputData[index + 1] = g2; outputData[index+2] = b2; outputData[index+3] = inputData[index+3];\n\n\t\t\t\tvar er = r1-r2; var eg = g1-g2; var eb = b1-b2;\n\n\t\t\t\tfor (i = -1; i <= 1; i++) {\n\t\t\t\t\tvar iy = i+y;\n\t\t\t\t\tif (0 <= iy && iy < height) {\n\t\t\t\t\t\tfor (j = -1; j <= 1; j++) {\n\t\t\t\t\t\t\tvar jx = j+x;\n\t\t\t\t\t\t\tif (0 <= jx && jx < width) {\n\t\t\t\t\t\t\t\tvar w;\n\t\t\t\t\t\t\t\tif (reverse){\n\t\t\t\t\t\t\t\t\tw = matrix[(i+1)*3-j+1];\n\t\t\t\t\t\t\t\t} else{\n\t\t\t\t\t\t\t\t\tw = matrix[(i+1)*3+j+1];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (w !== 0) {\n\t\t\t\t\t\t\t\t\tvar k = (reverse) ? index - j*4 : index + j*4;\n\t\t\t\t\t\t\t\t\tr1 = inputData[k]; g1 = inputData[k+1]; b1 = inputData[k+2];\n\t\t\t\t\t\t\t\t\tvar factor = w/sum;\n\t\t\t\t\t\t\t\t\tr1 += er * factor; g1 += eg * factor; b1 += eb * factor;\n\t\t\t\t\t\t\t\t\tinputData[k] = r1; inputData[k+1] = g1 ;inputData[k+2] = b1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tindex += direction*4;\n\t\t\t}\n\t\t}\n\t\tfor(j = 0; j < outputData.length; j++){\n\t\t\tinputData[j] = outputData[j];\n\t\t}\n\t};\n}\n/**\n * Highlights the edges of the image.\n */\nfunction EdgeFilter(){\n\tthis.name = \"Edge Detection\";\n\tthis.isDirAnimatable = true;\n\tthis.defaultValues = {\n\t};\n\tthis.valueRanges = {\n\t};\n\tvar matrixH = [-1,-2,-1,\n\t\t\t\t\t0, 0, 0,\n\t\t\t\t\t1, 2, 1];\n\tvar matrixV = [-1, 0, 1,\n\t\t\t\t   -2, 0, 2,\n\t\t\t\t   -1, 0, 1];\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tvar outputData = [];\n\t\tfor (var y = 0; y < height; y++) {\n\t\t\tfor (var x = 0; x < width; x++) {\n\t\t\t\tvar pixel = (y*width + x)*4;\n\t\t\t\tvar rh = 0; gh = 0; bh = 0;\n\t\t\t\tvar rv = 0; gv = 0; bv = 0;\n\t\t\t\tfor(var row = -1; row <= 1; row++){\n\t\t\t\t\tvar iy = y+row;\n\t\t\t\t\tvar ioffset;\n\t\t\t\t\tif(iy >= 0 && iy < height){\n\t\t\t\t\t\tioffset = iy*width*4;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tioffset = y*width*4;\n\t\t\t\t\t}\n\t\t\t\t\tvar moffset = 3*(row+1)+1;\n\t\t\t\t\tfor(var col = -1; col <= 1; col++){\n\t\t\t\t\t\tvar ix = x+col;\n\t\t\t\t\t\tif(!(ix >= 0 && ix < width)){\n\t\t\t\t\t\t\tix = x;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tix *= 4;\n\t\t\t\t\t\tvar r = inputData[ioffset+ix];\n\t\t\t\t\t\tvar g = inputData[ioffset+ix+1];\n\t\t\t\t\t\tvar b = inputData[ioffset+ix+2];\n\t\t\t\t\t\tvar h = matrixH[moffset+col];\n\t\t\t\t\t\tvar v = matrixV[moffset+col];\n\t\t\t\t\t\trh += parseInt(h*r,10);\n\t\t\t\t\t\tbh += parseInt(h*g,10);\n\t\t\t\t\t\tgh += parseInt(h*b,10);\n\t\t\t\t\t\trv += parseInt(v*r,10);\n\t\t\t\t\t\tgv += parseInt(v*g,10);\n\t\t\t\t\t\tbv += parseInt(v*b,10);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tr = parseInt(Math.sqrt(rh*rh + rv*rv) / 1.8,10);\n\t\t\t\tg = parseInt(Math.sqrt(gh*gh + gv*gv) / 1.8,10);\n\t\t\t\tb = parseInt(Math.sqrt(bh*bh + bv*bv) / 1.8,10);\n\n\t\t\t\toutputData[pixel] = r;\n\t\t\t\toutputData[pixel+1] = g;\n\t\t\t\toutputData[pixel+2] = b;\n\t\t\t\toutputData[pixel+3] = inputData[pixel+3];\n\t\t\t}\n\t\t}\n\t\tfor(var k = 0; k < outputData.length; k++){\n\t\t\tinputData[k] = outputData[k];\n\t\t}\n\t};\n}\n/**\n * Embosses the image with a simulated light source.\n * Angle and elevation sets the position of the light.\n */\nfunction EmbossFilter(){\n\tthis.name = \"Emboss\";\n\tthis.isDirAnimatable = false;\n\tthis.defaultValues = {\n\t\theight : 1,\n\t\tangle : 135,\n\t\televation : 30\n\t};\n\tthis.valueRanges = {\n\t\theight : {min:1, max:10},\n\t\tangle : {min:0, max:360},\n\t\televation : {min:0, max:180}\n\t};\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar bumpHeight = (values.height === undefined) ? this.defaultValues.height : values.height;\n\t\tvar angle = (values.angle === undefined) ? this.defaultValues.angle : values.angle;\n\t\tvar elevation = (values.elevation === undefined) ? this.defaultValues.elevation : values.elevation;\n\t\tangle = angle / 180 * Math.PI;\n\t\televation = elevation / 180 * Math.PI;\n\t\tvar width45 = 3 * bumpHeight;\n\t\tvar pixelScale = 255.9;\n\n\t\tvar bumpPixels = [];\n\t\tvar bumpMapWidth = width;\n\t\tvar bumpMapHeight = height;\n\t\tfor(var i = 0; i < inputData.length; i+=4){\n\t\t\tbumpPixels[i/4] = (inputData[i] + inputData[i+1] + inputData[i+2])/3;\n\t\t}\n\t\tvar Nx, Ny, Nz, Lx, Ly, Lz, Nz2, NzLz, NdotL;\n\t\tvar shade, background;\n\n\t\tLx = parseInt(Math.cos(angle) * Math.cos(elevation) * pixelScale,10);\n\t\tLy = parseInt(Math.sin(angle) * Math.cos(elevation) * pixelScale,10);\n\t\tLz = parseInt(Math.sin(elevation) * pixelScale,10);\n\n\t\tNz = parseInt(6 * 255 / width45,10);\n\t\tNz2 = Nz * Nz;\n\t\tNzLz = Nz * Lz;\n\t\tbackground = Lz;\n\n\t\tvar bumpIndex = 0;\n\n\t\tfor (var y = 0; y < height; y++, bumpIndex += bumpMapWidth) {\n\t\t\tvar s1 = bumpIndex;\n\t\t\tvar s2 = s1 + bumpMapWidth;\n\t\t\tvar s3 = s2 + bumpMapWidth;\n\t\t\tfor (var x = 0; x < width; x++, s1++, s2++, s3++) {\n\t\t\t\tvar pixel = (y*width + x)*4;\n\t\t\t\tif (y !== 0 && y < height-2 && x !== 0 && x < width-2) {\n\t\t\t\t\tNx = bumpPixels[s1-1] + bumpPixels[s2-1] + bumpPixels[s3-1] - bumpPixels[s1+1] - bumpPixels[s2+1] - bumpPixels[s3+1];\n\t\t\t\t\tNy = bumpPixels[s3-1] + bumpPixels[s3] + bumpPixels[s3+1] - bumpPixels[s1-1] - bumpPixels[s1] - bumpPixels[s1+1];\n\t\t\t\t\tif (Nx === 0 && Ny === 0){\n\t\t\t\t\t\tshade = background;\n\t\t\t\t\t} else if ((NdotL = Nx*Lx + Ny*Ly + NzLz) < 0){\n\t\t\t\t\t\tshade = 0;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tshade = parseInt(NdotL / Math.sqrt(Nx*Nx + Ny*Ny + Nz2),10);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tshade = background;\n\t\t\t\t}\n\t\t\t\tinputData[pixel] = inputData[pixel+1] = inputData[pixel+2] = shade;\n\t\t\t}\n\t\t}\n\t};\n}\n/**\n * Adjust simulated exposure values on the image.\n */\nfunction ExposureFilter(){\n\tthis.name = \"Exposure\";\n\tthis.isDirAnimatable = true;\n\tthis.defaultValues = {\n\t\texposure : 1.0\n\t};\n\tthis.valueRanges = {\n\t\texposure : {min:0, max:5}\n\t};\n\n\tvar filterUtils = new FilterUtils();\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar exposure = (values.exposure === undefined) ? this.defaultValues.exposure : values.exposure;\n\t\tvar table = [];\n\t\tfor(var i = 0; i < 256; i++){\n\t\t\ttable[i] = parseInt(255 *(1-Math.exp(-(i/255) * exposure)),10);\n\t\t}\n\t\tfilterUtils.tableFilter(inputData, table, width, height);\n\t};\n}\n/**\n * Adjusts the gain and bias of the image. Gain alters the contrast while bias biases\n * colors towards lighter or darker.\n */\nfunction GainFilter(){\n\tthis.name = \"Gain/Bias\";\n\tthis.isDirAnimatable = true;\n\tthis.defaultValues = {\n\t\tgain: 0.5,\n\t\tbias: 0.5\n\t};\n\tthis.valueRanges = {\n\t\tgain: {min:0.0, max:1.0},\n\t\tbias: {min:0.0, max:1.0}\n\t};\n\tvar table = [];\n\n\tvar filterUtils = new FilterUtils();\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar gain = (values.gain === undefined) ? this.defaultValues.gain : values.gain;\n\t\tvar bias = (values.bias === undefined) ? this.defaultValues.bias : values.bias;\n\n\t\tvar table = [];\n\n\t\tfor(var i = 0; i < 256; i++){\n\t\t\tvar val = i/255;\n\t\t\tvar k = (1/gain-2) * (1-2*val);\n\t\t\tval = (val < 0.5) ? val/(k+1) : (k-val)/(k-1);\n\t\t\tval /= (1/bias-2)*(1-val)+1;\n\t\t\ttable[i] = parseInt(255 * val,10);\n\t\t}\n\t\tfilterUtils.tableFilter(inputData,table,width,height);\n\t};\n}\n/**\n * Adjusts the gamma values of the image. Values over 1 increase the gamma while values over 0 decrease gamma.\n */\nfunction GammaFilter(){\n\tthis.name = \"Gamma\";\n\tthis.isDirAnimatable = true;\n\tthis.defaultValues = {\n\t\tamount : 1.0\n\t};\n\tthis.valueRanges = {\n\t\tamount : {min:0.0, max:2.0}\n\t};\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar amount = (values.amount === undefined) ? this.defaultValues.amount : values.amount;\n\t\tif(amount < 0){\n\t\t\tamount = 0.0;\n\t\t}\n\t\tif(!FilterUtils){\n\t\t\tif(console){\n\t\t\t\tconsole.error(\"Unable to find filterutils.js, please include this file! (Required by \" + this.name + \" filter)\");\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tvar filterUtils = new FilterUtils();\n\t\tvar table = [];\n\t\tfor(var i = 0; i < 256; i++){\n\t\t\ttable[i] = 255 * Math.pow(i/255, 1/amount) + 0.5;\n\t\t}\n\t\tfilterUtils.tableFilter(inputData,table,width,height);\n\t};\n}\n/**\n * Sets the image to grayscale.\n */\nfunction GrayscaleFilter(){\n\tthis.name = \"Grayscale\";\n\tthis.isDirAnimatable = true;\n\tthis.defaultValues = {\n\t};\n\tthis.valueRanges = {\n\t};\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tfor (var y = 0; y < height; y++) {\n\t\t\tfor (var x = 0; x < width; x++) {\n\t\t\t\tvar pixel = (y*width + x)*4;\n\t\t\t\tvar luma = inputData[pixel]*0.3 + inputData[pixel+1]*0.59 + inputData[pixel+2]*0.11;\n\t\t\t\tinputData[pixel] = inputData[pixel+1] = inputData[pixel+2] = luma;\n\t\t\t}\n\t\t}\n\t};\n}\n/**\n * Adjusts the hue of the image by going over to HSV values.\n */\nfunction HueFilter(){\n\tthis.name = \"Hue\";\n\tthis.isDirAnimatable = true;\n\tthis.defaultValues = {\n\t\tamount : 0.0\n\t};\n\tthis.valueRanges = {\n\t\tamount : {min:-1.0, max:1.0}\n\t};\n\n\tvar filterUtils = new FilterUtils();\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar amount = (values.amount === undefined) ? this.defaultValues.amount : values.amount;\n\t\tfor (var y = 0; y < height; y++) {\n\t\t\tfor (var x = 0; x < width; x++) {\n\t\t\t\tvar pixel = (y*width + x)*4;\n\t\t\t\tvar hsv = filterUtils.RGBtoHSV(inputData[pixel],inputData[pixel+1],inputData[pixel+2]);\n\t\t\t\thsv[0] += amount;\n\t\t\t\twhile(hsv[0] < 0){\n\t\t\t\t\thsv[0] += 360;\n\t\t\t\t}\n\t\t\t\tvar rgb = filterUtils.HSVtoRGB(hsv[0],hsv[1],hsv[2]);\n\t\t\t\tfor(var i = 0; i < 3; i++){\n\t\t\t\t\tinputData[pixel+i] = rgb[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n}\n/**\n * Inverts the colors of the image.\n */\nfunction InvertFilter(){\n\tthis.name = \"Invert\";\n\tthis.isDirAnimatable = true;\n\tthis.defaultValues = {\n\t};\n\tthis.valueRanges = {\n\t};\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tfor (var y = 0; y < height; y++) {\n\t\t\tfor (var x = 0; x < width; x++) {\n\t\t\t\tvar pixel = (y*width + x)*4;\n\t\t\t\tfor(var i = 0; i < 3; i++){\n\t\t\t\t\tinputData[pixel+i] = 255 - inputData[pixel+i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n}\n/**\n * Creates a kaleidoscope effect on the image. CenterX and CenterY specify the\n * position in terms of ratios of width and height.\n */\nfunction KaleidoscopeFilter(){\n\tthis.name = \"Kaleidoscope\";\n\tthis.isDirAnimatable = false;\n\tthis.defaultValues = {\n\t\tangle : 0,\n\t\trotation : 0,\n\t\tsides : 3,\n\t\tcenterX : 0.5,\n\t\tcenterY : 0.5\n\t};\n\tthis.valueRanges = {\n\t\tangle : {min: 0, max: 360},\n\t\trotation : {min: 0, max: 360},\n\t\tsides : {min: 1, max: 30},\n\t\tcenterX : {min: 0.0, max:1.0},\n\t\tcenterY : {min: 0.0, max:1.0}\n\t};\n\n\tvar filterUtils = new FilterUtils();\n\tthis.filter = function (input, values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar angle = (values.angle === undefined) ? this.defaultValues.angle : values.angle;\n\t\tvar rotation = (values.rotation === undefined) ? this.defaultValues.rotation : values.rotation;\n\t\tvar sides = (values.sides === undefined) ? this.defaultValues.sides : values.sides;\n\t\tvar centerX = (values.centerX === undefined) ? this.defaultValues.centerX : values.centerX;\n\t\tvar centerY = (values.centerY === undefined) ? this.defaultValues.centerY : values.centerY;\n\t\tvar iCenterX = width * centerX; var iCenterY = height * centerY;\n\t\tangle = angle/180 * Math.PI;\n\t\trotation = rotation/180 * Math.PI;\n\t\tvar transInverse = function(x,y,out){\n\t\t\tvar dx = x - iCenterX;\n\t\t\tvar dy = y - iCenterY;\n\t\t\tvar r = Math.sqrt(dx*dx + dy*dy);\n\t\t\tvar theta = Math.atan2(dy,dx) - angle - rotation;\n\t\t\ttheta = filterUtils.triangle(theta/Math.PI*sides*0.5);\n\t\t\ttheta += angle;\n\t\t\tout[0] = iCenterX + r*Math.cos(theta);\n\t\t\tout[1] = iCenterY + r*Math.sin(theta);\n\t\t};\n\t\tfilterUtils.transformFilter(inputData,transInverse,width,height);\n\t};\n}\n/**\n * Applies a fisheye lens distortion effect on the image. CenterX and CenterY specify the\n * position in terms of ratios of width and height.\n */\nfunction LensDistortionFilter(){\n\tthis.name = \"Lens Distortion\";\n\tthis.isDirAnimatable = false;\n\tthis.defaultValues = {\n\t\trefraction : 1.5,\n\t\tradius : 50,\n\t\tcenterX : 0.5,\n\t\tcenterY : 0.5\n\t};\n\tthis.valueRanges = {\n\t\trefraction : {min: 1, max: 10},\n\t\tradius : {min: 1, max: 200},\n\t\tcenterX : {min: 0.0, max:1.0},\n\t\tcenterY : {min: 0.0, max:1.0}\n\t};\n\n\tvar filterUtils = new FilterUtils();\n\n\tthis.filter = function (input, values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar refraction = (values.refraction === undefined) ? this.defaultValues.refraction : values.refraction;\n\t\tvar centerX = (values.centerX === undefined) ? this.defaultValues.centerX : values.centerX;\n\t\tvar centerY = (values.centerY === undefined) ? this.defaultValues.centerY : values.centerY;\n\t\tvar radius = (values.radius === undefined) ? this.defaultValues.radius : values.radius;\n\t\tvar radius2 = radius*radius;\n\t\tvar iCenterX = width * centerX; var iCenterY = height * centerY;\n\t\tvar transInverse = function(x,y,out){\n\t\t\tvar dx = x-iCenterX;\n\t\t\tvar dy = y-iCenterY;\n\t\t\tvar x2 = dx*dx;\n\t\t\tvar y2 = dy*dy;\n\t\t\tif (y2 >= (radius2 - (radius2*x2)/radius2)) {\n\t\t\t\tout[0] = x;\n\t\t\t\tout[1] = y;\n\t\t\t} else {\n\t\t\t\tvar rRefraction = 1.0 / refraction;\n\n\t\t\t\tvar z = Math.sqrt((1.0 - x2/radius2 - y2/radius2) * radius2);\n\t\t\t\tvar z2 = z*z;\n\n\t\t\t\tvar xAngle = Math.acos(dx / Math.sqrt(x2+z2));\n\t\t\t\tvar angle1 = Math.PI/2 - xAngle;\n\t\t\t\tvar angle2 = Math.asin(Math.sin(angle1)*rRefraction);\n\t\t\t\tangle2 = Math.PI/2 - xAngle - angle2;\n\t\t\t\tout[0] = x - Math.tan(angle2)*z;\n\n\t\t\t\tvar yAngle = Math.acos(dy / Math.sqrt(y2+z2));\n\t\t\t\tangle1 = Math.PI/2 - yAngle;\n\t\t\t\tangle2 = Math.asin(Math.sin(angle1)*rRefraction);\n\t\t\t\tangle2 = Math.PI/2 - yAngle - angle2;\n\t\t\t\tout[1] = y - Math.tan(angle2)*z;\n\t\t\t}\n\t\t};\n\t\tfilterUtils.transformFilter(inputData,transInverse,width,height);\n\t};\n}\n/**\n * Smears out the image with line shapes to create a painting style effect. Mix specifies\n * the intensity of the effect.\n */\nfunction LineSmearFilter(){\n\tthis.name = \"Line Smear\";\n\tthis.isDirAnimatable = false;\n\tthis.defaultValues = {\n\t\tdistance : 8,\n\t\tdensity : 0.5,\n\t\tangle : 0,\n\t\tmix : 0.5\n\t};\n\tthis.valueRanges = {\n\t\tdistance : {min:1, max:30},\n\t\tdensity : {min:0.0, max:1.0},\n\t\tangle : {min:0, max:360},\n\t\tmix : {min:0.0, max:1.0}\n\t};\n\n\tvar filterUtils = new FilterUtils();\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tvar outputData = [];\n\t\tvar k;\n\t\tfor(k = 0; k < inputData.length; k++){\n\t\t\toutputData[k] = inputData[k];\n\t\t}\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar distance = (values.distance === undefined) ? this.defaultValues.distance : values.distance;\n\t\tif(distance < 1){ distance = 1;}\n\t\tdistance = parseInt(distance,10);\n\t\tvar density = (values.density === undefined) ? this.defaultValues.density : values.density;\n\t\tvar angle = (values.angle === undefined) ? this.defaultValues.angle : values.angle;\n\t\tvar mix = (values.mix === undefined) ? this.defaultValues.mix : values.mix;\n\t\tangle = angle/180*Math.PI;\n\t\tvar sinAngle = Math.sin(angle);\n\t\tvar cosAngle = Math.cos(angle);\n\t\tvar numShapes = parseInt(2*density*width*height / 2,10);\n\t\tfor(var i = 0; i < numShapes; i++){\n\t\t\tvar sx = (Math.random()*Math.pow(2,32) & 0x7fffffff) % width;\n\t\t\tvar sy = (Math.random()*Math.pow(2,32) & 0x7fffffff) % height;\n\t\t\tvar length = (Math.random()*Math.pow(2,32) & 0x7fffffff) % distance + 1;\n\t\t\tvar rgb2 = [inputData[(sy*width+sx)*4],inputData[(sy*width+sx)*4+1],inputData[(sy*width+sx)*4+2],inputData[(sy*width+sx)*4+3]];\n\t\t\tvar dx = parseInt(length*cosAngle,10);\n\t\t\tvar dy = parseInt(length*sinAngle,10);\n\n\t\t\tvar x0 = sx-dx;\n\t\t\tvar y0 = sy-dy;\n\t\t\tvar x1 = sx+dx;\n\t\t\tvar y1 = sy+dy;\n\t\t\tvar x, y, d, incrE, incrNE, ddx, ddy;\n\n\t\t\tif (x1 < x0){\n\t\t\t\tddx = -1;\n\t\t\t} else {\n\t\t\t\tddx = 1;\n\t\t\t}\n\t\t\tif (y1 < y0){\n\t\t\t\tddy = -1;\n\t\t\t} else {\n\t\t\t\tddy = 1;\n\t\t\t}\n\t\t\tdx = x1-x0;\n\t\t\tdy = y1-y0;\n\t\t\tdx = Math.abs(dx);\n\t\t\tdy = Math.abs(dy);\n\t\t\tx = x0;\n\t\t\ty = y0;\n\t\t\tvar rgb1;\n\t\t\tvar mixedRGB;\n\t\t\tif (x < width && x >= 0 && y < height && y >= 0) {\n\t\t\t\trgb1 = [outputData[(y*width+x)*4],outputData[(y*width+x)*4+1],outputData[(y*width+x)*4+2],outputData[(y*width+x)*4+3]];\n\t\t\t\tmixedRGB = filterUtils.mixColors(mix,rgb1,rgb2);\n\t\t\t\tfor(k = 0; k < 3; k++){\n\t\t\t\t\toutputData[(y*width+x)*4+k] = mixedRGB[k];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (Math.abs(dx) > Math.abs(dy)) {\n\t\t\t\td = 2*dy-dx;\n\t\t\t\tincrE = 2*dy;\n\t\t\t\tincrNE = 2*(dy-dx);\n\n\t\t\t\twhile (x != x1) {\n\t\t\t\t\tif (d <= 0){\n\t\t\t\t\t\td += incrE;\n\t\t\t\t\t} else {\n\t\t\t\t\t\td += incrNE;\n\t\t\t\t\t\ty += ddy;\n\t\t\t\t\t}\n\t\t\t\t\tx += ddx;\n\t\t\t\t\tif (x < width && x >= 0 && y < height && y >= 0) {\n\t\t\t\t\t\trgb1 = [outputData[(y*width+x)*4],outputData[(y*width+x)*4+1],outputData[(y*width+x)*4+2],outputData[(y*width+x)*4+3]];\n\t\t\t\t\t\tmixedRGB = filterUtils.mixColors(mix,rgb1,rgb2);\n\t\t\t\t\t\tfor(k = 0; k < 3; k++){\n\t\t\t\t\t\t\toutputData[(y*width+x)*4+k] = mixedRGB[k];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\td = 2*dx-dy;\n\t\t\t\tincrE = 2*dx;\n\t\t\t\tincrNE = 2*(dx-dy);\n\n\t\t\t\twhile (y != y1) {\n\t\t\t\t\tif (d <= 0) {\n\t\t\t\t\t\td += incrE;\n\t\t\t\t\t}else {\n\t\t\t\t\t\td += incrNE;\n\t\t\t\t\t\tx += ddx;\n\t\t\t\t\t}\n\t\t\t\t\ty += ddy;\n\t\t\t\t\tif (x < width && x >= 0 && y < height && y >= 0) {\n\t\t\t\t\t\trgb1 = [outputData[(y*width+x)*4],outputData[(y*width+x)*4+1],outputData[(y*width+x)*4+2],outputData[(y*width+x)*4+3]];\n\t\t\t\t\t\tmixedRGB = filterUtils.mixColors(mix,rgb1,rgb2);\n\t\t\t\t\t\tfor(k = 0; k < 3; k++){\n\t\t\t\t\t\t\toutputData[(y*width+x)*4+k] = mixedRGB[k];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(k = 0; k < outputData.length; k++){\n\t\t\tinputData[k] = outputData[k];\n\t\t}\n\t};\n}\n/**\n * Replaces every pixel with the maximum RGB value of the neighboring pixels. Each color is\n * considered separately.\n */\nfunction MaximumFilter(){\n\tthis.name = \"Maximum\";\n\tthis.isDirAnimatable = true;\n\tthis.defaultValues = {\n\t};\n\tthis.valueRanges = {\n\t};\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tvar outputData = [];\n\t\tfor (var y = 0; y < height; y++) {\n\t\t\tfor (var x = 0; x < width; x++) {\n\t\t\t\tvar pixel = (y*width + x)*4;\n\t\t\t\tvar maxR = 0;\n\t\t\t\tvar maxG = 0;\n\t\t\t\tvar maxB = 0;\n\t\t\t\tfor (var dy = -1; dy <= 1; dy++){\n\t\t\t\t\tvar iy = y+dy;\n\t\t\t\t\tif(iy >= 0 && iy < height){\n\t\t\t\t\t\tfor (var dx = -1; dx <= 1; dx++){\n\t\t\t\t\t\t\tvar ix = x+dx;\n\t\t\t\t\t\t\tif(ix >= 0 && ix < width){\n\t\t\t\t\t\t\t\tvar iPixel = (iy*width + ix)*4;\n\t\t\t\t\t\t\t\tmaxR = Math.max(maxR,inputData[iPixel]);\n\t\t\t\t\t\t\t\tmaxG = Math.max(maxG,inputData[iPixel+1]);\n\t\t\t\t\t\t\t\tmaxB = Math.max(maxB,inputData[iPixel+2]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\toutputData[pixel] = maxR;\n\t\t\t\toutputData[pixel+1] = maxG;\n\t\t\t\toutputData[pixel+2] = maxB;\n\t\t\t\toutputData[pixel+3] = inputData[pixel+3];\n\t\t\t}\n\t\t}\n\t\tfor(var k = 0; k < outputData.length; k++){\n\t\t\tinputData[k] = outputData[k];\n\t\t}\n\t};\n}\n/**\n * Replaces every pixel with the median RGB value of the neighboring pixels. Each color is\n * considered separately.\n */\nfunction MedianFilter(){\n\tthis.name = \"Median\";\n\tthis.isDirAnimatable = false;\n\tthis.defaultValues = {\n\t};\n\tthis.valueRanges = {\n\t};\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tvar outputData = [];\n\t\tfor (var y = 0; y < height; y++) {\n\t\t\tfor (var x = 0; x < width; x++) {\n\t\t\t\tvar pixel = (y*width + x)*4;\n\t\t\t\tvar rList = [];\n\t\t\t\tvar gList = [];\n\t\t\t\tvar bList = [];\n\t\t\t\tfor (var dy = -1; dy <= 1; dy++){\n\t\t\t\t\tvar iy = y+dy;\n\t\t\t\t\tif(iy >= 0 && iy < height){\n\t\t\t\t\t\tfor (var dx = -1; dx <= 1; dx++){\n\t\t\t\t\t\t\tvar ix = x+dx;\n\t\t\t\t\t\t\tif(ix >= 0 && ix < width){\n\t\t\t\t\t\t\t\tvar iPixel = (iy*width + ix)*4;\n\t\t\t\t\t\t\t\trList.push(inputData[iPixel]);\n\t\t\t\t\t\t\t\tgList.push(inputData[iPixel+1]);\n\t\t\t\t\t\t\t\tbList.push(inputData[iPixel+2]);\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar sortFunc = function(a,b){\n\t\t\t\t\treturn a-b;\n\t\t\t\t};\n\t\t\t\trList.sort(sortFunc);\n\t\t\t\tgList.sort(sortFunc);\n\t\t\t\tbList.sort(sortFunc);\n\t\t\t\toutputData[pixel] = rList[4];\n\t\t\t\toutputData[pixel+1] = gList[4];\n\t\t\t\toutputData[pixel+2] = bList[4];\n\t\t\t\toutputData[pixel+3] = inputData[pixel+3];\n\t\t\t}\n\t\t}\n\t\tfor(var k = 0; k < outputData.length; k++){\n\t\t\tinputData[k] = outputData[k];\n\t\t}\n\t};\n}\n/**\n * Replaces every pixel with the minimum RGB value of the neighboring pixels. Each color is\n * considered separately.\n */\nfunction MinimumFilter(){\n\tthis.name = \"Minimum\";\n\tthis.isDirAnimatable = true;\n\tthis.defaultValues = {\n\t};\n\tthis.valueRanges = {\n\t};\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tvar outputData = [];\n\t\tfor (var y = 0; y < height; y++) {\n\t\t\tfor (var x = 0; x < width; x++) {\n\t\t\t\tvar pixel = (y*width + x)*4;\n\t\t\t\tvar minR = 255;\n\t\t\t\tvar minG = 255;\n\t\t\t\tvar minB = 255;\n\t\t\t\tfor (var dy = -1; dy <= 1; dy++){\n\t\t\t\t\tvar iy = y+dy;\n\t\t\t\t\tif(iy >= 0 && iy < height){\n\t\t\t\t\t\tfor (var dx = -1; dx <= 1; dx++){\n\t\t\t\t\t\t\tvar ix = x+dx;\n\t\t\t\t\t\t\tif(ix >= 0 && ix < width){\n\t\t\t\t\t\t\t\tvar iPixel = (iy*width + ix)*4;\n\t\t\t\t\t\t\t\tminR = Math.min(minR,inputData[iPixel]);\n\t\t\t\t\t\t\t\tminG = Math.min(minG,inputData[iPixel+1]);\n\t\t\t\t\t\t\t\tminB = Math.min(minB,inputData[iPixel+2]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\toutputData[pixel] = minR;\n\t\t\t\toutputData[pixel+1] = minG;\n\t\t\t\toutputData[pixel+2] = minB;\n\t\t\t\toutputData[pixel+3] = inputData[pixel+3];\n\t\t\t}\n\t\t}\n\t\tfor(var k = 0; k < outputData.length; k++){\n\t\t\tinputData[k] = outputData[k];\n\t\t}\n\t};\n}\n/**\n * Creates random noise on the image, with or without color.\n */\nfunction NoiseFilter(){\n\tthis.name = \"Noise\";\n\tthis.isDirAnimatable = true;\n\tthis.defaultValues = {\n\t\tamount : 25,\n\t\tdensity : 1,\n\t\tmonochrome : true\n\t};\n\tthis.valueRanges = {\n\t\tamount : {min:0, max:100},\n\t\tdensity : {min:0, max:1.0},\n\t\tmonochrome : {min:false, max:true}\n\t};\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar amount = (values.amount === undefined) ? this.defaultValues.amount : values.amount;\n\t\tvar density = (values.density === undefined) ? this.defaultValues.density : values.density;\n\t\tvar monochrome = (values.monochrome === undefined) ? this.defaultValues.monochrome : values.monochrome;\n\t\tfor (var y = 0; y < height; y++) {\n\t\t\tfor (var x = 0; x < width; x++) {\n\t\t\t\tvar pixel = (y*width + x)*4;\n\t\t\t\tif(Math.random() <= density){\n\t\t\t\t\tvar n;\n\t\t\t\t\tif(monochrome){\n\t\t\t\t\t\tn = parseInt((2*Math.random()-1) * amount,10);\n\t\t\t\t\t\tinputData[pixel] += n;\n\t\t\t\t\t\tinputData[pixel+1] += n;\n\t\t\t\t\t\tinputData[pixel+2] += n;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor(var i = 0; i < 3; i++){\n\t\t\t\t\t\t\tn = parseInt((2*Math.random()-1) * amount,10);\n\t\t\t\t\t\t\tinputData[pixel+i] += n;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n}\n/**\n * Produces an oil painting effect on the image.\n * NOTE: This filter can be very slow, especially at higher ranges. Use with caution.\n */\nfunction OilFilter(){\n\tthis.name = \"Oil Painting\";\n\tthis.isDirAnimatable = false;\n\tthis.defaultValues = {\n\t\trange : 3\n\t};\n\tthis.valueRanges = {\n\t\trange : {min:0, max:5}\n\t};\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tvar outputData = [];\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar range = (values.range === undefined) ? this.defaultValues.range : values.range;\n\t\trange = parseInt(range,10);\n\t\tvar index = 0;\n\t\tvar rHistogram = [];\n\t\tvar gHistogram = [];\n\t\tvar bHistogram = [];\n\t\tvar rTotal = [];\n\t\tvar gTotal = [];\n\t\tvar bTotal = [];\n\t\tvar levels = 256;\n\t\tfor (var y = 0; y < height; y++) {\n\t\t\tfor (var x = 0; x < width; x++) {\n\t\t\t\tvar pixel = (y*width + x)*4;\n\t\t\t\tfor (var j = 0; j < levels; j++){\n\t\t\t\t\trHistogram[j] = gHistogram[j] = bHistogram[j] = rTotal[j] = gTotal[j] = bTotal[j] = 0;\n\t\t\t\t}\n\t\t\t\tfor (var row = -range; row <= range; row++) {\n\t\t\t\t\tvar iy = y+row;\n\t\t\t\t\tvar ioffset;\n\t\t\t\t\tif (0 <= iy && iy < height) {\n\t\t\t\t\t\tioffset = iy*width;\n\t\t\t\t\t\tfor (var col = -range; col <= range; col++) {\n\t\t\t\t\t\t\tvar ix = x+col;\n\t\t\t\t\t\t\tif (0 <= ix && ix < width) {\n\t\t\t\t\t\t\t\tvar ro = inputData[(ioffset+ix)*4];\n\t\t\t\t\t\t\t\tvar go = inputData[(ioffset+ix)*4+1];\n\t\t\t\t\t\t\t\tvar bo = inputData[(ioffset+ix)*4+2];\n\t\t\t\t\t\t\t\tvar ri = ro*levels/256;\n\t\t\t\t\t\t\t\tvar gi = go*levels/256;\n\t\t\t\t\t\t\t\tvar bi = bo*levels/256;\n\t\t\t\t\t\t\t\trTotal[ri] += ro;\n\t\t\t\t\t\t\t\tgTotal[gi] += go;\n\t\t\t\t\t\t\t\tbTotal[bi] += bo;\n\t\t\t\t\t\t\t\trHistogram[ri]++;\n\t\t\t\t\t\t\t\tgHistogram[gi]++;\n\t\t\t\t\t\t\t\tbHistogram[bi]++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar r = 0, g = 0, b = 0;\n\t\t\t\tfor (var i = 1; i < levels; i++) {\n\t\t\t\t\tif (rHistogram[i] > rHistogram[r]){\n\t\t\t\t\t\tr = i;\n\t\t\t\t\t}\n\t\t\t\t\tif (gHistogram[i] > gHistogram[g]){\n\t\t\t\t\t\tg = i;\n\t\t\t\t\t}\n\t\t\t\t\tif (bHistogram[i] > bHistogram[b]){\n\t\t\t\t\t\tb = i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tr = rTotal[r] / rHistogram[r];\n\t\t\t\tg = gTotal[g] / gHistogram[g];\n\t\t\t\tb = bTotal[b] / bHistogram[b];\n\t\t\t\toutputData[pixel] = r;\n\t\t\t\toutputData[pixel+1] = g;\n\t\t\t\toutputData[pixel+2] = b;\n\t\t\t\toutputData[pixel+3] = inputData[pixel+3];\n\t\t\t}\n\t\t}\n\t\tfor(var k = 0; k < outputData.length; k++){\n\t\t\tinputData[k] = outputData[k];\n\t\t}\n\t};\n}\n/**\n * Changes the opacity of the image.\n */\nfunction OpacityFilter(){\n\tthis.name = \"Opacity\";\n\tthis.isDirAnimatable = true;\n\tthis.defaultValues = {\n\t\tamount : 1.0\n\t};\n\tthis.valueRanges = {\n\t\tamount : {min:0.0, max:1.0}\n\t};\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar amount = (values.amount === undefined) ? this.defaultValues.amount : values.amount;\n\t\tfor (var y = 0; y < height; y++) {\n\t\t\tfor (var x = 0; x < width; x++) {\n\t\t\t\tvar pixel = (y*width + x)*4;\n\t\t\t\tinputData[pixel+3] = 255*amount;\n\t\t\t}\n\t\t}\n\t};\n}\n/**\n * Pinches and whirls the image toward the center point. CenterX and CenterY specify the\n * position in terms of ratios of width and height.\n */\nfunction PinchFilter(){\n\tthis.name = \"Pinch/Whirl\";\n\tthis.isDirAnimatable = false;\n\tthis.defaultValues = {\n\t\tamount : 0.5,\n\t\tradius : 100,\n\t\tangle : 0,\n\t\tcenterX : 0.5,\n\t\tcenterY : 0.5\n\t};\n\tthis.valueRanges = {\n\t\tamount : {min: -1.0, max: 1.0},\n\t\tradius : {min: 1, max: 200},\n\t\tangle : {min: 0, max: 360},\n\t\tcenterX : {min: 0.0, max:1.0},\n\t\tcenterY : {min: 0.0, max:1.0}\n\t};\n\n\tvar filterUtils = new FilterUtils();\n\n\tthis.filter = function (input, values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar amount = (values.amount === undefined) ? this.defaultValues.amount : values.amount;\n\t\tvar angle = (values.angle === undefined) ? this.defaultValues.angle : values.angle;\n\t\tvar centerX = (values.centerX === undefined) ? this.defaultValues.centerX : values.centerX;\n\t\tvar centerY = (values.centerY === undefined) ? this.defaultValues.centerY : values.centerY;\n\t\tvar radius = (values.radius === undefined) ? this.defaultValues.radius : values.radius;\n\t\tvar radius2 = radius*radius;\n\t\tangle = angle/180 * Math.PI;\n\t\tvar iCenterX = width * centerX; var iCenterY = height * centerY;\n\t\tvar transInverse = function(x,y,out){\n\t\t\tvar dx = x-iCenterX;\n\t\t\tvar dy = y-iCenterY;\n\t\t\tvar distance = dx*dx + dy*dy;\n\t\t\tif(distance > radius2 || distance === 0){\n\t\t\t\tout[0] = x;\n\t\t\t\tout[1] = y;\n\t\t\t} else {\n\t\t\t\tvar d = Math.sqrt( distance / radius2 );\n\t\t\t\tvar t = Math.pow( Math.sin( Math.PI*0.5 * d ), -amount);\n\t\t\t\tdx *= t;\n\t\t\t\tdy *= t;\n\t\t\t\tvar e = 1 - d;\n\t\t\t\tvar a = angle * e * e;\n\t\t\t\tvar s = Math.sin(a);\n\t\t\t\tvar c = Math.cos(a);\n\t\t\t\tout[0] = iCenterX + c*dx - s*dy;\n\t\t\t\tout[1] = iCenterY + s*dx + c*dy;\n\t\t\t}\n\t\t};\n\t\tfilterUtils.transformFilter(inputData,transInverse,width,height);\n\t};\n}\n/**\n * Pixelates the image i.e. divides the image into blocks of color.\n */\nfunction PixelationFilter(){\n\tthis.name = \"Pixelation\";\n\tthis.isDirAnimatable = false;\n\tthis.defaultValues = {\n\t\tsize : 5\n\t};\n\tthis.valueRanges = {\n\t\tsize : {min:1, max:50}\n\t};\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar size = (values.size === undefined) ? this.defaultValues.size : values.size;\n\t\tsize = parseInt(size,10);\n\t\tvar pixels = [];\n\t\tvar by, bx, bPixel;\n\t\tfor (var y = 0; y < height; y+=size) {\n\t\t\tfor (var x = 0; x < width; x+=size) {\n\t\t\t\tvar pixel = (y*width + x)*4;\n\t\t\t\tvar w = Math.min(size, width-x);\n\t\t\t\tvar h = Math.min(size, height-y);\n\t\t\t\tvar t = w*h;\n\t\t\t\tvar r = 0, g = 0, b = 0;\n\t\t\t\tfor(by = y; by < y+h; by++){\n\t\t\t\t\tfor(bx = x; bx < x+w; bx++){\n\t\t\t\t\t\tbPixel = (by*width + bx)*4;\n\t\t\t\t\t\tr += inputData[bPixel];\n\t\t\t\t\t\tg +=  inputData[bPixel+1];\n\t\t\t\t\t\tb += inputData[bPixel+2];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(by = y; by < y+h; by++){\n\t\t\t\t\tfor(bx = x; bx < x+w; bx++){\n\t\t\t\t\t\tbPixel = (by*width + bx)*4;\n\t\t\t\t\t\tinputData[bPixel] = r/t;\n\t\t\t\t\t\tinputData[bPixel+1] = g/t;\n\t\t\t\t\t\tinputData[bPixel+2] = b/t;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n}\n/**\n * Posterizes the image, i.e. restricts the color values to a set amount of levels.\n */\nfunction PosterizeFilter(){\n\tthis.name = \"Posterize\";\n\tthis.isDirAnimatable = false;\n\tthis.defaultValues = {\n\t\tlevels : 6\n\t};\n\tthis.valueRanges = {\n\t\tlevels : {min:2, max:30 }\n\t};\n\n\tvar filterUtils = new FilterUtils();\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar levels = (values.levels === undefined) ? this.defaultValues.levels : parseInt(values.levels,10);\n\t\tif(levels <= 1){\n\t\t\treturn;\n\t\t}\n\t\tvar table = [];\n\t\tfor(var i = 0; i < 256; i++){\n\t\t\ttable[i] = parseInt(255 * parseInt(i*levels/256,10) / (levels-1),10);\n\t\t}\n\t\tfilterUtils.tableFilter(inputData,table,width,height);\n\t};\n}\n/**\n * Adjust the factor of each RGB color value in the image.\n */\nfunction RGBAdjustFilter(){\n\tthis.name = \"RGBAdjust\";\n\tthis.isDirAnimatable = true;\n\tthis.defaultValues = {\n\t\tred: 1.0,\n\t\tgreen: 1.0,\n\t\tblue: 1.0\n\t};\n\tthis.valueRanges = {\n\t\tred: {min: 0.0, max: 2.0},\n\t\tgreen: {min: 0.0, max: 2.0},\n\t\tblue: {min: 0.0, max: 2.0}\n\t};\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar red = (values.red === undefined) ? this.defaultValues.red : values.red;\n\t\tvar green = (values.green === undefined) ? this.defaultValues.green : values.green;\n\t\tvar blue = (values.blue === undefined) ? this.defaultValues.blue : values.blue;\n\t\tif(red < 0){ red = 0; }\n\t\tif(green < 0){ green = 0; }\n\t\tif(blue < 0){ blue = 0; }\n\t\tfor (var y = 0; y < height; y++) {\n\t\t\tfor (var x = 0; x < width; x++) {\n\t\t\t\tvar pixel = (y*width + x)*4;\n\t\t\t\tinputData[pixel] *= red;\n\t\t\t\tinputData[pixel+1] *= green;\n\t\t\t\tinputData[pixel+2] *= blue;\n\t\t\t}\n\t\t}\n\t};\n}\n/**\n * Adjusts the saturation value of the image. Values over 1 increase saturation while values below decrease saturation.\n * For a true grayscale effect, use the grayscale filter instead.\n */\nfunction SaturationFilter(){\n\tthis.name = \"Saturation\";\n\tthis.isDirAnimatable = true;\n\tthis.defaultValues = {\n\t\tamount : 1.0\n\t};\n\tthis.valueRanges = {\n\t\tamount : {min:0.0, max:2.0}\n\t};\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar amount = (values.amount === undefined) ? this.defaultValues.amount : values.amount;\n\t\tvar RW = 0.3;\n\t\tvar RG = 0.59;\n\t\tvar RB = 0.11;\n\t\tvar a = (1 - amount) * RW + amount;\n\t\tvar b = (1 - amount) * RW;\n\t\tvar c = (1 - amount) * RW;\n\t\tvar d = (1 - amount) * RG;\n\t\tvar e = (1 - amount) * RG + amount;\n\t\tvar f = (1 - amount) * RG;\n\t\tvar g = (1 - amount) * RB;\n\t\tvar h = (1 - amount) * RB;\n\t\tvar i = (1 - amount) * RB + amount;\n\t\tfor (var y = 0; y < height; y++) {\n\t\t\tfor (var x = 0; x < width; x++) {\n\t\t\t\tvar pixel = (y*width + x)*4;\n\t\t\t\tvar pR = inputData[pixel];\n\t\t\t\tvar pG = inputData[pixel+1];\n\t\t\t\tvar pB = inputData[pixel+2];\n\t\t\t\tinputData[pixel]   = a*pR + d*pG + g*pB;\n\t\t\t\tinputData[pixel+1] = b*pR + e*pG + h*pB;\n\t\t\t\tinputData[pixel+2]  = c*pR + f*pG + i*pB;\n\t\t\t}\n\t\t}\n\t};\n}\n/**\n * Creates ripples on the image horizontally/vertically in a sawtooth pattern.\n */\nfunction SawtoothRippleFilter(){\n\tthis.name = \"Sawtooth Ripples\";\n\tthis.isDirAnimatable = false;\n\tthis.defaultValues = {\n\t\txAmplitude : 5,\n\t\tyAmplitude : 5,\n\t\txWavelength : 16,\n\t\tyWavelength : 16\n\t};\n\tthis.valueRanges = {\n\t\txAmplitude : {min:0, max:30},\n\t\tyAmplitude : {min:0, max:30},\n\t\txWavelength : {min:1, max:50},\n\t\tyWavelength : {min:1, max:50}\n\t};\n\n\tvar filterUtils = new FilterUtils();\n\n\tthis.filter = function (input, values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar xAmplitude = (values.xAmplitude === undefined) ? this.defaultValues.xAmplitude : values.xAmplitude;\n\t\tvar yAmplitude = (values.yAmplitude === undefined) ? this.defaultValues.yAmplitude : values.yAmplitude;\n\t\tvar xWavelength = (values.xWavelength === undefined) ? this.defaultValues.xWavelength : values.xWavelength;\n\t\tvar yWavelength = (values.yWavelength === undefined) ? this.defaultValues.yWavelength : values.yWavelength;\n\t\tvar transInverse = function(x,y,out){\n\t\t\tvar nx = y/xWavelength;\n\t\t\tvar ny = x/yWavelength;\n\t\t\tvar fx = filterUtils.mod(nx,1);\n\t\t\tvar fy = filterUtils.mod(ny,1);\n\t\t\tout[0] = x + xAmplitude * fx;\n\t\t\tout[1] = y + yAmplitude * fy;\n\t\t};\n\t\tfilterUtils.transformFilter(inputData,transInverse,width,height);\n\t};\n}\n/**\n * Creates a sepia effect on the image i.e. gives the image a yellow-brownish tone.\n */\nfunction SepiaFilter(){\n\tthis.name = \"Sepia\";\n\tthis.isDirAnimatable = true;\n\tthis.defaultValues = {\n\t\tamount : 10\n\t};\n\tthis.valueRanges = {\n\t\tamount : {min:0, max:30}\n\t};\n\n\tvar filterUtils = new FilterUtils();\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar amount = (values.amount === undefined) ? this.defaultValues.amount : values.amount;\n\t\tamount *= 255/100;\n\t\tfor (var y = 0; y < height; y++) {\n\t\t\tfor (var x = 0; x < width; x++) {\n\t\t\t\tvar pixel = (y*width + x)*4;\n\t\t\t\tvar luma = inputData[pixel]*0.3 + inputData[pixel+1]*0.59 + inputData[pixel+2]*0.11;\n\t\t\t\tvar r,g,b;\n\t\t\t\tr = g = b = luma;\n\t\t\t\tr += 40;\n\t\t\t\tg += 20;\n\t\t\t\tb -= amount;\n\n\t\t\t\tinputData[pixel] = r;\n\t\t\t\tinputData[pixel+1] = g;\n\t\t\t\tinputData[pixel+2] = b;\n\t\t\t}\n\t\t}\n\t};\n}\n/**\n * Sharpens the image slightly. For increased effect, apply the filter multiple times.\n */\nfunction SharpenFilter(){\n\tthis.name = \"Sharpen\";\n\tthis.isDirAnimatable = true;\n\tthis.defaultValues = {\n\t};\n\tthis.valueRanges = {\n\t};\n\n\tvar filterUtils = new FilterUtils();\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tvar matrix = [ 0.0,-0.2, 0.0,\n\t\t\t\t\t  -0.2, 1.8,-0.2,\n\t\t\t\t\t   0.0, -0.2, 0.0];\n\t\tfilterUtils.convolveFilter(inputData,matrix,width,height);\n\t};\n}\n/**\n * Creates ripples on the image horizontally/vertically in a sine pattern.\n */\nfunction SineRippleFilter(){\n\tthis.name = \"Sine Ripples\";\n\tthis.isDirAnimatable = false;\n\tthis.defaultValues = {\n\t\txAmplitude : 5,\n\t\tyAmplitude : 5,\n\t\txWavelength : 16,\n\t\tyWavelength : 16\n\t};\n\tthis.valueRanges = {\n\t\txAmplitude : {min:0, max:30},\n\t\tyAmplitude : {min:0, max:30},\n\t\txWavelength : {min:1, max:50},\n\t\tyWavelength : {min:1, max:50}\n\t};\n\n\tvar filterUtils = new FilterUtils();\n\n\tthis.filter = function (input, values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar xAmplitude = (values.xAmplitude === undefined) ? this.defaultValues.xAmplitude : values.xAmplitude;\n\t\tvar yAmplitude = (values.yAmplitude === undefined) ? this.defaultValues.yAmplitude : values.yAmplitude;\n\t\tvar xWavelength = (values.xWavelength === undefined) ? this.defaultValues.xWavelength : values.xWavelength;\n\t\tvar yWavelength = (values.yWavelength === undefined) ? this.defaultValues.yWavelength : values.yWavelength;\n\t\tvar transInverse = function(x,y,out){\n\t\t\tvar nx = y/xWavelength;\n\t\t\tvar ny = x/yWavelength;\n\t\t\tvar fx = Math.sin(nx);\n\t\t\tvar fy = Math.sin(ny);\n\t\t\tout[0] = x + xAmplitude * fx;\n\t\t\tout[1] = y + yAmplitude * fy;\n\t\t};\n\t\tfilterUtils.transformFilter(inputData,transInverse,width,height);\n\t};\n}\n/**\n * Produces a solarization effect on the image.\n */\nfunction SolarizeFilter(){\n\tthis.name = \"Solarize\";\n\tthis.isDirAnimatable = true;\n\tthis.defaultValues = {\n\t};\n\tthis.valueRanges = {\n\t};\n\n\tvar filterUtils = new FilterUtils();\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tvar table = [];\n\t\tfor(var i = 0; i < 256; i++){\n\t\t\tvar val = (i/255 > 0.5) ? 2*(i/255-0.5) : 2*(0.5-i/255);\n\t\t\ttable[i] = parseInt(255 * val,10);\n\t\t}\n\t\tfilterUtils.tableFilter(inputData, table, width, height);\n\t};\n}\n/**\n * Generates a sparkle/sunburst effect on the image. CenterX and CenterY specify the\n * position in terms of ratios of width and height.\n */\nfunction SparkleFilter(){\n\tthis.name = \"Sparkle\";\n\tthis.isDirAnimatable = false;\n\tthis.defaultValues = {\n\t\trays : 50,\n\t\tsize : 25,\n\t\tamount : 50,\n\t\trandomness : 25,\n\t\tcenterX : 0.5,\n\t\tcenterY : 0.5\n\t};\n\tthis.valueRanges = {\n\t\trays : {min:1, max:100},\n\t\tsize : {min:1, max:200},\n\t\tamount : {min:0, max:100},\n\t\trandomness : {min:0, max:50},\n\t\tcenterX : {min:0, max:1.0},\n\t\tcenterY : {min:0, max:1.0}\n\t};\n\n\tvar filterUtils = new FilterUtils();\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar rays = (values.rays === undefined) ? this.defaultValues.rays : values.rays;\n\t\trays = parseInt(rays, 10);\n\t\tvar size = (values.size === undefined) ? this.defaultValues.size : values.size;\n\t\tvar amount = (values.amount === undefined) ? this.defaultValues.amount : values.amount;\n\t\tvar randomness = (values.randomness === undefined) ? this.defaultValues.randomness : values.randomness;\n\t\tvar centerX = (values.centerX === undefined) ? this.defaultValues.centerX : values.centerX;\n\t\tvar centerY = (values.centerY === undefined) ? this.defaultValues.centerY : values.centerY;\n\t\tvar iCenterX = centerX * width;\n\t\tvar iCenterY = centerY * height;\n\t\tvar rayLengths = [];\n\t\tfor(var j = 0; j < rays; j++){\n\t\t\trayLengths[j]= size + randomness / 100 * size * filterUtils.gaussianRandom();\n\t\t}\n\t\tfor (var y = 0; y < height; y++) {\n\t\t\tfor (var x = 0; x < width; x++) {\n\t\t\t\tvar pixel = (y*width + x)*4;\n\t\t\t\tvar dx = x-iCenterX;\n\t\t\t\tvar dy = y-iCenterY;\n\t\t\t\tvar distance = dx*dx + dy*dy;\n\t\t\t\tvar angle = Math.atan2(dy,dx);\n\t\t\t\tvar d = (angle+Math.PI) / (Math.PI*2) * rays;\n\t\t\t\tvar i = parseInt(d,10);\n\t\t\t\tvar f = d - i;\n\t\t\t\tif(size !== 0){\n\t\t\t\t\tvar length = filterUtils.linearInterpolate(f, rayLengths[i % rays], rayLengths[(i+1) % rays]);\n\t\t\t\t\tvar g = length*length / (distance+0.0001);\n\t\t\t\t\tg = Math.pow(g, (100-amount) / 50);\n\t\t\t\t\tf -= 0.5;\n\t\t\t\t\tf = 1 - f*f;\n\t\t\t\t\tf *= g;\n\t\t\t\t}\n\t\t\t\tf = filterUtils.clampPixel(f,0,1);\n\t\t\t\tvar mixedRGB = filterUtils.mixColors(f,[inputData[pixel],inputData[pixel+1],inputData[pixel+2],inputData[pixel+3]],[255,255,255,255]);\n\t\t\t\tfor(var k = 0; k < 3; k++){\n\t\t\t\t\tinputData[pixel+k] = mixedRGB[k];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n}\n/**\n * Smears out the image with square shapes to create a painting style effect.\n * The mix values sets the intensity of the effect.\n * NOTE: This filter can be very slow, especially at higher densities/sizes. Use with caution.\n */\nfunction SquareSmearFilter(){\n\tthis.name = \"Square Smear\";\n\tthis.isDirAnimatable = false;\n\tthis.defaultValues = {\n\t\tsize : 4,\n\t\tdensity : 0.5,\n\t\tmix : 0.5\n\t};\n\tthis.valueRanges = {\n\t\tsize : {min:1, max:10},\n\t\tdensity : {min:0.0, max:1.0},\n\t\tmix : {min:0.0, max:1.0}\n\t};\n\n\tvar filterUtils = new FilterUtils();\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tvar outputData = [];\n\t\tvar k;\n\t\tfor(k = 0; k < inputData.length; k++){\n\t\t\toutputData[k] = inputData[k];\n\t\t}\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar size = (values.size === undefined) ? this.defaultValues.size : values.size;\n\t\tif(size < 1){ size = 1;}\n\t\tsize = parseInt(size,10);\n\t\tvar density = (values.density === undefined) ? this.defaultValues.density : values.density;\n\t\tvar mix = (values.mix === undefined) ? this.defaultValues.mix : values.mix;\n\t\tvar radius = size+1;\n\t\tvar radius2 = radius*radius;\n\t\tvar numShapes = parseInt(2*density/30*width*height / 2,10);\n\t\tfor(var i = 0; i < numShapes; i++){\n\t\t\tvar sx = (Math.random()*Math.pow(2,32) & 0x7fffffff) % width;\n\t\t\tvar sy = (Math.random()*Math.pow(2,32) & 0x7fffffff) % height;\n\t\t\tvar rgb2 = [inputData[(sy*width+sx)*4],inputData[(sy*width+sx)*4+1],inputData[(sy*width+sx)*4+2],inputData[(sy*width+sx)*4+3]];\n\t\t\tfor(var x = sx - radius; x < sx + radius + 1; x++){\n\n\t\t\t\tfor(var y = sy - radius; y < sy + radius + 1; y++){\n\t\t\t\t\tif (x >= 0 && x < width && y >= 0 && y < height) {\n\t\t\t\t\t\tvar rgb1 = [outputData[(y*width+x)*4],outputData[(y*width+x)*4+1],outputData[(y*width+x)*4+2],outputData[(y*width+x)*4+3]];\n\t\t\t\t\t\tvar mixedRGB = filterUtils.mixColors(mix,rgb1,rgb2);\n\t\t\t\t\t\tfor(k = 0; k < 3; k++){\n\t\t\t\t\t\t\toutputData[(y*width+x)*4+k] = mixedRGB[k];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(k = 0; k < outputData.length; k++){\n\t\t\tinputData[k] = outputData[k];\n\t\t}\n\t};\n}\n/**\n * Divides the colors into black and white following the treshold value. Brightnesses above the threshold\n * sets the color to white while values below the threshold sets the color to black.\n */\nfunction ThresholdFilter(){\n\tthis.name = \"Black & White\";\n\tthis.isDirAnimatable = true;\n\tthis.defaultValues = {\n\t\tthreshold : 127\n\t};\n\tthis.valueRanges = {\n\t\tthreshold : {min:0, max:255}\n\t};\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar threshold = (values.threshold === undefined) ? this.defaultValues.threshold : values.threshold;\n\t\tfor (var y = 0; y < height; y++) {\n\t\t\tfor (var x = 0; x < width; x++) {\n\t\t\t\tvar pixel = (y*width + x)*4;\n\t\t\t\tvar brightness = (inputData[pixel] + inputData[pixel+1] + inputData[pixel+2])/3;\n\t\t\t\tvar colorVal = 0;\n\t\t\t\tif(brightness > threshold){\n\t\t\t\t\tcolorVal = 255;\n\t\t\t\t}\n\t\t\t\tinputData[pixel] = inputData[pixel+1] = inputData[pixel+2] = colorVal;\n\t\t\t}\n\t\t}\n\t};\n}\n/**\n * Creates ripples on the image horizontally/vertically in a sine pattern.\n */\nfunction TriangleRippleFilter(){\n\tthis.name = \"Triangle Ripples\";\n\tthis.isDirAnimatable = false;\n\tthis.defaultValues = {\n\t\txAmplitude : 5,\n\t\tyAmplitude : 5,\n\t\txWavelength : 16,\n\t\tyWavelength : 16\n\t};\n\tthis.valueRanges = {\n\t\txAmplitude : {min:0, max:30},\n\t\tyAmplitude : {min:0, max:30},\n\t\txWavelength : {min:1, max:50},\n\t\tyWavelength : {min:1, max:50}\n\t};\n\n\tvar filterUtils = new FilterUtils();\n\n\tthis.filter = function (input, values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar xAmplitude = (values.xAmplitude === undefined) ? this.defaultValues.xAmplitude : values.xAmplitude;\n\t\tvar yAmplitude = (values.yAmplitude === undefined) ? this.defaultValues.yAmplitude : values.yAmplitude;\n\t\tvar xWavelength = (values.xWavelength === undefined) ? this.defaultValues.xWavelength : values.xWavelength;\n\t\tvar yWavelength = (values.yWavelength === undefined) ? this.defaultValues.yWavelength : values.yWavelength;\n\t\tvar transInverse = function(x,y,out){\n\t\t\tvar nx = y/xWavelength;\n\t\t\tvar ny = x/yWavelength;\n\t\t\tvar fx = filterUtils.triangle(nx,1);\n\t\t\tvar fy = filterUtils.triangle(ny,1);\n\t\t\tout[0] = x + xAmplitude * fx;\n\t\t\tout[1] = y + yAmplitude * fy;\n\t\t};\n\t\tfilterUtils.transformFilter(inputData,transInverse,width,height);\n\t};\n}\n/**\n * Twists the image around a given center point. CenterX and CenterY specify the\n * position in terms of ratios of width and height.\n */\nfunction TwirlFilter(){\n\tthis.name = \"Twirl\";\n\tthis.isDirAnimatable = false;\n\tthis.defaultValues = {\n\t\tradius : 100,\n\t\tangle : 180,\n\t\tcenterX : 0.5,\n\t\tcenterY : 0.5\n\t};\n\tthis.valueRanges = {\n\t\tradius : {min: 1, max: 200},\n\t\tangle : {min: 0, max: 360},\n\t\tcenterX : {min: 0.0, max:1.0},\n\t\tcenterY : {min: 0.0, max:1.0}\n\t};\n\n\tvar filterUtils = new FilterUtils();\n\n\tthis.filter = function (input, values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar angle = (values.angle === undefined) ? this.defaultValues.angle : values.angle;\n\t\tvar centerX = (values.centerX === undefined) ? this.defaultValues.centerX : values.centerX;\n\t\tvar centerY = (values.centerY === undefined) ? this.defaultValues.centerY : values.centerY;\n\t\tvar radius = (values.radius === undefined) ? this.defaultValues.radius : values.radius;\n\t\tvar radius2 = radius*radius;\n\t\tangle = angle/180 * Math.PI;\n\t\tvar iCenterX = width * centerX; var iCenterY = height * centerY;\n\t\tvar transInverse = function(x,y,out){\n\t\t\tvar dx = x-iCenterX;\n\t\t\tvar dy = y-iCenterY;\n\t\t\tvar distance = dx*dx + dy*dy;\n\t\t\tif(distance > radius2){\n\t\t\t\tout[0] = x;\n\t\t\t\tout[1] = y;\n\t\t\t} else {\n\t\t\t\tdistance = Math.sqrt(distance);\n\t\t\t\tvar a = Math.atan2(dy, dx) + angle * (radius-distance) / radius;\n\t\t\t\tout[0] = iCenterX + distance*Math.cos(a);\n\t\t\t\tout[1] = iCenterY + distance*Math.sin(a);\n\t\t\t}\n\t\t};\n\t\tfilterUtils.transformFilter(inputData,transInverse,width,height);\n\t};\n}\n/**\n * Creates a classical vignette effect on the image i.e. darkens the corners.\n */\nfunction VignetteFilter(){\n\tthis.name = \"Vignette\";\n\tthis.isDirAnimatable = false;\n\tthis.defaultValues = {\n\t\tamount : 0.3\n\t};\n\tthis.valueRanges = {\n\t\tamount : {min:0.0, max:1.0}\n\t};\n\tthis.filter = function(input,values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tvar outputData = [];\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar amount = (values.amount === undefined) ? this.defaultValues.amount : values.amount;\n\t\tvar canvas = document.createElement(\"canvas\");\n\t\tcanvas.width = width;\n\t\tcanvas.height = height;\n\t\tvar context = canvas.getContext(\"2d\");\n\t\tvar gradient;\n\t\tvar radius = Math.sqrt( Math.pow(width/2, 2) + Math.pow(height/2, 2) );\n\t\tcontext.putImageData(input,0,0);\n\t\tcontext.globalCompositeOperation = 'source-over';\n\n\t\tgradient = context.createRadialGradient(width/2, height/2, 0, width/2, height/2, radius);\n\t\tgradient.addColorStop(0, 'rgba(0,0,0,0)');\n\t\tgradient.addColorStop(0.5, 'rgba(0,0,0,0)');\n\t\tgradient.addColorStop(1, 'rgba(0,0,0,' + amount + ')');\n\t\tcontext.fillStyle = gradient;\n\t\tcontext.fillRect(0, 0, width, height);\n\t\toutputData = context.getImageData(0,0,width,height).data;\n\t\tfor(var k = 0; k < outputData.length; k++){\n\t\t\tinputData[k] = outputData[k];\n\t\t}\n\t};\n}\n/**\n * Produces a water ripple/waves on the image. CenterX and CenterY specify the\n * position in terms of ratios of width and height.\n */\nfunction WaterRippleFilter(){\n\tthis.name = \"Water Ripples\";\n\tthis.isDirAnimatable = false;\n\tthis.defaultValues = {\n\t\tphase : 0,\n\t\tradius : 50,\n\t\twavelength : 16,\n\t\tamplitude : 10,\n\t\tcenterX : 0.5,\n\t\tcenterY : 0.5\n\t};\n\tthis.valueRanges = {\n\t\tphase : {min: 0, max: 100},\n\t\tradius : {min: 1, max: 200},\n\t\twavelength : {min: 1, max: 100},\n\t\tamplitude : {min: 1, max: 100},\n\t\tcenterX : {min: 0.0, max:1.0},\n\t\tcenterY : {min: 0.0, max:1.0}\n\t};\n\tvar filterUtils = new FilterUtils();\n\n\tthis.filter = function (input, values){\n\t\tvar width = input.width, height = input.height;\n\t\tvar inputData = input.data;\n\t\tif(values === undefined){ values = this.defaultValues; }\n\t\tvar wavelength = (values.wavelength === undefined) ? this.defaultValues.wavelength : values.wavelength;\n\t\tvar amplitude = (values.amplitude === undefined) ? this.defaultValues.amplitude : values.amplitude;\n\t\tvar phase = (values.phase === undefined) ? this.defaultValues.phase : values.phase;\n\t\tvar centerX = (values.centerX === undefined) ? this.defaultValues.centerX : values.centerX;\n\t\tvar centerY = (values.centerY === undefined) ? this.defaultValues.centerY : values.centerY;\n\t\tvar radius = (values.radius === undefined) ? this.defaultValues.radius : values.radius;\n\t\tvar radius2 = radius*radius;\n\t\tvar iCenterX = width * centerX; var iCenterY = height * centerY;\n\t\tvar transInverse = function(x,y,out){\n\t\t\tvar dx = x-iCenterX;\n\t\t\tvar dy = y-iCenterY;\n\t\t\tvar distance2 = dx*dx + dy*dy;\n\t\t\tif(distance2 > radius2){\n\t\t\t\tout[0] = x;\n\t\t\t\tout[1] = y;\n\t\t\t} else {\n\t\t\t\tvar distance = Math.sqrt(distance2);\n\t\t\t\tvar amount = amplitude * Math.sin(distance/wavelength * Math.PI * 2 - phase);\n\t\t\t\tamount *= (radius-distance)/radius;\n\t\t\t\tif(distance !== 0){\n\t\t\t\t\tamount *= wavelength/distance;\n\t\t\t\t}\n\t\t\t\tout[0] = x + dx*amount;\n\t\t\t\tout[1] = y + dy*amount;\n\t\t\t}\n\t\t};\n\t\tfilterUtils.transformFilter(inputData,transInverse,width,height);\n\t};\n}\n/**\n * A collection of all the filters.\n */\nvar JSManipulate = {\n\tblur : new BlurFilter(),\n\tbrightness : new BrightnessFilter(),\n\tbump : new BumpFilter(),\n\tcirclesmear : new CircleSmearFilter(),\n\tcontrast : new ContrastFilter(),\n\tcrosssmear : new CrossSmearFilter(),\n\tdiffusion : new DiffusionFilter(),\n\tdither : new DitherFilter(),\n\tedge : new EdgeFilter(),\n\temboss : new EmbossFilter(),\n\texposure : new ExposureFilter(),\n\tgain : new GainFilter(),\n\tgamma : new GammaFilter(),\n\tgrayscale : new GrayscaleFilter(),\n\thue : new HueFilter(),\n\tinvert : new InvertFilter(),\n\tkaleidoscope : new KaleidoscopeFilter(),\n\tlensdistortion : new LensDistortionFilter(),\n\tlinesmear : new LineSmearFilter(),\n\tmaximum : new MaximumFilter(),\n\tmedian : new MedianFilter(),\n\tminimum : new MinimumFilter(),\n\tnoise : new NoiseFilter(),\n\toil : new OilFilter(),\n\topacity : new OpacityFilter(),\n\tpinch : new PinchFilter(),\n\tpixelate : new PixelationFilter(),\n\tposterize : new PosterizeFilter(),\n\trgbadjust : new RGBAdjustFilter(),\n\tsaturation : new SaturationFilter(),\n\tsawtoothripple : new SawtoothRippleFilter(),\n\tsepia : new SepiaFilter(),\n\tsharpen : new SharpenFilter(),\n\tsineripple : new SineRippleFilter(),\n\tsolarize : new SolarizeFilter(),\n\tsparkle : new SparkleFilter(),\n\tsquaresmear : new SquareSmearFilter(),\n\tthreshold : new ThresholdFilter(),\n\ttriangleripple : new TriangleRippleFilter(),\n\ttwirl : new TwirlFilter(),\n\tvignette : new VignetteFilter(),\n\twaterripple : new WaterRippleFilter()\n};\n\n\n\nvar ImageFilters = JSManipulate;\n\n\n//Attach to Gamelab object\nGamelab.ImageFilters = ImageFilters;\n;/**\r\n * Creates Gamelab.js Canvas: The canvas-renderer for Gamelab games.\r\n\r\n @description\r\n This Canvas library handles the low-level drawing of Gamelab.Animation objects on HTML5Canvas.\r\n -Draws Sprites according to their rotation, size, and properties.\r\n * @returns {CanvasLib} a CanvasLib object.\r\n */\r\n\r\n(function() {\r\n\r\n  console.log('CanvasStack class... creating');\r\n\r\n  class GamelabCanvas {\r\n\r\n    constructor() {\r\n\r\n      this.__levelMaker = false;\r\n\r\n      //draw is synonymous w/ drawSprite\r\n      this.draw = this.draw_object;\r\n    }\r\n\r\n    isStopped() {\r\n\r\n      return Gamelab.stopDraw || false;\r\n\r\n    }\r\n\r\n    arc(p1, p2, options = {}) {\r\n\r\n      if (this.isStopped())\r\n        return;\r\n\r\n\r\n      var ctx = Gamelab.game_windows[0].ctx;\r\n\r\n      ctx.strokeStyle = 'aqua';\r\n\r\n      ctx.beginPath();\r\n      ctx.arc(p1.x, p1.y, p2.x, p2.y, Math.PI * 2, true);\r\n      ctx.stroke();\r\n\r\n    }\r\n\r\n    draw_image_frame(image, framePos, frameSize, position, size, rotation, canvasContext, flipX, flipY, origin) {\r\n\r\n      if (this.isStopped())\r\n        return;\r\n\r\n\r\n      var fx = framePos.x,\r\n        fy = framePos.y,\r\n        fw = frameSize.x,\r\n        fh = frameSize.y,\r\n        x = position.x,\r\n        y = position.y,\r\n        width = size.x,\r\n        height = size.y;\r\n\r\n\r\n      //save canvas state before draw\r\n      canvasContext.save();\r\n\r\n      //degrees rotation:\r\n      var deg = Math.round(rotation);\r\n      deg = deg % 360;\r\n      var rad = deg * Math.PI / 180;\r\n      //Set the origin to the center of the image\r\n      canvasContext.translate(x, y);\r\n      canvasContext.rotate(rad);\r\n      //Rotate the canvas around the origin\r\n\r\n      canvasContext.translate(0, canvasContext.width);\r\n\r\n      if (flipX) {\r\n\r\n        canvasContext.scale(-1, 1);\r\n      } else {\r\n\r\n      }\r\n\r\n      if (flipY) {\r\n\r\n        canvasContext.scale(1, -1);\r\n      } else {\r\n\r\n      }\r\n\r\n      origin = origin || new Gamelab.Vector(width / 2, height / 2);\r\n\r\n      //draw the image\r\n      canvasContext.drawImage(image, fx, fy, fw, fh, origin.x * (-1), origin.y * (-1), width, height);\r\n      //reset the canvas\r\n\r\n      canvasContext.restore();\r\n\r\n    }\r\n\r\n    draw_data(x, y, w, h, data, ctx) {\r\n\r\n      if (this.isStopped())\r\n        return;\r\n\r\n\r\n      ctx.putImageData(data, x, y, 0, 0, w, h);\r\n\r\n    }\r\n  }\r\n\r\n\r\n  Gamelab.Canvas = new GamelabCanvas();\r\n\r\n  Gamelab.GamelabCanvas = GamelabCanvas;\r\n\r\n  class OffscreenCanvasRendering {\r\n    constructor(psuedoImage) {\r\n\r\n      I('StashToCanvas():');\r\n\r\n      this.htmlImage = psuedoImage.domElement || psuedoImage;\r\n\r\n      this.testCanvas = document.createElement(\"CANVAS\");\r\n\r\n      this.testCtx = this.testCanvas.getContext(\"2d\");\r\n\r\n      this.testCanvas.width = this.htmlImage.width;\r\n\r\n      this.testCanvas.height = this.htmlImage.height;\r\n\r\n      this.testCanvas.style.zIndex = '9999';\r\n\r\n      this.testCtx.drawImage(this.htmlImage, 0, 0);\r\n\r\n      return {\r\n        canvas: this.testCanvas,\r\n        ctx: this.testCtx\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  Gamelab.OffscreenCanvasRendering = OffscreenCanvasRendering;\r\n\r\n})();\r\n;if (typeof JSON.decycle !== 'function') {\r\n    JSON.decycle = function decycle(object) {\r\n        \"use strict\";\r\n\r\n        var objects = [],   // Keep a reference to each unique object or array\r\n            paths = [];     // Keep the path to each unique object or array\r\n\r\n        return (function derez(value, path) {\r\n\r\n\r\n            var i,          // The loop counter\r\n                name,       // Property name\r\n                nu;         // The new object or array\r\n\r\n            switch (typeof value) {\r\n            case 'object':\r\n\r\n                if (!value) {\r\n                    return null;\r\n                }\r\n\r\n\r\n                for (i = 0; i < objects.length; i += 1) {\r\n                    if (objects[i] === value) {\r\n                        return {$ref: paths[i]};\r\n                    }\r\n                }\r\n\r\n// Otherwise, accumulate the unique value and its path.\r\n\r\n                objects.push(value);\r\n                paths.push(path);\r\n\r\n// If it is an array, replicate the array.\r\n\r\n                if (Object.prototype.toString.apply(value) === '[object Array]') {\r\n                    nu = [];\r\n                    for (i = 0; i < value.length; i += 1) {\r\n                        nu[i] = derez(value[i], path + '[' + i + ']');\r\n                    }\r\n                } else {\r\n\r\n// If it is an object, replicate the object.\r\n\r\n                    nu = {};\r\n                    for (name in value) {\r\n                        if (Object.prototype.hasOwnProperty.call(value, name)) {\r\n                            nu[name] = derez(value[name],\r\n                                path + '[' + JSON.stringify(name) + ']');\r\n                        }\r\n                    }\r\n                }\r\n                return nu;\r\n            case 'number':\r\n            case 'string':\r\n            case 'boolean':\r\n                return value;\r\n            }\r\n        }(object, '$'));\r\n    };\r\n}\r\n\r\nif (typeof JSON.retrocycle !== 'function') {\r\n    JSON.retrocycle = function retrocycle($) {\r\n        \"use strict\";\r\n\r\n        var px =\r\n            /^\\$(?:\\[(?:\\d?|\\\"(?:[^\\\\\\\"\\u0000-\\u001f]|\\\\([\\\\\\\"\\/bfnrt]|u[0-9a-zA-Z]{4}))*\\\")\\])*$/;\r\n\r\n        (function rez(value) {\r\n\r\n            var i, item, name, path;\r\n\r\n            if (value && typeof value === 'object') {\r\n                if (Object.prototype.toString.apply(value) === '[object Array]') {\r\n                    for (i = 0; i < value.length; i += 1) {\r\n                        item = value[i];\r\n                        if (item && typeof item === 'object') {\r\n                            path = item.$ref;\r\n                            if (typeof path === 'string' && px.test(path)) {\r\n                                value[i] = eval(path);\r\n                            } else {\r\n                                rez(item);\r\n                            }\r\n                        }\r\n                    }\r\n                } else {\r\n                    for (name in value) {\r\n                        if (typeof value[name] === 'object') {\r\n                            item = value[name];\r\n                            if (item) {\r\n                                path = item.$ref;\r\n                                if (typeof path === 'string' && px.test(path)) {\r\n                                    value[name] = eval(path);\r\n                                } else {\r\n                                    rez(item);\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }($));\r\n        return $;\r\n    };\r\n}\r\n\r\nvar json_stringify = JSON.stringify;\r\n\r\nJSON.stringify = function(object, arg2, arg3)\r\n{\r\n  var clean_object = JSON.decycle(object);\r\n  return json_stringify(clean_object, arg2, arg3);\r\n};\r\n\r\nvar json_parse = JSON.parse;\r\n\r\nJSON.parse = function(object, arg2, arg3){\r\n  var retro_object = JSON.retrocycle(object);\r\n  return json_parse(retro_object);\r\n};\r\n;/**\r\n * @author mrdoob / http://mrdoob.com/\r\n */\r\n\r\n\r\n/***************\r\n *\r\n * @ignore\r\n *\r\n * *****************/\r\n\r\nvar Stats = function () {\r\n\r\n\tvar mode = 0;\r\n\r\n\tvar container = document.createElement( 'div' );\r\n\tcontainer.style.cssText = 'position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000';\r\n\tcontainer.addEventListener( 'click', function ( event ) {\r\n\r\n\t\tevent.preventDefault();\r\n\t\tshowPanel( ++ mode % container.children.length );\r\n\r\n\t}, false );\r\n\r\n\t//\r\n\r\n\tfunction addPanel( panel ) {\r\n\r\n\t\tcontainer.appendChild( panel.dom );\r\n\t\treturn panel;\r\n\r\n\t}\r\n\r\n\tfunction showPanel( id ) {\r\n\r\n\t\tfor ( var i = 0; i < container.children.length; i ++ ) {\r\n\r\n\t\t\tcontainer.children[ i ].style.display = i === id ? 'block' : 'none';\r\n\r\n\t\t}\r\n\r\n\t\tmode = id;\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tvar beginTime = ( performance || Date ).now(), prevTime = beginTime, frames = 0;\r\n\r\n\tvar fpsPanel = addPanel( new Stats.Panel( 'FPS', '#0ff', '#002' ) );\r\n\tvar msPanel = addPanel( new Stats.Panel( 'MS', '#0f0', '#020' ) );\r\n\r\n\tif ( self.performance && self.performance.memory ) {\r\n\r\n\t\tvar memPanel = addPanel( new Stats.Panel( 'MB', '#f08', '#201' ) );\r\n\r\n\t}\r\n\r\n\tshowPanel( 0 );\r\n\r\n\treturn {\r\n\r\n\t\tREVISION: 16,\r\n\r\n\t\tdom: container,\r\n\r\n\t\taddPanel: addPanel,\r\n\t\tshowPanel: showPanel,\r\n\r\n\t\tbegin: function () {\r\n\r\n\t\t\tbeginTime = ( performance || Date ).now();\r\n\r\n\t\t},\r\n\r\n\t\tend: function () {\r\n\r\n\t\t\tframes ++;\r\n\r\n\t\t\tvar time = ( performance || Date ).now();\r\n\r\n\t\t\tmsPanel.update( time - beginTime, 200 );\r\n\r\n\t\t\tif ( time >= prevTime + 1000 ) {\r\n\r\n\t\t\t\tfpsPanel.update( ( frames * 1000 ) / ( time - prevTime ), 100 );\r\n\r\n\t\t\t\tprevTime = time;\r\n\t\t\t\tframes = 0;\r\n\r\n\t\t\t\tif ( memPanel ) {\r\n\r\n\t\t\t\t\tvar memory = performance.memory;\r\n\t\t\t\t\tmemPanel.update( memory.usedJSHeapSize / 1048576, memory.jsHeapSizeLimit / 1048576 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn time;\r\n\r\n\t\t},\r\n\r\n\t\tupdate: function () {\r\n\r\n\t\t\tbeginTime = this.end();\r\n\r\n\t\t},\r\n\r\n\t\t// Backwards Compatibility\r\n\r\n\t\tdomElement: container,\r\n\t\tsetMode: showPanel\r\n\r\n\t};\r\n\r\n};\r\n\r\nStats.Panel = function ( name, fg, bg ) {\r\n\r\n\tvar min = Infinity, max = 0, round = Math.round;\r\n\tvar PR = round( window.devicePixelRatio || 1 );\r\n\r\n\tvar WIDTH = 80 * PR, HEIGHT = 48 * PR,\r\n\t\t\tTEXT_X = 3 * PR, TEXT_Y = 2 * PR,\r\n\t\t\tGRAPH_X = 3 * PR, GRAPH_Y = 15 * PR,\r\n\t\t\tGRAPH_WIDTH = 74 * PR, GRAPH_HEIGHT = 30 * PR;\r\n\r\n\tvar canvas = document.createElement( 'canvas' );\r\n\tcanvas.width = WIDTH;\r\n\tcanvas.height = HEIGHT;\r\n\tcanvas.style.cssText = 'width:80px;height:48px';\r\n\r\n\tvar context = canvas.getContext( '2d' );\r\n\tcontext.font = 'bold ' + ( 9 * PR ) + 'px Helvetica,Arial,sans-serif';\r\n\tcontext.textBaseline = 'top';\r\n\r\n\tcontext.fillStyle = bg;\r\n\tcontext.fillRect( 0, 0, WIDTH, HEIGHT );\r\n\r\n\tcontext.fillStyle = fg;\r\n\tcontext.fillText( name, TEXT_X, TEXT_Y );\r\n\tcontext.fillRect( GRAPH_X, GRAPH_Y, GRAPH_WIDTH, GRAPH_HEIGHT );\r\n\r\n\tcontext.fillStyle = bg;\r\n\tcontext.globalAlpha = 0.9;\r\n\tcontext.fillRect( GRAPH_X, GRAPH_Y, GRAPH_WIDTH, GRAPH_HEIGHT );\r\n\r\n\treturn {\r\n\r\n\t\tdom: canvas,\r\n\r\n\t\tupdate: function ( value, maxValue ) {\r\n\r\n\t\t\tmin = Math.min( min, value );\r\n\t\t\tmax = Math.max( max, value );\r\n\r\n\t\t\tcontext.fillStyle = bg;\r\n\t\t\tcontext.globalAlpha = 1;\r\n\t\t\tcontext.fillRect( 0, 0, WIDTH, GRAPH_Y );\r\n\t\t\tcontext.fillStyle = fg;\r\n\t\t\tcontext.fillText( round( value ) + ' ' + name + ' (' + round( min ) + '-' + round( max ) + ')', TEXT_X, TEXT_Y );\r\n\r\n\t\t\tcontext.drawImage( canvas, GRAPH_X + PR, GRAPH_Y, GRAPH_WIDTH - PR, GRAPH_HEIGHT, GRAPH_X, GRAPH_Y, GRAPH_WIDTH - PR, GRAPH_HEIGHT );\r\n\r\n\t\t\tcontext.fillRect( GRAPH_X + GRAPH_WIDTH - PR, GRAPH_Y, PR, GRAPH_HEIGHT );\r\n\r\n\t\t\tcontext.fillStyle = bg;\r\n\t\t\tcontext.globalAlpha = 0.9;\r\n\t\t\tcontext.fillRect( GRAPH_X + GRAPH_WIDTH - PR, GRAPH_Y, PR, round( ( 1 - ( value / maxValue ) ) * GRAPH_HEIGHT ) );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n};\r\n;/**\r\n * Tween.js - Licensed under the MIT license\r\n * https://github.com/tweenjs/tween.js\r\n * ----------------------------------------------\r\n *\r\n * See https://github.com/tweenjs/tween.js/graphs/contributors for the full list of contributors.\r\n * Thank you all, you're awesome!\r\n */\r\n\r\n\r\n/*\r\n*\r\n* @ignore\r\n*\r\n* */\r\n\r\nvar TWEEN = TWEEN || (function () {\r\n\r\n\tvar _tweens = [];\r\n\r\n\treturn {\r\n\r\n\t\tgetAll: function () {\r\n\r\n\t\t\treturn _tweens;\r\n\r\n\t\t},\r\n\r\n\t\tremoveAll: function () {\r\n\r\n\t\t\t_tweens = [];\r\n\r\n\t\t},\r\n\r\n\t\tadd: function (tween) {\r\n\r\n\t\t\t_tweens.push(tween);\r\n\r\n\t\t},\r\n\r\n\t\tremove: function (tween) {\r\n\r\n\t\t\tvar i = _tweens.indexOf(tween);\r\n\r\n\t\t\tif (i !== -1) {\r\n\t\t\t\t_tweens.splice(i, 1);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tupdate: function (time, preserve) {\r\n\r\n\t\t\tif (_tweens.length === 0) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tvar i = 0;\r\n\r\n\t\t\ttime = time !== undefined ? time : TWEEN.now();\r\n\r\n\t\t\twhile (i < _tweens.length) {\r\n\r\n\t\t\t\tif (_tweens[i].update(time) || preserve) {\r\n\t\t\t\t\ti++;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t_tweens.splice(i, 1);\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\t};\r\n\r\n})();\r\n\r\n//removed polyfill\r\n\r\nTWEEN.now = Date.now;\r\n\r\nTWEEN.Tween = function (object) {\r\n\r\n\tvar _object = object;\r\n\tvar _valuesStart = {};\r\n\tvar _valuesEnd = {};\r\n\tvar _valuesStartRepeat = {};\r\n\tvar _duration = 1000;\r\n\tvar _repeat = 0;\r\n\tvar _repeatDelayTime;\r\n\tvar _yoyo = false;\r\n\tvar _isPlaying = false;\r\n\tvar _reversed = false;\r\n\tvar _delayTime = 0;\r\n\tvar _startTime = null;\r\n\tvar _easingFunction = TWEEN.Easing.Linear.None;\r\n\tvar _interpolationFunction = TWEEN.Interpolation.Linear;\r\n\tvar _chainedTweens = [];\r\n\tvar _onStartCallback = null;\r\n\tvar _onStartCallbackFired = false;\r\n\tvar _onUpdateCallback = null;\r\n\tvar _onCompleteCallback = null;\r\n\tvar _onStopCallback = null;\r\n\r\n\t// Set all starting values present on the target object\r\n\tfor (var field in object) {\r\n\t\t_valuesStart[field] = parseFloat(object[field], 10);\r\n\t}\r\n\r\n\tthis.to = function (properties, duration) {\r\n\r\n\t\tif (duration !== undefined) {\r\n\t\t\t_duration = duration;\r\n\t\t}\r\n\r\n\t\t_valuesEnd = properties;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.start = function (time) {\r\n\r\n\t\tTWEEN.add(this);\r\n\r\n\t\t_isPlaying = true;\r\n\r\n\t\t_onStartCallbackFired = false;\r\n\r\n\t\t_startTime = time !== undefined ? time : TWEEN.now();\r\n\t\t_startTime += _delayTime;\r\n\r\n\t\tfor (var property in _valuesEnd) {\r\n\r\n\t\t\t// Check if an Array was provided as property value\r\n\t\t\tif (_valuesEnd[property] instanceof Array) {\r\n\r\n\t\t\t\tif (_valuesEnd[property].length === 0) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Create a local copy of the Array with the start value at the front\r\n\t\t\t\t_valuesEnd[property] = [_object[property]].concat(_valuesEnd[property]);\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// If `to()` specifies a property that doesn't exist in the source object,\r\n\t\t\t// we should not set that property in the object\r\n\t\t\tif (_object[property] === undefined) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\t_valuesStart[property] = _object[property];\r\n\r\n\t\t\tif ((_valuesStart[property] instanceof Array) === false) {\r\n\t\t\t\t_valuesStart[property] *= 1.0; // Ensures we're using numbers, not strings\r\n\t\t\t}\r\n\r\n\t\t\t_valuesStartRepeat[property] = _valuesStart[property] || 0;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.stop = function () {\r\n\r\n\t\tif (!_isPlaying) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tTWEEN.remove(this);\r\n\t\t_isPlaying = false;\r\n\r\n\t\tif (_onStopCallback !== null) {\r\n\t\t\t_onStopCallback.call(_object, _object);\r\n\t\t}\r\n\r\n\t\tthis.stopChainedTweens();\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.end = function () {\r\n\r\n\t\tthis.update(_startTime + _duration);\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.stopChainedTweens = function () {\r\n\r\n\t\tfor (var i = 0, numChainedTweens = _chainedTweens.length; i < numChainedTweens; i++) {\r\n\t\t\t_chainedTweens[i].stop();\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.delay = function (amount) {\r\n\r\n\t\t_delayTime = amount;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.repeat = function (times) {\r\n\r\n\t\t_repeat = times;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.repeatDelay = function (amount) {\r\n\r\n\t\t_repeatDelayTime = amount;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.yoyo = function (yoyo) {\r\n\r\n\t\t_yoyo = yoyo;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\r\n\tthis.easing = function (easing) {\r\n\r\n\t\t_easingFunction = easing;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.interpolation = function (interpolation) {\r\n\r\n\t\t_interpolationFunction = interpolation;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.chain = function () {\r\n\r\n\t\t_chainedTweens = arguments;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.onStart = function (callback) {\r\n\r\n\t\t_onStartCallback = callback;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.onUpdate = function (callback) {\r\n\r\n\t\t_onUpdateCallback = callback;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.onComplete = function (callback) {\r\n\r\n\t\t_onCompleteCallback = callback;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.onStop = function (callback) {\r\n\r\n\t\t_onStopCallback = callback;\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tthis.update = function (time) {\r\n\r\n\t\tvar property;\r\n\t\tvar elapsed;\r\n\t\tvar value;\r\n\r\n\t\tif (time < _startTime) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tif (_onStartCallbackFired === false) {\r\n\r\n\t\t\tif (_onStartCallback !== null) {\r\n\t\t\t\t_onStartCallback.call(_object, _object);\r\n\t\t\t}\r\n\r\n\t\t\t_onStartCallbackFired = true;\r\n\t\t}\r\n\r\n\t\telapsed = (time - _startTime) / _duration;\r\n\t\telapsed = elapsed > 1 ? 1 : elapsed;\r\n\r\n\t\tvalue = _easingFunction(elapsed);\r\n\r\n\t\tfor (property in _valuesEnd) {\r\n\r\n\t\t\t// Don't update properties that do not exist in the source object\r\n\t\t\tif (_valuesStart[property] === undefined) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tvar start = _valuesStart[property] || 0;\r\n\t\t\tvar end = _valuesEnd[property];\r\n\r\n\t\t\tif (end instanceof Array) {\r\n\r\n\t\t\t\t_object[property] = _interpolationFunction(end, value);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// Parses relative end values with start as base (e.g.: +10, -3)\r\n\t\t\t\tif (typeof (end) === 'string') {\r\n\r\n\t\t\t\t\tif (end.charAt(0) === '+' || end.charAt(0) === '-') {\r\n\t\t\t\t\t\tend = start + parseFloat(end, 10);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tend = parseFloat(end, 10);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Protect against non numeric properties.\r\n\t\t\t\tif (typeof (end) === 'number') {\r\n\t\t\t\t\t_object[property] = start + (end - start) * value;\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif (_onUpdateCallback !== null) {\r\n\t\t\t_onUpdateCallback.call(_object, value);\r\n\t\t}\r\n\r\n\t\tif (elapsed === 1) {\r\n\r\n\t\t\tif (_repeat > 0) {\r\n\r\n\t\t\t\tif (isFinite(_repeat)) {\r\n\t\t\t\t\t_repeat--;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Reassign starting values, restart by making startTime = now\r\n\t\t\t\tfor (property in _valuesStartRepeat) {\r\n\r\n\t\t\t\t\tif (typeof (_valuesEnd[property]) === 'string') {\r\n\t\t\t\t\t\t_valuesStartRepeat[property] = _valuesStartRepeat[property] + parseFloat(_valuesEnd[property], 10);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (_yoyo) {\r\n\t\t\t\t\t\tvar tmp = _valuesStartRepeat[property];\r\n\r\n\t\t\t\t\t\t_valuesStartRepeat[property] = _valuesEnd[property];\r\n\t\t\t\t\t\t_valuesEnd[property] = tmp;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t_valuesStart[property] = _valuesStartRepeat[property];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (_yoyo) {\r\n\t\t\t\t\t_reversed = !_reversed;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (_repeatDelayTime !== undefined) {\r\n\t\t\t\t\t_startTime = time + _repeatDelayTime;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t_startTime = time + _delayTime;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif (_onCompleteCallback !== null) {\r\n\r\n\t\t\t\t\t_onCompleteCallback.call(_object, _object);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (var i = 0, numChainedTweens = _chainedTweens.length; i < numChainedTweens; i++) {\r\n\t\t\t\t\t// Make the chained tweens start exactly at the time they should,\r\n\t\t\t\t\t// even if the `update()` method was called way past the duration of the tween\r\n\t\t\t\t\t_chainedTweens[i].start(_startTime + _duration);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t};\r\n\r\n};\r\n\r\n\r\nTWEEN.Easing = {\r\n\r\n\tLinear: {\r\n\r\n\t\tNone: function (k) {\r\n\r\n\t\t\treturn k;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tQuadratic: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\treturn k * k;\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\treturn k * (2 - k);\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tif ((k *= 2) < 1) {\r\n\t\t\t\treturn 0.5 * k * k;\r\n\t\t\t}\r\n\r\n\t\t\treturn - 0.5 * (--k * (k - 2) - 1);\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tCubic: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\treturn k * k * k;\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\treturn --k * k * k + 1;\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tif ((k *= 2) < 1) {\r\n\t\t\t\treturn 0.5 * k * k * k;\r\n\t\t\t}\r\n\r\n\t\t\treturn 0.5 * ((k -= 2) * k * k + 2);\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tQuartic: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\treturn k * k * k * k;\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\treturn 1 - (--k * k * k * k);\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tif ((k *= 2) < 1) {\r\n\t\t\t\treturn 0.5 * k * k * k * k;\r\n\t\t\t}\r\n\r\n\t\t\treturn - 0.5 * ((k -= 2) * k * k * k - 2);\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tQuintic: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\treturn k * k * k * k * k;\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\treturn --k * k * k * k * k + 1;\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tif ((k *= 2) < 1) {\r\n\t\t\t\treturn 0.5 * k * k * k * k * k;\r\n\t\t\t}\r\n\r\n\t\t\treturn 0.5 * ((k -= 2) * k * k * k * k + 2);\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tSinusoidal: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\treturn 1 - Math.cos(k * Math.PI / 2);\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\treturn Math.sin(k * Math.PI / 2);\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\treturn 0.5 * (1 - Math.cos(Math.PI * k));\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tExponential: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\treturn k === 0 ? 0 : Math.pow(1024, k - 1);\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\treturn k === 1 ? 1 : 1 - Math.pow(2, - 10 * k);\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tif (k === 0) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\r\n\t\t\tif (k === 1) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\r\n\t\t\tif ((k *= 2) < 1) {\r\n\t\t\t\treturn 0.5 * Math.pow(1024, k - 1);\r\n\t\t\t}\r\n\r\n\t\t\treturn 0.5 * (- Math.pow(2, - 10 * (k - 1)) + 2);\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tCircular: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\treturn 1 - Math.sqrt(1 - k * k);\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\treturn Math.sqrt(1 - (--k * k));\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tif ((k *= 2) < 1) {\r\n\t\t\t\treturn - 0.5 * (Math.sqrt(1 - k * k) - 1);\r\n\t\t\t}\r\n\r\n\t\t\treturn 0.5 * (Math.sqrt(1 - (k -= 2) * k) + 1);\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tElastic: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\tif (k === 0) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\r\n\t\t\tif (k === 1) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\r\n\t\t\treturn -Math.pow(2, 10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI);\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\tif (k === 0) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\r\n\t\t\tif (k === 1) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\r\n\t\t\treturn Math.pow(2, -10 * k) * Math.sin((k - 0.1) * 5 * Math.PI) + 1;\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tif (k === 0) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\r\n\t\t\tif (k === 1) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\r\n\t\t\tk *= 2;\r\n\r\n\t\t\tif (k < 1) {\r\n\t\t\t\treturn -0.5 * Math.pow(2, 10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI);\r\n\t\t\t}\r\n\r\n\t\t\treturn 0.5 * Math.pow(2, -10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI) + 1;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tBack: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\tvar s = 1.70158;\r\n\r\n\t\t\treturn k * k * ((s + 1) * k - s);\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\tvar s = 1.70158;\r\n\r\n\t\t\treturn --k * k * ((s + 1) * k + s) + 1;\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tvar s = 1.70158 * 1.525;\r\n\r\n\t\t\tif ((k *= 2) < 1) {\r\n\t\t\t\treturn 0.5 * (k * k * ((s + 1) * k - s));\r\n\t\t\t}\r\n\r\n\t\t\treturn 0.5 * ((k -= 2) * k * ((s + 1) * k + s) + 2);\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tBounce: {\r\n\r\n\t\tIn: function (k) {\r\n\r\n\t\t\treturn 1 - TWEEN.Easing.Bounce.Out(1 - k);\r\n\r\n\t\t},\r\n\r\n\t\tOut: function (k) {\r\n\r\n\t\t\tif (k < (1 / 2.75)) {\r\n\t\t\t\treturn 7.5625 * k * k;\r\n\t\t\t} else if (k < (2 / 2.75)) {\r\n\t\t\t\treturn 7.5625 * (k -= (1.5 / 2.75)) * k + 0.75;\r\n\t\t\t} else if (k < (2.5 / 2.75)) {\r\n\t\t\t\treturn 7.5625 * (k -= (2.25 / 2.75)) * k + 0.9375;\r\n\t\t\t} else {\r\n\t\t\t\treturn 7.5625 * (k -= (2.625 / 2.75)) * k + 0.984375;\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tInOut: function (k) {\r\n\r\n\t\t\tif (k < 0.5) {\r\n\t\t\t\treturn TWEEN.Easing.Bounce.In(k * 2) * 0.5;\r\n\t\t\t}\r\n\r\n\t\t\treturn TWEEN.Easing.Bounce.Out(k * 2 - 1) * 0.5 + 0.5;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nTWEEN.Interpolation = {\r\n\r\n\tLinear: function (v, k) {\r\n\r\n\t\tvar m = v.length - 1;\r\n\t\tvar f = m * k;\r\n\t\tvar i = Math.floor(f);\r\n\t\tvar fn = TWEEN.Interpolation.Utils.Linear;\r\n\r\n\t\tif (k < 0) {\r\n\t\t\treturn fn(v[0], v[1], f);\r\n\t\t}\r\n\r\n\t\tif (k > 1) {\r\n\t\t\treturn fn(v[m], v[m - 1], m - f);\r\n\t\t}\r\n\r\n\t\treturn fn(v[i], v[i + 1 > m ? m : i + 1], f - i);\r\n\r\n\t},\r\n\r\n\tBezier: function (v, k) {\r\n\r\n\t\tvar b = 0;\r\n\t\tvar n = v.length - 1;\r\n\t\tvar pw = Math.pow;\r\n\t\tvar bn = TWEEN.Interpolation.Utils.Bernstein;\r\n\r\n\t\tfor (var i = 0; i <= n; i++) {\r\n\t\t\tb += pw(1 - k, n - i) * pw(k, i) * v[i] * bn(n, i);\r\n\t\t}\r\n\r\n\t\treturn b;\r\n\r\n\t},\r\n\r\n\tCatmullRom: function (v, k) {\r\n\r\n\t\tvar m = v.length - 1;\r\n\t\tvar f = m * k;\r\n\t\tvar i = Math.floor(f);\r\n\t\tvar fn = TWEEN.Interpolation.Utils.CatmullRom;\r\n\r\n\t\tif (v[0] === v[m]) {\r\n\r\n\t\t\tif (k < 0) {\r\n\t\t\t\ti = Math.floor(f = m * (1 + k));\r\n\t\t\t}\r\n\r\n\t\t\treturn fn(v[(i - 1 + m) % m], v[i], v[(i + 1) % m], v[(i + 2) % m], f - i);\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif (k < 0) {\r\n\t\t\t\treturn v[0] - (fn(v[0], v[0], v[1], v[1], -f) - v[0]);\r\n\t\t\t}\r\n\r\n\t\t\tif (k > 1) {\r\n\t\t\t\treturn v[m] - (fn(v[m], v[m], v[m - 1], v[m - 1], f - m) - v[m]);\r\n\t\t\t}\r\n\r\n\t\t\treturn fn(v[i ? i - 1 : 0], v[i], v[m < i + 1 ? m : i + 1], v[m < i + 2 ? m : i + 2], f - i);\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tUtils: {\r\n\r\n\t\tLinear: function (p0, p1, t) {\r\n\r\n\t\t\treturn (p1 - p0) * t + p0;\r\n\r\n\t\t},\r\n\r\n\t\tBernstein: function (n, i) {\r\n\r\n\t\t\tvar fc = TWEEN.Interpolation.Utils.Factorial;\r\n\r\n\t\t\treturn fc(n) / fc(i) / fc(n - i);\r\n\r\n\t\t},\r\n\r\n\t\tFactorial: (function () {\r\n\r\n\t\t\tvar a = [1];\r\n\r\n\t\t\treturn function (n) {\r\n\r\n\t\t\t\tvar s = 1;\r\n\r\n\t\t\t\tif (a[n]) {\r\n\t\t\t\t\treturn a[n];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (var i = n; i > 1; i--) {\r\n\t\t\t\t\ts *= i;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ta[n] = s;\r\n\t\t\t\treturn s;\r\n\r\n\t\t\t};\r\n\r\n\t\t})(),\r\n\r\n\t\tCatmullRom: function (p0, p1, p2, p3, t) {\r\n\r\n\t\t\tvar v0 = (p2 - p0) * 0.5;\r\n\t\t\tvar v1 = (p3 - p1) * 0.5;\r\n\t\t\tvar t2 = t * t;\r\n\t\t\tvar t3 = t * t2;\r\n\r\n\t\t\treturn (2 * p1 - 2 * p2 + v0 + v1) * t3 + (- 3 * p1 + 3 * p2 - 2 * v0 - v1) * t2 + v0 * t + p1;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\n\r\n\r\n\r\n//Attach to the global Gamelab object\r\n\r\n/***************\r\n *\r\n * @memberOf Gamelab\r\n *\r\n * *****************/\r\n\r\nGamelab.TWEEN = TWEEN;\r\n\r\n\r\n/*\r\n\r\n// UMD (Universal Module Definition)\r\n(function (root) {\r\n\r\n    if (typeof define === 'function' && define.amd) {\r\n\r\n        // AMD\r\n        define([], function () {\r\n            return TWEEN;\r\n        });\r\n\r\n    } else if (typeof module !== 'undefined' && typeof exports === 'object') {\r\n\r\n        // Node.js\r\n        module.exports = TWEEN;\r\n\r\n    } else if (root !== undefined) {\r\n\r\n        // Global variable\r\n        root.TWEEN = TWEEN;\r\n\r\n    }\r\n\r\n})(this);\r\n\r\n*/\r\n;\n//Call Gamelab.FeatureInject::\n\nGamelab.FeatureInject();\n\n\n// UMD (Universal Module Definition)\n(function (root) {\n\n    if (typeof define === 'function' && define.amd) {\n\n        // AMD\n        define([], function () {\n            return Gamelab;\n        });\n\n    } else if (typeof module !== 'undefined' && typeof exports === 'object') {\n\n        // Node.js\n        module.exports = Gamelab;\n\n    } else if (root !== undefined) {\n\n        // Global variable\n        root.Gamelab = Gamelab;\n\n    }\n\n})(this);\n"]}